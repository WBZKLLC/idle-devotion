{"dependencies":[{"name":"@sentry/core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":47,"index":47}}],"key":"/o+dASQcHF2bB25icdsM0E4TExc=","exportNames":["*"],"imports":1}},{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":48},"end":{"line":2,"column":52,"index":100}}],"key":"m+kcirlwHAgMIuUoyR2vCxbhWD4=","exportNames":["*"],"imports":1}},{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":101},"end":{"line":3,"column":90,"index":191}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"makeFetchTransport\", {\n    enumerable: true,\n    get: function () {\n      return makeFetchTransport;\n    }\n  });\n  var _sentryCore = require(_dependencyMap[0], \"@sentry/core\");\n  var _sentryUtils = require(_dependencyMap[1], \"@sentry/utils\");\n  var _utilsJs = require(_dependencyMap[2], \"./utils.js\");\n  /**\n   * Creates a Transport that uses the Fetch API to send events to Sentry.\n   */\n  function makeFetchTransport(options, nativeFetch = (0, _utilsJs.getNativeFetchImplementation)()) {\n    let pendingBodySize = 0;\n    let pendingCount = 0;\n    function makeRequest(request) {\n      const requestSize = request.body.length;\n      pendingBodySize += requestSize;\n      pendingCount++;\n      const requestOptions = {\n        body: request.body,\n        method: 'POST',\n        referrerPolicy: 'origin',\n        headers: options.headers,\n        // Outgoing requests are usually cancelled when navigating to a different page, causing a \"TypeError: Failed to\n        // fetch\" error and sending a \"network_error\" client-outcome - in Chrome, the request status shows \"(cancelled)\".\n        // The `keepalive` flag keeps outgoing requests alive, even when switching pages. We want this since we're\n        // frequently sending events right before the user is switching pages (eg. whenfinishing navigation transactions).\n        // Gotchas:\n        // - `keepalive` isn't supported by Firefox\n        // - As per spec (https://fetch.spec.whatwg.org/#http-network-or-cache-fetch):\n        //   If the sum of contentLength and inflightKeepaliveBytes is greater than 64 kibibytes, then return a network error.\n        //   We will therefore only activate the flag when we're below that limit.\n        // There is also a limit of requests that can be open at the same time, so we also limit this to 15\n        // See https://github.com/getsentry/sentry-javascript/pull/7553 for details\n        keepalive: pendingBodySize <= 60000 && pendingCount < 15,\n        ...options.fetchOptions\n      };\n      try {\n        return nativeFetch(options.url, requestOptions).then(response => {\n          pendingBodySize -= requestSize;\n          pendingCount--;\n          return {\n            statusCode: response.status,\n            headers: {\n              'x-sentry-rate-limits': response.headers.get('X-Sentry-Rate-Limits'),\n              'retry-after': response.headers.get('Retry-After')\n            }\n          };\n        });\n      } catch (e) {\n        (0, _utilsJs.clearCachedFetchImplementation)();\n        pendingBodySize -= requestSize;\n        pendingCount--;\n        return (0, _sentryUtils.rejectedSyncPromise)(e);\n      }\n    }\n    return (0, _sentryCore.createTransport)(options, makeRequest);\n  }\n});","lineCount":66,"map":[[7,2,63,0,"Object"],[7,8,63,0],[7,9,63,0,"defineProperty"],[7,23,63,0],[7,24,63,0,"exports"],[7,31,63,0],[8,4,63,0,"enumerable"],[8,14,63,0],[9,4,63,0,"get"],[9,7,63,0],[9,18,63,0,"get"],[9,19,63,0],[10,6,63,0],[10,13,63,9,"makeFetchTransport"],[10,31,63,27],[11,4,63,27],[12,2,63,27],[13,2,1,0],[13,6,1,0,"_sentryCore"],[13,17,1,0],[13,20,1,0,"require"],[13,27,1,0],[13,28,1,0,"_dependencyMap"],[13,42,1,0],[14,2,2,0],[14,6,2,0,"_sentryUtils"],[14,18,2,0],[14,21,2,0,"require"],[14,28,2,0],[14,29,2,0,"_dependencyMap"],[14,43,2,0],[15,2,3,0],[15,6,3,0,"_utilsJs"],[15,14,3,0],[15,17,3,0,"require"],[15,24,3,0],[15,25,3,0,"_dependencyMap"],[15,39,3,0],[16,2,5,0],[17,0,6,0],[18,0,7,0],[19,2,8,0],[19,11,8,9,"makeFetchTransport"],[19,29,8,27,"makeFetchTransport"],[19,30,9,2,"options"],[19,37,9,9],[19,39,10,2,"nativeFetch"],[19,50,10,13],[19,53,10,16],[19,57,10,16,"getNativeFetchImplementation"],[19,65,10,44],[19,66,10,44,"getNativeFetchImplementation"],[19,94,10,44],[19,96,10,45],[19,97,10,46],[19,99,11,2],[20,4,12,2],[20,8,12,6,"pendingBodySize"],[20,23,12,21],[20,26,12,24],[20,27,12,25],[21,4,13,2],[21,8,13,6,"pendingCount"],[21,20,13,18],[21,23,13,21],[21,24,13,22],[22,4,15,2],[22,13,15,11,"makeRequest"],[22,24,15,22,"makeRequest"],[22,25,15,23,"request"],[22,32,15,30],[22,34,15,32],[23,6,16,4],[23,12,16,10,"requestSize"],[23,23,16,21],[23,26,16,24,"request"],[23,33,16,31],[23,34,16,32,"body"],[23,38,16,36],[23,39,16,37,"length"],[23,45,16,43],[24,6,17,4,"pendingBodySize"],[24,21,17,19],[24,25,17,23,"requestSize"],[24,36,17,34],[25,6,18,4,"pendingCount"],[25,18,18,16],[25,20,18,18],[26,6,20,4],[26,12,20,10,"requestOptions"],[26,26,20,24],[26,29,20,27],[27,8,21,6,"body"],[27,12,21,10],[27,14,21,12,"request"],[27,21,21,19],[27,22,21,20,"body"],[27,26,21,24],[28,8,22,6,"method"],[28,14,22,12],[28,16,22,14],[28,22,22,20],[29,8,23,6,"referrerPolicy"],[29,22,23,20],[29,24,23,22],[29,32,23,30],[30,8,24,6,"headers"],[30,15,24,13],[30,17,24,15,"options"],[30,24,24,22],[30,25,24,23,"headers"],[30,32,24,30],[31,8,25,6],[32,8,26,6],[33,8,27,6],[34,8,28,6],[35,8,29,6],[36,8,30,6],[37,8,31,6],[38,8,32,6],[39,8,33,6],[40,8,34,6],[41,8,35,6],[42,8,36,6,"keepalive"],[42,17,36,15],[42,19,36,17,"pendingBodySize"],[42,34,36,32],[42,38,36,36],[42,43,36,41],[42,47,36,45,"pendingCount"],[42,59,36,57],[42,62,36,60],[42,64,36,62],[43,8,37,6],[43,11,37,9,"options"],[43,18,37,16],[43,19,37,17,"fetchOptions"],[44,6,38,4],[44,7,38,5],[45,6,40,4],[45,10,40,8],[46,8,41,6],[46,15,41,13,"nativeFetch"],[46,26,41,24],[46,27,41,25,"options"],[46,34,41,32],[46,35,41,33,"url"],[46,38,41,36],[46,40,41,38,"requestOptions"],[46,54,41,52],[46,55,41,53],[46,56,41,54,"then"],[46,60,41,58],[46,61,41,59,"response"],[46,69,41,67],[46,73,41,71],[47,10,42,8,"pendingBodySize"],[47,25,42,23],[47,29,42,27,"requestSize"],[47,40,42,38],[48,10,43,8,"pendingCount"],[48,22,43,20],[48,24,43,22],[49,10,44,8],[49,17,44,15],[50,12,45,10,"statusCode"],[50,22,45,20],[50,24,45,22,"response"],[50,32,45,30],[50,33,45,31,"status"],[50,39,45,37],[51,12,46,10,"headers"],[51,19,46,17],[51,21,46,19],[52,14,47,12],[52,36,47,34],[52,38,47,36,"response"],[52,46,47,44],[52,47,47,45,"headers"],[52,54,47,52],[52,55,47,53,"get"],[52,58,47,56],[52,59,47,57],[52,81,47,79],[52,82,47,80],[53,14,48,12],[53,27,48,25],[53,29,48,27,"response"],[53,37,48,35],[53,38,48,36,"headers"],[53,45,48,43],[53,46,48,44,"get"],[53,49,48,47],[53,50,48,48],[53,63,48,61],[54,12,49,10],[55,10,50,8],[55,11,50,9],[56,8,51,6],[56,9,51,7],[56,10,51,8],[57,6,52,4],[57,7,52,5],[57,8,52,6],[57,15,52,13,"e"],[57,16,52,14],[57,18,52,16],[58,8,53,6],[58,12,53,6,"clearCachedFetchImplementation"],[58,20,53,36],[58,21,53,36,"clearCachedFetchImplementation"],[58,51,53,36],[58,53,53,37],[58,54,53,38],[59,8,54,6,"pendingBodySize"],[59,23,54,21],[59,27,54,25,"requestSize"],[59,38,54,36],[60,8,55,6,"pendingCount"],[60,20,55,18],[60,22,55,20],[61,8,56,6],[61,15,56,13],[61,19,56,13,"rejectedSyncPromise"],[61,31,56,32],[61,32,56,32,"rejectedSyncPromise"],[61,51,56,32],[61,53,56,33,"e"],[61,54,56,34],[61,55,56,35],[62,6,57,4],[63,4,58,2],[64,4,60,2],[64,11,60,9],[64,15,60,9,"createTransport"],[64,26,60,24],[64,27,60,24,"createTransport"],[64,42,60,24],[64,44,60,25,"options"],[64,51,60,32],[64,53,60,34,"makeRequest"],[64,64,60,45],[64,65,60,46],[65,2,61,0],[66,0,61,1],[66,3]],"functionMap":{"names":["<global>","makeFetchTransport","makeRequest","nativeFetch.then$argument_0"],"mappings":"AAA;ACO;ECO;2DC0B;ODU;GDO;CDG"},"hasCjsExports":false},"type":"js/module"}]}