{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.getFriendsSummary = getFriendsSummary;\n  exports.getFriendsList = getFriendsList;\n  exports.getFriendRequests = getFriendRequests;\n  exports.acceptFriendRequest = acceptFriendRequest;\n  exports.declineFriendRequest = declineFriendRequest;\n  exports.searchPlayers = searchPlayers;\n  exports.sendFriendRequest = sendFriendRequest;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  // /app/frontend/lib/api/friends.ts\n  // Phase 3.23.2: Friends API Layer\n  //\n  // Canonical API calls for friends system.\n  // Graceful error handling â€” returns defaults on failure.\n\n  const API_BASE = _expoVirtualEnv.env.EXPO_PUBLIC_API_URL || '';\n\n  /**\n   * Get friends summary (badge counts)\n   */\n  async function getFriendsSummary(username) {\n    try {\n      const res = await fetch(`${API_BASE}/api/friends/summary/${username}`);\n      if (!res.ok) throw new Error('Failed to fetch friends summary');\n      return await res.json();\n    } catch {\n      return {\n        pendingRequests: 0,\n        totalFriends: 0\n      };\n    }\n  }\n\n  /**\n   * Get friends list\n   */\n  async function getFriendsList(username) {\n    try {\n      const res = await fetch(`${API_BASE}/api/friends/list/${username}`);\n      if (!res.ok) throw new Error('Failed to fetch friends list');\n      const data = await res.json();\n      // Transform backend response to frontend format\n      return data.map(f => ({\n        id: f.friend_id || f.id,\n        username: f.friend_username || f.username,\n        lastOnline: f.last_collected ? 'Earlier today' : 'Yesterday',\n        status: 'offline',\n        affinity: f.can_collect ? 50 : undefined\n      }));\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Get friend requests\n   */\n  async function getFriendRequests(username) {\n    try {\n      const res = await fetch(`${API_BASE}/api/friends/requests/${username}`);\n      if (!res.ok) throw new Error('Failed to fetch friend requests');\n      const data = await res.json();\n      // Transform to frontend format\n      return data.map(r => ({\n        id: r.id,\n        fromUsername: r.from_username,\n        timestamp: 'Just now'\n      }));\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Accept friend request\n   */\n  async function acceptFriendRequest(username, requestId) {\n    const res = await fetch(`${API_BASE}/api/friends/requests/${username}/${requestId}/accept`, {\n      method: 'POST'\n    });\n    if (!res.ok) throw new Error('Failed to accept request');\n  }\n\n  /**\n   * Decline friend request\n   */\n  async function declineFriendRequest(username, requestId) {\n    const res = await fetch(`${API_BASE}/api/friends/requests/${username}/${requestId}/decline`, {\n      method: 'POST'\n    });\n    if (!res.ok) throw new Error('Failed to decline request');\n  }\n\n  /**\n   * Search for players\n   */\n  async function searchPlayers(query, username) {\n    if (!query || query.length < 2) return [];\n    try {\n      const params = new URLSearchParams({\n        q: query\n      });\n      if (username) params.append('username', username);\n      const res = await fetch(`${API_BASE}/api/friends/search?${params}`);\n      if (!res.ok) throw new Error('Failed to search players');\n      return await res.json();\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Send friend request\n   */\n  async function sendFriendRequest(fromUsername, toUsername) {\n    const res = await fetch(`${API_BASE}/api/friends/requests/send`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        from: fromUsername,\n        to: toUsername\n      })\n    });\n    if (!res.ok) throw new Error('Failed to send request');\n  }\n});","lineCount":133,"map":[[7,2,12,0,"exports"],[7,9,12,0],[7,10,12,0,"getFriendsSummary"],[7,27,12,0],[7,30,12,0,"getFriendsSummary"],[7,47,12,0],[8,2,28,0,"exports"],[8,9,28,0],[8,10,28,0,"getFriendsList"],[8,24,28,0],[8,27,28,0,"getFriendsList"],[8,41,28,0],[9,2,55,0,"exports"],[9,9,55,0],[9,10,55,0,"getFriendRequests"],[9,27,55,0],[9,30,55,0,"getFriendRequests"],[9,47,55,0],[10,2,78,0,"exports"],[10,9,78,0],[10,10,78,0,"acceptFriendRequest"],[10,29,78,0],[10,32,78,0,"acceptFriendRequest"],[10,51,78,0],[11,2,88,0,"exports"],[11,9,88,0],[11,10,88,0,"declineFriendRequest"],[11,30,88,0],[11,33,88,0,"declineFriendRequest"],[11,53,88,0],[12,2,98,0,"exports"],[12,9,98,0],[12,10,98,0,"searchPlayers"],[12,23,98,0],[12,26,98,0,"searchPlayers"],[12,39,98,0],[13,2,122,0,"exports"],[13,9,122,0],[13,10,122,0,"sendFriendRequest"],[13,27,122,0],[13,30,122,0,"sendFriendRequest"],[13,47,122,0],[14,2,129,1],[14,6,129,1,"_expoVirtualEnv"],[14,21,129,1],[14,24,129,1,"require"],[14,31,129,1],[14,32,129,1,"_dependencyMap"],[14,46,129,1],[15,2,1,0],[16,2,2,0],[17,2,3,0],[18,2,4,0],[19,2,5,0],[21,2,7,0],[21,8,7,6,"API_BASE"],[21,16,7,14],[21,19,7,17,"_expoVirtualEnv"],[21,34,7,17],[21,35,7,17,"env"],[21,38,7,17],[21,39,7,17,"EXPO_PUBLIC_API_URL"],[21,58,7,17],[21,62,7,52],[21,64,7,54],[23,2,9,0],[24,0,10,0],[25,0,11,0],[26,2,12,7],[26,17,12,22,"getFriendsSummary"],[26,34,12,39,"getFriendsSummary"],[26,35,12,40,"username"],[26,43,12,56],[26,45,15,3],[27,4,16,2],[27,8,16,6],[28,6,17,4],[28,12,17,10,"res"],[28,15,17,13],[28,18,17,16],[28,24,17,22,"fetch"],[28,29,17,27],[28,30,17,28],[28,33,17,31,"API_BASE"],[28,41,17,39],[28,65,17,63,"username"],[28,73,17,71],[28,75,17,73],[28,76,17,74],[29,6,18,4],[29,10,18,8],[29,11,18,9,"res"],[29,14,18,12],[29,15,18,13,"ok"],[29,17,18,15],[29,19,18,17],[29,25,18,23],[29,29,18,27,"Error"],[29,34,18,32],[29,35,18,33],[29,68,18,66],[29,69,18,67],[30,6,19,4],[30,13,19,11],[30,19,19,17,"res"],[30,22,19,20],[30,23,19,21,"json"],[30,27,19,25],[30,28,19,26],[30,29,19,27],[31,4,20,2],[31,5,20,3],[31,6,20,4],[31,12,20,10],[32,6,21,4],[32,13,21,11],[33,8,21,13,"pendingRequests"],[33,23,21,28],[33,25,21,30],[33,26,21,31],[34,8,21,33,"totalFriends"],[34,20,21,45],[34,22,21,47],[35,6,21,49],[35,7,21,50],[36,4,22,2],[37,2,23,0],[39,2,25,0],[40,0,26,0],[41,0,27,0],[42,2,28,7],[42,17,28,22,"getFriendsList"],[42,31,28,36,"getFriendsList"],[42,32,28,37,"username"],[42,40,28,53],[42,42,34,4],[43,4,35,2],[43,8,35,6],[44,6,36,4],[44,12,36,10,"res"],[44,15,36,13],[44,18,36,16],[44,24,36,22,"fetch"],[44,29,36,27],[44,30,36,28],[44,33,36,31,"API_BASE"],[44,41,36,39],[44,62,36,60,"username"],[44,70,36,68],[44,72,36,70],[44,73,36,71],[45,6,37,4],[45,10,37,8],[45,11,37,9,"res"],[45,14,37,12],[45,15,37,13,"ok"],[45,17,37,15],[45,19,37,17],[45,25,37,23],[45,29,37,27,"Error"],[45,34,37,32],[45,35,37,33],[45,65,37,63],[45,66,37,64],[46,6,38,4],[46,12,38,10,"data"],[46,16,38,14],[46,19,38,17],[46,25,38,23,"res"],[46,28,38,26],[46,29,38,27,"json"],[46,33,38,31],[46,34,38,32],[46,35,38,33],[47,6,39,4],[48,6,40,4],[48,13,40,11,"data"],[48,17,40,15],[48,18,40,16,"map"],[48,21,40,19],[48,22,40,21,"f"],[48,23,40,27],[48,28,40,33],[49,8,41,6,"id"],[49,10,41,8],[49,12,41,10,"f"],[49,13,41,11],[49,14,41,12,"friend_id"],[49,23,41,21],[49,27,41,25,"f"],[49,28,41,26],[49,29,41,27,"id"],[49,31,41,29],[50,8,42,6,"username"],[50,16,42,14],[50,18,42,16,"f"],[50,19,42,17],[50,20,42,18,"friend_username"],[50,35,42,33],[50,39,42,37,"f"],[50,40,42,38],[50,41,42,39,"username"],[50,49,42,47],[51,8,43,6,"lastOnline"],[51,18,43,16],[51,20,43,18,"f"],[51,21,43,19],[51,22,43,20,"last_collected"],[51,36,43,34],[51,39,43,37],[51,54,43,52],[51,57,43,55],[51,68,43,66],[52,8,44,6,"status"],[52,14,44,12],[52,16,44,14],[52,25,44,32],[53,8,45,6,"affinity"],[53,16,45,14],[53,18,45,16,"f"],[53,19,45,17],[53,20,45,18,"can_collect"],[53,31,45,29],[53,34,45,32],[53,36,45,34],[53,39,45,37,"undefined"],[54,6,46,4],[54,7,46,5],[54,8,46,6],[54,9,46,7],[55,4,47,2],[55,5,47,3],[55,6,47,4],[55,12,47,10],[56,6,48,4],[56,13,48,11],[56,15,48,13],[57,4,49,2],[58,2,50,0],[60,2,52,0],[61,0,53,0],[62,0,54,0],[63,2,55,7],[63,17,55,22,"getFriendRequests"],[63,34,55,39,"getFriendRequests"],[63,35,55,40,"username"],[63,43,55,56],[63,45,59,4],[64,4,60,2],[64,8,60,6],[65,6,61,4],[65,12,61,10,"res"],[65,15,61,13],[65,18,61,16],[65,24,61,22,"fetch"],[65,29,61,27],[65,30,61,28],[65,33,61,31,"API_BASE"],[65,41,61,39],[65,66,61,64,"username"],[65,74,61,72],[65,76,61,74],[65,77,61,75],[66,6,62,4],[66,10,62,8],[66,11,62,9,"res"],[66,14,62,12],[66,15,62,13,"ok"],[66,17,62,15],[66,19,62,17],[66,25,62,23],[66,29,62,27,"Error"],[66,34,62,32],[66,35,62,33],[66,68,62,66],[66,69,62,67],[67,6,63,4],[67,12,63,10,"data"],[67,16,63,14],[67,19,63,17],[67,25,63,23,"res"],[67,28,63,26],[67,29,63,27,"json"],[67,33,63,31],[67,34,63,32],[67,35,63,33],[68,6,64,4],[69,6,65,4],[69,13,65,11,"data"],[69,17,65,15],[69,18,65,16,"map"],[69,21,65,19],[69,22,65,21,"r"],[69,23,65,27],[69,28,65,33],[70,8,66,6,"id"],[70,10,66,8],[70,12,66,10,"r"],[70,13,66,11],[70,14,66,12,"id"],[70,16,66,14],[71,8,67,6,"fromUsername"],[71,20,67,18],[71,22,67,20,"r"],[71,23,67,21],[71,24,67,22,"from_username"],[71,37,67,35],[72,8,68,6,"timestamp"],[72,17,68,15],[72,19,68,17],[73,6,69,4],[73,7,69,5],[73,8,69,6],[73,9,69,7],[74,4,70,2],[74,5,70,3],[74,6,70,4],[74,12,70,10],[75,6,71,4],[75,13,71,11],[75,15,71,13],[76,4,72,2],[77,2,73,0],[79,2,75,0],[80,0,76,0],[81,0,77,0],[82,2,78,7],[82,17,78,22,"acceptFriendRequest"],[82,36,78,41,"acceptFriendRequest"],[82,37,78,42,"username"],[82,45,78,58],[82,47,78,60,"requestId"],[82,56,78,77],[82,58,78,94],[83,4,79,2],[83,10,79,8,"res"],[83,13,79,11],[83,16,79,14],[83,22,79,20,"fetch"],[83,27,79,25],[83,28,79,26],[83,31,79,29,"API_BASE"],[83,39,79,37],[83,64,79,62,"username"],[83,72,79,70],[83,76,79,74,"requestId"],[83,85,79,83],[83,94,79,92],[83,96,79,94],[84,6,80,4,"method"],[84,12,80,10],[84,14,80,12],[85,4,81,2],[85,5,81,3],[85,6,81,4],[86,4,82,2],[86,8,82,6],[86,9,82,7,"res"],[86,12,82,10],[86,13,82,11,"ok"],[86,15,82,13],[86,17,82,15],[86,23,82,21],[86,27,82,25,"Error"],[86,32,82,30],[86,33,82,31],[86,59,82,57],[86,60,82,58],[87,2,83,0],[89,2,85,0],[90,0,86,0],[91,0,87,0],[92,2,88,7],[92,17,88,22,"declineFriendRequest"],[92,37,88,42,"declineFriendRequest"],[92,38,88,43,"username"],[92,46,88,59],[92,48,88,61,"requestId"],[92,57,88,78],[92,59,88,95],[93,4,89,2],[93,10,89,8,"res"],[93,13,89,11],[93,16,89,14],[93,22,89,20,"fetch"],[93,27,89,25],[93,28,89,26],[93,31,89,29,"API_BASE"],[93,39,89,37],[93,64,89,62,"username"],[93,72,89,70],[93,76,89,74,"requestId"],[93,85,89,83],[93,95,89,93],[93,97,89,95],[94,6,90,4,"method"],[94,12,90,10],[94,14,90,12],[95,4,91,2],[95,5,91,3],[95,6,91,4],[96,4,92,2],[96,8,92,6],[96,9,92,7,"res"],[96,12,92,10],[96,13,92,11,"ok"],[96,15,92,13],[96,17,92,15],[96,23,92,21],[96,27,92,25,"Error"],[96,32,92,30],[96,33,92,31],[96,60,92,58],[96,61,92,59],[97,2,93,0],[99,2,95,0],[100,0,96,0],[101,0,97,0],[102,2,98,7],[102,17,98,22,"searchPlayers"],[102,30,98,35,"searchPlayers"],[102,31,98,36,"query"],[102,36,98,49],[102,38,98,51,"username"],[102,46,98,68],[102,48,104,4],[103,4,105,2],[103,8,105,6],[103,9,105,7,"query"],[103,14,105,12],[103,18,105,16,"query"],[103,23,105,21],[103,24,105,22,"length"],[103,30,105,28],[103,33,105,31],[103,34,105,32],[103,36,105,34],[103,43,105,41],[103,45,105,43],[104,4,107,2],[104,8,107,6],[105,6,108,4],[105,12,108,10,"params"],[105,18,108,16],[105,21,108,19],[105,25,108,23,"URLSearchParams"],[105,40,108,38],[105,41,108,39],[106,8,108,41,"q"],[106,9,108,42],[106,11,108,44,"query"],[107,6,108,50],[107,7,108,51],[107,8,108,52],[108,6,109,4],[108,10,109,8,"username"],[108,18,109,16],[108,20,109,18,"params"],[108,26,109,24],[108,27,109,25,"append"],[108,33,109,31],[108,34,109,32],[108,44,109,42],[108,46,109,44,"username"],[108,54,109,52],[108,55,109,53],[109,6,111,4],[109,12,111,10,"res"],[109,15,111,13],[109,18,111,16],[109,24,111,22,"fetch"],[109,29,111,27],[109,30,111,28],[109,33,111,31,"API_BASE"],[109,41,111,39],[109,64,111,62,"params"],[109,70,111,68],[109,72,111,70],[109,73,111,71],[110,6,112,4],[110,10,112,8],[110,11,112,9,"res"],[110,14,112,12],[110,15,112,13,"ok"],[110,17,112,15],[110,19,112,17],[110,25,112,23],[110,29,112,27,"Error"],[110,34,112,32],[110,35,112,33],[110,61,112,59],[110,62,112,60],[111,6,113,4],[111,13,113,11],[111,19,113,17,"res"],[111,22,113,20],[111,23,113,21,"json"],[111,27,113,25],[111,28,113,26],[111,29,113,27],[112,4,114,2],[112,5,114,3],[112,6,114,4],[112,12,114,10],[113,6,115,4],[113,13,115,11],[113,15,115,13],[114,4,116,2],[115,2,117,0],[117,2,119,0],[118,0,120,0],[119,0,121,0],[120,2,122,7],[120,17,122,22,"sendFriendRequest"],[120,34,122,39,"sendFriendRequest"],[120,35,122,40,"fromUsername"],[120,47,122,60],[120,49,122,62,"toUsername"],[120,59,122,80],[120,61,122,97],[121,4,123,2],[121,10,123,8,"res"],[121,13,123,11],[121,16,123,14],[121,22,123,20,"fetch"],[121,27,123,25],[121,28,123,26],[121,31,123,29,"API_BASE"],[121,39,123,37],[121,67,123,65],[121,69,123,67],[122,6,124,4,"method"],[122,12,124,10],[122,14,124,12],[122,20,124,18],[123,6,125,4,"headers"],[123,13,125,11],[123,15,125,13],[124,8,125,15],[124,22,125,29],[124,24,125,31],[125,6,125,50],[125,7,125,51],[126,6,126,4,"body"],[126,10,126,8],[126,12,126,10,"JSON"],[126,16,126,14],[126,17,126,15,"stringify"],[126,26,126,24],[126,27,126,25],[127,8,126,27,"from"],[127,12,126,31],[127,14,126,33,"fromUsername"],[127,26,126,45],[128,8,126,47,"to"],[128,10,126,49],[128,12,126,51,"toUsername"],[129,6,126,62],[129,7,126,63],[130,4,127,2],[130,5,127,3],[130,6,127,4],[131,4,128,2],[131,8,128,6],[131,9,128,7,"res"],[131,12,128,10],[131,13,128,11,"ok"],[131,15,128,13],[131,17,128,15],[131,23,128,21],[131,27,128,25,"Error"],[131,32,128,30],[131,33,128,31],[131,57,128,55],[131,58,128,56],[132,2,129,0],[133,0,129,1],[133,3]],"functionMap":{"names":["<global>","getFriendsSummary","getFriendsList","data.map$argument_0","getFriendRequests","acceptFriendRequest","declineFriendRequest","searchPlayers","sendFriendRequest"],"mappings":"AAA;OCW;CDW;OEK;oBCY;MDM;CFI;OIK;oBDU;MCI;CJI;OKK;CLK;OMK;CNK;OOK;CPmB;OQK;CRO"},"hasCjsExports":false},"type":"js/module"}]}