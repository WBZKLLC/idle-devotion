{"dependencies":[{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":67,"index":67}}],"key":"m+kcirlwHAgMIuUoyR2vCxbhWD4=","exportNames":["*"],"imports":1}},{"name":"../api.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":68},"end":{"line":2,"column":66,"index":134}}],"key":"cPKsELqWARxElqFlbsOK3W8pAh4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"eventFromEnvelope\", {\n    enumerable: true,\n    get: function () {\n      return eventFromEnvelope;\n    }\n  });\n  Object.defineProperty(exports, \"makeMultiplexedTransport\", {\n    enumerable: true,\n    get: function () {\n      return makeMultiplexedTransport;\n    }\n  });\n  var _sentryUtils = require(_dependencyMap[0], \"@sentry/utils\");\n  var _apiJs = require(_dependencyMap[1], \"../api.js\");\n  /**\n   * Gets an event from an envelope.\n   *\n   * This is only exported for use in the tests\n   */\n  function eventFromEnvelope(env, types) {\n    let event;\n    (0, _sentryUtils.forEachEnvelopeItem)(env, (item, type) => {\n      if (types.includes(type)) {\n        event = Array.isArray(item) ? item[1] : undefined;\n      }\n      // bail out if we found an event\n      return !!event;\n    });\n    return event;\n  }\n\n  /**\n   * Creates a transport that overrides the release on all events.\n   */\n  function makeOverrideReleaseTransport(createTransport, release) {\n    return options => {\n      const transport = createTransport(options);\n      return {\n        send: async envelope => {\n          const event = eventFromEnvelope(envelope, ['event', 'transaction', 'profile', 'replay_event']);\n          if (event) {\n            event.release = release;\n          }\n          return transport.send(envelope);\n        },\n        flush: timeout => transport.flush(timeout)\n      };\n    };\n  }\n\n  /**\n   * Creates a transport that can send events to different DSNs depending on the envelope contents.\n   */\n  function makeMultiplexedTransport(createTransport, matcher) {\n    return options => {\n      const fallbackTransport = createTransport(options);\n      const otherTransports = {};\n      function getTransport(dsn, release) {\n        // We create a transport for every unique dsn/release combination as there may be code from multiple releases in\n        // use at the same time\n        const key = release ? `${dsn}:${release}` : dsn;\n        if (!otherTransports[key]) {\n          const validatedDsn = (0, _sentryUtils.dsnFromString)(dsn);\n          if (!validatedDsn) {\n            return undefined;\n          }\n          const url = (0, _apiJs.getEnvelopeEndpointWithUrlEncodedAuth)(validatedDsn);\n          otherTransports[key] = release ? makeOverrideReleaseTransport(createTransport, release)(Object.assign({}, options, {\n            url\n          })) : createTransport(Object.assign({}, options, {\n            url\n          }));\n        }\n        return otherTransports[key];\n      }\n      async function send(envelope) {\n        function getEvent(types) {\n          const eventTypes = types && types.length ? types : ['event'];\n          return eventFromEnvelope(envelope, eventTypes);\n        }\n        const transports = matcher({\n          envelope,\n          getEvent\n        }).map(result => {\n          if (typeof result === 'string') {\n            return getTransport(result, undefined);\n          } else {\n            return getTransport(result.dsn, result.release);\n          }\n        }).filter(t => !!t);\n\n        // If we have no transports to send to, use the fallback transport\n        if (transports.length === 0) {\n          transports.push(fallbackTransport);\n        }\n        const results = await Promise.all(transports.map(transport => transport.send(envelope)));\n        return results[0];\n      }\n      async function flush(timeout) {\n        const allTransports = [...Object.keys(otherTransports).map(dsn => otherTransports[dsn]), fallbackTransport];\n        const results = await Promise.all(allTransports.map(transport => transport.flush(timeout)));\n        return results.every(r => r);\n      }\n      return {\n        send,\n        flush\n      };\n    };\n  }\n});","lineCount":116,"map":[[7,2,117,0,"Object"],[7,8,117,0],[7,9,117,0,"defineProperty"],[7,23,117,0],[7,24,117,0,"exports"],[7,31,117,0],[8,4,117,0,"enumerable"],[8,14,117,0],[9,4,117,0,"get"],[9,7,117,0],[9,18,117,0,"get"],[9,19,117,0],[10,6,117,0],[10,13,117,9,"eventFromEnvelope"],[10,30,117,26],[11,4,117,26],[12,2,117,26],[13,2,117,0,"Object"],[13,8,117,0],[13,9,117,0,"defineProperty"],[13,23,117,0],[13,24,117,0,"exports"],[13,31,117,0],[14,4,117,0,"enumerable"],[14,14,117,0],[15,4,117,0,"get"],[15,7,117,0],[15,18,117,0,"get"],[15,19,117,0],[16,6,117,0],[16,13,117,28,"makeMultiplexedTransport"],[16,37,117,52],[17,4,117,52],[18,2,117,52],[19,2,1,0],[19,6,1,0,"_sentryUtils"],[19,18,1,0],[19,21,1,0,"require"],[19,28,1,0],[19,29,1,0,"_dependencyMap"],[19,43,1,0],[20,2,2,0],[20,6,2,0,"_apiJs"],[20,12,2,0],[20,15,2,0,"require"],[20,22,2,0],[20,23,2,0,"_dependencyMap"],[20,37,2,0],[21,2,4,0],[22,0,5,0],[23,0,6,0],[24,0,7,0],[25,0,8,0],[26,2,9,0],[26,11,9,9,"eventFromEnvelope"],[26,28,9,26,"eventFromEnvelope"],[26,29,9,27,"env"],[26,32,9,30],[26,34,9,32,"types"],[26,39,9,37],[26,41,9,39],[27,4,10,2],[27,8,10,6,"event"],[27,13,10,11],[28,4,12,2],[28,8,12,2,"forEachEnvelopeItem"],[28,20,12,21],[28,21,12,21,"forEachEnvelopeItem"],[28,40,12,21],[28,42,12,22,"env"],[28,45,12,25],[28,47,12,27],[28,48,12,28,"item"],[28,52,12,32],[28,54,12,34,"type"],[28,58,12,38],[28,63,12,43],[29,6,13,4],[29,10,13,8,"types"],[29,15,13,13],[29,16,13,14,"includes"],[29,24,13,22],[29,25,13,23,"type"],[29,29,13,27],[29,30,13,28],[29,32,13,30],[30,8,14,6,"event"],[30,13,14,11],[30,16,14,14,"Array"],[30,21,14,19],[30,22,14,20,"isArray"],[30,29,14,27],[30,30,14,28,"item"],[30,34,14,32],[30,35,14,33],[30,38,14,37,"item"],[30,42,14,41],[30,43,14,44],[30,44,14,45],[30,45,14,46],[30,48,14,49,"undefined"],[30,57,14,58],[31,6,15,4],[32,6,16,4],[33,6,17,4],[33,13,17,11],[33,14,17,12],[33,15,17,13,"event"],[33,20,17,18],[34,4,18,2],[34,5,18,3],[34,6,18,4],[35,4,20,2],[35,11,20,9,"event"],[35,16,20,14],[36,2,21,0],[38,2,23,0],[39,0,24,0],[40,0,25,0],[41,2,26,0],[41,11,26,9,"makeOverrideReleaseTransport"],[41,39,26,37,"makeOverrideReleaseTransport"],[41,40,27,2,"createTransport"],[41,55,27,17],[41,57,28,2,"release"],[41,64,28,9],[41,66,29,2],[42,4,30,2],[42,11,30,9,"options"],[42,18,30,16],[42,22,30,20],[43,6,31,4],[43,12,31,10,"transport"],[43,21,31,19],[43,24,31,22,"createTransport"],[43,39,31,37],[43,40,31,38,"options"],[43,47,31,45],[43,48,31,46],[44,6,33,4],[44,13,33,11],[45,8,34,6,"send"],[45,12,34,10],[45,14,34,12],[45,20,34,19,"envelope"],[45,28,34,27],[45,32,34,32],[46,10,35,8],[46,16,35,14,"event"],[46,21,35,19],[46,24,35,22,"eventFromEnvelope"],[46,41,35,39],[46,42,35,40,"envelope"],[46,50,35,48],[46,52,35,50],[46,53,35,51],[46,60,35,58],[46,62,35,60],[46,75,35,73],[46,77,35,75],[46,86,35,84],[46,88,35,86],[46,102,35,100],[46,103,35,101],[46,104,35,102],[47,10,37,8],[47,14,37,12,"event"],[47,19,37,17],[47,21,37,19],[48,12,38,10,"event"],[48,17,38,15],[48,18,38,16,"release"],[48,25,38,23],[48,28,38,26,"release"],[48,35,38,33],[49,10,39,8],[50,10,40,8],[50,17,40,15,"transport"],[50,26,40,24],[50,27,40,25,"send"],[50,31,40,29],[50,32,40,30,"envelope"],[50,40,40,38],[50,41,40,39],[51,8,41,6],[51,9,41,7],[52,8,42,6,"flush"],[52,13,42,11],[52,15,42,13,"timeout"],[52,22,42,20],[52,26,42,24,"transport"],[52,35,42,33],[52,36,42,34,"flush"],[52,41,42,39],[52,42,42,40,"timeout"],[52,49,42,47],[53,6,43,4],[53,7,43,5],[54,4,44,2],[54,5,44,3],[55,2,45,0],[57,2,47,0],[58,0,48,0],[59,0,49,0],[60,2,50,0],[60,11,50,9,"makeMultiplexedTransport"],[60,35,50,33,"makeMultiplexedTransport"],[60,36,51,2,"createTransport"],[60,51,51,17],[60,53,52,2,"matcher"],[60,60,52,9],[60,62,53,2],[61,4,54,2],[61,11,54,9,"options"],[61,18,54,16],[61,22,54,20],[62,6,55,4],[62,12,55,10,"fallbackTransport"],[62,29,55,27],[62,32,55,30,"createTransport"],[62,47,55,45],[62,48,55,46,"options"],[62,55,55,53],[62,56,55,54],[63,6,56,4],[63,12,56,10,"otherTransports"],[63,27,56,25],[63,30,56,28],[63,31,56,29],[63,32,56,30],[64,6,58,4],[64,15,58,13,"getTransport"],[64,27,58,25,"getTransport"],[64,28,58,26,"dsn"],[64,31,58,29],[64,33,58,31,"release"],[64,40,58,38],[64,42,58,40],[65,8,59,6],[66,8,60,6],[67,8,61,6],[67,14,61,12,"key"],[67,17,61,15],[67,20,61,18,"release"],[67,27,61,25],[67,30,61,28],[67,33,61,31,"dsn"],[67,36,61,34],[67,40,61,38,"release"],[67,47,61,45],[67,49,61,47],[67,52,61,50,"dsn"],[67,55,61,53],[68,8,63,6],[68,12,63,10],[68,13,63,11,"otherTransports"],[68,28,63,26],[68,29,63,27,"key"],[68,32,63,30],[68,33,63,31],[68,35,63,33],[69,10,64,8],[69,16,64,14,"validatedDsn"],[69,28,64,26],[69,31,64,29],[69,35,64,29,"dsnFromString"],[69,47,64,42],[69,48,64,42,"dsnFromString"],[69,61,64,42],[69,63,64,43,"dsn"],[69,66,64,46],[69,67,64,47],[70,10,65,8],[70,14,65,12],[70,15,65,13,"validatedDsn"],[70,27,65,25],[70,29,65,27],[71,12,66,10],[71,19,66,17,"undefined"],[71,28,66,26],[72,10,67,8],[73,10,68,8],[73,16,68,14,"url"],[73,19,68,17],[73,22,68,20],[73,26,68,20,"getEnvelopeEndpointWithUrlEncodedAuth"],[73,32,68,57],[73,33,68,57,"getEnvelopeEndpointWithUrlEncodedAuth"],[73,70,68,57],[73,72,68,58,"validatedDsn"],[73,84,68,70],[73,85,68,71],[74,10,70,8,"otherTransports"],[74,25,70,23],[74,26,70,24,"key"],[74,29,70,27],[74,30,70,28],[74,33,70,31,"release"],[74,40,70,38],[74,43,71,12,"makeOverrideReleaseTransport"],[74,71,71,40],[74,72,71,41,"createTransport"],[74,87,71,56],[74,89,71,58,"release"],[74,96,71,65],[74,97,71,66],[74,98,71,66,"Object"],[74,104,71,66],[74,105,71,66,"assign"],[74,111,71,66],[74,116,71,72,"options"],[74,123,71,79],[75,12,71,81,"url"],[76,10,71,84],[76,12,71,86],[76,13,71,87],[76,16,72,12,"createTransport"],[76,31,72,27],[76,32,72,27,"Object"],[76,38,72,27],[76,39,72,27,"assign"],[76,45,72,27],[76,50,72,33,"options"],[76,57,72,40],[77,12,72,42,"url"],[78,10,72,45],[78,12,72,47],[78,13,72,48],[79,8,73,6],[80,8,75,6],[80,15,75,13,"otherTransports"],[80,30,75,28],[80,31,75,29,"key"],[80,34,75,32],[80,35,75,33],[81,6,76,4],[82,6,78,4],[82,21,78,19,"send"],[82,25,78,23,"send"],[82,26,78,24,"envelope"],[82,34,78,32],[82,36,78,34],[83,8,79,6],[83,17,79,15,"getEvent"],[83,25,79,23,"getEvent"],[83,26,79,24,"types"],[83,31,79,29],[83,33,79,31],[84,10,80,8],[84,16,80,14,"eventTypes"],[84,26,80,24],[84,29,80,27,"types"],[84,34,80,32],[84,38,80,36,"types"],[84,43,80,41],[84,44,80,42,"length"],[84,50,80,48],[84,53,80,51,"types"],[84,58,80,56],[84,61,80,59],[84,62,80,60],[84,69,80,67],[84,70,80,68],[85,10,81,8],[85,17,81,15,"eventFromEnvelope"],[85,34,81,32],[85,35,81,33,"envelope"],[85,43,81,41],[85,45,81,43,"eventTypes"],[85,55,81,53],[85,56,81,54],[86,8,82,6],[87,8,84,6],[87,14,84,12,"transports"],[87,24,84,22],[87,27,84,25,"matcher"],[87,34,84,32],[87,35,84,33],[88,10,84,35,"envelope"],[88,18,84,43],[89,10,84,45,"getEvent"],[90,8,84,54],[90,9,84,55],[90,10,84,56],[90,11,85,9,"map"],[90,14,85,12],[90,15,85,13,"result"],[90,21,85,19],[90,25,85,23],[91,10,86,10],[91,14,86,14],[91,21,86,21,"result"],[91,27,86,27],[91,32,86,32],[91,40,86,40],[91,42,86,42],[92,12,87,12],[92,19,87,19,"getTransport"],[92,31,87,31],[92,32,87,32,"result"],[92,38,87,38],[92,40,87,40,"undefined"],[92,49,87,49],[92,50,87,50],[93,10,88,10],[93,11,88,11],[93,17,88,17],[94,12,89,12],[94,19,89,19,"getTransport"],[94,31,89,31],[94,32,89,32,"result"],[94,38,89,38],[94,39,89,39,"dsn"],[94,42,89,42],[94,44,89,44,"result"],[94,50,89,50],[94,51,89,51,"release"],[94,58,89,58],[94,59,89,59],[95,10,90,10],[96,8,91,8],[96,9,91,9],[96,10,91,10],[96,11,92,9,"filter"],[96,17,92,15],[96,18,92,17,"t"],[96,19,92,18],[96,23,92,23],[96,24,92,24],[96,25,92,25,"t"],[96,26,92,26],[96,27,92,27],[98,8,94,6],[99,8,95,6],[99,12,95,10,"transports"],[99,22,95,20],[99,23,95,21,"length"],[99,29,95,27],[99,34,95,32],[99,35,95,33],[99,37,95,35],[100,10,96,8,"transports"],[100,20,96,18],[100,21,96,19,"push"],[100,25,96,23],[100,26,96,24,"fallbackTransport"],[100,43,96,41],[100,44,96,42],[101,8,97,6],[102,8,99,6],[102,14,99,12,"results"],[102,21,99,19],[102,24,99,22],[102,30,99,28,"Promise"],[102,37,99,35],[102,38,99,36,"all"],[102,41,99,39],[102,42,99,40,"transports"],[102,52,99,50],[102,53,99,51,"map"],[102,56,99,54],[102,57,99,55,"transport"],[102,66,99,64],[102,70,99,68,"transport"],[102,79,99,77],[102,80,99,78,"send"],[102,84,99,82],[102,85,99,83,"envelope"],[102,93,99,91],[102,94,99,92],[102,95,99,93],[102,96,99,94],[103,8,101,6],[103,15,101,13,"results"],[103,22,101,20],[103,23,101,21],[103,24,101,22],[103,25,101,23],[104,6,102,4],[105,6,104,4],[105,21,104,19,"flush"],[105,26,104,24,"flush"],[105,27,104,25,"timeout"],[105,34,104,32],[105,36,104,34],[106,8,105,6],[106,14,105,12,"allTransports"],[106,27,105,25],[106,30,105,28],[106,31,105,29],[106,34,105,32,"Object"],[106,40,105,38],[106,41,105,39,"keys"],[106,45,105,43],[106,46,105,44,"otherTransports"],[106,61,105,59],[106,62,105,60],[106,63,105,61,"map"],[106,66,105,64],[106,67,105,65,"dsn"],[106,70,105,68],[106,74,105,72,"otherTransports"],[106,89,105,87],[106,90,105,88,"dsn"],[106,93,105,91],[106,94,105,92],[106,95,105,93],[106,97,105,95,"fallbackTransport"],[106,114,105,112],[106,115,105,113],[107,8,106,6],[107,14,106,12,"results"],[107,21,106,19],[107,24,106,22],[107,30,106,28,"Promise"],[107,37,106,35],[107,38,106,36,"all"],[107,41,106,39],[107,42,106,40,"allTransports"],[107,55,106,53],[107,56,106,54,"map"],[107,59,106,57],[107,60,106,58,"transport"],[107,69,106,67],[107,73,106,71,"transport"],[107,82,106,80],[107,83,106,81,"flush"],[107,88,106,86],[107,89,106,87,"timeout"],[107,96,106,94],[107,97,106,95],[107,98,106,96],[107,99,106,97],[108,8,107,6],[108,15,107,13,"results"],[108,22,107,20],[108,23,107,21,"every"],[108,28,107,26],[108,29,107,27,"r"],[108,30,107,28],[108,34,107,32,"r"],[108,35,107,33],[108,36,107,34],[109,6,108,4],[110,6,110,4],[110,13,110,11],[111,8,111,6,"send"],[111,12,111,10],[112,8,112,6,"flush"],[113,6,113,4],[113,7,113,5],[114,4,114,2],[114,5,114,3],[115,2,115,0],[116,0,115,1],[116,3]],"functionMap":{"names":["<global>","eventFromEnvelope","forEachEnvelopeItem$argument_1","makeOverrideReleaseTransport","<anonymous>","send","flush","makeMultiplexedTransport","getTransport","getEvent","matcher.map$argument_0","matcher.map.filter$argument_0","transports.map$argument_0","Object.keys.map$argument_0","allTransports.map$argument_0","results.every$argument_0"],"mappings":"AAA;ACQ;2BCG;GDM;CDG;AGK;SCI;YCI;ODO;aEC,mCF;GDE;CHC;AOK;SHI;III;KJkB;ICE;MIC;OJG;aKG;SLM;gBMC,UN;uDOO,qCP;KDG;IEE;iEOC,2BP;0DQC,qCR;2BSC,MT;KFC;GGM;CPC"},"hasCjsExports":false},"type":"js/module"}]}