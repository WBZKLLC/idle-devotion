{"dependencies":[{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":14,"index":78},"end":{"line":3,"column":38,"index":102}}],"key":"ud8OE6Lg8Q81+bS6ynZj2uyMPdA=","exportNames":["*"],"imports":1}},{"name":"../api.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":12,"index":116},"end":{"line":4,"column":32,"index":136}}],"key":"+eGiiNBp9LiioqcKgPq/GmiVEfQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  const utils = require(_dependencyMap[0], \"@sentry/utils\");\n  const api = require(_dependencyMap[1], \"../api.js\");\n\n  /**\n   * Gets an event from an envelope.\n   *\n   * This is only exported for use in the tests\n   */\n  function eventFromEnvelope(env, types) {\n    let event;\n    utils.forEachEnvelopeItem(env, (item, type) => {\n      if (types.includes(type)) {\n        event = Array.isArray(item) ? item[1] : undefined;\n      }\n      // bail out if we found an event\n      return !!event;\n    });\n    return event;\n  }\n\n  /**\n   * Creates a transport that overrides the release on all events.\n   */\n  function makeOverrideReleaseTransport(createTransport, release) {\n    return options => {\n      const transport = createTransport(options);\n      return {\n        send: async envelope => {\n          const event = eventFromEnvelope(envelope, ['event', 'transaction', 'profile', 'replay_event']);\n          if (event) {\n            event.release = release;\n          }\n          return transport.send(envelope);\n        },\n        flush: timeout => transport.flush(timeout)\n      };\n    };\n  }\n\n  /**\n   * Creates a transport that can send events to different DSNs depending on the envelope contents.\n   */\n  function makeMultiplexedTransport(createTransport, matcher) {\n    return options => {\n      const fallbackTransport = createTransport(options);\n      const otherTransports = {};\n      function getTransport(dsn, release) {\n        // We create a transport for every unique dsn/release combination as there may be code from multiple releases in\n        // use at the same time\n        const key = release ? `${dsn}:${release}` : dsn;\n        if (!otherTransports[key]) {\n          const validatedDsn = utils.dsnFromString(dsn);\n          if (!validatedDsn) {\n            return undefined;\n          }\n          const url = api.getEnvelopeEndpointWithUrlEncodedAuth(validatedDsn);\n          otherTransports[key] = release ? makeOverrideReleaseTransport(createTransport, release)({\n            ...options,\n            url\n          }) : createTransport({\n            ...options,\n            url\n          });\n        }\n        return otherTransports[key];\n      }\n      async function send(envelope) {\n        function getEvent(types) {\n          const eventTypes = types && types.length ? types : ['event'];\n          return eventFromEnvelope(envelope, eventTypes);\n        }\n        const transports = matcher({\n          envelope,\n          getEvent\n        }).map(result => {\n          if (typeof result === 'string') {\n            return getTransport(result, undefined);\n          } else {\n            return getTransport(result.dsn, result.release);\n          }\n        }).filter(t => !!t);\n\n        // If we have no transports to send to, use the fallback transport\n        if (transports.length === 0) {\n          transports.push(fallbackTransport);\n        }\n        const results = await Promise.all(transports.map(transport => transport.send(envelope)));\n        return results[0];\n      }\n      async function flush(timeout) {\n        const allTransports = [...Object.keys(otherTransports).map(dsn => otherTransports[dsn]), fallbackTransport];\n        const results = await Promise.all(allTransports.map(transport => transport.flush(timeout)));\n        return results.every(r => r);\n      }\n      return {\n        send,\n        flush\n      };\n    };\n  }\n  exports.eventFromEnvelope = eventFromEnvelope;\n  exports.makeMultiplexedTransport = makeMultiplexedTransport;\n});","lineCount":107,"map":[[2,2,1,0,"Object"],[2,8,1,6],[2,9,1,7,"defineProperty"],[2,23,1,21],[2,24,1,22,"exports"],[2,31,1,29],[2,33,1,31],[2,45,1,43],[2,47,1,45],[3,4,1,47,"value"],[3,9,1,52],[3,11,1,54],[4,2,1,59],[4,3,1,60],[4,4,1,61],[5,2,3,0],[5,8,3,6,"utils"],[5,13,3,11],[5,16,3,14,"require"],[5,23,3,21],[5,24,3,21,"_dependencyMap"],[5,38,3,21],[5,58,3,37],[5,59,3,38],[6,2,4,0],[6,8,4,6,"api"],[6,11,4,9],[6,14,4,12,"require"],[6,21,4,19],[6,22,4,19,"_dependencyMap"],[6,36,4,19],[6,52,4,31],[6,53,4,32],[8,2,6,0],[9,0,7,0],[10,0,8,0],[11,0,9,0],[12,0,10,0],[13,2,11,0],[13,11,11,9,"eventFromEnvelope"],[13,28,11,26,"eventFromEnvelope"],[13,29,11,27,"env"],[13,32,11,30],[13,34,11,32,"types"],[13,39,11,37],[13,41,11,39],[14,4,12,2],[14,8,12,6,"event"],[14,13,12,11],[15,4,14,2,"utils"],[15,9,14,7],[15,10,14,8,"forEachEnvelopeItem"],[15,29,14,27],[15,30,14,28,"env"],[15,33,14,31],[15,35,14,33],[15,36,14,34,"item"],[15,40,14,38],[15,42,14,40,"type"],[15,46,14,44],[15,51,14,49],[16,6,15,4],[16,10,15,8,"types"],[16,15,15,13],[16,16,15,14,"includes"],[16,24,15,22],[16,25,15,23,"type"],[16,29,15,27],[16,30,15,28],[16,32,15,30],[17,8,16,6,"event"],[17,13,16,11],[17,16,16,14,"Array"],[17,21,16,19],[17,22,16,20,"isArray"],[17,29,16,27],[17,30,16,28,"item"],[17,34,16,32],[17,35,16,33],[17,38,16,37,"item"],[17,42,16,41],[17,43,16,44],[17,44,16,45],[17,45,16,46],[17,48,16,49,"undefined"],[17,57,16,58],[18,6,17,4],[19,6,18,4],[20,6,19,4],[20,13,19,11],[20,14,19,12],[20,15,19,13,"event"],[20,20,19,18],[21,4,20,2],[21,5,20,3],[21,6,20,4],[22,4,22,2],[22,11,22,9,"event"],[22,16,22,14],[23,2,23,0],[25,2,25,0],[26,0,26,0],[27,0,27,0],[28,2,28,0],[28,11,28,9,"makeOverrideReleaseTransport"],[28,39,28,37,"makeOverrideReleaseTransport"],[28,40,29,2,"createTransport"],[28,55,29,17],[28,57,30,2,"release"],[28,64,30,9],[28,66,31,2],[29,4,32,2],[29,11,32,9,"options"],[29,18,32,16],[29,22,32,20],[30,6,33,4],[30,12,33,10,"transport"],[30,21,33,19],[30,24,33,22,"createTransport"],[30,39,33,37],[30,40,33,38,"options"],[30,47,33,45],[30,48,33,46],[31,6,35,4],[31,13,35,11],[32,8,36,6,"send"],[32,12,36,10],[32,14,36,12],[32,20,36,19,"envelope"],[32,28,36,27],[32,32,36,32],[33,10,37,8],[33,16,37,14,"event"],[33,21,37,19],[33,24,37,22,"eventFromEnvelope"],[33,41,37,39],[33,42,37,40,"envelope"],[33,50,37,48],[33,52,37,50],[33,53,37,51],[33,60,37,58],[33,62,37,60],[33,75,37,73],[33,77,37,75],[33,86,37,84],[33,88,37,86],[33,102,37,100],[33,103,37,101],[33,104,37,102],[34,10,39,8],[34,14,39,12,"event"],[34,19,39,17],[34,21,39,19],[35,12,40,10,"event"],[35,17,40,15],[35,18,40,16,"release"],[35,25,40,23],[35,28,40,26,"release"],[35,35,40,33],[36,10,41,8],[37,10,42,8],[37,17,42,15,"transport"],[37,26,42,24],[37,27,42,25,"send"],[37,31,42,29],[37,32,42,30,"envelope"],[37,40,42,38],[37,41,42,39],[38,8,43,6],[38,9,43,7],[39,8,44,6,"flush"],[39,13,44,11],[39,15,44,13,"timeout"],[39,22,44,20],[39,26,44,24,"transport"],[39,35,44,33],[39,36,44,34,"flush"],[39,41,44,39],[39,42,44,40,"timeout"],[39,49,44,47],[40,6,45,4],[40,7,45,5],[41,4,46,2],[41,5,46,3],[42,2,47,0],[44,2,49,0],[45,0,50,0],[46,0,51,0],[47,2,52,0],[47,11,52,9,"makeMultiplexedTransport"],[47,35,52,33,"makeMultiplexedTransport"],[47,36,53,2,"createTransport"],[47,51,53,17],[47,53,54,2,"matcher"],[47,60,54,9],[47,62,55,2],[48,4,56,2],[48,11,56,9,"options"],[48,18,56,16],[48,22,56,20],[49,6,57,4],[49,12,57,10,"fallbackTransport"],[49,29,57,27],[49,32,57,30,"createTransport"],[49,47,57,45],[49,48,57,46,"options"],[49,55,57,53],[49,56,57,54],[50,6,58,4],[50,12,58,10,"otherTransports"],[50,27,58,25],[50,30,58,28],[50,31,58,29],[50,32,58,30],[51,6,60,4],[51,15,60,13,"getTransport"],[51,27,60,25,"getTransport"],[51,28,60,26,"dsn"],[51,31,60,29],[51,33,60,31,"release"],[51,40,60,38],[51,42,60,40],[52,8,61,6],[53,8,62,6],[54,8,63,6],[54,14,63,12,"key"],[54,17,63,15],[54,20,63,18,"release"],[54,27,63,25],[54,30,63,28],[54,33,63,31,"dsn"],[54,36,63,34],[54,40,63,38,"release"],[54,47,63,45],[54,49,63,47],[54,52,63,50,"dsn"],[54,55,63,53],[55,8,65,6],[55,12,65,10],[55,13,65,11,"otherTransports"],[55,28,65,26],[55,29,65,27,"key"],[55,32,65,30],[55,33,65,31],[55,35,65,33],[56,10,66,8],[56,16,66,14,"validatedDsn"],[56,28,66,26],[56,31,66,29,"utils"],[56,36,66,34],[56,37,66,35,"dsnFromString"],[56,50,66,48],[56,51,66,49,"dsn"],[56,54,66,52],[56,55,66,53],[57,10,67,8],[57,14,67,12],[57,15,67,13,"validatedDsn"],[57,27,67,25],[57,29,67,27],[58,12,68,10],[58,19,68,17,"undefined"],[58,28,68,26],[59,10,69,8],[60,10,70,8],[60,16,70,14,"url"],[60,19,70,17],[60,22,70,20,"api"],[60,25,70,23],[60,26,70,24,"getEnvelopeEndpointWithUrlEncodedAuth"],[60,63,70,61],[60,64,70,62,"validatedDsn"],[60,76,70,74],[60,77,70,75],[61,10,72,8,"otherTransports"],[61,25,72,23],[61,26,72,24,"key"],[61,29,72,27],[61,30,72,28],[61,33,72,31,"release"],[61,40,72,38],[61,43,73,12,"makeOverrideReleaseTransport"],[61,71,73,40],[61,72,73,41,"createTransport"],[61,87,73,56],[61,89,73,58,"release"],[61,96,73,65],[61,97,73,66],[61,98,73,67],[62,12,73,69],[62,15,73,72,"options"],[62,22,73,79],[63,12,73,81,"url"],[64,10,73,85],[64,11,73,86],[64,12,73,87],[64,15,74,12,"createTransport"],[64,30,74,27],[64,31,74,28],[65,12,74,30],[65,15,74,33,"options"],[65,22,74,40],[66,12,74,42,"url"],[67,10,74,46],[67,11,74,47],[67,12,74,48],[68,8,75,6],[69,8,77,6],[69,15,77,13,"otherTransports"],[69,30,77,28],[69,31,77,29,"key"],[69,34,77,32],[69,35,77,33],[70,6,78,4],[71,6,80,4],[71,21,80,19,"send"],[71,25,80,23,"send"],[71,26,80,24,"envelope"],[71,34,80,32],[71,36,80,34],[72,8,81,6],[72,17,81,15,"getEvent"],[72,25,81,23,"getEvent"],[72,26,81,24,"types"],[72,31,81,29],[72,33,81,31],[73,10,82,8],[73,16,82,14,"eventTypes"],[73,26,82,24],[73,29,82,27,"types"],[73,34,82,32],[73,38,82,36,"types"],[73,43,82,41],[73,44,82,42,"length"],[73,50,82,48],[73,53,82,51,"types"],[73,58,82,56],[73,61,82,59],[73,62,82,60],[73,69,82,67],[73,70,82,68],[74,10,83,8],[74,17,83,15,"eventFromEnvelope"],[74,34,83,32],[74,35,83,33,"envelope"],[74,43,83,41],[74,45,83,43,"eventTypes"],[74,55,83,53],[74,56,83,54],[75,8,84,6],[76,8,86,6],[76,14,86,12,"transports"],[76,24,86,22],[76,27,86,25,"matcher"],[76,34,86,32],[76,35,86,33],[77,10,86,35,"envelope"],[77,18,86,43],[78,10,86,45,"getEvent"],[79,8,86,54],[79,9,86,55],[79,10,86,56],[79,11,87,9,"map"],[79,14,87,12],[79,15,87,13,"result"],[79,21,87,19],[79,25,87,23],[80,10,88,10],[80,14,88,14],[80,21,88,21,"result"],[80,27,88,27],[80,32,88,32],[80,40,88,40],[80,42,88,42],[81,12,89,12],[81,19,89,19,"getTransport"],[81,31,89,31],[81,32,89,32,"result"],[81,38,89,38],[81,40,89,40,"undefined"],[81,49,89,49],[81,50,89,50],[82,10,90,10],[82,11,90,11],[82,17,90,17],[83,12,91,12],[83,19,91,19,"getTransport"],[83,31,91,31],[83,32,91,32,"result"],[83,38,91,38],[83,39,91,39,"dsn"],[83,42,91,42],[83,44,91,44,"result"],[83,50,91,50],[83,51,91,51,"release"],[83,58,91,58],[83,59,91,59],[84,10,92,10],[85,8,93,8],[85,9,93,9],[85,10,93,10],[85,11,94,9,"filter"],[85,17,94,15],[85,18,94,17,"t"],[85,19,94,18],[85,23,94,23],[85,24,94,24],[85,25,94,25,"t"],[85,26,94,26],[85,27,94,27],[87,8,96,6],[88,8,97,6],[88,12,97,10,"transports"],[88,22,97,20],[88,23,97,21,"length"],[88,29,97,27],[88,34,97,32],[88,35,97,33],[88,37,97,35],[89,10,98,8,"transports"],[89,20,98,18],[89,21,98,19,"push"],[89,25,98,23],[89,26,98,24,"fallbackTransport"],[89,43,98,41],[89,44,98,42],[90,8,99,6],[91,8,101,6],[91,14,101,12,"results"],[91,21,101,19],[91,24,101,22],[91,30,101,28,"Promise"],[91,37,101,35],[91,38,101,36,"all"],[91,41,101,39],[91,42,101,40,"transports"],[91,52,101,50],[91,53,101,51,"map"],[91,56,101,54],[91,57,101,55,"transport"],[91,66,101,64],[91,70,101,68,"transport"],[91,79,101,77],[91,80,101,78,"send"],[91,84,101,82],[91,85,101,83,"envelope"],[91,93,101,91],[91,94,101,92],[91,95,101,93],[91,96,101,94],[92,8,103,6],[92,15,103,13,"results"],[92,22,103,20],[92,23,103,21],[92,24,103,22],[92,25,103,23],[93,6,104,4],[94,6,106,4],[94,21,106,19,"flush"],[94,26,106,24,"flush"],[94,27,106,25,"timeout"],[94,34,106,32],[94,36,106,34],[95,8,107,6],[95,14,107,12,"allTransports"],[95,27,107,25],[95,30,107,28],[95,31,107,29],[95,34,107,32,"Object"],[95,40,107,38],[95,41,107,39,"keys"],[95,45,107,43],[95,46,107,44,"otherTransports"],[95,61,107,59],[95,62,107,60],[95,63,107,61,"map"],[95,66,107,64],[95,67,107,65,"dsn"],[95,70,107,68],[95,74,107,72,"otherTransports"],[95,89,107,87],[95,90,107,88,"dsn"],[95,93,107,91],[95,94,107,92],[95,95,107,93],[95,97,107,95,"fallbackTransport"],[95,114,107,112],[95,115,107,113],[96,8,108,6],[96,14,108,12,"results"],[96,21,108,19],[96,24,108,22],[96,30,108,28,"Promise"],[96,37,108,35],[96,38,108,36,"all"],[96,41,108,39],[96,42,108,40,"allTransports"],[96,55,108,53],[96,56,108,54,"map"],[96,59,108,57],[96,60,108,58,"transport"],[96,69,108,67],[96,73,108,71,"transport"],[96,82,108,80],[96,83,108,81,"flush"],[96,88,108,86],[96,89,108,87,"timeout"],[96,96,108,94],[96,97,108,95],[96,98,108,96],[96,99,108,97],[97,8,109,6],[97,15,109,13,"results"],[97,22,109,20],[97,23,109,21,"every"],[97,28,109,26],[97,29,109,27,"r"],[97,30,109,28],[97,34,109,32,"r"],[97,35,109,33],[97,36,109,34],[98,6,110,4],[99,6,112,4],[99,13,112,11],[100,8,113,6,"send"],[100,12,113,10],[101,8,114,6,"flush"],[102,6,115,4],[102,7,115,5],[103,4,116,2],[103,5,116,3],[104,2,117,0],[105,2,119,0,"exports"],[105,9,119,7],[105,10,119,8,"eventFromEnvelope"],[105,27,119,25],[105,30,119,28,"eventFromEnvelope"],[105,47,119,45],[106,2,120,0,"exports"],[106,9,120,7],[106,10,120,8,"makeMultiplexedTransport"],[106,34,120,32],[106,37,120,35,"makeMultiplexedTransport"],[106,61,120,59],[107,0,120,60],[107,3]],"functionMap":{"names":["<global>","eventFromEnvelope","utils.forEachEnvelopeItem$argument_1","makeOverrideReleaseTransport","<anonymous>","send","flush","makeMultiplexedTransport","getTransport","getEvent","matcher.map$argument_0","matcher.map.filter$argument_0","transports.map$argument_0","Object.keys.map$argument_0","allTransports.map$argument_0","results.every$argument_0"],"mappings":"AAA;ACU;iCCG;GDM;CDG;AGK;SCI;YCI;ODO;aEC,mCF;GDE;CHC;AOK;SHI;III;KJkB;ICE;MIC;OJG;aKG;SLM;gBMC,UN;uDOO,qCP;KDG;IEE;iEOC,2BP;0DQC,qCR;2BSC,MT;KFC;GGM;CPC"},"hasCjsExports":true},"type":"js/module"}]}