{"dependencies":[{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":54,"index":54}}],"key":"m+kcirlwHAgMIuUoyR2vCxbhWD4=","exportNames":["*"],"imports":1}},{"name":"../helpers.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":55},"end":{"line":2,"column":39,"index":94}}],"key":"xGB1RU1bemGAHq3E44EIR7oSA2c=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"clearCachedFetchImplementation\", {\n    enumerable: true,\n    get: function () {\n      return clearCachedFetchImplementation;\n    }\n  });\n  Object.defineProperty(exports, \"getNativeFetchImplementation\", {\n    enumerable: true,\n    get: function () {\n      return getNativeFetchImplementation;\n    }\n  });\n  var _sentryUtils = require(_dependencyMap[0], \"@sentry/utils\");\n  var _helpersJs = require(_dependencyMap[1], \"../helpers.js\");\n  let cachedFetchImpl = undefined;\n\n  /**\n   * A special usecase for incorrectly wrapped Fetch APIs in conjunction with ad-blockers.\n   * Whenever someone wraps the Fetch API and returns the wrong promise chain,\n   * this chain becomes orphaned and there is no possible way to capture it's rejections\n   * other than allowing it bubble up to this very handler. eg.\n   *\n   * const f = window.fetch;\n   * window.fetch = function () {\n   *   const p = f.apply(this, arguments);\n   *\n   *   p.then(function() {\n   *     console.log('hi.');\n   *   });\n   *\n   *   return p;\n   * }\n   *\n   * `p.then(function () { ... })` is producing a completely separate promise chain,\n   * however, what's returned is `p` - the result of original `fetch` call.\n   *\n   * This mean, that whenever we use the Fetch API to send our own requests, _and_\n   * some ad-blocker blocks it, this orphaned chain will _always_ reject,\n   * effectively causing another event to be captured.\n   * This makes a whole process become an infinite loop, which we need to somehow\n   * deal with, and break it in one way or another.\n   *\n   * To deal with this issue, we are making sure that we _always_ use the real\n   * browser Fetch API, instead of relying on what `window.fetch` exposes.\n   * The only downside to this would be missing our own requests as breadcrumbs,\n   * but because we are already not doing this, it should be just fine.\n   *\n   * Possible failed fetch error messages per-browser:\n   *\n   * Chrome:  Failed to fetch\n   * Edge:    Failed to Fetch\n   * Firefox: NetworkError when attempting to fetch resource\n   * Safari:  resource blocked by content blocker\n   */\n  function getNativeFetchImplementation() {\n    if (cachedFetchImpl) {\n      return cachedFetchImpl;\n    }\n\n    /* eslint-disable @typescript-eslint/unbound-method */\n\n    // Fast path to avoid DOM I/O\n    if ((0, _sentryUtils.isNativeFetch)(_helpersJs.WINDOW.fetch)) {\n      return cachedFetchImpl = _helpersJs.WINDOW.fetch.bind(_helpersJs.WINDOW);\n    }\n    const document = _helpersJs.WINDOW.document;\n    let fetchImpl = _helpersJs.WINDOW.fetch;\n    // eslint-disable-next-line deprecation/deprecation\n    if (document && typeof document.createElement === 'function') {\n      try {\n        const sandbox = document.createElement('iframe');\n        sandbox.hidden = true;\n        document.head.appendChild(sandbox);\n        const contentWindow = sandbox.contentWindow;\n        if (contentWindow && contentWindow.fetch) {\n          fetchImpl = contentWindow.fetch;\n        }\n        document.head.removeChild(sandbox);\n      } catch (e) {\n        (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && _sentryUtils.logger.warn('Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ', e);\n      }\n    }\n    return cachedFetchImpl = fetchImpl.bind(_helpersJs.WINDOW);\n    /* eslint-enable @typescript-eslint/unbound-method */\n  }\n\n  /** Clears cached fetch impl */\n  function clearCachedFetchImplementation() {\n    cachedFetchImpl = undefined;\n  }\n});","lineCount":97,"map":[[7,2,84,0,"Object"],[7,8,84,0],[7,9,84,0,"defineProperty"],[7,23,84,0],[7,24,84,0,"exports"],[7,31,84,0],[8,4,84,0,"enumerable"],[8,14,84,0],[9,4,84,0,"get"],[9,7,84,0],[9,18,84,0,"get"],[9,19,84,0],[10,6,84,0],[10,13,84,9,"clearCachedFetchImplementation"],[10,43,84,39],[11,4,84,39],[12,2,84,39],[13,2,84,0,"Object"],[13,8,84,0],[13,9,84,0,"defineProperty"],[13,23,84,0],[13,24,84,0,"exports"],[13,31,84,0],[14,4,84,0,"enumerable"],[14,14,84,0],[15,4,84,0,"get"],[15,7,84,0],[15,18,84,0,"get"],[15,19,84,0],[16,6,84,0],[16,13,84,41,"getNativeFetchImplementation"],[16,41,84,69],[17,4,84,69],[18,2,84,69],[19,2,1,0],[19,6,1,0,"_sentryUtils"],[19,18,1,0],[19,21,1,0,"require"],[19,28,1,0],[19,29,1,0,"_dependencyMap"],[19,43,1,0],[20,2,2,0],[20,6,2,0,"_helpersJs"],[20,16,2,0],[20,19,2,0,"require"],[20,26,2,0],[20,27,2,0,"_dependencyMap"],[20,41,2,0],[21,2,4,0],[21,6,4,4,"cachedFetchImpl"],[21,21,4,19],[21,24,4,22,"undefined"],[21,33,4,31],[23,2,6,0],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,0,14,0],[32,0,15,0],[33,0,16,0],[34,0,17,0],[35,0,18,0],[36,0,19,0],[37,0,20,0],[38,0,21,0],[39,0,22,0],[40,0,23,0],[41,0,24,0],[42,0,25,0],[43,0,26,0],[44,0,27,0],[45,0,28,0],[46,0,29,0],[47,0,30,0],[48,0,31,0],[49,0,32,0],[50,0,33,0],[51,0,34,0],[52,0,35,0],[53,0,36,0],[54,0,37,0],[55,0,38,0],[56,0,39,0],[57,0,40,0],[58,0,41,0],[59,0,42,0],[60,0,43,0],[61,2,44,0],[61,11,44,9,"getNativeFetchImplementation"],[61,39,44,37,"getNativeFetchImplementation"],[61,40,44,37],[61,42,44,40],[62,4,45,2],[62,8,45,6,"cachedFetchImpl"],[62,23,45,21],[62,25,45,23],[63,6,46,4],[63,13,46,11,"cachedFetchImpl"],[63,28,46,26],[64,4,47,2],[66,4,49,2],[68,4,51,2],[69,4,52,2],[69,8,52,6],[69,12,52,6,"isNativeFetch"],[69,24,52,19],[69,25,52,19,"isNativeFetch"],[69,38,52,19],[69,40,52,20,"WINDOW"],[69,50,52,26],[69,51,52,26,"WINDOW"],[69,57,52,26],[69,58,52,27,"fetch"],[69,63,52,32],[69,64,52,33],[69,66,52,35],[70,6,53,4],[70,13,53,12,"cachedFetchImpl"],[70,28,53,27],[70,31,53,30,"WINDOW"],[70,41,53,36],[70,42,53,36,"WINDOW"],[70,48,53,36],[70,49,53,37,"fetch"],[70,54,53,42],[70,55,53,43,"bind"],[70,59,53,47],[70,60,53,48,"WINDOW"],[70,70,53,54],[70,71,53,54,"WINDOW"],[70,77,53,54],[70,78,53,55],[71,4,54,2],[72,4,56,2],[72,10,56,8,"document"],[72,18,56,16],[72,21,56,19,"WINDOW"],[72,31,56,25],[72,32,56,25,"WINDOW"],[72,38,56,25],[72,39,56,26,"document"],[72,47,56,34],[73,4,57,2],[73,8,57,6,"fetchImpl"],[73,17,57,15],[73,20,57,18,"WINDOW"],[73,30,57,24],[73,31,57,24,"WINDOW"],[73,37,57,24],[73,38,57,25,"fetch"],[73,43,57,30],[74,4,58,2],[75,4,59,2],[75,8,59,6,"document"],[75,16,59,14],[75,20,59,18],[75,27,59,25,"document"],[75,35,59,33],[75,36,59,34,"createElement"],[75,49,59,47],[75,54,59,52],[75,64,59,62],[75,66,59,64],[76,6,60,4],[76,10,60,8],[77,8,61,6],[77,14,61,12,"sandbox"],[77,21,61,19],[77,24,61,22,"document"],[77,32,61,30],[77,33,61,31,"createElement"],[77,46,61,44],[77,47,61,45],[77,55,61,53],[77,56,61,54],[78,8,62,6,"sandbox"],[78,15,62,13],[78,16,62,14,"hidden"],[78,22,62,20],[78,25,62,23],[78,29,62,27],[79,8,63,6,"document"],[79,16,63,14],[79,17,63,15,"head"],[79,21,63,19],[79,22,63,20,"appendChild"],[79,33,63,31],[79,34,63,32,"sandbox"],[79,41,63,39],[79,42,63,40],[80,8,64,6],[80,14,64,12,"contentWindow"],[80,27,64,25],[80,30,64,28,"sandbox"],[80,37,64,35],[80,38,64,36,"contentWindow"],[80,51,64,49],[81,8,65,6],[81,12,65,10,"contentWindow"],[81,25,65,23],[81,29,65,27,"contentWindow"],[81,42,65,40],[81,43,65,41,"fetch"],[81,48,65,46],[81,50,65,48],[82,10,66,8,"fetchImpl"],[82,19,66,17],[82,22,66,20,"contentWindow"],[82,35,66,33],[82,36,66,34,"fetch"],[82,41,66,39],[83,8,67,6],[84,8,68,6,"document"],[84,16,68,14],[84,17,68,15,"head"],[84,21,68,19],[84,22,68,20,"removeChild"],[84,33,68,31],[84,34,68,32,"sandbox"],[84,41,68,39],[84,42,68,40],[85,6,69,4],[85,7,69,5],[85,8,69,6],[85,15,69,13,"e"],[85,16,69,14],[85,18,69,16],[86,8,70,6],[86,9,70,7],[86,16,70,14,"__SENTRY_DEBUG__"],[86,32,70,30],[86,37,70,35],[86,48,70,46],[86,52,70,50,"__SENTRY_DEBUG__"],[86,68,70,66],[86,73,71,8,"logger"],[86,85,71,14],[86,86,71,14,"logger"],[86,92,71,14],[86,93,71,15,"warn"],[86,97,71,19],[86,98,71,20],[86,179,71,101],[86,181,71,103,"e"],[86,182,71,104],[86,183,71,105],[87,6,72,4],[88,4,73,2],[89,4,75,2],[89,11,75,10,"cachedFetchImpl"],[89,26,75,25],[89,29,75,28,"fetchImpl"],[89,38,75,37],[89,39,75,38,"bind"],[89,43,75,42],[89,44,75,43,"WINDOW"],[89,54,75,49],[89,55,75,49,"WINDOW"],[89,61,75,49],[89,62,75,50],[90,4,76,2],[91,2,77,0],[93,2,79,0],[94,2,80,0],[94,11,80,9,"clearCachedFetchImplementation"],[94,41,80,39,"clearCachedFetchImplementation"],[94,42,80,39],[94,44,80,42],[95,4,81,2,"cachedFetchImpl"],[95,19,81,17],[95,22,81,20,"undefined"],[95,31,81,29],[96,2,82,0],[97,0,82,1],[97,3]],"functionMap":{"names":["<global>","getNativeFetchImplementation","clearCachedFetchImplementation"],"mappings":"AAA;AC2C;CDiC;AEG;CFE"},"hasCjsExports":false},"type":"js/module"}]}