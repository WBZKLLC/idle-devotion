{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"ENTITLEMENT_KEYS\", {\n    enumerable: true,\n    get: function () {\n      return ENTITLEMENT_KEYS;\n    }\n  });\n  Object.defineProperty(exports, \"PREMIUM_CINEMATIC_OWNED_PREFIX\", {\n    enumerable: true,\n    get: function () {\n      return PREMIUM_CINEMATIC_OWNED_PREFIX;\n    }\n  });\n  exports.premiumCinematicOwnedKey = premiumCinematicOwnedKey;\n  exports.isHeroCinematicKey = isHeroCinematicKey;\n  exports.extractHeroIdFromKey = extractHeroIdFromKey;\n  exports.createEmptyEntitlementsMap = createEmptyEntitlementsMap;\n  exports.isEntitlementOwned = isEntitlementOwned;\n  // /app/frontend/lib/entitlements/types.ts\n  // Canonical Entitlements Contract - SINGLE SOURCE OF TRUTH\n  // Server is authoritative; client caches for UX only\n\n  /**\n   * Entitlement status from server\n   */\n\n  /**\n   * Known entitlement keys (finite set, type-safe)\n   */\n\n  const ENTITLEMENT_KEYS = {\n    PREMIUM: 'PREMIUM',\n    PREMIUM_CINEMATICS_PACK: 'PREMIUM_CINEMATICS_PACK',\n    NO_ADS: 'NO_ADS',\n    STARTER_PACK: 'STARTER_PACK'\n  };\n\n  /**\n   * Per-hero cinematic ownership key helper\n   * Dynamic keys: PREMIUM_CINEMATIC_OWNED:<heroId>\n   */\n  const PREMIUM_CINEMATIC_OWNED_PREFIX = 'PREMIUM_CINEMATIC_OWNED:';\n  function premiumCinematicOwnedKey(heroId) {\n    return `${PREMIUM_CINEMATIC_OWNED_PREFIX}${heroId}`;\n  }\n  function isHeroCinematicKey(key) {\n    return key.startsWith(PREMIUM_CINEMATIC_OWNED_PREFIX);\n  }\n  function extractHeroIdFromKey(key) {\n    if (!isHeroCinematicKey(key)) return null;\n    return key.slice(PREMIUM_CINEMATIC_OWNED_PREFIX.length);\n  }\n\n  /**\n   * Single entitlement from server\n   */\n\n  /**\n   * Server entitlements response shape\n   * This is the SINGLE source of truth for what user owns\n   * \n   * STRICT INVARIANTS:\n   * - entitlements must include ALL known keys (even if not_owned)\n   * - server_time is required (no client Date.now decisions for expiry)\n   * - version increments whenever entitlements change\n   */\n\n  /**\n   * Create empty entitlements map with all known keys as not_owned\n   */\n  function createEmptyEntitlementsMap() {\n    return Object.values(ENTITLEMENT_KEYS).reduce((acc, key) => {\n      acc[key] = {\n        key,\n        status: 'not_owned'\n      };\n      return acc;\n    }, {});\n  }\n\n  /**\n   * Check if entitlement is owned and not expired\n   * Uses server_time for expiry checks (NOT client time)\n   */\n  function isEntitlementOwned(entitlement, serverTime) {\n    if (!entitlement) return false;\n    if (entitlement.status !== 'owned') return false;\n\n    // Check expiry using server time\n    if (entitlement.expires_at) {\n      const expiresAt = new Date(entitlement.expires_at).getTime();\n      const serverNow = new Date(serverTime).getTime();\n      if (serverNow > expiresAt) return false;\n    }\n    return true;\n  }\n});","lineCount":102,"map":[[7,2,19,0,"Object"],[7,8,19,0],[7,9,19,0,"defineProperty"],[7,23,19,0],[7,24,19,0,"exports"],[7,31,19,0],[8,4,19,0,"enumerable"],[8,14,19,0],[9,4,19,0,"get"],[9,7,19,0],[9,18,19,0,"get"],[9,19,19,0],[10,6,19,0],[10,13,19,0,"ENTITLEMENT_KEYS"],[10,29,19,0],[11,4,19,0],[12,2,19,0],[13,2,30,0,"Object"],[13,8,30,0],[13,9,30,0,"defineProperty"],[13,23,30,0],[13,24,30,0,"exports"],[13,31,30,0],[14,4,30,0,"enumerable"],[14,14,30,0],[15,4,30,0,"get"],[15,7,30,0],[15,18,30,0,"get"],[15,19,30,0],[16,6,30,0],[16,13,30,0,"PREMIUM_CINEMATIC_OWNED_PREFIX"],[16,43,30,0],[17,4,30,0],[18,2,30,0],[19,2,32,0,"exports"],[19,9,32,0],[19,10,32,0,"premiumCinematicOwnedKey"],[19,34,32,0],[19,37,32,0,"premiumCinematicOwnedKey"],[19,61,32,0],[20,2,36,0,"exports"],[20,9,36,0],[20,10,36,0,"isHeroCinematicKey"],[20,28,36,0],[20,31,36,0,"isHeroCinematicKey"],[20,49,36,0],[21,2,40,0,"exports"],[21,9,40,0],[21,10,40,0,"extractHeroIdFromKey"],[21,30,40,0],[21,33,40,0,"extractHeroIdFromKey"],[21,53,40,0],[22,2,96,0,"exports"],[22,9,96,0],[22,10,96,0,"createEmptyEntitlementsMap"],[22,36,96,0],[22,39,96,0,"createEmptyEntitlementsMap"],[22,65,96,0],[23,2,107,0,"exports"],[23,9,107,0],[23,10,107,0,"isEntitlementOwned"],[23,28,107,0],[23,31,107,0,"isEntitlementOwned"],[23,49,107,0],[24,2,1,0],[25,2,2,0],[26,2,3,0],[28,2,5,0],[29,0,6,0],[30,0,7,0],[32,2,10,0],[33,0,11,0],[34,0,12,0],[36,2,19,7],[36,8,19,13,"ENTITLEMENT_KEYS"],[36,24,19,29],[36,27,19,32],[37,4,20,2,"PREMIUM"],[37,11,20,9],[37,13,20,11],[37,22,20,20],[38,4,21,2,"PREMIUM_CINEMATICS_PACK"],[38,27,21,25],[38,29,21,27],[38,54,21,52],[39,4,22,2,"NO_ADS"],[39,10,22,8],[39,12,22,10],[39,20,22,18],[40,4,23,2,"STARTER_PACK"],[40,16,23,14],[40,18,23,16],[41,2,24,0],[41,3,24,51],[43,2,26,0],[44,0,27,0],[45,0,28,0],[46,0,29,0],[47,2,30,7],[47,8,30,13,"PREMIUM_CINEMATIC_OWNED_PREFIX"],[47,38,30,43],[47,41,30,46],[47,67,30,72],[48,2,32,7],[48,11,32,16,"premiumCinematicOwnedKey"],[48,35,32,40,"premiumCinematicOwnedKey"],[48,36,32,41,"heroId"],[48,42,32,55],[48,44,32,65],[49,4,33,2],[49,11,33,9],[49,14,33,12,"PREMIUM_CINEMATIC_OWNED_PREFIX"],[49,44,33,42],[49,47,33,45,"heroId"],[49,53,33,51],[49,55,33,53],[50,2,34,0],[51,2,36,7],[51,11,36,16,"isHeroCinematicKey"],[51,29,36,34,"isHeroCinematicKey"],[51,30,36,35,"key"],[51,33,36,46],[51,35,36,57],[52,4,37,2],[52,11,37,9,"key"],[52,14,37,12],[52,15,37,13,"startsWith"],[52,25,37,23],[52,26,37,24,"PREMIUM_CINEMATIC_OWNED_PREFIX"],[52,56,37,54],[52,57,37,55],[53,2,38,0],[54,2,40,7],[54,11,40,16,"extractHeroIdFromKey"],[54,31,40,36,"extractHeroIdFromKey"],[54,32,40,37,"key"],[54,35,40,48],[54,37,40,65],[55,4,41,2],[55,8,41,6],[55,9,41,7,"isHeroCinematicKey"],[55,27,41,25],[55,28,41,26,"key"],[55,31,41,29],[55,32,41,30],[55,34,41,32],[55,41,41,39],[55,45,41,43],[56,4,42,2],[56,11,42,9,"key"],[56,14,42,12],[56,15,42,13,"slice"],[56,20,42,18],[56,21,42,19,"PREMIUM_CINEMATIC_OWNED_PREFIX"],[56,51,42,49],[56,52,42,50,"length"],[56,58,42,56],[56,59,42,57],[57,2,43,0],[59,2,45,0],[60,0,46,0],[61,0,47,0],[63,2,64,0],[64,0,65,0],[65,0,66,0],[66,0,67,0],[67,0,68,0],[68,0,69,0],[69,0,70,0],[70,0,71,0],[71,0,72,0],[73,2,93,0],[74,0,94,0],[75,0,95,0],[76,2,96,7],[76,11,96,16,"createEmptyEntitlementsMap"],[76,37,96,42,"createEmptyEntitlementsMap"],[76,38,96,42],[76,40,96,80],[77,4,97,2],[77,11,97,9,"Object"],[77,17,97,15],[77,18,97,16,"values"],[77,24,97,22],[77,25,97,23,"ENTITLEMENT_KEYS"],[77,41,97,39],[77,42,97,40],[77,43,97,41,"reduce"],[77,49,97,47],[77,50,97,48],[77,51,97,49,"acc"],[77,54,97,52],[77,56,97,54,"key"],[77,59,97,57],[77,64,97,62],[78,6,98,4,"acc"],[78,9,98,7],[78,10,98,8,"key"],[78,13,98,11],[78,14,98,12],[78,17,98,15],[79,8,98,17,"key"],[79,11,98,20],[80,8,98,22,"status"],[80,14,98,28],[80,16,98,30],[81,6,98,42],[81,7,98,43],[82,6,99,4],[82,13,99,11,"acc"],[82,16,99,14],[83,4,100,2],[83,5,100,3],[83,7,100,5],[83,8,100,6],[83,9,100,44],[83,10,100,45],[84,2,101,0],[86,2,103,0],[87,0,104,0],[88,0,105,0],[89,0,106,0],[90,2,107,7],[90,11,107,16,"isEntitlementOwned"],[90,29,107,34,"isEntitlementOwned"],[90,30,108,2,"entitlement"],[90,41,108,44],[90,43,109,2,"serverTime"],[90,53,109,20],[90,55,110,11],[91,4,111,2],[91,8,111,6],[91,9,111,7,"entitlement"],[91,20,111,18],[91,22,111,20],[91,29,111,27],[91,34,111,32],[92,4,112,2],[92,8,112,6,"entitlement"],[92,19,112,17],[92,20,112,18,"status"],[92,26,112,24],[92,31,112,29],[92,38,112,36],[92,40,112,38],[92,47,112,45],[92,52,112,50],[94,4,114,2],[95,4,115,2],[95,8,115,6,"entitlement"],[95,19,115,17],[95,20,115,18,"expires_at"],[95,30,115,28],[95,32,115,30],[96,6,116,4],[96,12,116,10,"expiresAt"],[96,21,116,19],[96,24,116,22],[96,28,116,26,"Date"],[96,32,116,30],[96,33,116,31,"entitlement"],[96,44,116,42],[96,45,116,43,"expires_at"],[96,55,116,53],[96,56,116,54],[96,57,116,55,"getTime"],[96,64,116,62],[96,65,116,63],[96,66,116,64],[97,6,117,4],[97,12,117,10,"serverNow"],[97,21,117,19],[97,24,117,22],[97,28,117,26,"Date"],[97,32,117,30],[97,33,117,31,"serverTime"],[97,43,117,41],[97,44,117,42],[97,45,117,43,"getTime"],[97,52,117,50],[97,53,117,51],[97,54,117,52],[98,6,118,4],[98,10,118,8,"serverNow"],[98,19,118,17],[98,22,118,20,"expiresAt"],[98,31,118,29],[98,33,118,31],[98,40,118,38],[98,45,118,43],[99,4,119,2],[100,4,121,2],[100,11,121,9],[100,15,121,13],[101,2,122,0],[102,0,122,1],[102,3]],"functionMap":{"names":["<global>","premiumCinematicOwnedKey","isHeroCinematicKey","extractHeroIdFromKey","createEmptyEntitlementsMap","Object.values.reduce$argument_0","isEntitlementOwned"],"mappings":"AAA;OC+B;CDE;OEE;CFE;OGE;CHG;OIqD;gDCC;GDG;CJC;OMM;CNe"},"hasCjsExports":false},"type":"js/module"}]}