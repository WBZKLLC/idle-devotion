{"dependencies":[{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"../authStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":201},"end":{"line":9,"column":47,"index":248}}],"key":"8h7N/7sKemAZqrgZg8dH/jTl5ys=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"API_BASE\", {\n    enumerable: true,\n    get: function () {\n      return API_BASE;\n    }\n  });\n  exports.apiUrl = apiUrl;\n  exports.getAuthHeaders = getAuthHeaders;\n  exports.getJsonHeaders = getJsonHeaders;\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[0], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _authStorage = require(_dependencyMap[1], \"../authStorage\");\n  /**\n   * Centralized API Configuration\n   * \n   * Single source of truth for API base URL across all platforms.\n   * Web preview, device, and tunnel all use this.\n   */\n\n  /**\n   * Get the API base URL based on platform and environment.\n   * \n   * Priority:\n   * 1. EXPO_PUBLIC_BACKEND_URL (if set)\n   * 2. EXPO_PUBLIC_API_URL (legacy fallback)\n   * 3. Platform-specific defaults\n   */\n  function getApiBaseUrl() {\n    // Check environment variables - normalize trailing slashes\n    const RAW = process.env.EXPO_PUBLIC_BACKEND_URL ?? process.env.EXPO_PUBLIC_API_URL ?? '';\n\n    // Use explicitly set URLs first (trimmed of trailing slashes)\n    if (RAW) {\n      return RAW.replace(/\\/+$/, '');\n    }\n\n    // Platform-specific defaults when no env var is set\n    if (Platform.default.OS === 'web') {\n      // Web preview: use relative paths (assumes proxy is configured)\n      // If no proxy, this will fail - but that's expected\n      return '';\n    }\n\n    // Native device: default to localhost:8001 (won't work on real device without tunnel)\n    // In production, EXPO_PUBLIC_BACKEND_URL should always be set\n    return 'http://localhost:8001';\n  }\n\n  /**\n   * The API base URL - use this everywhere instead of hardcoding.\n   * \n   * Usage:\n   *   import { API_BASE } from '@/lib/api/config';\n   *   fetch(`${API_BASE}/api/endpoint`, { ... });\n   */\n  const API_BASE = getApiBaseUrl();\n\n  /**\n   * Construct a full API URL.\n   * \n   * @param path - The API path (e.g., '/api/daily/status')\n   * @returns Full URL with base\n   */\n  function apiUrl(path) {\n    // Ensure path starts with /\n    const normalizedPath = path.startsWith('/') ? path : `/${path}`;\n    return `${API_BASE}${normalizedPath}`;\n  }\n\n  /**\n   * Get auth headers for API requests (without Content-Type).\n   * Use this for FormData uploads where browser sets Content-Type automatically.\n   * \n   * @returns Headers object with Authorization if token exists\n   */\n  async function getAuthHeaders() {\n    const token = await (0, _authStorage.loadAuthToken)();\n    if (token) {\n      return {\n        'Authorization': `Bearer ${token}`\n      };\n    }\n    return {};\n  }\n\n  /**\n   * Get auth + JSON headers for typical API requests.\n   * Single source of truth - all API modules should use this for JSON endpoints.\n   * \n   * @returns Headers object with Authorization (if token) + Content-Type\n   */\n  async function getJsonHeaders() {\n    const auth = await getAuthHeaders();\n    return {\n      ...auth,\n      'Content-Type': 'application/json'\n    };\n  }\n\n  // Log the API base URL in development for debugging\n  if (__DEV__) {\n    console.log('[API Config] Base URL:', API_BASE || '(relative paths)');\n    console.log('[API Config] Platform:', Platform.default.OS);\n\n    // WARN if API_BASE is empty - likely means env var not picked up\n    if (!API_BASE) {\n      console.warn('[API Config] ⚠️ API_BASE is empty! ' + 'Set EXPO_PUBLIC_BACKEND_URL in .env for web preview to work. ' + 'Falling back to relative paths (will 404 if no proxy configured).');\n    }\n  }\n});","lineCount":121,"map":[[12,2,49,0,"Object"],[12,8,49,0],[12,9,49,0,"defineProperty"],[12,23,49,0],[12,24,49,0,"exports"],[12,31,49,0],[13,4,49,0,"enumerable"],[13,14,49,0],[14,4,49,0,"get"],[14,7,49,0],[14,18,49,0,"get"],[14,19,49,0],[15,6,49,0],[15,13,49,0,"API_BASE"],[15,21,49,0],[16,4,49,0],[17,2,49,0],[18,2,57,0,"exports"],[18,9,57,0],[18,10,57,0,"apiUrl"],[18,16,57,0],[18,19,57,0,"apiUrl"],[18,25,57,0],[19,2,69,0,"exports"],[19,9,69,0],[19,10,69,0,"getAuthHeaders"],[19,24,69,0],[19,27,69,0,"getAuthHeaders"],[19,41,69,0],[20,2,83,0,"exports"],[20,9,83,0],[20,10,83,0,"getJsonHeaders"],[20,24,83,0],[20,27,83,0,"getJsonHeaders"],[20,41,83,0],[21,2,89,1],[21,6,89,1,"_reactNativeWebDistExportsPlatform"],[21,40,89,1],[21,43,89,1,"require"],[21,50,89,1],[21,51,89,1,"_dependencyMap"],[21,65,89,1],[22,2,89,1],[22,6,89,1,"Platform"],[22,14,89,1],[22,17,89,1,"_interopDefault"],[22,32,89,1],[22,33,89,1,"_reactNativeWebDistExportsPlatform"],[22,67,89,1],[23,2,9,0],[23,6,9,0,"_authStorage"],[23,18,9,0],[23,21,9,0,"require"],[23,28,9,0],[23,29,9,0,"_dependencyMap"],[23,43,9,0],[24,2,1,0],[25,0,2,0],[26,0,3,0],[27,0,4,0],[28,0,5,0],[29,0,6,0],[31,2,11,0],[32,0,12,0],[33,0,13,0],[34,0,14,0],[35,0,15,0],[36,0,16,0],[37,0,17,0],[38,0,18,0],[39,2,19,0],[39,11,19,9,"getApiBaseUrl"],[39,24,19,22,"getApiBaseUrl"],[39,25,19,22],[39,27,19,33],[40,4,20,2],[41,4,21,2],[41,10,21,8,"RAW"],[41,13,21,11],[41,16,21,14,"process"],[41,23,21,21],[41,24,21,22,"env"],[41,27,21,25],[41,28,21,26,"EXPO_PUBLIC_BACKEND_URL"],[41,51,21,49],[41,55,22,7,"process"],[41,62,22,14],[41,63,22,15,"env"],[41,66,22,18],[41,67,22,19,"EXPO_PUBLIC_API_URL"],[41,86,22,38],[41,90,23,7],[41,92,23,9],[43,4,25,2],[44,4,26,2],[44,8,26,6,"RAW"],[44,11,26,9],[44,13,26,11],[45,6,27,4],[45,13,27,11,"RAW"],[45,16,27,14],[45,17,27,15,"replace"],[45,24,27,22],[45,25,27,23],[45,31,27,29],[45,33,27,31],[45,35,27,33],[45,36,27,34],[46,4,28,2],[48,4,30,2],[49,4,31,2],[49,8,31,6,"Platform"],[49,16,31,14],[49,17,31,14,"default"],[49,24,31,14],[49,25,31,15,"OS"],[49,27,31,17],[49,32,31,22],[49,37,31,27],[49,39,31,29],[50,6,32,4],[51,6,33,4],[52,6,34,4],[52,13,34,11],[52,15,34,13],[53,4,35,2],[55,4,37,2],[56,4,38,2],[57,4,39,2],[57,11,39,9],[57,34,39,32],[58,2,40,0],[60,2,42,0],[61,0,43,0],[62,0,44,0],[63,0,45,0],[64,0,46,0],[65,0,47,0],[66,0,48,0],[67,2,49,7],[67,8,49,13,"API_BASE"],[67,16,49,21],[67,19,49,24,"getApiBaseUrl"],[67,32,49,37],[67,33,49,38],[67,34,49,39],[69,2,51,0],[70,0,52,0],[71,0,53,0],[72,0,54,0],[73,0,55,0],[74,0,56,0],[75,2,57,7],[75,11,57,16,"apiUrl"],[75,17,57,22,"apiUrl"],[75,18,57,23,"path"],[75,22,57,35],[75,24,57,45],[76,4,58,2],[77,4,59,2],[77,10,59,8,"normalizedPath"],[77,24,59,22],[77,27,59,25,"path"],[77,31,59,29],[77,32,59,30,"startsWith"],[77,42,59,40],[77,43,59,41],[77,46,59,44],[77,47,59,45],[77,50,59,48,"path"],[77,54,59,52],[77,57,59,55],[77,61,59,59,"path"],[77,65,59,63],[77,67,59,65],[78,4,60,2],[78,11,60,9],[78,14,60,12,"API_BASE"],[78,22,60,20],[78,25,60,23,"normalizedPath"],[78,39,60,37],[78,41,60,39],[79,2,61,0],[81,2,63,0],[82,0,64,0],[83,0,65,0],[84,0,66,0],[85,0,67,0],[86,0,68,0],[87,2,69,7],[87,17,69,22,"getAuthHeaders"],[87,31,69,36,"getAuthHeaders"],[87,32,69,36],[87,34,69,72],[88,4,70,2],[88,10,70,8,"token"],[88,15,70,13],[88,18,70,16],[88,24,70,22],[88,28,70,22,"loadAuthToken"],[88,40,70,35],[88,41,70,35,"loadAuthToken"],[88,54,70,35],[88,56,70,36],[88,57,70,37],[89,4,71,2],[89,8,71,6,"token"],[89,13,71,11],[89,15,71,13],[90,6,72,4],[90,13,72,11],[91,8,72,13],[91,23,72,28],[91,25,72,30],[91,35,72,40,"token"],[91,40,72,45],[92,6,72,48],[92,7,72,49],[93,4,73,2],[94,4,74,2],[94,11,74,9],[94,12,74,10],[94,13,74,11],[95,2,75,0],[97,2,77,0],[98,0,78,0],[99,0,79,0],[100,0,80,0],[101,0,81,0],[102,0,82,0],[103,2,83,7],[103,17,83,22,"getJsonHeaders"],[103,31,83,36,"getJsonHeaders"],[103,32,83,36],[103,34,83,72],[104,4,84,2],[104,10,84,8,"auth"],[104,14,84,12],[104,17,84,15],[104,23,84,21,"getAuthHeaders"],[104,37,84,35],[104,38,84,36],[104,39,84,37],[105,4,85,2],[105,11,85,9],[106,6,86,4],[106,9,86,7,"auth"],[106,13,86,11],[107,6,87,4],[107,20,87,18],[107,22,87,20],[108,4,88,2],[108,5,88,3],[109,2,89,0],[111,2,91,0],[112,2,92,0],[112,6,92,4,"__DEV__"],[112,13,92,11],[112,15,92,13],[113,4,93,2,"console"],[113,11,93,9],[113,12,93,10,"log"],[113,15,93,13],[113,16,93,14],[113,40,93,38],[113,42,93,40,"API_BASE"],[113,50,93,48],[113,54,93,52],[113,72,93,70],[113,73,93,71],[114,4,94,2,"console"],[114,11,94,9],[114,12,94,10,"log"],[114,15,94,13],[114,16,94,14],[114,40,94,38],[114,42,94,40,"Platform"],[114,50,94,48],[114,51,94,48,"default"],[114,58,94,48],[114,59,94,49,"OS"],[114,61,94,51],[114,62,94,52],[116,4,96,2],[117,4,97,2],[117,8,97,6],[117,9,97,7,"API_BASE"],[117,17,97,15],[117,19,97,17],[118,6,98,4,"console"],[118,13,98,11],[118,14,98,12,"warn"],[118,18,98,16],[118,19,99,6],[118,56,99,43],[118,59,100,6],[118,122,100,69],[118,125,101,6],[118,192,102,4],[118,193,102,5],[119,4,103,2],[120,2,104,0],[121,0,104,1],[121,3]],"functionMap":{"names":["<global>","getApiBaseUrl","apiUrl","getAuthHeaders","getJsonHeaders"],"mappings":"AAA;ACkB;CDqB;OEiB;CFI;OGQ;CHM;OIQ;CJM"},"hasCjsExports":false},"type":"js/module"}]}