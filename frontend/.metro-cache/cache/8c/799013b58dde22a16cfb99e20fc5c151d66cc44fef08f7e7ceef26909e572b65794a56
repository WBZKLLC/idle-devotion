{"dependencies":[{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":149},"end":{"line":5,"column":26,"index":175}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"api\", {\n    enumerable: true,\n    get: function () {\n      return api;\n    }\n  });\n  exports.requireUsername = requireUsername;\n  exports.fetchUserHeroes = fetchUserHeroes;\n  exports.promoteHeroStar = promoteHeroStar;\n  exports.getHeroProgression = getHeroProgression;\n  exports.getUserHeroById = getUserHeroById;\n  exports.fetchUser = fetchUser;\n  exports.performSummon = performSummon;\n  var _axios = require(_dependencyMap[0], \"axios\");\n  var axios = _interopDefault(_axios);\n  // /app/frontend/lib/api.ts\n  // SINGLE SOURCE OF TRUTH for all backend API calls\n  // Screens should import from here to prevent endpoint string drift\n\n  const API_BASE = process.env.EXPO_PUBLIC_BACKEND_URL ? `${process.env.EXPO_PUBLIC_BACKEND_URL}/api` : '/api';\n  const api = axios.default.create({\n    baseURL: API_BASE,\n    timeout: 20000\n  });\n  function requireUsername(username) {\n    if (!username) throw new Error('Missing username');\n    return username;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // USER HEROES\n  // ─────────────────────────────────────────────────────────────\n\n  async function fetchUserHeroes(username) {\n    const u = requireUsername(username);\n    const res = await api.get(`/user/${encodeURIComponent(u)}/heroes`);\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // STAR PROMOTION (canonical endpoint)\n  // POST /api/hero/{user_hero_id}/promote-star?username=...\n  // ─────────────────────────────────────────────────────────────\n\n  async function promoteHeroStar(userHeroId, username) {\n    const u = requireUsername(username);\n    const res = await api.post(`/hero/${encodeURIComponent(userHeroId)}/promote-star`, null, {\n      params: {\n        username: u\n      }\n    });\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // HERO PROGRESSION (read model for hero-progression screen)\n  // GET /api/hero/{username}/hero/{heroId}/progression\n  // NOTE: Falls back gracefully if endpoint doesn't exist\n  // ─────────────────────────────────────────────────────────────\n\n  async function getHeroProgression(username, heroId) {\n    const u = requireUsername(username);\n    const res = await api.get(`/hero/${encodeURIComponent(u)}/hero/${encodeURIComponent(heroId)}/progression`);\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // SINGLE HERO FETCH (fallback when hero not in store cache)\n  // NOTE: Temporary implementation - fetches full list and filters.\n  // Replace with GET /user/{username}/heroes/{userHeroId} once backend exists.\n  // Screens call getUserHeroById() and never hit list endpoints directly.\n  // ─────────────────────────────────────────────────────────────\n\n  async function getUserHeroById(username, userHeroId) {\n    const u = requireUsername(username);\n    const res = await api.get(`/user/${encodeURIComponent(u)}/heroes`);\n    const list = Array.isArray(res.data) ? res.data : res.data?.heroes ?? res.data ?? [];\n    const found = list.find(h => String(h?.id) === String(userHeroId));\n    if (!found) throw new Error('Hero not found');\n    return found;\n  }\n\n  // RULE: All hero endpoints live here.\n  // Screens should not build URLs manually (prevents drift).\n\n  // ─────────────────────────────────────────────────────────────\n  // USER AUTH / PROFILE\n  // ─────────────────────────────────────────────────────────────\n\n  async function fetchUser(username) {\n    const u = requireUsername(username);\n    const res = await api.get(`/user/${encodeURIComponent(u)}`);\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // GACHA / SUMMON\n  // ─────────────────────────────────────────────────────────────\n\n  async function performSummon(username, summonType) {\n    const u = requireUsername(username);\n    const res = await api.post(`/gacha/summon`, null, {\n      params: {\n        username: u,\n        summon_type: summonType\n      }\n    });\n    return res.data;\n  }\n\n  // Add more hero endpoints here ONLY.\n  // Screens should import from lib/api.ts so route strings never drift again.\n});","lineCount":124,"map":[[12,2,11,0,"Object"],[12,8,11,0],[12,9,11,0,"defineProperty"],[12,23,11,0],[12,24,11,0,"exports"],[12,31,11,0],[13,4,11,0,"enumerable"],[13,14,11,0],[14,4,11,0,"get"],[14,7,11,0],[14,18,11,0,"get"],[14,19,11,0],[15,6,11,0],[15,13,11,0,"api"],[15,16,11,0],[16,4,11,0],[17,2,11,0],[18,2,16,0,"exports"],[18,9,16,0],[18,10,16,0,"requireUsername"],[18,25,16,0],[18,28,16,0,"requireUsername"],[18,43,16,0],[19,2,25,0,"exports"],[19,9,25,0],[19,10,25,0,"fetchUserHeroes"],[19,25,25,0],[19,28,25,0,"fetchUserHeroes"],[19,43,25,0],[20,2,36,0,"exports"],[20,9,36,0],[20,10,36,0,"promoteHeroStar"],[20,25,36,0],[20,28,36,0,"promoteHeroStar"],[20,43,36,0],[21,2,57,0,"exports"],[21,9,57,0],[21,10,57,0,"getHeroProgression"],[21,28,57,0],[21,31,57,0,"getHeroProgression"],[21,49,57,0],[22,2,70,0,"exports"],[22,9,70,0],[22,10,70,0,"getUserHeroById"],[22,25,70,0],[22,28,70,0,"getUserHeroById"],[22,43,70,0],[23,2,86,0,"exports"],[23,9,86,0],[23,10,86,0,"fetchUser"],[23,19,86,0],[23,22,86,0,"fetchUser"],[23,31,86,0],[24,2,96,0,"exports"],[24,9,96,0],[24,10,96,0,"performSummon"],[24,23,96,0],[24,26,96,0,"performSummon"],[24,39,96,0],[25,2,5,0],[25,6,5,0,"_axios"],[25,12,5,0],[25,15,5,0,"require"],[25,22,5,0],[25,23,5,0,"_dependencyMap"],[25,37,5,0],[26,2,5,0],[26,6,5,0,"axios"],[26,11,5,0],[26,14,5,0,"_interopDefault"],[26,29,5,0],[26,30,5,0,"_axios"],[26,36,5,0],[27,2,1,0],[28,2,2,0],[29,2,3,0],[31,2,7,0],[31,8,7,6,"API_BASE"],[31,16,7,14],[31,19,7,17,"process"],[31,26,7,24],[31,27,7,25,"env"],[31,30,7,28],[31,31,7,29,"EXPO_PUBLIC_BACKEND_URL"],[31,54,7,52],[31,57,8,4],[31,60,8,7,"process"],[31,67,8,14],[31,68,8,15,"env"],[31,71,8,18],[31,72,8,19,"EXPO_PUBLIC_BACKEND_URL"],[31,95,8,42],[31,101,8,48],[31,104,9,4],[31,110,9,10],[32,2,11,7],[32,8,11,13,"api"],[32,11,11,16],[32,14,11,19,"axios"],[32,19,11,24],[32,20,11,24,"default"],[32,27,11,24],[32,28,11,25,"create"],[32,34,11,31],[32,35,11,32],[33,4,12,2,"baseURL"],[33,11,12,9],[33,13,12,11,"API_BASE"],[33,21,12,19],[34,4,13,2,"timeout"],[34,11,13,9],[34,13,13,11],[35,2,14,0],[35,3,14,1],[35,4,14,2],[36,2,16,7],[36,11,16,16,"requireUsername"],[36,26,16,31,"requireUsername"],[36,27,16,32,"username"],[36,35,16,49],[36,37,16,51],[37,4,17,2],[37,8,17,6],[37,9,17,7,"username"],[37,17,17,15],[37,19,17,17],[37,25,17,23],[37,29,17,27,"Error"],[37,34,17,32],[37,35,17,33],[37,53,17,51],[37,54,17,52],[38,4,18,2],[38,11,18,9,"username"],[38,19,18,17],[39,2,19,0],[41,2,21,0],[42,2,22,0],[43,2,23,0],[45,2,25,7],[45,17,25,22,"fetchUserHeroes"],[45,32,25,37,"fetchUserHeroes"],[45,33,25,38,"username"],[45,41,25,54],[45,43,25,56],[46,4,26,2],[46,10,26,8,"u"],[46,11,26,9],[46,14,26,12,"requireUsername"],[46,29,26,27],[46,30,26,28,"username"],[46,38,26,36],[46,39,26,37],[47,4,27,2],[47,10,27,8,"res"],[47,13,27,11],[47,16,27,14],[47,22,27,20,"api"],[47,25,27,23],[47,26,27,24,"get"],[47,29,27,27],[47,30,27,28],[47,39,27,37,"encodeURIComponent"],[47,57,27,55],[47,58,27,56,"u"],[47,59,27,57],[47,60,27,58],[47,69,27,67],[47,70,27,68],[48,4,28,2],[48,11,28,9,"res"],[48,14,28,12],[48,15,28,13,"data"],[48,19,28,17],[49,2,29,0],[51,2,31,0],[52,2,32,0],[53,2,33,0],[54,2,34,0],[56,2,36,7],[56,17,36,22,"promoteHeroStar"],[56,32,36,37,"promoteHeroStar"],[56,33,36,38,"userHeroId"],[56,43,36,56],[56,45,36,58,"username"],[56,53,36,74],[56,55,36,76],[57,4,37,2],[57,10,37,8,"u"],[57,11,37,9],[57,14,37,12,"requireUsername"],[57,29,37,27],[57,30,37,28,"username"],[57,38,37,36],[57,39,37,37],[58,4,38,2],[58,10,38,8,"res"],[58,13,38,11],[58,16,38,14],[58,22,38,20,"api"],[58,25,38,23],[58,26,38,24,"post"],[58,30,38,28],[58,31,39,4],[58,40,39,13,"encodeURIComponent"],[58,58,39,31],[58,59,39,32,"userHeroId"],[58,69,39,42],[58,70,39,43],[58,85,39,58],[58,87,40,4],[58,91,40,8],[58,93,41,4],[59,6,41,6,"params"],[59,12,41,12],[59,14,41,14],[60,8,41,16,"username"],[60,16,41,24],[60,18,41,26,"u"],[61,6,41,28],[62,4,41,30],[62,5,42,2],[62,6,42,3],[63,4,43,2],[63,11,43,9,"res"],[63,14,43,12],[63,15,43,13,"data"],[63,19,43,17],[64,2,49,0],[66,2,51,0],[67,2,52,0],[68,2,53,0],[69,2,54,0],[70,2,55,0],[72,2,57,7],[72,17,57,22,"getHeroProgression"],[72,35,57,40,"getHeroProgression"],[72,36,57,41,"username"],[72,44,57,57],[72,46,57,59,"heroId"],[72,52,57,73],[72,54,57,75],[73,4,58,2],[73,10,58,8,"u"],[73,11,58,9],[73,14,58,12,"requireUsername"],[73,29,58,27],[73,30,58,28,"username"],[73,38,58,36],[73,39,58,37],[74,4,59,2],[74,10,59,8,"res"],[74,13,59,11],[74,16,59,14],[74,22,59,20,"api"],[74,25,59,23],[74,26,59,24,"get"],[74,29,59,27],[74,30,59,28],[74,39,59,37,"encodeURIComponent"],[74,57,59,55],[74,58,59,56,"u"],[74,59,59,57],[74,60,59,58],[74,69,59,67,"encodeURIComponent"],[74,87,59,85],[74,88,59,86,"heroId"],[74,94,59,92],[74,95,59,93],[74,109,59,107],[74,110,59,108],[75,4,60,2],[75,11,60,9,"res"],[75,14,60,12],[75,15,60,13,"data"],[75,19,60,17],[76,2,61,0],[78,2,63,0],[79,2,64,0],[80,2,65,0],[81,2,66,0],[82,2,67,0],[83,2,68,0],[85,2,70,7],[85,17,70,22,"getUserHeroById"],[85,32,70,37,"getUserHeroById"],[85,33,70,38,"username"],[85,41,70,54],[85,43,70,56,"userHeroId"],[85,53,70,74],[85,55,70,76],[86,4,71,2],[86,10,71,8,"u"],[86,11,71,9],[86,14,71,12,"requireUsername"],[86,29,71,27],[86,30,71,28,"username"],[86,38,71,36],[86,39,71,37],[87,4,72,2],[87,10,72,8,"res"],[87,13,72,11],[87,16,72,14],[87,22,72,20,"api"],[87,25,72,23],[87,26,72,24,"get"],[87,29,72,27],[87,30,72,28],[87,39,72,37,"encodeURIComponent"],[87,57,72,55],[87,58,72,56,"u"],[87,59,72,57],[87,60,72,58],[87,69,72,67],[87,70,72,68],[88,4,73,2],[88,10,73,8,"list"],[88,14,73,12],[88,17,73,15,"Array"],[88,22,73,20],[88,23,73,21,"isArray"],[88,30,73,28],[88,31,73,29,"res"],[88,34,73,32],[88,35,73,33,"data"],[88,39,73,37],[88,40,73,38],[88,43,73,41,"res"],[88,46,73,44],[88,47,73,45,"data"],[88,51,73,49],[88,54,73,53,"res"],[88,57,73,56],[88,58,73,57,"data"],[88,62,73,61],[88,64,73,63,"heroes"],[88,70,73,69],[88,74,73,73,"res"],[88,77,73,76],[88,78,73,77,"data"],[88,82,73,81],[88,86,73,85],[88,88,73,88],[89,4,74,2],[89,10,74,8,"found"],[89,15,74,13],[89,18,74,16,"list"],[89,22,74,20],[89,23,74,21,"find"],[89,27,74,25],[89,28,74,27,"h"],[89,29,74,33],[89,33,74,38,"String"],[89,39,74,44],[89,40,74,45,"h"],[89,41,74,46],[89,43,74,48,"id"],[89,45,74,50],[89,46,74,51],[89,51,74,56,"String"],[89,57,74,62],[89,58,74,63,"userHeroId"],[89,68,74,73],[89,69,74,74],[89,70,74,75],[90,4,75,2],[90,8,75,6],[90,9,75,7,"found"],[90,14,75,12],[90,16,75,14],[90,22,75,20],[90,26,75,24,"Error"],[90,31,75,29],[90,32,75,30],[90,48,75,46],[90,49,75,47],[91,4,76,2],[91,11,76,9,"found"],[91,16,76,14],[92,2,77,0],[94,2,79,0],[95,2,80,0],[97,2,82,0],[98,2,83,0],[99,2,84,0],[101,2,86,7],[101,17,86,22,"fetchUser"],[101,26,86,31,"fetchUser"],[101,27,86,32,"username"],[101,35,86,48],[101,37,86,50],[102,4,87,2],[102,10,87,8,"u"],[102,11,87,9],[102,14,87,12,"requireUsername"],[102,29,87,27],[102,30,87,28,"username"],[102,38,87,36],[102,39,87,37],[103,4,88,2],[103,10,88,8,"res"],[103,13,88,11],[103,16,88,14],[103,22,88,20,"api"],[103,25,88,23],[103,26,88,24,"get"],[103,29,88,27],[103,30,88,28],[103,39,88,37,"encodeURIComponent"],[103,57,88,55],[103,58,88,56,"u"],[103,59,88,57],[103,60,88,58],[103,62,88,60],[103,63,88,61],[104,4,89,2],[104,11,89,9,"res"],[104,14,89,12],[104,15,89,13,"data"],[104,19,89,17],[105,2,90,0],[107,2,92,0],[108,2,93,0],[109,2,94,0],[111,2,96,7],[111,17,96,22,"performSummon"],[111,30,96,35,"performSummon"],[111,31,96,36,"username"],[111,39,96,52],[111,41,96,54,"summonType"],[111,51,96,84],[111,53,96,86],[112,4,97,2],[112,10,97,8,"u"],[112,11,97,9],[112,14,97,12,"requireUsername"],[112,29,97,27],[112,30,97,28,"username"],[112,38,97,36],[112,39,97,37],[113,4,98,2],[113,10,98,8,"res"],[113,13,98,11],[113,16,98,14],[113,22,98,20,"api"],[113,25,98,23],[113,26,98,24,"post"],[113,30,98,28],[113,31,98,29],[113,46,98,44],[113,48,98,46],[113,52,98,50],[113,54,98,52],[114,6,99,4,"params"],[114,12,99,10],[114,14,99,12],[115,8,99,14,"username"],[115,16,99,22],[115,18,99,24,"u"],[115,19,99,25],[116,8,99,27,"summon_type"],[116,19,99,38],[116,21,99,40,"summonType"],[117,6,99,51],[118,4,100,2],[118,5,100,3],[118,6,100,4],[119,4,101,2],[119,11,101,9,"res"],[119,14,101,12],[119,15,101,13,"data"],[119,19,101,17],[120,2,102,0],[122,2,104,0],[123,2,105,0],[124,0,105,0],[124,3]],"functionMap":{"names":["<global>","requireUsername","fetchUserHeroes","promoteHeroStar","getHeroProgression","getUserHeroById","list.find$argument_0","fetchUser","performSummon"],"mappings":"AAA;OCe;CDG;OEM;CFI;OGO;CHa;OIQ;CJI;OKS;0BCI,gDD;CLG;OOS;CPI;OQM;CRM"},"hasCjsExports":false},"type":"js/module"}]}