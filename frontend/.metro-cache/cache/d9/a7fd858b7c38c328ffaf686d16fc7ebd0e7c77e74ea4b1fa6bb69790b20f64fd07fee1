{"dependencies":[{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":14,"index":78},"end":{"line":3,"column":38,"index":102}}],"key":"ud8OE6Lg8Q81+bS6ynZj2uyMPdA=","exportNames":["*"],"imports":1}},{"name":"./types.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":14,"index":118},"end":{"line":4,"column":35,"index":139}}],"key":"v1w+pnJrgvUP3JbmDiiF/Rw8c9Q=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  const utils = require(_dependencyMap[0], \"@sentry/utils\");\n  const types = require(_dependencyMap[1], \"./types.js\");\n\n  /**\n   * Default function implementing pageload and navigation transactions\n   */\n  function instrumentRoutingWithDefaults(customStartTransaction, startTransactionOnPageLoad = true, startTransactionOnLocationChange = true) {\n    if (!types.WINDOW || !types.WINDOW.location) {\n      (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && utils.logger.warn('Could not initialize routing instrumentation due to invalid location');\n      return;\n    }\n    let startingUrl = types.WINDOW.location.href;\n    let activeTransaction;\n    if (startTransactionOnPageLoad) {\n      activeTransaction = customStartTransaction({\n        name: types.WINDOW.location.pathname,\n        // pageload should always start at timeOrigin (and needs to be in s, not ms)\n        startTimestamp: utils.browserPerformanceTimeOrigin ? utils.browserPerformanceTimeOrigin / 1000 : undefined,\n        op: 'pageload',\n        origin: 'auto.pageload.browser',\n        metadata: {\n          source: 'url'\n        }\n      });\n    }\n    if (startTransactionOnLocationChange) {\n      utils.addInstrumentationHandler('history', ({\n        to,\n        from\n      }) => {\n        /**\n         * This early return is there to account for some cases where a navigation transaction starts right after\n         * long-running pageload. We make sure that if `from` is undefined and a valid `startingURL` exists, we don't\n         * create an uneccessary navigation transaction.\n         *\n         * This was hard to duplicate, but this behavior stopped as soon as this fix was applied. This issue might also\n         * only be caused in certain development environments where the usage of a hot module reloader is causing\n         * errors.\n         */\n        if (from === undefined && startingUrl && startingUrl.indexOf(to) !== -1) {\n          startingUrl = undefined;\n          return;\n        }\n        if (from !== to) {\n          startingUrl = undefined;\n          if (activeTransaction) {\n            (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && utils.logger.log(`[Tracing] Finishing current transaction with op: ${activeTransaction.op}`);\n            // If there's an open transaction on the scope, we need to finish it before creating an new one.\n            activeTransaction.finish();\n          }\n          activeTransaction = customStartTransaction({\n            name: types.WINDOW.location.pathname,\n            op: 'navigation',\n            origin: 'auto.navigation.browser',\n            metadata: {\n              source: 'url'\n            }\n          });\n        }\n      });\n    }\n  }\n  exports.instrumentRoutingWithDefaults = instrumentRoutingWithDefaults;\n});","lineCount":68,"map":[[2,2,1,0,"Object"],[2,8,1,6],[2,9,1,7,"defineProperty"],[2,23,1,21],[2,24,1,22,"exports"],[2,31,1,29],[2,33,1,31],[2,45,1,43],[2,47,1,45],[3,4,1,47,"value"],[3,9,1,52],[3,11,1,54],[4,2,1,59],[4,3,1,60],[4,4,1,61],[5,2,3,0],[5,8,3,6,"utils"],[5,13,3,11],[5,16,3,14,"require"],[5,23,3,21],[5,24,3,21,"_dependencyMap"],[5,38,3,21],[5,58,3,37],[5,59,3,38],[6,2,4,0],[6,8,4,6,"types"],[6,13,4,11],[6,16,4,14,"require"],[6,23,4,21],[6,24,4,21,"_dependencyMap"],[6,38,4,21],[6,55,4,34],[6,56,4,35],[8,2,6,0],[9,0,7,0],[10,0,8,0],[11,2,9,0],[11,11,9,9,"instrumentRoutingWithDefaults"],[11,40,9,38,"instrumentRoutingWithDefaults"],[11,41,10,2,"customStartTransaction"],[11,63,10,24],[11,65,11,2,"startTransactionOnPageLoad"],[11,91,11,28],[11,94,11,31],[11,98,11,35],[11,100,12,2,"startTransactionOnLocationChange"],[11,132,12,34],[11,135,12,37],[11,139,12,41],[11,141,13,2],[12,4,14,2],[12,8,14,6],[12,9,14,7,"types"],[12,14,14,12],[12,15,14,13,"WINDOW"],[12,21,14,19],[12,25,14,23],[12,26,14,24,"types"],[12,31,14,29],[12,32,14,30,"WINDOW"],[12,38,14,36],[12,39,14,37,"location"],[12,47,14,45],[12,49,14,47],[13,6,15,4],[13,7,15,5],[13,14,15,12,"__SENTRY_DEBUG__"],[13,30,15,28],[13,35,15,33],[13,46,15,44],[13,50,15,48,"__SENTRY_DEBUG__"],[13,66,15,64],[13,71,15,69,"utils"],[13,76,15,74],[13,77,15,75,"logger"],[13,83,15,81],[13,84,15,82,"warn"],[13,88,15,86],[13,89,15,87],[13,159,15,157],[13,160,15,158],[14,6,16,4],[15,4,17,2],[16,4,19,2],[16,8,19,6,"startingUrl"],[16,19,19,17],[16,22,19,20,"types"],[16,27,19,25],[16,28,19,26,"WINDOW"],[16,34,19,32],[16,35,19,33,"location"],[16,43,19,41],[16,44,19,42,"href"],[16,48,19,46],[17,4,21,2],[17,8,21,6,"activeTransaction"],[17,25,21,23],[18,4,22,2],[18,8,22,6,"startTransactionOnPageLoad"],[18,34,22,32],[18,36,22,34],[19,6,23,4,"activeTransaction"],[19,23,23,21],[19,26,23,24,"customStartTransaction"],[19,48,23,46],[19,49,23,47],[20,8,24,6,"name"],[20,12,24,10],[20,14,24,12,"types"],[20,19,24,17],[20,20,24,18,"WINDOW"],[20,26,24,24],[20,27,24,25,"location"],[20,35,24,33],[20,36,24,34,"pathname"],[20,44,24,42],[21,8,25,6],[22,8,26,6,"startTimestamp"],[22,22,26,20],[22,24,26,22,"utils"],[22,29,26,27],[22,30,26,28,"browserPerformanceTimeOrigin"],[22,58,26,56],[22,61,26,59,"utils"],[22,66,26,64],[22,67,26,65,"browserPerformanceTimeOrigin"],[22,95,26,93],[22,98,26,96],[22,102,26,100],[22,105,26,103,"undefined"],[22,114,26,112],[23,8,27,6,"op"],[23,10,27,8],[23,12,27,10],[23,22,27,20],[24,8,28,6,"origin"],[24,14,28,12],[24,16,28,14],[24,39,28,37],[25,8,29,6,"metadata"],[25,16,29,14],[25,18,29,16],[26,10,29,18,"source"],[26,16,29,24],[26,18,29,26],[27,8,29,32],[28,6,30,4],[28,7,30,5],[28,8,30,6],[29,4,31,2],[30,4,33,2],[30,8,33,6,"startTransactionOnLocationChange"],[30,40,33,38],[30,42,33,40],[31,6,34,4,"utils"],[31,11,34,9],[31,12,34,10,"addInstrumentationHandler"],[31,37,34,35],[31,38,34,36],[31,47,34,45],[31,49,34,47],[31,50,34,48],[32,8,34,50,"to"],[32,10,34,52],[33,8,34,54,"from"],[34,6,34,59],[34,7,34,60],[34,12,34,65],[35,8,35,6],[36,0,36,0],[37,0,37,0],[38,0,38,0],[39,0,39,0],[40,0,40,0],[41,0,41,0],[42,0,42,0],[43,0,43,0],[44,8,44,6],[44,12,44,10,"from"],[44,16,44,14],[44,21,44,19,"undefined"],[44,30,44,28],[44,34,44,32,"startingUrl"],[44,45,44,43],[44,49,44,47,"startingUrl"],[44,60,44,58],[44,61,44,59,"indexOf"],[44,68,44,66],[44,69,44,67,"to"],[44,71,44,69],[44,72,44,70],[44,77,44,75],[44,78,44,76],[44,79,44,77],[44,81,44,79],[45,10,45,8,"startingUrl"],[45,21,45,19],[45,24,45,22,"undefined"],[45,33,45,31],[46,10,46,8],[47,8,47,6],[48,8,49,6],[48,12,49,10,"from"],[48,16,49,14],[48,21,49,19,"to"],[48,23,49,21],[48,25,49,23],[49,10,50,8,"startingUrl"],[49,21,50,19],[49,24,50,22,"undefined"],[49,33,50,31],[50,10,51,8],[50,14,51,12,"activeTransaction"],[50,31,51,29],[50,33,51,31],[51,12,52,10],[51,13,52,11],[51,20,52,18,"__SENTRY_DEBUG__"],[51,36,52,34],[51,41,52,39],[51,52,52,50],[51,56,52,54,"__SENTRY_DEBUG__"],[51,72,52,70],[51,77,52,75,"utils"],[51,82,52,80],[51,83,52,81,"logger"],[51,89,52,87],[51,90,52,88,"log"],[51,93,52,91],[51,94,52,92],[51,146,52,144,"activeTransaction"],[51,163,52,161],[51,164,52,162,"op"],[51,166,52,164],[51,168,52,166],[51,169,52,167],[52,12,53,10],[53,12,54,10,"activeTransaction"],[53,29,54,27],[53,30,54,28,"finish"],[53,36,54,34],[53,37,54,35],[53,38,54,36],[54,10,55,8],[55,10,56,8,"activeTransaction"],[55,27,56,25],[55,30,56,28,"customStartTransaction"],[55,52,56,50],[55,53,56,51],[56,12,57,10,"name"],[56,16,57,14],[56,18,57,16,"types"],[56,23,57,21],[56,24,57,22,"WINDOW"],[56,30,57,28],[56,31,57,29,"location"],[56,39,57,37],[56,40,57,38,"pathname"],[56,48,57,46],[57,12,58,10,"op"],[57,14,58,12],[57,16,58,14],[57,28,58,26],[58,12,59,10,"origin"],[58,18,59,16],[58,20,59,18],[58,45,59,43],[59,12,60,10,"metadata"],[59,20,60,18],[59,22,60,20],[60,14,60,22,"source"],[60,20,60,28],[60,22,60,30],[61,12,60,36],[62,10,61,8],[62,11,61,9],[62,12,61,10],[63,8,62,6],[64,6,63,4],[64,7,63,5],[64,8,63,6],[65,4,64,2],[66,2,65,0],[67,2,67,0,"exports"],[67,9,67,7],[67,10,67,8,"instrumentRoutingWithDefaults"],[67,39,67,37],[67,42,67,40,"instrumentRoutingWithDefaults"],[67,71,67,69],[68,0,67,70],[68,3]],"functionMap":{"names":["<global>","instrumentRoutingWithDefaults","utils.addInstrumentationHandler$argument_1"],"mappings":"AAA;ACQ;+CCyB;KD6B;CDE"},"hasCjsExports":true},"type":"js/module"}]}