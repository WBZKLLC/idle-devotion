{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":11,"column":0,"index":327},"end":{"line":11,"column":33,"index":360}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"../lib/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":12,"column":0,"index":361},"end":{"line":12,"column":71,"index":432}}],"key":"cGGbCGri3M695PzY+v7ylQ+Rxt0=","exportNames":["*"],"imports":1}},{"name":"../lib/entitlements/types","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0,"index":433},"end":{"line":21,"column":35,"index":669}}],"key":"W08TkULB6K5ayFSZK0DQ51a7f14=","exportNames":["*"],"imports":1}},{"name":"../lib/entitlements/legacy","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":670},"end":{"line":26,"column":36,"index":779}}],"key":"+rKOnoh7xdxUkJQypQ3SMN7jDOc=","exportNames":["*"],"imports":1}},{"name":"../lib/api","data":{"asyncType":"async","isESMImport":true,"locs":[{"start":{"line":38,"column":22,"index":1270},"end":{"line":38,"column":42,"index":1290}}],"key":"qv6pIAfHV5HK/E8UlfJgciwW1c8=","exportNames":["*"],"imports":1}},{"name":"expo/internal/async-require-module","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":38,"column":16,"index":1264},"end":{"line":38,"column":42,"index":1290}}],"key":"y8mhXL4zKvSVvgnacXXOn0UU+QQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"useEntitlementStore\", {\n    enumerable: true,\n    get: function () {\n      return useEntitlementStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var _libStorage = require(_dependencyMap[1], \"../lib/storage\");\n  var _libEntitlementsTypes = require(_dependencyMap[2], \"../lib/entitlements/types\");\n  var _libEntitlementsLegacy = require(_dependencyMap[3], \"../lib/entitlements/legacy\");\n  /**\n   * Entitlement Store - Server Truth Model\n   * \n   * STRICT INVARIANTS:\n   * - Store NEVER grants entitlements - only server can grant\n   * - Store caches server snapshots for UX (offline/fast reads)\n   * - All reads go through gating helpers, not direct store access\n   * - Refresh from server on: startup, post-purchase, manual\n   */\n\n  // Debug logging helpers\n  const dlog = (...args) => {\n    if (__DEV__) console.log(...args);\n  };\n  const STORAGE_KEY = '@idledevotion/entitlements/v4';\n  const LEGACY_STORAGE_KEY = '@idledevotion/entitlements/v3';\n\n  // API import (lazy to avoid circular deps at module load)\n  let _getEntitlementsSnapshot = null;\n  async function getEntitlementsSnapshotApi() {\n    if (!_getEntitlementsSnapshot) {\n      const api = await require(_dependencyMap[5], \"expo/internal/async-require-module\")(_dependencyMap[4], _dependencyMap.paths, \"../lib/api\");\n      _getEntitlementsSnapshot = api.getEntitlementsSnapshot;\n    }\n    return _getEntitlementsSnapshot();\n  }\n  const useEntitlementStore = (0, _zustand.create)((set, get) => ({\n    snapshot: null,\n    entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n    lastRefreshAt: null,\n    isRefreshing: false,\n    refreshError: null,\n    /**\n     * Hydrate from cached snapshot on app startup\n     * Does NOT grant - only restores last known server state\n     */\n    hydrateEntitlements: async () => {\n      dlog('[entitlementStore] Hydrating from cache...');\n      try {\n        // Try to load cached snapshot\n        const cached = await (0, _libStorage.storageGet)(STORAGE_KEY);\n        if (cached) {\n          const parsed = JSON.parse(cached);\n          const normalized = Object.assign({}, (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(), parsed.entitlements);\n          set({\n            snapshot: parsed,\n            entitlementsByKey: normalized\n          });\n          dlog('[entitlementStore] Hydrated from cache:', Object.keys(normalized).length, 'keys');\n        }\n\n        // Migrate legacy data if present\n        await migrateLegacyData(set, get);\n      } catch (e) {\n        console.error('[entitlementStore] Hydration error:', e);\n      }\n    },\n    /**\n     * Refresh entitlements from server\n     * This is the ONLY way to get authoritative entitlement state\n     */\n    refreshFromServer: async reason => {\n      if (get().isRefreshing) {\n        dlog('[entitlementStore] Already refreshing, skipping');\n        return;\n      }\n      dlog('[entitlementStore] Refreshing from server, reason:', reason);\n      set({\n        isRefreshing: true,\n        refreshError: null\n      });\n      try {\n        const snap = await getEntitlementsSnapshotApi();\n\n        // Strict normalization: fill missing keys as not_owned\n        const normalized = Object.assign({}, (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(), snap.entitlements);\n        set({\n          snapshot: snap,\n          entitlementsByKey: normalized,\n          lastRefreshAt: Date.now(),\n          isRefreshing: false\n        });\n\n        // Persist for offline cache\n        await (0, _libStorage.storageSet)(STORAGE_KEY, JSON.stringify(snap));\n        dlog('[entitlementStore] Refreshed from server:', snap.version);\n      } catch (e) {\n        const errorMsg = e?.response?.data?.detail || e?.message || 'Failed to refresh entitlements';\n        console.error('[entitlementStore] Refresh error:', errorMsg);\n        set({\n          isRefreshing: false,\n          refreshError: errorMsg\n        });\n      }\n    },\n    /**\n     * Apply a snapshot directly (used by purchase verify flow)\n     * Skips network call - uses snapshot returned from verify endpoint\n     */\n    applySnapshot: snap => {\n      dlog('[entitlementStore] Applying snapshot directly, version:', snap.version);\n\n      // Strict normalization\n      const normalized = Object.assign({}, (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(), snap.entitlements);\n      set({\n        snapshot: snap,\n        entitlementsByKey: normalized,\n        lastRefreshAt: Date.now(),\n        refreshError: null\n      });\n\n      // Persist for offline cache\n      (0, _libStorage.storageSet)(STORAGE_KEY, JSON.stringify(snap)).catch(() => {});\n    },\n    /**\n     * Clear all entitlement state (on logout)\n     */\n    clear: () => {\n      dlog('[entitlementStore] Clearing state');\n      set({\n        snapshot: null,\n        entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n        lastRefreshAt: null,\n        refreshError: null\n      });\n      (0, _libStorage.storageRemove)(STORAGE_KEY).catch(() => {});\n    },\n    /**\n     * Check if user has entitlement (internal use)\n     * Screens should use gating helpers instead\n     */\n    hasEntitlement: key => {\n      const {\n        entitlementsByKey,\n        snapshot\n      } = get();\n      const entitlement = entitlementsByKey[key];\n      if (!entitlement || entitlement.status !== 'owned') return false;\n\n      // Check expiry using server time\n      if (entitlement.expires_at && snapshot?.server_time) {\n        const expiresAt = new Date(entitlement.expires_at).getTime();\n        const serverNow = new Date(snapshot.server_time).getTime();\n        if (serverNow > expiresAt) return false;\n      }\n      return true;\n    },\n    // ═══════════════════════════════════════════════════════════\n    // DEV ONLY METHODS - For testing paywalls/features\n    // These should NEVER be called in production code paths\n    // ═══════════════════════════════════════════════════════════\n\n    devGrantEntitlement: key => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devGrantEntitlement called in production - BLOCKED');\n        return;\n      }\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = Object.assign({}, entitlementsByKey, {\n        [key]: {\n          key,\n          status: 'owned',\n          granted_at: new Date().toISOString(),\n          reason: 'admin'\n        }\n      });\n\n      // Create fake snapshot for dev\n      const fakeSnapshot = {\n        server_time: new Date().toISOString(),\n        version: Date.now(),\n        username: 'DEV_USER',\n        entitlements: updated,\n        source: 'database'\n      };\n      set({\n        entitlementsByKey: updated,\n        snapshot: fakeSnapshot\n      });\n      dlog('[entitlementStore] DEV: Granted', key);\n    },\n    devRevokeEntitlement: key => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devRevokeEntitlement called in production - BLOCKED');\n        return;\n      }\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = Object.assign({}, entitlementsByKey, {\n        [key]: {\n          key,\n          status: 'not_owned'\n        }\n      });\n      set({\n        entitlementsByKey: updated\n      });\n      dlog('[entitlementStore] DEV: Revoked', key);\n    },\n    devClearAll: () => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devClearAll called in production - BLOCKED');\n        return;\n      }\n      set({\n        entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n        snapshot: null\n      });\n      (0, _libStorage.storageRemove)(STORAGE_KEY).catch(() => {});\n      dlog('[entitlementStore] DEV: Cleared all entitlements');\n    }\n  }));\n\n  /**\n   * Migrate legacy entitlement data to new format\n   */\n  async function migrateLegacyData(set, get) {\n    try {\n      const legacyData = await (0, _libStorage.storageGet)(LEGACY_STORAGE_KEY);\n      if (!legacyData) return;\n      dlog('[entitlementStore] Migrating legacy data...');\n      const legacy = JSON.parse(legacyData);\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = Object.assign({}, entitlementsByKey);\n\n      // Migrate each legacy key\n      for (const [oldKey, value] of Object.entries(legacy)) {\n        if (value) {\n          const newKey = (0, _libEntitlementsLegacy.migrateLegacyKey)(oldKey);\n          updated[newKey] = {\n            key: newKey,\n            status: 'owned',\n            granted_at: new Date().toISOString(),\n            reason: 'unknown'\n          };\n          dlog('[entitlementStore] Migrated:', oldKey, '->', newKey);\n        }\n      }\n      set({\n        entitlementsByKey: updated\n      });\n\n      // Remove legacy data after migration\n      await (0, _libStorage.storageRemove)(LEGACY_STORAGE_KEY);\n      dlog('[entitlementStore] Legacy migration complete');\n    } catch (e) {\n      console.error('[entitlementStore] Legacy migration error:', e);\n    }\n  }\n});","lineCount":271,"map":[[7,2,71,0,"Object"],[7,8,71,0],[7,9,71,0,"defineProperty"],[7,23,71,0],[7,24,71,0,"exports"],[7,31,71,0],[8,4,71,0,"enumerable"],[8,14,71,0],[9,4,71,0,"get"],[9,7,71,0],[9,18,71,0,"get"],[9,19,71,0],[10,6,71,0],[10,13,71,0,"useEntitlementStore"],[10,32,71,0],[11,4,71,0],[12,2,71,0],[13,2,11,0],[13,6,11,0,"_zustand"],[13,14,11,0],[13,17,11,0,"require"],[13,24,11,0],[13,25,11,0,"_dependencyMap"],[13,39,11,0],[14,2,12,0],[14,6,12,0,"_libStorage"],[14,17,12,0],[14,20,12,0,"require"],[14,27,12,0],[14,28,12,0,"_dependencyMap"],[14,42,12,0],[15,2,13,0],[15,6,13,0,"_libEntitlementsTypes"],[15,27,13,0],[15,30,13,0,"require"],[15,37,13,0],[15,38,13,0,"_dependencyMap"],[15,52,13,0],[16,2,22,0],[16,6,22,0,"_libEntitlementsLegacy"],[16,28,22,0],[16,31,22,0,"require"],[16,38,22,0],[16,39,22,0,"_dependencyMap"],[16,53,22,0],[17,2,1,0],[18,0,2,0],[19,0,3,0],[20,0,4,0],[21,0,5,0],[22,0,6,0],[23,0,7,0],[24,0,8,0],[25,0,9,0],[27,2,28,0],[28,2,29,0],[28,8,29,6,"dlog"],[28,12,29,10],[28,15,29,13,"dlog"],[28,16,29,14],[28,19,29,17,"args"],[28,23,29,28],[28,28,29,33],[29,4,29,35],[29,8,29,39,"__DEV__"],[29,15,29,46],[29,17,29,48,"console"],[29,24,29,55],[29,25,29,56,"log"],[29,28,29,59],[29,29,29,60],[29,32,29,63,"args"],[29,36,29,67],[29,37,29,68],[30,2,29,70],[30,3,29,71],[31,2,31,0],[31,8,31,6,"STORAGE_KEY"],[31,19,31,17],[31,22,31,20],[31,53,31,51],[32,2,32,0],[32,8,32,6,"LEGACY_STORAGE_KEY"],[32,26,32,24],[32,29,32,27],[32,60,32,58],[34,2,34,0],[35,2,35,0],[35,6,35,4,"_getEntitlementsSnapshot"],[35,30,35,74],[35,33,35,77],[35,37,35,81],[36,2,36,0],[36,17,36,15,"getEntitlementsSnapshotApi"],[36,43,36,41,"getEntitlementsSnapshotApi"],[36,44,36,41],[36,46,36,75],[37,4,37,2],[37,8,37,6],[37,9,37,7,"_getEntitlementsSnapshot"],[37,33,37,31],[37,35,37,33],[38,6,38,4],[38,12,38,10,"api"],[38,15,38,13],[38,18,38,16],[38,24,38,16,"require"],[38,31,38,16],[38,32,38,16,"_dependencyMap"],[38,46,38,16],[38,89,38,16,"_dependencyMap"],[38,103,38,16],[38,108,38,16,"_dependencyMap"],[38,122,38,16],[38,123,38,16,"paths"],[38,128,38,16],[38,143,38,42],[39,6,39,4,"_getEntitlementsSnapshot"],[39,30,39,28],[39,33,39,31,"api"],[39,36,39,34],[39,37,39,35,"getEntitlementsSnapshot"],[39,60,39,58],[40,4,40,2],[41,4,41,2],[41,11,41,9,"_getEntitlementsSnapshot"],[41,35,41,33],[41,36,41,34],[41,37,41,35],[42,2,42,0],[43,2,71,7],[43,8,71,13,"useEntitlementStore"],[43,27,71,32],[43,30,71,35],[43,34,71,35,"create"],[43,42,71,41],[43,43,71,41,"create"],[43,49,71,41],[43,51,71,65],[43,52,71,66,"set"],[43,55,71,69],[43,57,71,71,"get"],[43,60,71,74],[43,66,71,80],[44,4,72,2,"snapshot"],[44,12,72,10],[44,14,72,12],[44,18,72,16],[45,4,73,2,"entitlementsByKey"],[45,21,73,19],[45,23,73,21],[45,27,73,21,"createEmptyEntitlementsMap"],[45,48,73,47],[45,49,73,47,"createEmptyEntitlementsMap"],[45,75,73,47],[45,77,73,48],[45,78,73,49],[46,4,74,2,"lastRefreshAt"],[46,17,74,15],[46,19,74,17],[46,23,74,21],[47,4,75,2,"isRefreshing"],[47,16,75,14],[47,18,75,16],[47,23,75,21],[48,4,76,2,"refreshError"],[48,16,76,14],[48,18,76,16],[48,22,76,20],[49,4,78,2],[50,0,79,0],[51,0,80,0],[52,0,81,0],[53,4,82,2,"hydrateEntitlements"],[53,23,82,21],[53,25,82,23],[53,31,82,23,"hydrateEntitlements"],[53,32,82,23],[53,37,82,35],[54,6,83,4,"dlog"],[54,10,83,8],[54,11,83,9],[54,55,83,53],[54,56,83,54],[55,6,85,4],[55,10,85,8],[56,8,86,6],[57,8,87,6],[57,14,87,12,"cached"],[57,20,87,18],[57,23,87,21],[57,29,87,27],[57,33,87,27,"storageGet"],[57,44,87,37],[57,45,87,37,"storageGet"],[57,55,87,37],[57,57,87,38,"STORAGE_KEY"],[57,68,87,49],[57,69,87,50],[58,8,88,6],[58,12,88,10,"cached"],[58,18,88,16],[58,20,88,18],[59,10,89,8],[59,16,89,14,"parsed"],[59,22,89,20],[59,25,89,23,"JSON"],[59,29,89,27],[59,30,89,28,"parse"],[59,35,89,33],[59,36,89,34,"cached"],[59,42,89,40],[59,43,89,65],[60,10,90,8],[60,16,90,14,"normalized"],[60,26,90,24],[60,29,90,24,"Object"],[60,35,90,24],[60,36,90,24,"assign"],[60,42,90,24],[60,47,90,32],[60,51,90,32,"createEmptyEntitlementsMap"],[60,72,90,58],[60,73,90,58,"createEmptyEntitlementsMap"],[60,99,90,58],[60,101,90,59],[60,102,90,60],[60,104,90,65,"parsed"],[60,110,90,71],[60,111,90,72,"entitlements"],[60,123,90,84],[60,124,90,86],[61,10,91,8,"set"],[61,13,91,11],[61,14,91,12],[62,12,92,10,"snapshot"],[62,20,92,18],[62,22,92,20,"parsed"],[62,28,92,26],[63,12,93,10,"entitlementsByKey"],[63,29,93,27],[63,31,93,29,"normalized"],[64,10,94,8],[64,11,94,9],[64,12,94,10],[65,10,95,8,"dlog"],[65,14,95,12],[65,15,95,13],[65,56,95,54],[65,58,95,56,"Object"],[65,64,95,62],[65,65,95,63,"keys"],[65,69,95,67],[65,70,95,68,"normalized"],[65,80,95,78],[65,81,95,79],[65,82,95,80,"length"],[65,88,95,86],[65,90,95,88],[65,96,95,94],[65,97,95,95],[66,8,96,6],[68,8,98,6],[69,8,99,6],[69,14,99,12,"migrateLegacyData"],[69,31,99,29],[69,32,99,30,"set"],[69,35,99,33],[69,37,99,35,"get"],[69,40,99,38],[69,41,99,39],[70,6,101,4],[70,7,101,5],[70,8,101,6],[70,15,101,13,"e"],[70,16,101,14],[70,18,101,16],[71,8,102,6,"console"],[71,15,102,13],[71,16,102,14,"error"],[71,21,102,19],[71,22,102,20],[71,59,102,57],[71,61,102,59,"e"],[71,62,102,60],[71,63,102,61],[72,6,103,4],[73,4,104,2],[73,5,104,3],[74,4,106,2],[75,0,107,0],[76,0,108,0],[77,0,109,0],[78,4,110,2,"refreshFromServer"],[78,21,110,19],[78,23,110,21],[78,29,110,28,"reason"],[78,35,110,34],[78,39,110,39],[79,6,111,4],[79,10,111,8,"get"],[79,13,111,11],[79,14,111,12],[79,15,111,13],[79,16,111,14,"isRefreshing"],[79,28,111,26],[79,30,111,28],[80,8,112,6,"dlog"],[80,12,112,10],[80,13,112,11],[80,62,112,60],[80,63,112,61],[81,8,113,6],[82,6,114,4],[83,6,116,4,"dlog"],[83,10,116,8],[83,11,116,9],[83,63,116,61],[83,65,116,63,"reason"],[83,71,116,69],[83,72,116,70],[84,6,117,4,"set"],[84,9,117,7],[84,10,117,8],[85,8,117,10,"isRefreshing"],[85,20,117,22],[85,22,117,24],[85,26,117,28],[86,8,117,30,"refreshError"],[86,20,117,42],[86,22,117,44],[87,6,117,49],[87,7,117,50],[87,8,117,51],[88,6,119,4],[88,10,119,8],[89,8,120,6],[89,14,120,12,"snap"],[89,18,120,16],[89,21,120,19],[89,27,120,25,"getEntitlementsSnapshotApi"],[89,53,120,51],[89,54,120,52],[89,55,120,53],[91,8,122,6],[92,8,123,6],[92,14,123,12,"normalized"],[92,24,123,22],[92,27,123,22,"Object"],[92,33,123,22],[92,34,123,22,"assign"],[92,40,123,22],[92,45,123,30],[92,49,123,30,"createEmptyEntitlementsMap"],[92,70,123,56],[92,71,123,56,"createEmptyEntitlementsMap"],[92,97,123,56],[92,99,123,57],[92,100,123,58],[92,102,123,63,"snap"],[92,106,123,67],[92,107,123,68,"entitlements"],[92,119,123,80],[92,120,123,82],[93,8,125,6,"set"],[93,11,125,9],[93,12,125,10],[94,10,126,8,"snapshot"],[94,18,126,16],[94,20,126,18,"snap"],[94,24,126,22],[95,10,127,8,"entitlementsByKey"],[95,27,127,25],[95,29,127,27,"normalized"],[95,39,127,37],[96,10,128,8,"lastRefreshAt"],[96,23,128,21],[96,25,128,23,"Date"],[96,29,128,27],[96,30,128,28,"now"],[96,33,128,31],[96,34,128,32],[96,35,128,33],[97,10,129,8,"isRefreshing"],[97,22,129,20],[97,24,129,22],[98,8,130,6],[98,9,130,7],[98,10,130,8],[100,8,132,6],[101,8,133,6],[101,14,133,12],[101,18,133,12,"storageSet"],[101,29,133,22],[101,30,133,22,"storageSet"],[101,40,133,22],[101,42,133,23,"STORAGE_KEY"],[101,53,133,34],[101,55,133,36,"JSON"],[101,59,133,40],[101,60,133,41,"stringify"],[101,69,133,50],[101,70,133,51,"snap"],[101,74,133,55],[101,75,133,56],[101,76,133,57],[102,8,135,6,"dlog"],[102,12,135,10],[102,13,135,11],[102,56,135,54],[102,58,135,56,"snap"],[102,62,135,60],[102,63,135,61,"version"],[102,70,135,68],[102,71,135,69],[103,6,137,4],[103,7,137,5],[103,8,137,6],[103,15,137,13,"e"],[103,16,137,19],[103,18,137,21],[104,8,138,6],[104,14,138,12,"errorMsg"],[104,22,138,20],[104,25,138,23,"e"],[104,26,138,24],[104,28,138,26,"response"],[104,36,138,34],[104,38,138,36,"data"],[104,42,138,40],[104,44,138,42,"detail"],[104,50,138,48],[104,54,138,52,"e"],[104,55,138,53],[104,57,138,55,"message"],[104,64,138,62],[104,68,138,66],[104,100,138,98],[105,8,139,6,"console"],[105,15,139,13],[105,16,139,14,"error"],[105,21,139,19],[105,22,139,20],[105,57,139,55],[105,59,139,57,"errorMsg"],[105,67,139,65],[105,68,139,66],[106,8,140,6,"set"],[106,11,140,9],[106,12,140,10],[107,10,141,8,"isRefreshing"],[107,22,141,20],[107,24,141,22],[107,29,141,27],[108,10,142,8,"refreshError"],[108,22,142,20],[108,24,142,22,"errorMsg"],[109,8,143,6],[109,9,143,7],[109,10,143,8],[110,6,144,4],[111,4,145,2],[111,5,145,3],[112,4,147,2],[113,0,148,0],[114,0,149,0],[115,0,150,0],[116,4,151,2,"applySnapshot"],[116,17,151,15],[116,19,151,18,"snap"],[116,23,151,44],[116,27,151,49],[117,6,152,4,"dlog"],[117,10,152,8],[117,11,152,9],[117,68,152,66],[117,70,152,68,"snap"],[117,74,152,72],[117,75,152,73,"version"],[117,82,152,80],[117,83,152,81],[119,6,154,4],[120,6,155,4],[120,12,155,10,"normalized"],[120,22,155,20],[120,25,155,20,"Object"],[120,31,155,20],[120,32,155,20,"assign"],[120,38,155,20],[120,43,155,28],[120,47,155,28,"createEmptyEntitlementsMap"],[120,68,155,54],[120,69,155,54,"createEmptyEntitlementsMap"],[120,95,155,54],[120,97,155,55],[120,98,155,56],[120,100,155,61,"snap"],[120,104,155,65],[120,105,155,66,"entitlements"],[120,117,155,78],[120,118,155,80],[121,6,157,4,"set"],[121,9,157,7],[121,10,157,8],[122,8,158,6,"snapshot"],[122,16,158,14],[122,18,158,16,"snap"],[122,22,158,20],[123,8,159,6,"entitlementsByKey"],[123,25,159,23],[123,27,159,25,"normalized"],[123,37,159,35],[124,8,160,6,"lastRefreshAt"],[124,21,160,19],[124,23,160,21,"Date"],[124,27,160,25],[124,28,160,26,"now"],[124,31,160,29],[124,32,160,30],[124,33,160,31],[125,8,161,6,"refreshError"],[125,20,161,18],[125,22,161,20],[126,6,162,4],[126,7,162,5],[126,8,162,6],[128,6,164,4],[129,6,165,4],[129,10,165,4,"storageSet"],[129,21,165,14],[129,22,165,14,"storageSet"],[129,32,165,14],[129,34,165,15,"STORAGE_KEY"],[129,45,165,26],[129,47,165,28,"JSON"],[129,51,165,32],[129,52,165,33,"stringify"],[129,61,165,42],[129,62,165,43,"snap"],[129,66,165,47],[129,67,165,48],[129,68,165,49],[129,69,165,50,"catch"],[129,74,165,55],[129,75,165,56],[129,81,165,62],[129,82,165,63],[129,83,165,64],[129,84,165,65],[130,4,166,2],[130,5,166,3],[131,4,168,2],[132,0,169,0],[133,0,170,0],[134,4,171,2,"clear"],[134,9,171,7],[134,11,171,9,"clear"],[134,12,171,9],[134,17,171,15],[135,6,172,4,"dlog"],[135,10,172,8],[135,11,172,9],[135,46,172,44],[135,47,172,45],[136,6,173,4,"set"],[136,9,173,7],[136,10,173,8],[137,8,174,6,"snapshot"],[137,16,174,14],[137,18,174,16],[137,22,174,20],[138,8,175,6,"entitlementsByKey"],[138,25,175,23],[138,27,175,25],[138,31,175,25,"createEmptyEntitlementsMap"],[138,52,175,51],[138,53,175,51,"createEmptyEntitlementsMap"],[138,79,175,51],[138,81,175,52],[138,82,175,53],[139,8,176,6,"lastRefreshAt"],[139,21,176,19],[139,23,176,21],[139,27,176,25],[140,8,177,6,"refreshError"],[140,20,177,18],[140,22,177,20],[141,6,178,4],[141,7,178,5],[141,8,178,6],[142,6,179,4],[142,10,179,4,"storageRemove"],[142,21,179,17],[142,22,179,17,"storageRemove"],[142,35,179,17],[142,37,179,18,"STORAGE_KEY"],[142,48,179,29],[142,49,179,30],[142,50,179,31,"catch"],[142,55,179,36],[142,56,179,37],[142,62,179,43],[142,63,179,44],[142,64,179,45],[142,65,179,46],[143,4,180,2],[143,5,180,3],[144,4,182,2],[145,0,183,0],[146,0,184,0],[147,0,185,0],[148,4,186,2,"hasEntitlement"],[148,18,186,16],[148,20,186,19,"key"],[148,23,186,30],[148,27,186,35],[149,6,187,4],[149,12,187,10],[150,8,187,12,"entitlementsByKey"],[150,25,187,29],[151,8,187,31,"snapshot"],[152,6,187,40],[152,7,187,41],[152,10,187,44,"get"],[152,13,187,47],[152,14,187,48],[152,15,187,49],[153,6,188,4],[153,12,188,10,"entitlement"],[153,23,188,21],[153,26,188,24,"entitlementsByKey"],[153,43,188,41],[153,44,188,42,"key"],[153,47,188,45],[153,48,188,46],[154,6,189,4],[154,10,189,8],[154,11,189,9,"entitlement"],[154,22,189,20],[154,26,189,24,"entitlement"],[154,37,189,35],[154,38,189,36,"status"],[154,44,189,42],[154,49,189,47],[154,56,189,54],[154,58,189,56],[154,65,189,63],[154,70,189,68],[156,6,191,4],[157,6,192,4],[157,10,192,8,"entitlement"],[157,21,192,19],[157,22,192,20,"expires_at"],[157,32,192,30],[157,36,192,34,"snapshot"],[157,44,192,42],[157,46,192,44,"server_time"],[157,57,192,55],[157,59,192,57],[158,8,193,6],[158,14,193,12,"expiresAt"],[158,23,193,21],[158,26,193,24],[158,30,193,28,"Date"],[158,34,193,32],[158,35,193,33,"entitlement"],[158,46,193,44],[158,47,193,45,"expires_at"],[158,57,193,55],[158,58,193,56],[158,59,193,57,"getTime"],[158,66,193,64],[158,67,193,65],[158,68,193,66],[159,8,194,6],[159,14,194,12,"serverNow"],[159,23,194,21],[159,26,194,24],[159,30,194,28,"Date"],[159,34,194,32],[159,35,194,33,"snapshot"],[159,43,194,41],[159,44,194,42,"server_time"],[159,55,194,53],[159,56,194,54],[159,57,194,55,"getTime"],[159,64,194,62],[159,65,194,63],[159,66,194,64],[160,8,195,6],[160,12,195,10,"serverNow"],[160,21,195,19],[160,24,195,22,"expiresAt"],[160,33,195,31],[160,35,195,33],[160,42,195,40],[160,47,195,45],[161,6,196,4],[162,6,198,4],[162,13,198,11],[162,17,198,15],[163,4,199,2],[163,5,199,3],[164,4,201,2],[165,4,202,2],[166,4,203,2],[167,4,204,2],[169,4,206,2,"devGrantEntitlement"],[169,23,206,21],[169,25,206,24,"key"],[169,28,206,35],[169,32,206,40],[170,6,207,4],[170,10,207,8],[170,11,207,9,"__DEV__"],[170,18,207,16],[170,20,207,18],[171,8,208,6,"console"],[171,15,208,13],[171,16,208,14,"warn"],[171,20,208,18],[171,21,208,19],[171,92,208,90],[171,93,208,91],[172,8,209,6],[173,6,210,4],[174,6,212,4],[174,12,212,10],[175,8,212,12,"entitlementsByKey"],[176,6,212,30],[176,7,212,31],[176,10,212,34,"get"],[176,13,212,37],[176,14,212,38],[176,15,212,39],[177,6,213,4],[177,12,213,10,"updated"],[177,19,213,17],[177,22,213,17,"Object"],[177,28,213,17],[177,29,213,17,"assign"],[177,35,213,17],[177,40,214,9,"entitlementsByKey"],[177,57,214,26],[178,8,215,6],[178,9,215,7,"key"],[178,12,215,10],[178,15,215,13],[179,10,216,8,"key"],[179,13,216,11],[180,10,217,8,"status"],[180,16,217,14],[180,18,217,16],[180,25,217,32],[181,10,218,8,"granted_at"],[181,20,218,18],[181,22,218,20],[181,26,218,24,"Date"],[181,30,218,28],[181,31,218,29],[181,32,218,30],[181,33,218,31,"toISOString"],[181,44,218,42],[181,45,218,43],[181,46,218,44],[182,10,219,8,"reason"],[182,16,219,14],[182,18,219,16],[183,8,220,6],[184,6,220,7],[184,8,221,5],[186,6,223,4],[187,6,224,4],[187,12,224,10,"fakeSnapshot"],[187,24,224,44],[187,27,224,47],[188,8,225,6,"server_time"],[188,19,225,17],[188,21,225,19],[188,25,225,23,"Date"],[188,29,225,27],[188,30,225,28],[188,31,225,29],[188,32,225,30,"toISOString"],[188,43,225,41],[188,44,225,42],[188,45,225,43],[189,8,226,6,"version"],[189,15,226,13],[189,17,226,15,"Date"],[189,21,226,19],[189,22,226,20,"now"],[189,25,226,23],[189,26,226,24],[189,27,226,25],[190,8,227,6,"username"],[190,16,227,14],[190,18,227,16],[190,28,227,26],[191,8,228,6,"entitlements"],[191,20,228,18],[191,22,228,20,"updated"],[191,29,228,27],[192,8,229,6,"source"],[192,14,229,12],[192,16,229,14],[193,6,230,4],[193,7,230,5],[194,6,232,4,"set"],[194,9,232,7],[194,10,232,8],[195,8,233,6,"entitlementsByKey"],[195,25,233,23],[195,27,233,25,"updated"],[195,34,233,32],[196,8,234,6,"snapshot"],[196,16,234,14],[196,18,234,16,"fakeSnapshot"],[197,6,235,4],[197,7,235,5],[197,8,235,6],[198,6,236,4,"dlog"],[198,10,236,8],[198,11,236,9],[198,44,236,42],[198,46,236,44,"key"],[198,49,236,47],[198,50,236,48],[199,4,237,2],[199,5,237,3],[200,4,239,2,"devRevokeEntitlement"],[200,24,239,22],[200,26,239,25,"key"],[200,29,239,36],[200,33,239,41],[201,6,240,4],[201,10,240,8],[201,11,240,9,"__DEV__"],[201,18,240,16],[201,20,240,18],[202,8,241,6,"console"],[202,15,241,13],[202,16,241,14,"warn"],[202,20,241,18],[202,21,241,19],[202,93,241,91],[202,94,241,92],[203,8,242,6],[204,6,243,4],[205,6,245,4],[205,12,245,10],[206,8,245,12,"entitlementsByKey"],[207,6,245,30],[207,7,245,31],[207,10,245,34,"get"],[207,13,245,37],[207,14,245,38],[207,15,245,39],[208,6,246,4],[208,12,246,10,"updated"],[208,19,246,17],[208,22,246,17,"Object"],[208,28,246,17],[208,29,246,17,"assign"],[208,35,246,17],[208,40,247,9,"entitlementsByKey"],[208,57,247,26],[209,8,248,6],[209,9,248,7,"key"],[209,12,248,10],[209,15,248,13],[210,10,249,8,"key"],[210,13,249,11],[211,10,250,8,"status"],[211,16,250,14],[211,18,250,16],[212,8,251,6],[213,6,251,7],[213,8,252,5],[214,6,254,4,"set"],[214,9,254,7],[214,10,254,8],[215,8,254,10,"entitlementsByKey"],[215,25,254,27],[215,27,254,29,"updated"],[216,6,254,37],[216,7,254,38],[216,8,254,39],[217,6,255,4,"dlog"],[217,10,255,8],[217,11,255,9],[217,44,255,42],[217,46,255,44,"key"],[217,49,255,47],[217,50,255,48],[218,4,256,2],[218,5,256,3],[219,4,258,2,"devClearAll"],[219,15,258,13],[219,17,258,15,"devClearAll"],[219,18,258,15],[219,23,258,21],[220,6,259,4],[220,10,259,8],[220,11,259,9,"__DEV__"],[220,18,259,16],[220,20,259,18],[221,8,260,6,"console"],[221,15,260,13],[221,16,260,14,"warn"],[221,20,260,18],[221,21,260,19],[221,84,260,82],[221,85,260,83],[222,8,261,6],[223,6,262,4],[224,6,264,4,"set"],[224,9,264,7],[224,10,264,8],[225,8,265,6,"entitlementsByKey"],[225,25,265,23],[225,27,265,25],[225,31,265,25,"createEmptyEntitlementsMap"],[225,52,265,51],[225,53,265,51,"createEmptyEntitlementsMap"],[225,79,265,51],[225,81,265,52],[225,82,265,53],[226,8,266,6,"snapshot"],[226,16,266,14],[226,18,266,16],[227,6,267,4],[227,7,267,5],[227,8,267,6],[228,6,268,4],[228,10,268,4,"storageRemove"],[228,21,268,17],[228,22,268,17,"storageRemove"],[228,35,268,17],[228,37,268,18,"STORAGE_KEY"],[228,48,268,29],[228,49,268,30],[228,50,268,31,"catch"],[228,55,268,36],[228,56,268,37],[228,62,268,43],[228,63,268,44],[228,64,268,45],[228,65,268,46],[229,6,269,4,"dlog"],[229,10,269,8],[229,11,269,9],[229,61,269,59],[229,62,269,60],[230,4,270,2],[231,2,271,0],[231,3,271,1],[231,4,271,2],[231,5,271,3],[233,2,273,0],[234,0,274,0],[235,0,275,0],[236,2,276,0],[236,17,276,15,"migrateLegacyData"],[236,34,276,32,"migrateLegacyData"],[236,35,277,2,"set"],[236,38,277,54],[236,40,278,2,"get"],[236,43,278,34],[236,45,279,2],[237,4,280,2],[237,8,280,6],[238,6,281,4],[238,12,281,10,"legacyData"],[238,22,281,20],[238,25,281,23],[238,31,281,29],[238,35,281,29,"storageGet"],[238,46,281,39],[238,47,281,39,"storageGet"],[238,57,281,39],[238,59,281,40,"LEGACY_STORAGE_KEY"],[238,77,281,58],[238,78,281,59],[239,6,282,4],[239,10,282,8],[239,11,282,9,"legacyData"],[239,21,282,19],[239,23,282,21],[240,6,284,4,"dlog"],[240,10,284,8],[240,11,284,9],[240,56,284,54],[240,57,284,55],[241,6,286,4],[241,12,286,10,"legacy"],[241,18,286,16],[241,21,286,19,"JSON"],[241,25,286,23],[241,26,286,24,"parse"],[241,31,286,29],[241,32,286,30,"legacyData"],[241,42,286,40],[241,43,286,41],[242,6,287,4],[242,12,287,10],[243,8,287,12,"entitlementsByKey"],[244,6,287,30],[244,7,287,31],[244,10,287,34,"get"],[244,13,287,37],[244,14,287,38],[244,15,287,39],[245,6,288,4],[245,12,288,10,"updated"],[245,19,288,17],[245,22,288,17,"Object"],[245,28,288,17],[245,29,288,17,"assign"],[245,35,288,17],[245,40,288,25,"entitlementsByKey"],[245,57,288,42],[245,58,288,44],[247,6,290,4],[248,6,291,4],[248,11,291,9],[248,17,291,15],[248,18,291,16,"oldKey"],[248,24,291,22],[248,26,291,24,"value"],[248,31,291,29],[248,32,291,30],[248,36,291,34,"Object"],[248,42,291,40],[248,43,291,41,"entries"],[248,50,291,48],[248,51,291,49,"legacy"],[248,57,291,55],[248,58,291,56],[248,60,291,58],[249,8,292,6],[249,12,292,10,"value"],[249,17,292,15],[249,19,292,17],[250,10,293,8],[250,16,293,14,"newKey"],[250,22,293,20],[250,25,293,23],[250,29,293,23,"migrateLegacyKey"],[250,51,293,39],[250,52,293,39,"migrateLegacyKey"],[250,68,293,39],[250,70,293,40,"oldKey"],[250,76,293,46],[250,77,293,47],[251,10,294,8,"updated"],[251,17,294,15],[251,18,294,16,"newKey"],[251,24,294,22],[251,25,294,23],[251,28,294,26],[252,12,295,10,"key"],[252,15,295,13],[252,17,295,15,"newKey"],[252,23,295,21],[253,12,296,10,"status"],[253,18,296,16],[253,20,296,18],[253,27,296,25],[254,12,297,10,"granted_at"],[254,22,297,20],[254,24,297,22],[254,28,297,26,"Date"],[254,32,297,30],[254,33,297,31],[254,34,297,32],[254,35,297,33,"toISOString"],[254,46,297,44],[254,47,297,45],[254,48,297,46],[255,12,298,10,"reason"],[255,18,298,16],[255,20,298,18],[256,10,299,8],[256,11,299,9],[257,10,300,8,"dlog"],[257,14,300,12],[257,15,300,13],[257,45,300,43],[257,47,300,45,"oldKey"],[257,53,300,51],[257,55,300,53],[257,59,300,57],[257,61,300,59,"newKey"],[257,67,300,65],[257,68,300,66],[258,8,301,6],[259,6,302,4],[260,6,304,4,"set"],[260,9,304,7],[260,10,304,8],[261,8,304,10,"entitlementsByKey"],[261,25,304,27],[261,27,304,29,"updated"],[262,6,304,37],[262,7,304,38],[262,8,304,39],[264,6,306,4],[265,6,307,4],[265,12,307,10],[265,16,307,10,"storageRemove"],[265,27,307,23],[265,28,307,23,"storageRemove"],[265,41,307,23],[265,43,307,24,"LEGACY_STORAGE_KEY"],[265,61,307,42],[265,62,307,43],[266,6,308,4,"dlog"],[266,10,308,8],[266,11,308,9],[266,57,308,55],[266,58,308,56],[267,4,310,2],[267,5,310,3],[267,6,310,4],[267,13,310,11,"e"],[267,14,310,12],[267,16,310,14],[268,6,311,4,"console"],[268,13,311,11],[268,14,311,12,"error"],[268,19,311,17],[268,20,311,18],[268,64,311,62],[268,66,311,64,"e"],[268,67,311,65],[268,68,311,66],[269,4,312,2],[270,2,313,0],[271,0,313,1],[271,3]],"functionMap":{"names":["<global>","dlog","getEntitlementsSnapshotApi","create$argument_0","hydrateEntitlements","refreshFromServer","applySnapshot","storageSet._catch$argument_0","clear","storageRemove._catch$argument_0","hasEntitlement","devGrantEntitlement","devRevokeEntitlement","devClearAll","migrateLegacyData"],"mappings":"AAA;aC4B,0DD;AEO;CFM;iEG6B;uBCW;GDsB;qBEM;GFmC;iBGM;wDCc,QD;GHC;SKK;qCCQ,QD;GLC;kBOM;GPa;uBQO;GR+B;wBSE;GTiB;eUE;qCJU,QI;GVE;EHC;AcK;CdqC"},"hasCjsExports":false},"type":"js/module"}]}