{"dependencies":[{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":14,"index":78},"end":{"line":3,"column":38,"index":102}}],"key":"ud8OE6Lg8Q81+bS6ynZj2uyMPdA=","exportNames":["*"],"imports":1}},{"name":"../helpers.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":16,"index":120},"end":{"line":4,"column":40,"index":144}}],"key":"SE77CtsJgC8iI+dksCgETtr2kFg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  const utils = require(_dependencyMap[0], \"@sentry/utils\");\n  const helpers = require(_dependencyMap[1], \"../helpers.js\");\n  let cachedFetchImpl = undefined;\n\n  /**\n   * A special usecase for incorrectly wrapped Fetch APIs in conjunction with ad-blockers.\n   * Whenever someone wraps the Fetch API and returns the wrong promise chain,\n   * this chain becomes orphaned and there is no possible way to capture it's rejections\n   * other than allowing it bubble up to this very handler. eg.\n   *\n   * const f = window.fetch;\n   * window.fetch = function () {\n   *   const p = f.apply(this, arguments);\n   *\n   *   p.then(function() {\n   *     console.log('hi.');\n   *   });\n   *\n   *   return p;\n   * }\n   *\n   * `p.then(function () { ... })` is producing a completely separate promise chain,\n   * however, what's returned is `p` - the result of original `fetch` call.\n   *\n   * This mean, that whenever we use the Fetch API to send our own requests, _and_\n   * some ad-blocker blocks it, this orphaned chain will _always_ reject,\n   * effectively causing another event to be captured.\n   * This makes a whole process become an infinite loop, which we need to somehow\n   * deal with, and break it in one way or another.\n   *\n   * To deal with this issue, we are making sure that we _always_ use the real\n   * browser Fetch API, instead of relying on what `window.fetch` exposes.\n   * The only downside to this would be missing our own requests as breadcrumbs,\n   * but because we are already not doing this, it should be just fine.\n   *\n   * Possible failed fetch error messages per-browser:\n   *\n   * Chrome:  Failed to fetch\n   * Edge:    Failed to Fetch\n   * Firefox: NetworkError when attempting to fetch resource\n   * Safari:  resource blocked by content blocker\n   */\n  function getNativeFetchImplementation() {\n    if (cachedFetchImpl) {\n      return cachedFetchImpl;\n    }\n\n    /* eslint-disable @typescript-eslint/unbound-method */\n\n    // Fast path to avoid DOM I/O\n    if (utils.isNativeFetch(helpers.WINDOW.fetch)) {\n      return cachedFetchImpl = helpers.WINDOW.fetch.bind(helpers.WINDOW);\n    }\n    const document = helpers.WINDOW.document;\n    let fetchImpl = helpers.WINDOW.fetch;\n    // eslint-disable-next-line deprecation/deprecation\n    if (document && typeof document.createElement === 'function') {\n      try {\n        const sandbox = document.createElement('iframe');\n        sandbox.hidden = true;\n        document.head.appendChild(sandbox);\n        const contentWindow = sandbox.contentWindow;\n        if (contentWindow && contentWindow.fetch) {\n          fetchImpl = contentWindow.fetch;\n        }\n        document.head.removeChild(sandbox);\n      } catch (e) {\n        (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && utils.logger.warn('Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ', e);\n      }\n    }\n    return cachedFetchImpl = fetchImpl.bind(helpers.WINDOW);\n    /* eslint-enable @typescript-eslint/unbound-method */\n  }\n\n  /** Clears cached fetch impl */\n  function clearCachedFetchImplementation() {\n    cachedFetchImpl = undefined;\n  }\n  exports.clearCachedFetchImplementation = clearCachedFetchImplementation;\n  exports.getNativeFetchImplementation = getNativeFetchImplementation;\n});","lineCount":85,"map":[[2,2,1,0,"Object"],[2,8,1,6],[2,9,1,7,"defineProperty"],[2,23,1,21],[2,24,1,22,"exports"],[2,31,1,29],[2,33,1,31],[2,45,1,43],[2,47,1,45],[3,4,1,47,"value"],[3,9,1,52],[3,11,1,54],[4,2,1,59],[4,3,1,60],[4,4,1,61],[5,2,3,0],[5,8,3,6,"utils"],[5,13,3,11],[5,16,3,14,"require"],[5,23,3,21],[5,24,3,21,"_dependencyMap"],[5,38,3,21],[5,58,3,37],[5,59,3,38],[6,2,4,0],[6,8,4,6,"helpers"],[6,15,4,13],[6,18,4,16,"require"],[6,25,4,23],[6,26,4,23,"_dependencyMap"],[6,40,4,23],[6,60,4,39],[6,61,4,40],[7,2,6,0],[7,6,6,4,"cachedFetchImpl"],[7,21,6,19],[7,24,6,22,"undefined"],[7,33,6,31],[9,2,8,0],[10,0,9,0],[11,0,10,0],[12,0,11,0],[13,0,12,0],[14,0,13,0],[15,0,14,0],[16,0,15,0],[17,0,16,0],[18,0,17,0],[19,0,18,0],[20,0,19,0],[21,0,20,0],[22,0,21,0],[23,0,22,0],[24,0,23,0],[25,0,24,0],[26,0,25,0],[27,0,26,0],[28,0,27,0],[29,0,28,0],[30,0,29,0],[31,0,30,0],[32,0,31,0],[33,0,32,0],[34,0,33,0],[35,0,34,0],[36,0,35,0],[37,0,36,0],[38,0,37,0],[39,0,38,0],[40,0,39,0],[41,0,40,0],[42,0,41,0],[43,0,42,0],[44,0,43,0],[45,0,44,0],[46,0,45,0],[47,2,46,0],[47,11,46,9,"getNativeFetchImplementation"],[47,39,46,37,"getNativeFetchImplementation"],[47,40,46,37],[47,42,46,40],[48,4,47,2],[48,8,47,6,"cachedFetchImpl"],[48,23,47,21],[48,25,47,23],[49,6,48,4],[49,13,48,11,"cachedFetchImpl"],[49,28,48,26],[50,4,49,2],[52,4,51,2],[54,4,53,2],[55,4,54,2],[55,8,54,6,"utils"],[55,13,54,11],[55,14,54,12,"isNativeFetch"],[55,27,54,25],[55,28,54,26,"helpers"],[55,35,54,33],[55,36,54,34,"WINDOW"],[55,42,54,40],[55,43,54,41,"fetch"],[55,48,54,46],[55,49,54,47],[55,51,54,49],[56,6,55,4],[56,13,55,12,"cachedFetchImpl"],[56,28,55,27],[56,31,55,30,"helpers"],[56,38,55,37],[56,39,55,38,"WINDOW"],[56,45,55,44],[56,46,55,45,"fetch"],[56,51,55,50],[56,52,55,51,"bind"],[56,56,55,55],[56,57,55,56,"helpers"],[56,64,55,63],[56,65,55,64,"WINDOW"],[56,71,55,70],[56,72,55,71],[57,4,56,2],[58,4,58,2],[58,10,58,8,"document"],[58,18,58,16],[58,21,58,19,"helpers"],[58,28,58,26],[58,29,58,27,"WINDOW"],[58,35,58,33],[58,36,58,34,"document"],[58,44,58,42],[59,4,59,2],[59,8,59,6,"fetchImpl"],[59,17,59,15],[59,20,59,18,"helpers"],[59,27,59,25],[59,28,59,26,"WINDOW"],[59,34,59,32],[59,35,59,33,"fetch"],[59,40,59,38],[60,4,60,2],[61,4,61,2],[61,8,61,6,"document"],[61,16,61,14],[61,20,61,18],[61,27,61,25,"document"],[61,35,61,33],[61,36,61,34,"createElement"],[61,49,61,47],[61,54,61,52],[61,64,61,62],[61,66,61,64],[62,6,62,4],[62,10,62,8],[63,8,63,6],[63,14,63,12,"sandbox"],[63,21,63,19],[63,24,63,22,"document"],[63,32,63,30],[63,33,63,31,"createElement"],[63,46,63,44],[63,47,63,45],[63,55,63,53],[63,56,63,54],[64,8,64,6,"sandbox"],[64,15,64,13],[64,16,64,14,"hidden"],[64,22,64,20],[64,25,64,23],[64,29,64,27],[65,8,65,6,"document"],[65,16,65,14],[65,17,65,15,"head"],[65,21,65,19],[65,22,65,20,"appendChild"],[65,33,65,31],[65,34,65,32,"sandbox"],[65,41,65,39],[65,42,65,40],[66,8,66,6],[66,14,66,12,"contentWindow"],[66,27,66,25],[66,30,66,28,"sandbox"],[66,37,66,35],[66,38,66,36,"contentWindow"],[66,51,66,49],[67,8,67,6],[67,12,67,10,"contentWindow"],[67,25,67,23],[67,29,67,27,"contentWindow"],[67,42,67,40],[67,43,67,41,"fetch"],[67,48,67,46],[67,50,67,48],[68,10,68,8,"fetchImpl"],[68,19,68,17],[68,22,68,20,"contentWindow"],[68,35,68,33],[68,36,68,34,"fetch"],[68,41,68,39],[69,8,69,6],[70,8,70,6,"document"],[70,16,70,14],[70,17,70,15,"head"],[70,21,70,19],[70,22,70,20,"removeChild"],[70,33,70,31],[70,34,70,32,"sandbox"],[70,41,70,39],[70,42,70,40],[71,6,71,4],[71,7,71,5],[71,8,71,6],[71,15,71,13,"e"],[71,16,71,14],[71,18,71,16],[72,8,72,6],[72,9,72,7],[72,16,72,14,"__SENTRY_DEBUG__"],[72,32,72,30],[72,37,72,35],[72,48,72,46],[72,52,72,50,"__SENTRY_DEBUG__"],[72,68,72,66],[72,73,73,8,"utils"],[72,78,73,13],[72,79,73,14,"logger"],[72,85,73,20],[72,86,73,21,"warn"],[72,90,73,25],[72,91,73,26],[72,172,73,107],[72,174,73,109,"e"],[72,175,73,110],[72,176,73,111],[73,6,74,4],[74,4,75,2],[75,4,77,2],[75,11,77,10,"cachedFetchImpl"],[75,26,77,25],[75,29,77,28,"fetchImpl"],[75,38,77,37],[75,39,77,38,"bind"],[75,43,77,42],[75,44,77,43,"helpers"],[75,51,77,50],[75,52,77,51,"WINDOW"],[75,58,77,57],[75,59,77,58],[76,4,78,2],[77,2,79,0],[79,2,81,0],[80,2,82,0],[80,11,82,9,"clearCachedFetchImplementation"],[80,41,82,39,"clearCachedFetchImplementation"],[80,42,82,39],[80,44,82,42],[81,4,83,2,"cachedFetchImpl"],[81,19,83,17],[81,22,83,20,"undefined"],[81,31,83,29],[82,2,84,0],[83,2,86,0,"exports"],[83,9,86,7],[83,10,86,8,"clearCachedFetchImplementation"],[83,40,86,38],[83,43,86,41,"clearCachedFetchImplementation"],[83,73,86,71],[84,2,87,0,"exports"],[84,9,87,7],[84,10,87,8,"getNativeFetchImplementation"],[84,38,87,36],[84,41,87,39,"getNativeFetchImplementation"],[84,69,87,67],[85,0,87,68],[85,3]],"functionMap":{"names":["<global>","getNativeFetchImplementation","clearCachedFetchImplementation"],"mappings":"AAA;AC6C;CDiC;AEG;CFE"},"hasCjsExports":true},"type":"js/module"}]}