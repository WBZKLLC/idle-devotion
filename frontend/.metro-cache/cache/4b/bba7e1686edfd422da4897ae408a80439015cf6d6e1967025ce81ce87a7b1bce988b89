{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"addOrUpdateIntegration\", {\n    enumerable: true,\n    get: function () {\n      return addOrUpdateIntegration;\n    }\n  });\n  /**\n   * Recursively traverses an object to update an existing nested key.\n   * Note: The provided key path must include existing properties,\n   * the function will not create objects while traversing.\n   *\n   * @param obj An object to update\n   * @param value The value to update the nested key with\n   * @param keyPath The path to the key to update ex. fizz.buzz.foo\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  function setNestedKey(obj, keyPath, value) {\n    // Ex. foo.bar.zoop will extract foo and bar.zoop\n    const match = keyPath.match(/([a-z_]+)\\.(.*)/i);\n    // The match will be null when there's no more recursing to do, i.e., when we've reached the right level of the object\n    if (match === null) {\n      obj[keyPath] = value;\n    } else {\n      // `match[1]` is the initial segment of the path, and `match[2]` is the remainder of the path\n      const innerObj = obj[match[1]];\n      setNestedKey(innerObj, match[2], value);\n    }\n  }\n\n  /**\n   * Enforces inclusion of a given integration with specified options in an integration array originally determined by the\n   * user, by either including the given default instance or by patching an existing user instance with the given options.\n   *\n   * Ideally this would happen when integrations are set up, but there isn't currently a mechanism there for merging\n   * options from a default integration instance with those from a user-provided instance of the same integration, only\n   * for allowing the user to override a default instance entirely. (TODO: Fix that.)\n   *\n   * @param defaultIntegrationInstance An instance of the integration with the correct options already set\n   * @param userIntegrations Integrations defined by the user.\n   * @param forcedOptions Options with which to patch an existing user-derived instance on the integration.\n   * @returns A final integrations array.\n   */\n  function addOrUpdateIntegration(defaultIntegrationInstance, userIntegrations, forcedOptions = {}) {\n    return Array.isArray(userIntegrations) ? addOrUpdateIntegrationInArray(defaultIntegrationInstance, userIntegrations, forcedOptions) : addOrUpdateIntegrationInFunction(defaultIntegrationInstance,\n    // Somehow TS can't figure out that not being an array makes this necessarily a function\n    userIntegrations, forcedOptions);\n  }\n  function addOrUpdateIntegrationInArray(defaultIntegrationInstance, userIntegrations, forcedOptions) {\n    const userInstance = userIntegrations.find(integration => integration.name === defaultIntegrationInstance.name);\n    if (userInstance) {\n      for (const [keyPath, value] of Object.entries(forcedOptions)) {\n        setNestedKey(userInstance, keyPath, value);\n      }\n      return userIntegrations;\n    }\n    return [...userIntegrations, defaultIntegrationInstance];\n  }\n  function addOrUpdateIntegrationInFunction(defaultIntegrationInstance, userIntegrationsFunc, forcedOptions) {\n    const wrapper = defaultIntegrations => {\n      const userFinalIntegrations = userIntegrationsFunc(defaultIntegrations);\n\n      // There are instances where we want the user to be able to prevent an integration from appearing at all, which they\n      // would do by providing a function which filters out the integration in question. If that's happened in one of\n      // those cases, don't add our default back in.\n      if (defaultIntegrationInstance.allowExclusionByUser) {\n        const userFinalInstance = userFinalIntegrations.find(integration => integration.name === defaultIntegrationInstance.name);\n        if (!userFinalInstance) {\n          return userFinalIntegrations;\n        }\n      }\n      return addOrUpdateIntegrationInArray(defaultIntegrationInstance, userFinalIntegrations, forcedOptions);\n    };\n    return wrapper;\n  }\n});","lineCount":81,"map":[[7,2,98,0,"Object"],[7,8,98,0],[7,9,98,0,"defineProperty"],[7,23,98,0],[7,24,98,0,"exports"],[7,31,98,0],[8,4,98,0,"enumerable"],[8,14,98,0],[9,4,98,0,"get"],[9,7,98,0],[9,18,98,0,"get"],[9,19,98,0],[10,6,98,0],[10,13,98,9,"addOrUpdateIntegration"],[10,35,98,31],[11,4,98,31],[12,2,98,31],[13,2,1,0],[14,0,2,0],[15,0,3,0],[16,0,4,0],[17,0,5,0],[18,0,6,0],[19,0,7,0],[20,0,8,0],[21,0,9,0],[22,2,10,0],[23,2,11,0],[23,11,11,9,"setNestedKey"],[23,23,11,21,"setNestedKey"],[23,24,11,22,"obj"],[23,27,11,25],[23,29,11,27,"keyPath"],[23,36,11,34],[23,38,11,36,"value"],[23,43,11,41],[23,45,11,43],[24,4,12,2],[25,4,13,2],[25,10,13,8,"match"],[25,15,13,13],[25,18,13,16,"keyPath"],[25,25,13,23],[25,26,13,24,"match"],[25,31,13,29],[25,32,13,30],[25,50,13,48],[25,51,13,49],[26,4,14,2],[27,4,15,2],[27,8,15,6,"match"],[27,13,15,11],[27,18,15,16],[27,22,15,20],[27,24,15,22],[28,6,16,4,"obj"],[28,9,16,7],[28,10,16,8,"keyPath"],[28,17,16,15],[28,18,16,16],[28,21,16,19,"value"],[28,26,16,24],[29,4,17,2],[29,5,17,3],[29,11,17,9],[30,6,18,4],[31,6,19,4],[31,12,19,10,"innerObj"],[31,20,19,18],[31,23,19,21,"obj"],[31,26,19,24],[31,27,19,25,"match"],[31,32,19,30],[31,33,19,31],[31,34,19,32],[31,35,19,33],[31,36,19,34],[32,6,20,4,"setNestedKey"],[32,18,20,16],[32,19,20,17,"innerObj"],[32,27,20,25],[32,29,20,27,"match"],[32,34,20,32],[32,35,20,33],[32,36,20,34],[32,37,20,35],[32,39,20,37,"value"],[32,44,20,42],[32,45,20,43],[33,4,21,2],[34,2,22,0],[36,2,24,0],[37,0,25,0],[38,0,26,0],[39,0,27,0],[40,0,28,0],[41,0,29,0],[42,0,30,0],[43,0,31,0],[44,0,32,0],[45,0,33,0],[46,0,34,0],[47,0,35,0],[48,0,36,0],[49,2,37,0],[49,11,37,9,"addOrUpdateIntegration"],[49,33,37,31,"addOrUpdateIntegration"],[49,34,38,2,"defaultIntegrationInstance"],[49,60,38,28],[49,62,39,2,"userIntegrations"],[49,78,39,18],[49,80,40,2,"forcedOptions"],[49,93,40,15],[49,96,40,18],[49,97,40,19],[49,98,40,20],[49,100,41,2],[50,4,42,2],[50,11,43,4,"Array"],[50,16,43,9],[50,17,43,10,"isArray"],[50,24,43,17],[50,25,43,18,"userIntegrations"],[50,41,43,34],[50,42,43,35],[50,45,44,8,"addOrUpdateIntegrationInArray"],[50,74,44,37],[50,75,44,38,"defaultIntegrationInstance"],[50,101,44,64],[50,103,44,66,"userIntegrations"],[50,119,44,82],[50,121,44,84,"forcedOptions"],[50,134,44,97],[50,135,44,98],[50,138,45,8,"addOrUpdateIntegrationInFunction"],[50,170,45,40],[50,171,46,10,"defaultIntegrationInstance"],[50,197,46,36],[51,4,47,10],[52,4,48,10,"userIntegrations"],[52,20,48,26],[52,22,49,10,"forcedOptions"],[52,35,50,8],[52,36,50,9],[53,2,52,0],[54,2,54,0],[54,11,54,9,"addOrUpdateIntegrationInArray"],[54,40,54,38,"addOrUpdateIntegrationInArray"],[54,41,55,2,"defaultIntegrationInstance"],[54,67,55,28],[54,69,56,2,"userIntegrations"],[54,85,56,18],[54,87,57,2,"forcedOptions"],[54,100,57,15],[54,102,58,2],[55,4,59,2],[55,10,59,8,"userInstance"],[55,22,59,20],[55,25,59,23,"userIntegrations"],[55,41,59,39],[55,42,59,40,"find"],[55,46,59,44],[55,47,59,45,"integration"],[55,58,59,56],[55,62,59,60,"integration"],[55,73,59,71],[55,74,59,72,"name"],[55,78,59,76],[55,83,59,81,"defaultIntegrationInstance"],[55,109,59,107],[55,110,59,108,"name"],[55,114,59,112],[55,115,59,113],[56,4,61,2],[56,8,61,6,"userInstance"],[56,20,61,18],[56,22,61,20],[57,6,62,4],[57,11,62,9],[57,17,62,15],[57,18,62,16,"keyPath"],[57,25,62,23],[57,27,62,25,"value"],[57,32,62,30],[57,33,62,31],[57,37,62,35,"Object"],[57,43,62,41],[57,44,62,42,"entries"],[57,51,62,49],[57,52,62,50,"forcedOptions"],[57,65,62,63],[57,66,62,64],[57,68,62,66],[58,8,63,6,"setNestedKey"],[58,20,63,18],[58,21,63,19,"userInstance"],[58,33,63,31],[58,35,63,33,"keyPath"],[58,42,63,40],[58,44,63,42,"value"],[58,49,63,47],[58,50,63,48],[59,6,64,4],[60,6,66,4],[60,13,66,11,"userIntegrations"],[60,29,66,27],[61,4,67,2],[62,4,69,2],[62,11,69,9],[62,12,69,10],[62,15,69,13,"userIntegrations"],[62,31,69,29],[62,33,69,31,"defaultIntegrationInstance"],[62,59,69,57],[62,60,69,58],[63,2,70,0],[64,2,72,0],[64,11,72,9,"addOrUpdateIntegrationInFunction"],[64,43,72,41,"addOrUpdateIntegrationInFunction"],[64,44,73,2,"defaultIntegrationInstance"],[64,70,73,28],[64,72,74,2,"userIntegrationsFunc"],[64,92,74,22],[64,94,75,2,"forcedOptions"],[64,107,75,15],[64,109,76,2],[65,4,77,2],[65,10,77,8,"wrapper"],[65,17,77,15],[65,20,77,18,"defaultIntegrations"],[65,39,77,37],[65,43,77,41],[66,6,78,4],[66,12,78,10,"userFinalIntegrations"],[66,33,78,31],[66,36,78,34,"userIntegrationsFunc"],[66,56,78,54],[66,57,78,55,"defaultIntegrations"],[66,76,78,74],[66,77,78,75],[68,6,80,4],[69,6,81,4],[70,6,82,4],[71,6,83,4],[71,10,83,8,"defaultIntegrationInstance"],[71,36,83,34],[71,37,83,35,"allowExclusionByUser"],[71,57,83,55],[71,59,83,57],[72,8,84,6],[72,14,84,12,"userFinalInstance"],[72,31,84,29],[72,34,84,32,"userFinalIntegrations"],[72,55,84,53],[72,56,84,54,"find"],[72,60,84,58],[72,61,85,8,"integration"],[72,72,85,19],[72,76,85,23,"integration"],[72,87,85,34],[72,88,85,35,"name"],[72,92,85,39],[72,97,85,44,"defaultIntegrationInstance"],[72,123,85,70],[72,124,85,71,"name"],[72,128,86,6],[72,129,86,7],[73,8,87,6],[73,12,87,10],[73,13,87,11,"userFinalInstance"],[73,30,87,28],[73,32,87,30],[74,10,88,8],[74,17,88,15,"userFinalIntegrations"],[74,38,88,36],[75,8,89,6],[76,6,90,4],[77,6,92,4],[77,13,92,11,"addOrUpdateIntegrationInArray"],[77,42,92,40],[77,43,92,41,"defaultIntegrationInstance"],[77,69,92,67],[77,71,92,69,"userFinalIntegrations"],[77,92,92,90],[77,94,92,92,"forcedOptions"],[77,107,92,105],[77,108,92,106],[78,4,93,2],[78,5,93,3],[79,4,95,2],[79,11,95,9,"wrapper"],[79,18,95,16],[80,2,96,0],[81,0,96,1],[81,3]],"functionMap":{"names":["<global>","setNestedKey","addOrUpdateIntegration","addOrUpdateIntegrationInArray","find$argument_0","addOrUpdateIntegrationInFunction","wrapper","userFinalIntegrations.find$argument_0"],"mappings":"AAA;ACU;CDW;AEe;CFe;AGE;6CCK,mED;CHW;AKE;kBCK;QCQ,mED;GDQ;CLG"},"hasCjsExports":false},"type":"js/module"}]}