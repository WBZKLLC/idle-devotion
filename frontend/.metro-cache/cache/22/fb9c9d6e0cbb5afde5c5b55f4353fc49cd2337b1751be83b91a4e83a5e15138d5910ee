{"dependencies":[{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":14,"index":78},"end":{"line":3,"column":38,"index":102}}],"key":"ud8OE6Lg8Q81+bS6ynZj2uyMPdA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  var utils = require(_dependencyMap[0], \"@sentry/utils\");\n  var DEFAULT_TRANSPORT_BUFFER_SIZE = 30;\n\n  /**\n   * Creates an instance of a Sentry `Transport`\n   *\n   * @param options\n   * @param makeRequest\n   */\n  function createTransport(options, makeRequest) {\n    var buffer = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : utils.makePromiseBuffer(options.bufferSize || DEFAULT_TRANSPORT_BUFFER_SIZE);\n    var rateLimits = {};\n    var flush = timeout => buffer.drain(timeout);\n    function send(envelope) {\n      var filteredEnvelopeItems = [];\n\n      // Drop rate limited items from envelope\n      utils.forEachEnvelopeItem(envelope, (item, type) => {\n        var envelopeItemDataCategory = utils.envelopeItemTypeToDataCategory(type);\n        if (utils.isRateLimited(rateLimits, envelopeItemDataCategory)) {\n          var event = getEventForEnvelopeItem(item, type);\n          options.recordDroppedEvent('ratelimit_backoff', envelopeItemDataCategory, event);\n        } else {\n          filteredEnvelopeItems.push(item);\n        }\n      });\n\n      // Skip sending if envelope is empty after filtering out rate limited events\n      if (filteredEnvelopeItems.length === 0) {\n        return utils.resolvedSyncPromise();\n      }\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      var filteredEnvelope = utils.createEnvelope(envelope[0], filteredEnvelopeItems);\n\n      // Creates client report for each item in an envelope\n      var recordEnvelopeLoss = reason => {\n        utils.forEachEnvelopeItem(filteredEnvelope, (item, type) => {\n          var event = getEventForEnvelopeItem(item, type);\n          options.recordDroppedEvent(reason, utils.envelopeItemTypeToDataCategory(type), event);\n        });\n      };\n      var requestTask = () => makeRequest({\n        body: utils.serializeEnvelope(filteredEnvelope, options.textEncoder)\n      }).then(response => {\n        // We don't want to throw on NOK responses, but we want to at least log them\n        if (response.statusCode !== undefined && (response.statusCode < 200 || response.statusCode >= 300)) {\n          (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && utils.logger.warn(`Sentry responded with status code ${response.statusCode} to sent event.`);\n        }\n        rateLimits = utils.updateRateLimits(rateLimits, response);\n        return response;\n      }, error => {\n        recordEnvelopeLoss('network_error');\n        throw error;\n      });\n      return buffer.add(requestTask).then(result => result, error => {\n        if (error instanceof utils.SentryError) {\n          (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && utils.logger.error('Skipped sending event because buffer is full.');\n          recordEnvelopeLoss('queue_overflow');\n          return utils.resolvedSyncPromise();\n        } else {\n          throw error;\n        }\n      });\n    }\n\n    // We use this to identifify if the transport is the base transport\n    // TODO (v8): Remove this again as we'll no longer need it\n    send.__sentry__baseTransport__ = true;\n    return {\n      send,\n      flush\n    };\n  }\n  function getEventForEnvelopeItem(item, type) {\n    if (type !== 'event' && type !== 'transaction') {\n      return undefined;\n    }\n    return Array.isArray(item) ? item[1] : undefined;\n  }\n  exports.DEFAULT_TRANSPORT_BUFFER_SIZE = DEFAULT_TRANSPORT_BUFFER_SIZE;\n  exports.createTransport = createTransport;\n});","lineCount":87,"map":[[2,2,1,0,"Object"],[2,8,1,6],[2,9,1,7,"defineProperty"],[2,23,1,21],[2,24,1,22,"exports"],[2,31,1,29],[2,33,1,31],[2,45,1,43],[2,47,1,45],[3,4,1,47,"value"],[3,9,1,52],[3,11,1,54],[4,2,1,59],[4,3,1,60],[4,4,1,61],[5,2,3,0],[5,6,3,6,"utils"],[5,11,3,11],[5,14,3,14,"require"],[5,21,3,21],[5,22,3,21,"_dependencyMap"],[5,36,3,21],[5,56,3,37],[5,57,3,38],[6,2,5,0],[6,6,5,6,"DEFAULT_TRANSPORT_BUFFER_SIZE"],[6,35,5,35],[6,38,5,38],[6,40,5,40],[8,2,7,0],[9,0,8,0],[10,0,9,0],[11,0,10,0],[12,0,11,0],[13,0,12,0],[14,2,13,0],[14,11,13,9,"createTransport"],[14,26,13,24,"createTransport"],[14,27,14,2,"options"],[14,34,14,9],[14,36,15,2,"makeRequest"],[14,47,15,13],[14,49,19,2],[15,4,19,2],[15,8,16,2,"buffer"],[15,14,16,8],[15,17,16,8,"arguments"],[15,26,16,8],[15,27,16,8,"length"],[15,33,16,8],[15,41,16,8,"arguments"],[15,50,16,8],[15,58,16,8,"undefined"],[15,67,16,8],[15,70,16,8,"arguments"],[15,79,16,8],[15,85,16,11,"utils"],[15,90,16,16],[15,91,16,17,"makePromiseBuffer"],[15,108,16,34],[15,109,17,4,"options"],[15,116,17,11],[15,117,17,12,"bufferSize"],[15,127,17,22],[15,131,17,26,"DEFAULT_TRANSPORT_BUFFER_SIZE"],[15,160,18,2],[15,161,18,3],[16,4,20,2],[16,8,20,6,"rateLimits"],[16,18,20,16],[16,21,20,19],[16,22,20,20],[16,23,20,21],[17,4,21,2],[17,8,21,8,"flush"],[17,13,21,13],[17,16,21,17,"timeout"],[17,23,21,24],[17,27,21,29,"buffer"],[17,33,21,35],[17,34,21,36,"drain"],[17,39,21,41],[17,40,21,42,"timeout"],[17,47,21,49],[17,48,21,50],[18,4,23,2],[18,13,23,11,"send"],[18,17,23,15,"send"],[18,18,23,16,"envelope"],[18,26,23,24],[18,28,23,26],[19,6,24,4],[19,10,24,10,"filteredEnvelopeItems"],[19,31,24,31],[19,34,24,34],[19,36,24,36],[21,6,26,4],[22,6,27,4,"utils"],[22,11,27,9],[22,12,27,10,"forEachEnvelopeItem"],[22,31,27,29],[22,32,27,30,"envelope"],[22,40,27,38],[22,42,27,40],[22,43,27,41,"item"],[22,47,27,45],[22,49,27,47,"type"],[22,53,27,51],[22,58,27,56],[23,8,28,6],[23,12,28,12,"envelopeItemDataCategory"],[23,36,28,36],[23,39,28,39,"utils"],[23,44,28,44],[23,45,28,45,"envelopeItemTypeToDataCategory"],[23,75,28,75],[23,76,28,76,"type"],[23,80,28,80],[23,81,28,81],[24,8,29,6],[24,12,29,10,"utils"],[24,17,29,15],[24,18,29,16,"isRateLimited"],[24,31,29,29],[24,32,29,30,"rateLimits"],[24,42,29,40],[24,44,29,42,"envelopeItemDataCategory"],[24,68,29,66],[24,69,29,67],[24,71,29,69],[25,10,30,8],[25,14,30,14,"event"],[25,19,30,19],[25,22,30,22,"getEventForEnvelopeItem"],[25,45,30,45],[25,46,30,46,"item"],[25,50,30,50],[25,52,30,52,"type"],[25,56,30,56],[25,57,30,57],[26,10,31,8,"options"],[26,17,31,15],[26,18,31,16,"recordDroppedEvent"],[26,36,31,34],[26,37,31,35],[26,56,31,54],[26,58,31,56,"envelopeItemDataCategory"],[26,82,31,80],[26,84,31,82,"event"],[26,89,31,87],[26,90,31,88],[27,8,32,6],[27,9,32,7],[27,15,32,13],[28,10,33,8,"filteredEnvelopeItems"],[28,31,33,29],[28,32,33,30,"push"],[28,36,33,34],[28,37,33,35,"item"],[28,41,33,39],[28,42,33,40],[29,8,34,6],[30,6,35,4],[30,7,35,5],[30,8,35,6],[32,6,37,4],[33,6,38,4],[33,10,38,8,"filteredEnvelopeItems"],[33,31,38,29],[33,32,38,30,"length"],[33,38,38,36],[33,43,38,41],[33,44,38,42],[33,46,38,44],[34,8,39,6],[34,15,39,13,"utils"],[34,20,39,18],[34,21,39,19,"resolvedSyncPromise"],[34,40,39,38],[34,41,39,39],[34,42,39,40],[35,6,40,4],[37,6,42,4],[38,6,43,4],[38,10,43,10,"filteredEnvelope"],[38,26,43,26],[38,29,43,29,"utils"],[38,34,43,34],[38,35,43,35,"createEnvelope"],[38,49,43,49],[38,50,43,50,"envelope"],[38,58,43,58],[38,59,43,59],[38,60,43,60],[38,61,43,61],[38,63,43,63,"filteredEnvelopeItems"],[38,84,43,85],[38,85,43,86],[40,6,45,4],[41,6,46,4],[41,10,46,10,"recordEnvelopeLoss"],[41,28,46,28],[41,31,46,32,"reason"],[41,37,46,38],[41,41,46,43],[42,8,47,6,"utils"],[42,13,47,11],[42,14,47,12,"forEachEnvelopeItem"],[42,33,47,31],[42,34,47,32,"filteredEnvelope"],[42,50,47,48],[42,52,47,50],[42,53,47,51,"item"],[42,57,47,55],[42,59,47,57,"type"],[42,63,47,61],[42,68,47,66],[43,10,48,8],[43,14,48,14,"event"],[43,19,48,19],[43,22,48,22,"getEventForEnvelopeItem"],[43,45,48,45],[43,46,48,46,"item"],[43,50,48,50],[43,52,48,52,"type"],[43,56,48,56],[43,57,48,57],[44,10,49,8,"options"],[44,17,49,15],[44,18,49,16,"recordDroppedEvent"],[44,36,49,34],[44,37,49,35,"reason"],[44,43,49,41],[44,45,49,43,"utils"],[44,50,49,48],[44,51,49,49,"envelopeItemTypeToDataCategory"],[44,81,49,79],[44,82,49,80,"type"],[44,86,49,84],[44,87,49,85],[44,89,49,87,"event"],[44,94,49,92],[44,95,49,93],[45,8,50,6],[45,9,50,7],[45,10,50,8],[46,6,51,4],[46,7,51,5],[47,6,53,4],[47,10,53,10,"requestTask"],[47,21,53,21],[47,24,53,24,"requestTask"],[47,25,53,24],[47,30,54,6,"makeRequest"],[47,41,54,17],[47,42,54,18],[48,8,54,20,"body"],[48,12,54,24],[48,14,54,26,"utils"],[48,19,54,31],[48,20,54,32,"serializeEnvelope"],[48,37,54,49],[48,38,54,50,"filteredEnvelope"],[48,54,54,66],[48,56,54,68,"options"],[48,63,54,75],[48,64,54,76,"textEncoder"],[48,75,54,87],[49,6,54,89],[49,7,54,90],[49,8,54,91],[49,9,54,92,"then"],[49,13,54,96],[49,14,55,8,"response"],[49,22,55,16],[49,26,55,20],[50,8,56,10],[51,8,57,10],[51,12,57,14,"response"],[51,20,57,22],[51,21,57,23,"statusCode"],[51,31,57,33],[51,36,57,38,"undefined"],[51,45,57,47],[51,50,57,52,"response"],[51,58,57,60],[51,59,57,61,"statusCode"],[51,69,57,71],[51,72,57,74],[51,75,57,77],[51,79,57,81,"response"],[51,87,57,89],[51,88,57,90,"statusCode"],[51,98,57,100],[51,102,57,104],[51,105,57,107],[51,106,57,108],[51,108,57,110],[52,10,58,12],[52,11,58,13],[52,18,58,20,"__SENTRY_DEBUG__"],[52,34,58,36],[52,39,58,41],[52,50,58,52],[52,54,58,56,"__SENTRY_DEBUG__"],[52,70,58,72],[52,75,58,77,"utils"],[52,80,58,82],[52,81,58,83,"logger"],[52,87,58,89],[52,88,58,90,"warn"],[52,92,58,94],[52,93,58,95],[52,130,58,132,"response"],[52,138,58,140],[52,139,58,141,"statusCode"],[52,149,58,151],[52,166,58,168],[52,167,58,169],[53,8,59,10],[54,8,61,10,"rateLimits"],[54,18,61,20],[54,21,61,23,"utils"],[54,26,61,28],[54,27,61,29,"updateRateLimits"],[54,43,61,45],[54,44,61,46,"rateLimits"],[54,54,61,56],[54,56,61,58,"response"],[54,64,61,66],[54,65,61,67],[55,8,62,10],[55,15,62,17,"response"],[55,23,62,25],[56,6,63,8],[56,7,63,9],[56,9,64,8,"error"],[56,14,64,13],[56,18,64,17],[57,8,65,10,"recordEnvelopeLoss"],[57,26,65,28],[57,27,65,29],[57,42,65,44],[57,43,65,45],[58,8,66,10],[58,14,66,16,"error"],[58,19,66,21],[59,6,67,8],[59,7,68,6],[59,8,68,7],[60,6,70,4],[60,13,70,11,"buffer"],[60,19,70,17],[60,20,70,18,"add"],[60,23,70,21],[60,24,70,22,"requestTask"],[60,35,70,33],[60,36,70,34],[60,37,70,35,"then"],[60,41,70,39],[60,42,71,6,"result"],[60,48,71,12],[60,52,71,16,"result"],[60,58,71,22],[60,60,72,6,"error"],[60,65,72,11],[60,69,72,15],[61,8,73,8],[61,12,73,12,"error"],[61,17,73,17],[61,29,73,29,"utils"],[61,34,73,34],[61,35,73,35,"SentryError"],[61,46,73,46],[61,48,73,48],[62,10,74,10],[62,11,74,11],[62,18,74,18,"__SENTRY_DEBUG__"],[62,34,74,34],[62,39,74,39],[62,50,74,50],[62,54,74,54,"__SENTRY_DEBUG__"],[62,70,74,70],[62,75,74,75,"utils"],[62,80,74,80],[62,81,74,81,"logger"],[62,87,74,87],[62,88,74,88,"error"],[62,93,74,93],[62,94,74,94],[62,141,74,141],[62,142,74,142],[63,10,75,10,"recordEnvelopeLoss"],[63,28,75,28],[63,29,75,29],[63,45,75,45],[63,46,75,46],[64,10,76,10],[64,17,76,17,"utils"],[64,22,76,22],[64,23,76,23,"resolvedSyncPromise"],[64,42,76,42],[64,43,76,43],[64,44,76,44],[65,8,77,8],[65,9,77,9],[65,15,77,15],[66,10,78,10],[66,16,78,16,"error"],[66,21,78,21],[67,8,79,8],[68,6,80,6],[68,7,81,4],[68,8,81,5],[69,4,82,2],[71,4,84,2],[72,4,85,2],[73,4,86,2,"send"],[73,8,86,6],[73,9,86,7,"__sentry__baseTransport__"],[73,34,86,32],[73,37,86,35],[73,41,86,39],[74,4,88,2],[74,11,88,9],[75,6,89,4,"send"],[75,10,89,8],[76,6,90,4,"flush"],[77,4,91,2],[77,5,91,3],[78,2,92,0],[79,2,94,0],[79,11,94,9,"getEventForEnvelopeItem"],[79,34,94,32,"getEventForEnvelopeItem"],[79,35,94,33,"item"],[79,39,94,37],[79,41,94,39,"type"],[79,45,94,43],[79,47,94,45],[80,4,95,2],[80,8,95,6,"type"],[80,12,95,10],[80,17,95,15],[80,24,95,22],[80,28,95,26,"type"],[80,32,95,30],[80,37,95,35],[80,50,95,48],[80,52,95,50],[81,6,96,4],[81,13,96,11,"undefined"],[81,22,96,20],[82,4,97,2],[83,4,99,2],[83,11,99,9,"Array"],[83,16,99,14],[83,17,99,15,"isArray"],[83,24,99,22],[83,25,99,23,"item"],[83,29,99,27],[83,30,99,28],[83,33,99,32,"item"],[83,37,99,36],[83,38,99,39],[83,39,99,40],[83,40,99,41],[83,43,99,44,"undefined"],[83,52,99,53],[84,2,100,0],[85,2,102,0,"exports"],[85,9,102,7],[85,10,102,8,"DEFAULT_TRANSPORT_BUFFER_SIZE"],[85,39,102,37],[85,42,102,40,"DEFAULT_TRANSPORT_BUFFER_SIZE"],[85,71,102,69],[86,2,103,0,"exports"],[86,9,103,7],[86,10,103,8,"createTransport"],[86,25,103,23],[86,28,103,26,"createTransport"],[86,43,103,41],[87,0,103,42],[87,3]],"functionMap":{"names":["<global>","createTransport","flush","send","utils.forEachEnvelopeItem$argument_1","recordEnvelopeLoss","requestTask","makeRequest.then$argument_0","makeRequest.then$argument_1","buffer.add.then$argument_0","buffer.add.then$argument_1","getEventForEnvelopeItem"],"mappings":"AAA;ACY;gBCQ,kCD;EEE;wCCI;KDQ;+BEW;kDDC;OCG;KFC;wBGE;QCE;SDQ;QEC;SFG;OHC;MMG,gBN;MOC;OPQ;GFE;CDU;AWE;CXM"},"hasCjsExports":true},"type":"js/module"}]}