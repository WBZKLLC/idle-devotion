{"dependencies":[{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":149},"end":{"line":5,"column":26,"index":175}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"api\", {\n    enumerable: true,\n    get: function () {\n      return api;\n    }\n  });\n  exports.requireUsername = requireUsername;\n  exports.fetchUserHeroes = fetchUserHeroes;\n  exports.promoteHeroStar = promoteHeroStar;\n  exports.getHeroProgression = getHeroProgression;\n  exports.fetchUser = fetchUser;\n  exports.performSummon = performSummon;\n  var _axios = require(_dependencyMap[0], \"axios\");\n  var axios = _interopDefault(_axios);\n  // /app/frontend/lib/api.ts\n  // SINGLE SOURCE OF TRUTH for all backend API calls\n  // Screens should import from here to prevent endpoint string drift\n\n  const API_BASE = process.env.EXPO_PUBLIC_BACKEND_URL ? `${process.env.EXPO_PUBLIC_BACKEND_URL}/api` : '/api';\n  const api = axios.default.create({\n    baseURL: API_BASE,\n    timeout: 20000\n  });\n  function requireUsername(username) {\n    if (!username) throw new Error('Missing username');\n    return username;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // USER HEROES\n  // ─────────────────────────────────────────────────────────────\n\n  async function fetchUserHeroes(username) {\n    const u = requireUsername(username);\n    const res = await api.get(`/user/${encodeURIComponent(u)}/heroes`);\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // STAR PROMOTION (canonical endpoint)\n  // POST /api/hero/{user_hero_id}/promote-star?username=...\n  // ─────────────────────────────────────────────────────────────\n\n  async function promoteHeroStar(userHeroId, username) {\n    const u = requireUsername(username);\n    const res = await api.post(`/hero/${encodeURIComponent(userHeroId)}/promote-star`, null, {\n      params: {\n        username: u\n      }\n    });\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // HERO PROGRESSION (read model for hero-progression screen)\n  // GET /api/hero/{username}/hero/{heroId}/progression\n  // NOTE: Falls back gracefully if endpoint doesn't exist\n  // ─────────────────────────────────────────────────────────────\n\n  async function getHeroProgression(username, heroId) {\n    const u = requireUsername(username);\n    const res = await api.get(`/hero/${encodeURIComponent(u)}/hero/${encodeURIComponent(heroId)}/progression`);\n    return res.data;\n  }\n\n  // RULE: All hero endpoints live here.\n  // Screens should not build URLs manually (prevents drift).\n\n  // ─────────────────────────────────────────────────────────────\n  // USER AUTH / PROFILE\n  // ─────────────────────────────────────────────────────────────\n\n  async function fetchUser(username) {\n    const u = requireUsername(username);\n    const res = await api.get(`/user/${encodeURIComponent(u)}`);\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // GACHA / SUMMON\n  // ─────────────────────────────────────────────────────────────\n\n  async function performSummon(username, summonType) {\n    const u = requireUsername(username);\n    const res = await api.post(`/gacha/summon`, null, {\n      params: {\n        username: u,\n        summon_type: summonType\n      }\n    });\n    return res.data;\n  }\n\n  // Add more hero endpoints here ONLY.\n  // Screens should import from lib/api.ts so route strings never drift again.\n});","lineCount":107,"map":[[12,2,11,0,"Object"],[12,8,11,0],[12,9,11,0,"defineProperty"],[12,23,11,0],[12,24,11,0,"exports"],[12,31,11,0],[13,4,11,0,"enumerable"],[13,14,11,0],[14,4,11,0,"get"],[14,7,11,0],[14,18,11,0,"get"],[14,19,11,0],[15,6,11,0],[15,13,11,0,"api"],[15,16,11,0],[16,4,11,0],[17,2,11,0],[18,2,16,0,"exports"],[18,9,16,0],[18,10,16,0,"requireUsername"],[18,25,16,0],[18,28,16,0,"requireUsername"],[18,43,16,0],[19,2,25,0,"exports"],[19,9,25,0],[19,10,25,0,"fetchUserHeroes"],[19,25,25,0],[19,28,25,0,"fetchUserHeroes"],[19,43,25,0],[20,2,36,0,"exports"],[20,9,36,0],[20,10,36,0,"promoteHeroStar"],[20,25,36,0],[20,28,36,0,"promoteHeroStar"],[20,43,36,0],[21,2,57,0,"exports"],[21,9,57,0],[21,10,57,0,"getHeroProgression"],[21,28,57,0],[21,31,57,0,"getHeroProgression"],[21,49,57,0],[22,2,70,0,"exports"],[22,9,70,0],[22,10,70,0,"fetchUser"],[22,19,70,0],[22,22,70,0,"fetchUser"],[22,31,70,0],[23,2,80,0,"exports"],[23,9,80,0],[23,10,80,0,"performSummon"],[23,23,80,0],[23,26,80,0,"performSummon"],[23,39,80,0],[24,2,5,0],[24,6,5,0,"_axios"],[24,12,5,0],[24,15,5,0,"require"],[24,22,5,0],[24,23,5,0,"_dependencyMap"],[24,37,5,0],[25,2,5,0],[25,6,5,0,"axios"],[25,11,5,0],[25,14,5,0,"_interopDefault"],[25,29,5,0],[25,30,5,0,"_axios"],[25,36,5,0],[26,2,1,0],[27,2,2,0],[28,2,3,0],[30,2,7,0],[30,8,7,6,"API_BASE"],[30,16,7,14],[30,19,7,17,"process"],[30,26,7,24],[30,27,7,25,"env"],[30,30,7,28],[30,31,7,29,"EXPO_PUBLIC_BACKEND_URL"],[30,54,7,52],[30,57,8,4],[30,60,8,7,"process"],[30,67,8,14],[30,68,8,15,"env"],[30,71,8,18],[30,72,8,19,"EXPO_PUBLIC_BACKEND_URL"],[30,95,8,42],[30,101,8,48],[30,104,9,4],[30,110,9,10],[31,2,11,7],[31,8,11,13,"api"],[31,11,11,16],[31,14,11,19,"axios"],[31,19,11,24],[31,20,11,24,"default"],[31,27,11,24],[31,28,11,25,"create"],[31,34,11,31],[31,35,11,32],[32,4,12,2,"baseURL"],[32,11,12,9],[32,13,12,11,"API_BASE"],[32,21,12,19],[33,4,13,2,"timeout"],[33,11,13,9],[33,13,13,11],[34,2,14,0],[34,3,14,1],[34,4,14,2],[35,2,16,7],[35,11,16,16,"requireUsername"],[35,26,16,31,"requireUsername"],[35,27,16,32,"username"],[35,35,16,49],[35,37,16,51],[36,4,17,2],[36,8,17,6],[36,9,17,7,"username"],[36,17,17,15],[36,19,17,17],[36,25,17,23],[36,29,17,27,"Error"],[36,34,17,32],[36,35,17,33],[36,53,17,51],[36,54,17,52],[37,4,18,2],[37,11,18,9,"username"],[37,19,18,17],[38,2,19,0],[40,2,21,0],[41,2,22,0],[42,2,23,0],[44,2,25,7],[44,17,25,22,"fetchUserHeroes"],[44,32,25,37,"fetchUserHeroes"],[44,33,25,38,"username"],[44,41,25,54],[44,43,25,56],[45,4,26,2],[45,10,26,8,"u"],[45,11,26,9],[45,14,26,12,"requireUsername"],[45,29,26,27],[45,30,26,28,"username"],[45,38,26,36],[45,39,26,37],[46,4,27,2],[46,10,27,8,"res"],[46,13,27,11],[46,16,27,14],[46,22,27,20,"api"],[46,25,27,23],[46,26,27,24,"get"],[46,29,27,27],[46,30,27,28],[46,39,27,37,"encodeURIComponent"],[46,57,27,55],[46,58,27,56,"u"],[46,59,27,57],[46,60,27,58],[46,69,27,67],[46,70,27,68],[47,4,28,2],[47,11,28,9,"res"],[47,14,28,12],[47,15,28,13,"data"],[47,19,28,17],[48,2,29,0],[50,2,31,0],[51,2,32,0],[52,2,33,0],[53,2,34,0],[55,2,36,7],[55,17,36,22,"promoteHeroStar"],[55,32,36,37,"promoteHeroStar"],[55,33,36,38,"userHeroId"],[55,43,36,56],[55,45,36,58,"username"],[55,53,36,74],[55,55,36,76],[56,4,37,2],[56,10,37,8,"u"],[56,11,37,9],[56,14,37,12,"requireUsername"],[56,29,37,27],[56,30,37,28,"username"],[56,38,37,36],[56,39,37,37],[57,4,38,2],[57,10,38,8,"res"],[57,13,38,11],[57,16,38,14],[57,22,38,20,"api"],[57,25,38,23],[57,26,38,24,"post"],[57,30,38,28],[57,31,39,4],[57,40,39,13,"encodeURIComponent"],[57,58,39,31],[57,59,39,32,"userHeroId"],[57,69,39,42],[57,70,39,43],[57,85,39,58],[57,87,40,4],[57,91,40,8],[57,93,41,4],[58,6,41,6,"params"],[58,12,41,12],[58,14,41,14],[59,8,41,16,"username"],[59,16,41,24],[59,18,41,26,"u"],[60,6,41,28],[61,4,41,30],[61,5,42,2],[61,6,42,3],[62,4,43,2],[62,11,43,9,"res"],[62,14,43,12],[62,15,43,13,"data"],[62,19,43,17],[63,2,49,0],[65,2,51,0],[66,2,52,0],[67,2,53,0],[68,2,54,0],[69,2,55,0],[71,2,57,7],[71,17,57,22,"getHeroProgression"],[71,35,57,40,"getHeroProgression"],[71,36,57,41,"username"],[71,44,57,57],[71,46,57,59,"heroId"],[71,52,57,73],[71,54,57,75],[72,4,58,2],[72,10,58,8,"u"],[72,11,58,9],[72,14,58,12,"requireUsername"],[72,29,58,27],[72,30,58,28,"username"],[72,38,58,36],[72,39,58,37],[73,4,59,2],[73,10,59,8,"res"],[73,13,59,11],[73,16,59,14],[73,22,59,20,"api"],[73,25,59,23],[73,26,59,24,"get"],[73,29,59,27],[73,30,59,28],[73,39,59,37,"encodeURIComponent"],[73,57,59,55],[73,58,59,56,"u"],[73,59,59,57],[73,60,59,58],[73,69,59,67,"encodeURIComponent"],[73,87,59,85],[73,88,59,86,"heroId"],[73,94,59,92],[73,95,59,93],[73,109,59,107],[73,110,59,108],[74,4,60,2],[74,11,60,9,"res"],[74,14,60,12],[74,15,60,13,"data"],[74,19,60,17],[75,2,61,0],[77,2,63,0],[78,2,64,0],[80,2,66,0],[81,2,67,0],[82,2,68,0],[84,2,70,7],[84,17,70,22,"fetchUser"],[84,26,70,31,"fetchUser"],[84,27,70,32,"username"],[84,35,70,48],[84,37,70,50],[85,4,71,2],[85,10,71,8,"u"],[85,11,71,9],[85,14,71,12,"requireUsername"],[85,29,71,27],[85,30,71,28,"username"],[85,38,71,36],[85,39,71,37],[86,4,72,2],[86,10,72,8,"res"],[86,13,72,11],[86,16,72,14],[86,22,72,20,"api"],[86,25,72,23],[86,26,72,24,"get"],[86,29,72,27],[86,30,72,28],[86,39,72,37,"encodeURIComponent"],[86,57,72,55],[86,58,72,56,"u"],[86,59,72,57],[86,60,72,58],[86,62,72,60],[86,63,72,61],[87,4,73,2],[87,11,73,9,"res"],[87,14,73,12],[87,15,73,13,"data"],[87,19,73,17],[88,2,74,0],[90,2,76,0],[91,2,77,0],[92,2,78,0],[94,2,80,7],[94,17,80,22,"performSummon"],[94,30,80,35,"performSummon"],[94,31,80,36,"username"],[94,39,80,52],[94,41,80,54,"summonType"],[94,51,80,84],[94,53,80,86],[95,4,81,2],[95,10,81,8,"u"],[95,11,81,9],[95,14,81,12,"requireUsername"],[95,29,81,27],[95,30,81,28,"username"],[95,38,81,36],[95,39,81,37],[96,4,82,2],[96,10,82,8,"res"],[96,13,82,11],[96,16,82,14],[96,22,82,20,"api"],[96,25,82,23],[96,26,82,24,"post"],[96,30,82,28],[96,31,82,29],[96,46,82,44],[96,48,82,46],[96,52,82,50],[96,54,82,52],[97,6,83,4,"params"],[97,12,83,10],[97,14,83,12],[98,8,83,14,"username"],[98,16,83,22],[98,18,83,24,"u"],[98,19,83,25],[99,8,83,27,"summon_type"],[99,19,83,38],[99,21,83,40,"summonType"],[100,6,83,51],[101,4,84,2],[101,5,84,3],[101,6,84,4],[102,4,85,2],[102,11,85,9,"res"],[102,14,85,12],[102,15,85,13,"data"],[102,19,85,17],[103,2,86,0],[105,2,88,0],[106,2,89,0],[107,0,89,0],[107,3]],"functionMap":{"names":["<global>","requireUsername","fetchUserHeroes","promoteHeroStar","getHeroProgression","fetchUser","performSummon"],"mappings":"AAA;OCe;CDG;OEM;CFI;OGO;CHa;OIQ;CJI;OKS;CLI;OMM;CNM"},"hasCjsExports":false},"type":"js/module"}]}