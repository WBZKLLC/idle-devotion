{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.getFriendsSummary = getFriendsSummary;\n  exports.getFriendsList = getFriendsList;\n  exports.getFriendRequests = getFriendRequests;\n  exports.acceptFriendRequest = acceptFriendRequest;\n  exports.declineFriendRequest = declineFriendRequest;\n  exports.searchPlayers = searchPlayers;\n  exports.sendFriendRequest = sendFriendRequest;\n  // /app/frontend/lib/api/friends.ts\n  // Phase 3.23.2: Friends API Layer\n  //\n  // Canonical API calls for friends system.\n  // Graceful error handling â€” returns defaults on failure.\n\n  const API_BASE = process.env.EXPO_PUBLIC_API_URL || '';\n\n  /**\n   * Get friends summary (badge counts)\n   */\n  async function getFriendsSummary(username) {\n    try {\n      const res = await fetch(`${API_BASE}/api/friends/summary/${username}`);\n      if (!res.ok) throw new Error('Failed to fetch friends summary');\n      return await res.json();\n    } catch {\n      return {\n        pendingRequests: 0,\n        totalFriends: 0\n      };\n    }\n  }\n\n  /**\n   * Get friends list\n   */\n  async function getFriendsList(username) {\n    try {\n      const res = await fetch(`${API_BASE}/api/friends/list/${username}`);\n      if (!res.ok) throw new Error('Failed to fetch friends list');\n      const data = await res.json();\n      // Transform backend response to frontend format\n      return data.map(f => ({\n        id: f.friend_id || f.id,\n        username: f.friend_username || f.username,\n        lastOnline: f.last_collected ? 'Earlier today' : 'Yesterday',\n        status: 'offline',\n        affinity: f.can_collect ? 50 : undefined\n      }));\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Get friend requests\n   */\n  async function getFriendRequests(username) {\n    try {\n      const res = await fetch(`${API_BASE}/api/friends/requests/${username}`);\n      if (!res.ok) throw new Error('Failed to fetch friend requests');\n      const data = await res.json();\n      // Transform to frontend format\n      return data.map(r => ({\n        id: r.id,\n        fromUsername: r.from_username,\n        timestamp: 'Just now'\n      }));\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Accept friend request\n   */\n  async function acceptFriendRequest(username, requestId) {\n    const res = await fetch(`${API_BASE}/api/friends/requests/${username}/${requestId}/accept`, {\n      method: 'POST'\n    });\n    if (!res.ok) throw new Error('Failed to accept request');\n  }\n\n  /**\n   * Decline friend request\n   */\n  async function declineFriendRequest(username, requestId) {\n    const res = await fetch(`${API_BASE}/api/friends/requests/${username}/${requestId}/decline`, {\n      method: 'POST'\n    });\n    if (!res.ok) throw new Error('Failed to decline request');\n  }\n\n  /**\n   * Search for players\n   */\n  async function searchPlayers(query, username) {\n    if (!query || query.length < 2) return [];\n    try {\n      const params = new URLSearchParams({\n        q: query\n      });\n      if (username) params.append('username', username);\n      const res = await fetch(`${API_BASE}/api/friends/search?${params}`);\n      if (!res.ok) throw new Error('Failed to search players');\n      return await res.json();\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Send friend request\n   */\n  async function sendFriendRequest(fromUsername, toUsername) {\n    const res = await fetch(`${API_BASE}/api/friends/requests/send`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        from: fromUsername,\n        to: toUsername\n      })\n    });\n    if (!res.ok) throw new Error('Failed to send request');\n  }\n});","lineCount":132,"map":[[7,2,12,0,"exports"],[7,9,12,0],[7,10,12,0,"getFriendsSummary"],[7,27,12,0],[7,30,12,0,"getFriendsSummary"],[7,47,12,0],[8,2,28,0,"exports"],[8,9,28,0],[8,10,28,0,"getFriendsList"],[8,24,28,0],[8,27,28,0,"getFriendsList"],[8,41,28,0],[9,2,55,0,"exports"],[9,9,55,0],[9,10,55,0,"getFriendRequests"],[9,27,55,0],[9,30,55,0,"getFriendRequests"],[9,47,55,0],[10,2,78,0,"exports"],[10,9,78,0],[10,10,78,0,"acceptFriendRequest"],[10,29,78,0],[10,32,78,0,"acceptFriendRequest"],[10,51,78,0],[11,2,88,0,"exports"],[11,9,88,0],[11,10,88,0,"declineFriendRequest"],[11,30,88,0],[11,33,88,0,"declineFriendRequest"],[11,53,88,0],[12,2,98,0,"exports"],[12,9,98,0],[12,10,98,0,"searchPlayers"],[12,23,98,0],[12,26,98,0,"searchPlayers"],[12,39,98,0],[13,2,122,0,"exports"],[13,9,122,0],[13,10,122,0,"sendFriendRequest"],[13,27,122,0],[13,30,122,0,"sendFriendRequest"],[13,47,122,0],[14,2,1,0],[15,2,2,0],[16,2,3,0],[17,2,4,0],[18,2,5,0],[20,2,7,0],[20,8,7,6,"API_BASE"],[20,16,7,14],[20,19,7,17,"process"],[20,26,7,24],[20,27,7,25,"env"],[20,30,7,28],[20,31,7,29,"EXPO_PUBLIC_API_URL"],[20,50,7,48],[20,54,7,52],[20,56,7,54],[22,2,9,0],[23,0,10,0],[24,0,11,0],[25,2,12,7],[25,17,12,22,"getFriendsSummary"],[25,34,12,39,"getFriendsSummary"],[25,35,12,40,"username"],[25,43,12,56],[25,45,15,3],[26,4,16,2],[26,8,16,6],[27,6,17,4],[27,12,17,10,"res"],[27,15,17,13],[27,18,17,16],[27,24,17,22,"fetch"],[27,29,17,27],[27,30,17,28],[27,33,17,31,"API_BASE"],[27,41,17,39],[27,65,17,63,"username"],[27,73,17,71],[27,75,17,73],[27,76,17,74],[28,6,18,4],[28,10,18,8],[28,11,18,9,"res"],[28,14,18,12],[28,15,18,13,"ok"],[28,17,18,15],[28,19,18,17],[28,25,18,23],[28,29,18,27,"Error"],[28,34,18,32],[28,35,18,33],[28,68,18,66],[28,69,18,67],[29,6,19,4],[29,13,19,11],[29,19,19,17,"res"],[29,22,19,20],[29,23,19,21,"json"],[29,27,19,25],[29,28,19,26],[29,29,19,27],[30,4,20,2],[30,5,20,3],[30,6,20,4],[30,12,20,10],[31,6,21,4],[31,13,21,11],[32,8,21,13,"pendingRequests"],[32,23,21,28],[32,25,21,30],[32,26,21,31],[33,8,21,33,"totalFriends"],[33,20,21,45],[33,22,21,47],[34,6,21,49],[34,7,21,50],[35,4,22,2],[36,2,23,0],[38,2,25,0],[39,0,26,0],[40,0,27,0],[41,2,28,7],[41,17,28,22,"getFriendsList"],[41,31,28,36,"getFriendsList"],[41,32,28,37,"username"],[41,40,28,53],[41,42,34,4],[42,4,35,2],[42,8,35,6],[43,6,36,4],[43,12,36,10,"res"],[43,15,36,13],[43,18,36,16],[43,24,36,22,"fetch"],[43,29,36,27],[43,30,36,28],[43,33,36,31,"API_BASE"],[43,41,36,39],[43,62,36,60,"username"],[43,70,36,68],[43,72,36,70],[43,73,36,71],[44,6,37,4],[44,10,37,8],[44,11,37,9,"res"],[44,14,37,12],[44,15,37,13,"ok"],[44,17,37,15],[44,19,37,17],[44,25,37,23],[44,29,37,27,"Error"],[44,34,37,32],[44,35,37,33],[44,65,37,63],[44,66,37,64],[45,6,38,4],[45,12,38,10,"data"],[45,16,38,14],[45,19,38,17],[45,25,38,23,"res"],[45,28,38,26],[45,29,38,27,"json"],[45,33,38,31],[45,34,38,32],[45,35,38,33],[46,6,39,4],[47,6,40,4],[47,13,40,11,"data"],[47,17,40,15],[47,18,40,16,"map"],[47,21,40,19],[47,22,40,21,"f"],[47,23,40,27],[47,28,40,33],[48,8,41,6,"id"],[48,10,41,8],[48,12,41,10,"f"],[48,13,41,11],[48,14,41,12,"friend_id"],[48,23,41,21],[48,27,41,25,"f"],[48,28,41,26],[48,29,41,27,"id"],[48,31,41,29],[49,8,42,6,"username"],[49,16,42,14],[49,18,42,16,"f"],[49,19,42,17],[49,20,42,18,"friend_username"],[49,35,42,33],[49,39,42,37,"f"],[49,40,42,38],[49,41,42,39,"username"],[49,49,42,47],[50,8,43,6,"lastOnline"],[50,18,43,16],[50,20,43,18,"f"],[50,21,43,19],[50,22,43,20,"last_collected"],[50,36,43,34],[50,39,43,37],[50,54,43,52],[50,57,43,55],[50,68,43,66],[51,8,44,6,"status"],[51,14,44,12],[51,16,44,14],[51,25,44,32],[52,8,45,6,"affinity"],[52,16,45,14],[52,18,45,16,"f"],[52,19,45,17],[52,20,45,18,"can_collect"],[52,31,45,29],[52,34,45,32],[52,36,45,34],[52,39,45,37,"undefined"],[53,6,46,4],[53,7,46,5],[53,8,46,6],[53,9,46,7],[54,4,47,2],[54,5,47,3],[54,6,47,4],[54,12,47,10],[55,6,48,4],[55,13,48,11],[55,15,48,13],[56,4,49,2],[57,2,50,0],[59,2,52,0],[60,0,53,0],[61,0,54,0],[62,2,55,7],[62,17,55,22,"getFriendRequests"],[62,34,55,39,"getFriendRequests"],[62,35,55,40,"username"],[62,43,55,56],[62,45,59,4],[63,4,60,2],[63,8,60,6],[64,6,61,4],[64,12,61,10,"res"],[64,15,61,13],[64,18,61,16],[64,24,61,22,"fetch"],[64,29,61,27],[64,30,61,28],[64,33,61,31,"API_BASE"],[64,41,61,39],[64,66,61,64,"username"],[64,74,61,72],[64,76,61,74],[64,77,61,75],[65,6,62,4],[65,10,62,8],[65,11,62,9,"res"],[65,14,62,12],[65,15,62,13,"ok"],[65,17,62,15],[65,19,62,17],[65,25,62,23],[65,29,62,27,"Error"],[65,34,62,32],[65,35,62,33],[65,68,62,66],[65,69,62,67],[66,6,63,4],[66,12,63,10,"data"],[66,16,63,14],[66,19,63,17],[66,25,63,23,"res"],[66,28,63,26],[66,29,63,27,"json"],[66,33,63,31],[66,34,63,32],[66,35,63,33],[67,6,64,4],[68,6,65,4],[68,13,65,11,"data"],[68,17,65,15],[68,18,65,16,"map"],[68,21,65,19],[68,22,65,21,"r"],[68,23,65,27],[68,28,65,33],[69,8,66,6,"id"],[69,10,66,8],[69,12,66,10,"r"],[69,13,66,11],[69,14,66,12,"id"],[69,16,66,14],[70,8,67,6,"fromUsername"],[70,20,67,18],[70,22,67,20,"r"],[70,23,67,21],[70,24,67,22,"from_username"],[70,37,67,35],[71,8,68,6,"timestamp"],[71,17,68,15],[71,19,68,17],[72,6,69,4],[72,7,69,5],[72,8,69,6],[72,9,69,7],[73,4,70,2],[73,5,70,3],[73,6,70,4],[73,12,70,10],[74,6,71,4],[74,13,71,11],[74,15,71,13],[75,4,72,2],[76,2,73,0],[78,2,75,0],[79,0,76,0],[80,0,77,0],[81,2,78,7],[81,17,78,22,"acceptFriendRequest"],[81,36,78,41,"acceptFriendRequest"],[81,37,78,42,"username"],[81,45,78,58],[81,47,78,60,"requestId"],[81,56,78,77],[81,58,78,94],[82,4,79,2],[82,10,79,8,"res"],[82,13,79,11],[82,16,79,14],[82,22,79,20,"fetch"],[82,27,79,25],[82,28,79,26],[82,31,79,29,"API_BASE"],[82,39,79,37],[82,64,79,62,"username"],[82,72,79,70],[82,76,79,74,"requestId"],[82,85,79,83],[82,94,79,92],[82,96,79,94],[83,6,80,4,"method"],[83,12,80,10],[83,14,80,12],[84,4,81,2],[84,5,81,3],[84,6,81,4],[85,4,82,2],[85,8,82,6],[85,9,82,7,"res"],[85,12,82,10],[85,13,82,11,"ok"],[85,15,82,13],[85,17,82,15],[85,23,82,21],[85,27,82,25,"Error"],[85,32,82,30],[85,33,82,31],[85,59,82,57],[85,60,82,58],[86,2,83,0],[88,2,85,0],[89,0,86,0],[90,0,87,0],[91,2,88,7],[91,17,88,22,"declineFriendRequest"],[91,37,88,42,"declineFriendRequest"],[91,38,88,43,"username"],[91,46,88,59],[91,48,88,61,"requestId"],[91,57,88,78],[91,59,88,95],[92,4,89,2],[92,10,89,8,"res"],[92,13,89,11],[92,16,89,14],[92,22,89,20,"fetch"],[92,27,89,25],[92,28,89,26],[92,31,89,29,"API_BASE"],[92,39,89,37],[92,64,89,62,"username"],[92,72,89,70],[92,76,89,74,"requestId"],[92,85,89,83],[92,95,89,93],[92,97,89,95],[93,6,90,4,"method"],[93,12,90,10],[93,14,90,12],[94,4,91,2],[94,5,91,3],[94,6,91,4],[95,4,92,2],[95,8,92,6],[95,9,92,7,"res"],[95,12,92,10],[95,13,92,11,"ok"],[95,15,92,13],[95,17,92,15],[95,23,92,21],[95,27,92,25,"Error"],[95,32,92,30],[95,33,92,31],[95,60,92,58],[95,61,92,59],[96,2,93,0],[98,2,95,0],[99,0,96,0],[100,0,97,0],[101,2,98,7],[101,17,98,22,"searchPlayers"],[101,30,98,35,"searchPlayers"],[101,31,98,36,"query"],[101,36,98,49],[101,38,98,51,"username"],[101,46,98,68],[101,48,104,4],[102,4,105,2],[102,8,105,6],[102,9,105,7,"query"],[102,14,105,12],[102,18,105,16,"query"],[102,23,105,21],[102,24,105,22,"length"],[102,30,105,28],[102,33,105,31],[102,34,105,32],[102,36,105,34],[102,43,105,41],[102,45,105,43],[103,4,107,2],[103,8,107,6],[104,6,108,4],[104,12,108,10,"params"],[104,18,108,16],[104,21,108,19],[104,25,108,23,"URLSearchParams"],[104,40,108,38],[104,41,108,39],[105,8,108,41,"q"],[105,9,108,42],[105,11,108,44,"query"],[106,6,108,50],[106,7,108,51],[106,8,108,52],[107,6,109,4],[107,10,109,8,"username"],[107,18,109,16],[107,20,109,18,"params"],[107,26,109,24],[107,27,109,25,"append"],[107,33,109,31],[107,34,109,32],[107,44,109,42],[107,46,109,44,"username"],[107,54,109,52],[107,55,109,53],[108,6,111,4],[108,12,111,10,"res"],[108,15,111,13],[108,18,111,16],[108,24,111,22,"fetch"],[108,29,111,27],[108,30,111,28],[108,33,111,31,"API_BASE"],[108,41,111,39],[108,64,111,62,"params"],[108,70,111,68],[108,72,111,70],[108,73,111,71],[109,6,112,4],[109,10,112,8],[109,11,112,9,"res"],[109,14,112,12],[109,15,112,13,"ok"],[109,17,112,15],[109,19,112,17],[109,25,112,23],[109,29,112,27,"Error"],[109,34,112,32],[109,35,112,33],[109,61,112,59],[109,62,112,60],[110,6,113,4],[110,13,113,11],[110,19,113,17,"res"],[110,22,113,20],[110,23,113,21,"json"],[110,27,113,25],[110,28,113,26],[110,29,113,27],[111,4,114,2],[111,5,114,3],[111,6,114,4],[111,12,114,10],[112,6,115,4],[112,13,115,11],[112,15,115,13],[113,4,116,2],[114,2,117,0],[116,2,119,0],[117,0,120,0],[118,0,121,0],[119,2,122,7],[119,17,122,22,"sendFriendRequest"],[119,34,122,39,"sendFriendRequest"],[119,35,122,40,"fromUsername"],[119,47,122,60],[119,49,122,62,"toUsername"],[119,59,122,80],[119,61,122,97],[120,4,123,2],[120,10,123,8,"res"],[120,13,123,11],[120,16,123,14],[120,22,123,20,"fetch"],[120,27,123,25],[120,28,123,26],[120,31,123,29,"API_BASE"],[120,39,123,37],[120,67,123,65],[120,69,123,67],[121,6,124,4,"method"],[121,12,124,10],[121,14,124,12],[121,20,124,18],[122,6,125,4,"headers"],[122,13,125,11],[122,15,125,13],[123,8,125,15],[123,22,125,29],[123,24,125,31],[124,6,125,50],[124,7,125,51],[125,6,126,4,"body"],[125,10,126,8],[125,12,126,10,"JSON"],[125,16,126,14],[125,17,126,15,"stringify"],[125,26,126,24],[125,27,126,25],[126,8,126,27,"from"],[126,12,126,31],[126,14,126,33,"fromUsername"],[126,26,126,45],[127,8,126,47,"to"],[127,10,126,49],[127,12,126,51,"toUsername"],[128,6,126,62],[128,7,126,63],[129,4,127,2],[129,5,127,3],[129,6,127,4],[130,4,128,2],[130,8,128,6],[130,9,128,7,"res"],[130,12,128,10],[130,13,128,11,"ok"],[130,15,128,13],[130,17,128,15],[130,23,128,21],[130,27,128,25,"Error"],[130,32,128,30],[130,33,128,31],[130,57,128,55],[130,58,128,56],[131,2,129,0],[132,0,129,1],[132,3]],"functionMap":{"names":["<global>","getFriendsSummary","getFriendsList","data.map$argument_0","getFriendRequests","acceptFriendRequest","declineFriendRequest","searchPlayers","sendFriendRequest"],"mappings":"AAA;OCW;CDW;OEK;oBCY;MDM;CFI;OIK;oBDU;MCI;CJI;OKK;CLK;OMK;CNK;OOK;CPmB;OQK;CRO"},"hasCjsExports":false},"type":"js/module"}]}