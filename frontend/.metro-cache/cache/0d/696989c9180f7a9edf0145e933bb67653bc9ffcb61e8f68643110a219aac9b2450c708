{"dependencies":[{"name":"../../types.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":14,"index":78},"end":{"line":3,"column":39,"index":103}}],"key":"z4PO8xkmHjanYOD9YhfRmr3fppA=","exportNames":["*"],"imports":1}},{"name":"./onHidden.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":17,"index":122},"end":{"line":4,"column":41,"index":146}}],"key":"0DoheTy9BL2UF62etRq0wlcv3i8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  const types = require(_dependencyMap[0], \"../../types.js\");\n  const onHidden = require(_dependencyMap[1], \"./onHidden.js\");\n\n  /*\n   * Copyright 2020 Google LLC\n   *\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   *     https://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  let firstHiddenTime = -1;\n  const initHiddenTime = () => {\n    // If the document is hidden and not prerendering, assume it was always\n    // hidden and the page was loaded in the background.\n    return types.WINDOW.document.visibilityState === 'hidden' && !types.WINDOW.document.prerendering ? 0 : Infinity;\n  };\n  const trackChanges = () => {\n    // Update the time if/when the document becomes hidden.\n    onHidden.onHidden(({\n      timeStamp\n    }) => {\n      firstHiddenTime = timeStamp;\n    }, true);\n  };\n  const getVisibilityWatcher = () => {\n    if (firstHiddenTime < 0) {\n      // If the document is hidden when this code runs, assume it was hidden\n      // since navigation start. This isn't a perfect heuristic, but it's the\n      // best we can do until an API is available to support querying past\n      // visibilityState.\n      firstHiddenTime = initHiddenTime();\n      trackChanges();\n    }\n    return {\n      get firstHiddenTime() {\n        return firstHiddenTime;\n      }\n    };\n  };\n  exports.getVisibilityWatcher = getVisibilityWatcher;\n});","lineCount":54,"map":[[2,2,1,0,"Object"],[2,8,1,6],[2,9,1,7,"defineProperty"],[2,23,1,21],[2,24,1,22,"exports"],[2,31,1,29],[2,33,1,31],[2,45,1,43],[2,47,1,45],[3,4,1,47,"value"],[3,9,1,52],[3,11,1,54],[4,2,1,59],[4,3,1,60],[4,4,1,61],[5,2,3,0],[5,8,3,6,"types"],[5,13,3,11],[5,16,3,14,"require"],[5,23,3,21],[5,24,3,21,"_dependencyMap"],[5,38,3,21],[5,59,3,38],[5,60,3,39],[6,2,4,0],[6,8,4,6,"onHidden"],[6,16,4,14],[6,19,4,17,"require"],[6,26,4,24],[6,27,4,24,"_dependencyMap"],[6,41,4,24],[6,61,4,40],[6,62,4,41],[8,2,6,0],[9,0,7,0],[10,0,8,0],[11,0,9,0],[12,0,10,0],[13,0,11,0],[14,0,12,0],[15,0,13,0],[16,0,14,0],[17,0,15,0],[18,0,16,0],[19,0,17,0],[20,0,18,0],[21,0,19,0],[22,0,20,0],[24,2,22,0],[24,6,22,4,"firstHiddenTime"],[24,21,22,19],[24,24,22,22],[24,25,22,23],[24,26,22,24],[25,2,24,0],[25,8,24,6,"initHiddenTime"],[25,22,24,20],[25,25,24,23,"initHiddenTime"],[25,26,24,23],[25,31,24,29],[26,4,25,2],[27,4,26,2],[28,4,27,2],[28,11,27,9,"types"],[28,16,27,14],[28,17,27,15,"WINDOW"],[28,23,27,21],[28,24,27,22,"document"],[28,32,27,30],[28,33,27,31,"visibilityState"],[28,48,27,46],[28,53,27,51],[28,61,27,59],[28,65,27,63],[28,66,27,64,"types"],[28,71,27,69],[28,72,27,70,"WINDOW"],[28,78,27,76],[28,79,27,77,"document"],[28,87,27,85],[28,88,27,86,"prerendering"],[28,100,27,98],[28,103,27,101],[28,104,27,102],[28,107,27,105,"Infinity"],[28,115,27,113],[29,2,28,0],[29,3,28,1],[30,2,30,0],[30,8,30,6,"trackChanges"],[30,20,30,18],[30,23,30,21,"trackChanges"],[30,24,30,21],[30,29,30,27],[31,4,31,2],[32,4,32,2,"onHidden"],[32,12,32,10],[32,13,32,11,"onHidden"],[32,21,32,19],[32,22,32,20],[32,23,32,21],[33,6,32,23,"timeStamp"],[34,4,32,33],[34,5,32,34],[34,10,32,39],[35,6,33,4,"firstHiddenTime"],[35,21,33,19],[35,24,33,22,"timeStamp"],[35,33,33,31],[36,4,34,2],[36,5,34,3],[36,7,34,5],[36,11,34,9],[36,12,34,10],[37,2,35,0],[37,3,35,1],[38,2,37,0],[38,8,37,6,"getVisibilityWatcher"],[38,28,37,26],[38,31,37,29,"getVisibilityWatcher"],[38,32,37,29],[38,37,39,5],[39,4,40,2],[39,8,40,6,"firstHiddenTime"],[39,23,40,21],[39,26,40,24],[39,27,40,25],[39,29,40,27],[40,6,41,4],[41,6,42,4],[42,6,43,4],[43,6,44,4],[44,6,45,4,"firstHiddenTime"],[44,21,45,19],[44,24,45,22,"initHiddenTime"],[44,38,45,36],[44,39,45,37],[44,40,45,38],[45,6,46,4,"trackChanges"],[45,18,46,16],[45,19,46,17],[45,20,46,18],[46,4,47,2],[47,4,48,2],[47,11,48,9],[48,6,49,4],[48,10,49,8,"firstHiddenTime"],[48,25,49,23,"firstHiddenTime"],[48,26,49,23],[48,28,49,26],[49,8,50,6],[49,15,50,13,"firstHiddenTime"],[49,30,50,28],[50,6,51,4],[51,4,52,2],[51,5,52,3],[52,2,53,0],[52,3,53,1],[53,2,55,0,"exports"],[53,9,55,7],[53,10,55,8,"getVisibilityWatcher"],[53,30,55,28],[53,33,55,31,"getVisibilityWatcher"],[53,53,55,51],[54,0,55,52],[54,3]],"functionMap":{"names":["<global>","initHiddenTime","trackChanges","onHidden.onHidden$argument_0","getVisibilityWatcher","get__firstHiddenTime"],"mappings":"AAA;uBCuB;CDI;qBEE;oBCE;GDE;CFC;6BIE;ICY;KDE;CJE"},"hasCjsExports":true},"type":"js/module"}]}