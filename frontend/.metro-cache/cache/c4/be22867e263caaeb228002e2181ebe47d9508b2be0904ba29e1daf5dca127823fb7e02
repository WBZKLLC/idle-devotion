{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":149},"end":{"line":5,"column":26,"index":175}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"api\", {\n    enumerable: true,\n    get: function () {\n      return api;\n    }\n  });\n  exports.requireUsername = requireUsername;\n  exports.fetchUserHeroes = fetchUserHeroes;\n  exports.promoteHeroStar = promoteHeroStar;\n  exports.getHeroProgression = getHeroProgression;\n  exports.fetchUser = fetchUser;\n  exports.performSummon = performSummon;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _axios = require(_dependencyMap[1], \"axios\");\n  var axios = _interopDefault(_axios);\n  // /app/frontend/lib/api.ts\n  // SINGLE SOURCE OF TRUTH for all backend API calls\n  // Screens should import from here to prevent endpoint string drift\n\n  const API_BASE = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL ? `${_expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL}/api` : '/api';\n  const api = axios.default.create({\n    baseURL: API_BASE,\n    timeout: 20000\n  });\n  function requireUsername(username) {\n    if (!username) throw new Error('Missing username');\n    return username;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // USER HEROES\n  // ─────────────────────────────────────────────────────────────\n\n  async function fetchUserHeroes(username) {\n    const u = requireUsername(username);\n    const res = await api.get(`/user/${encodeURIComponent(u)}/heroes`);\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // STAR PROMOTION (canonical endpoint)\n  // POST /api/hero/{user_hero_id}/promote-star?username=...\n  // ─────────────────────────────────────────────────────────────\n\n  async function promoteHeroStar(userHeroId, username) {\n    const u = requireUsername(username);\n    const res = await api.post(`/hero/${encodeURIComponent(userHeroId)}/promote-star`, null, {\n      params: {\n        username: u\n      }\n    });\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // HERO PROGRESSION (read model for hero-progression screen)\n  // GET /api/hero/{username}/hero/{heroId}/progression\n  // NOTE: Falls back gracefully if endpoint doesn't exist\n  // ─────────────────────────────────────────────────────────────\n\n  async function getHeroProgression(username, heroId) {\n    const u = requireUsername(username);\n    const res = await api.get(`/hero/${encodeURIComponent(u)}/hero/${encodeURIComponent(heroId)}/progression`);\n    return res.data;\n  }\n\n  // RULE: All hero endpoints live here.\n  // Screens should not build URLs manually (prevents drift).\n\n  // ─────────────────────────────────────────────────────────────\n  // USER AUTH / PROFILE\n  // ─────────────────────────────────────────────────────────────\n\n  async function fetchUser(username) {\n    const u = requireUsername(username);\n    const res = await api.get(`/user/${encodeURIComponent(u)}`);\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // GACHA / SUMMON\n  // ─────────────────────────────────────────────────────────────\n\n  async function performSummon(username, summonType) {\n    const u = requireUsername(username);\n    const res = await api.post(`/gacha/summon`, null, {\n      params: {\n        username: u,\n        summon_type: summonType\n      }\n    });\n    return res.data;\n  }\n\n  // Add more hero endpoints here ONLY.\n  // Screens should import from lib/api.ts so route strings never drift again.\n});","lineCount":108,"map":[[12,2,11,0,"Object"],[12,8,11,0],[12,9,11,0,"defineProperty"],[12,23,11,0],[12,24,11,0,"exports"],[12,31,11,0],[13,4,11,0,"enumerable"],[13,14,11,0],[14,4,11,0,"get"],[14,7,11,0],[14,18,11,0,"get"],[14,19,11,0],[15,6,11,0],[15,13,11,0,"api"],[15,16,11,0],[16,4,11,0],[17,2,11,0],[18,2,16,0,"exports"],[18,9,16,0],[18,10,16,0,"requireUsername"],[18,25,16,0],[18,28,16,0,"requireUsername"],[18,43,16,0],[19,2,25,0,"exports"],[19,9,25,0],[19,10,25,0,"fetchUserHeroes"],[19,25,25,0],[19,28,25,0,"fetchUserHeroes"],[19,43,25,0],[20,2,36,0,"exports"],[20,9,36,0],[20,10,36,0,"promoteHeroStar"],[20,25,36,0],[20,28,36,0,"promoteHeroStar"],[20,43,36,0],[21,2,57,0,"exports"],[21,9,57,0],[21,10,57,0,"getHeroProgression"],[21,28,57,0],[21,31,57,0,"getHeroProgression"],[21,49,57,0],[22,2,70,0,"exports"],[22,9,70,0],[22,10,70,0,"fetchUser"],[22,19,70,0],[22,22,70,0,"fetchUser"],[22,31,70,0],[23,2,80,0,"exports"],[23,9,80,0],[23,10,80,0,"performSummon"],[23,23,80,0],[23,26,80,0,"performSummon"],[23,39,80,0],[24,2,86,1],[24,6,86,1,"_expoVirtualEnv"],[24,21,86,1],[24,24,86,1,"require"],[24,31,86,1],[24,32,86,1,"_dependencyMap"],[24,46,86,1],[25,2,5,0],[25,6,5,0,"_axios"],[25,12,5,0],[25,15,5,0,"require"],[25,22,5,0],[25,23,5,0,"_dependencyMap"],[25,37,5,0],[26,2,5,0],[26,6,5,0,"axios"],[26,11,5,0],[26,14,5,0,"_interopDefault"],[26,29,5,0],[26,30,5,0,"_axios"],[26,36,5,0],[27,2,1,0],[28,2,2,0],[29,2,3,0],[31,2,7,0],[31,8,7,6,"API_BASE"],[31,16,7,14],[31,19,7,17,"_expoVirtualEnv"],[31,34,7,17],[31,35,7,17,"env"],[31,38,7,17],[31,39,7,17,"EXPO_PUBLIC_BACKEND_URL"],[31,62,7,17],[31,65,8,4],[31,68,8,4,"_expoVirtualEnv"],[31,83,8,4],[31,84,8,4,"env"],[31,87,8,4],[31,88,8,4,"EXPO_PUBLIC_BACKEND_URL"],[31,111,8,4],[31,117,8,48],[31,120,9,4],[31,126,9,10],[32,2,11,7],[32,8,11,13,"api"],[32,11,11,16],[32,14,11,19,"axios"],[32,19,11,24],[32,20,11,24,"default"],[32,27,11,24],[32,28,11,25,"create"],[32,34,11,31],[32,35,11,32],[33,4,12,2,"baseURL"],[33,11,12,9],[33,13,12,11,"API_BASE"],[33,21,12,19],[34,4,13,2,"timeout"],[34,11,13,9],[34,13,13,11],[35,2,14,0],[35,3,14,1],[35,4,14,2],[36,2,16,7],[36,11,16,16,"requireUsername"],[36,26,16,31,"requireUsername"],[36,27,16,32,"username"],[36,35,16,49],[36,37,16,51],[37,4,17,2],[37,8,17,6],[37,9,17,7,"username"],[37,17,17,15],[37,19,17,17],[37,25,17,23],[37,29,17,27,"Error"],[37,34,17,32],[37,35,17,33],[37,53,17,51],[37,54,17,52],[38,4,18,2],[38,11,18,9,"username"],[38,19,18,17],[39,2,19,0],[41,2,21,0],[42,2,22,0],[43,2,23,0],[45,2,25,7],[45,17,25,22,"fetchUserHeroes"],[45,32,25,37,"fetchUserHeroes"],[45,33,25,38,"username"],[45,41,25,54],[45,43,25,56],[46,4,26,2],[46,10,26,8,"u"],[46,11,26,9],[46,14,26,12,"requireUsername"],[46,29,26,27],[46,30,26,28,"username"],[46,38,26,36],[46,39,26,37],[47,4,27,2],[47,10,27,8,"res"],[47,13,27,11],[47,16,27,14],[47,22,27,20,"api"],[47,25,27,23],[47,26,27,24,"get"],[47,29,27,27],[47,30,27,28],[47,39,27,37,"encodeURIComponent"],[47,57,27,55],[47,58,27,56,"u"],[47,59,27,57],[47,60,27,58],[47,69,27,67],[47,70,27,68],[48,4,28,2],[48,11,28,9,"res"],[48,14,28,12],[48,15,28,13,"data"],[48,19,28,17],[49,2,29,0],[51,2,31,0],[52,2,32,0],[53,2,33,0],[54,2,34,0],[56,2,36,7],[56,17,36,22,"promoteHeroStar"],[56,32,36,37,"promoteHeroStar"],[56,33,36,38,"userHeroId"],[56,43,36,56],[56,45,36,58,"username"],[56,53,36,74],[56,55,36,76],[57,4,37,2],[57,10,37,8,"u"],[57,11,37,9],[57,14,37,12,"requireUsername"],[57,29,37,27],[57,30,37,28,"username"],[57,38,37,36],[57,39,37,37],[58,4,38,2],[58,10,38,8,"res"],[58,13,38,11],[58,16,38,14],[58,22,38,20,"api"],[58,25,38,23],[58,26,38,24,"post"],[58,30,38,28],[58,31,39,4],[58,40,39,13,"encodeURIComponent"],[58,58,39,31],[58,59,39,32,"userHeroId"],[58,69,39,42],[58,70,39,43],[58,85,39,58],[58,87,40,4],[58,91,40,8],[58,93,41,4],[59,6,41,6,"params"],[59,12,41,12],[59,14,41,14],[60,8,41,16,"username"],[60,16,41,24],[60,18,41,26,"u"],[61,6,41,28],[62,4,41,30],[62,5,42,2],[62,6,42,3],[63,4,43,2],[63,11,43,9,"res"],[63,14,43,12],[63,15,43,13,"data"],[63,19,43,17],[64,2,49,0],[66,2,51,0],[67,2,52,0],[68,2,53,0],[69,2,54,0],[70,2,55,0],[72,2,57,7],[72,17,57,22,"getHeroProgression"],[72,35,57,40,"getHeroProgression"],[72,36,57,41,"username"],[72,44,57,57],[72,46,57,59,"heroId"],[72,52,57,73],[72,54,57,75],[73,4,58,2],[73,10,58,8,"u"],[73,11,58,9],[73,14,58,12,"requireUsername"],[73,29,58,27],[73,30,58,28,"username"],[73,38,58,36],[73,39,58,37],[74,4,59,2],[74,10,59,8,"res"],[74,13,59,11],[74,16,59,14],[74,22,59,20,"api"],[74,25,59,23],[74,26,59,24,"get"],[74,29,59,27],[74,30,59,28],[74,39,59,37,"encodeURIComponent"],[74,57,59,55],[74,58,59,56,"u"],[74,59,59,57],[74,60,59,58],[74,69,59,67,"encodeURIComponent"],[74,87,59,85],[74,88,59,86,"heroId"],[74,94,59,92],[74,95,59,93],[74,109,59,107],[74,110,59,108],[75,4,60,2],[75,11,60,9,"res"],[75,14,60,12],[75,15,60,13,"data"],[75,19,60,17],[76,2,61,0],[78,2,63,0],[79,2,64,0],[81,2,66,0],[82,2,67,0],[83,2,68,0],[85,2,70,7],[85,17,70,22,"fetchUser"],[85,26,70,31,"fetchUser"],[85,27,70,32,"username"],[85,35,70,48],[85,37,70,50],[86,4,71,2],[86,10,71,8,"u"],[86,11,71,9],[86,14,71,12,"requireUsername"],[86,29,71,27],[86,30,71,28,"username"],[86,38,71,36],[86,39,71,37],[87,4,72,2],[87,10,72,8,"res"],[87,13,72,11],[87,16,72,14],[87,22,72,20,"api"],[87,25,72,23],[87,26,72,24,"get"],[87,29,72,27],[87,30,72,28],[87,39,72,37,"encodeURIComponent"],[87,57,72,55],[87,58,72,56,"u"],[87,59,72,57],[87,60,72,58],[87,62,72,60],[87,63,72,61],[88,4,73,2],[88,11,73,9,"res"],[88,14,73,12],[88,15,73,13,"data"],[88,19,73,17],[89,2,74,0],[91,2,76,0],[92,2,77,0],[93,2,78,0],[95,2,80,7],[95,17,80,22,"performSummon"],[95,30,80,35,"performSummon"],[95,31,80,36,"username"],[95,39,80,52],[95,41,80,54,"summonType"],[95,51,80,84],[95,53,80,86],[96,4,81,2],[96,10,81,8,"u"],[96,11,81,9],[96,14,81,12,"requireUsername"],[96,29,81,27],[96,30,81,28,"username"],[96,38,81,36],[96,39,81,37],[97,4,82,2],[97,10,82,8,"res"],[97,13,82,11],[97,16,82,14],[97,22,82,20,"api"],[97,25,82,23],[97,26,82,24,"post"],[97,30,82,28],[97,31,82,29],[97,46,82,44],[97,48,82,46],[97,52,82,50],[97,54,82,52],[98,6,83,4,"params"],[98,12,83,10],[98,14,83,12],[99,8,83,14,"username"],[99,16,83,22],[99,18,83,24,"u"],[99,19,83,25],[100,8,83,27,"summon_type"],[100,19,83,38],[100,21,83,40,"summonType"],[101,6,83,51],[102,4,84,2],[102,5,84,3],[102,6,84,4],[103,4,85,2],[103,11,85,9,"res"],[103,14,85,12],[103,15,85,13,"data"],[103,19,85,17],[104,2,86,0],[106,2,88,0],[107,2,89,0],[108,0,89,0],[108,3]],"functionMap":{"names":["<global>","requireUsername","fetchUserHeroes","promoteHeroStar","getHeroProgression","fetchUser","performSummon"],"mappings":"AAA;OCe;CDG;OEM;CFI;OGO;CHa;OIQ;CJI;OKS;CLI;OMM;CNM"},"hasCjsExports":false},"type":"js/module"}]}