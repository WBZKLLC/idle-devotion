{"dependencies":[{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":39,"index":39}}],"key":"m+kcirlwHAgMIuUoyR2vCxbhWD4=","exportNames":["*"],"imports":1}},{"name":"./hubextensions.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":40},"end":{"line":2,"column":64,"index":104}}],"key":"bwhNLetZnG9aoSV4K3NzIc7v2vc=","exportNames":["*"],"imports":1}},{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":105},"end":{"line":3,"column":221,"index":326}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"BrowserProfilingIntegration\", {\n    enumerable: true,\n    get: function () {\n      return BrowserProfilingIntegration;\n    }\n  });\n  var _sentryUtils = require(_dependencyMap[0], \"@sentry/utils\");\n  var _hubextensionsJs = require(_dependencyMap[1], \"./hubextensions.js\");\n  var _utilsJs = require(_dependencyMap[2], \"./utils.js\");\n  /**\n   * Browser profiling integration. Stores any event that has contexts[\"profile\"][\"profile_id\"]\n   * This exists because we do not want to await async profiler.stop calls as transaction.finish is called\n   * in a synchronous context. Instead, we handle sending the profile async from the promise callback and\n   * rely on being able to pull the event from the cache when we need to construct the envelope. This makes the\n   * integration less reliable as we might be dropping profiles when the cache is full.\n   *\n   * @experimental\n   */\n  class BrowserProfilingIntegration {\n    static __initStatic() {\n      this.id = 'BrowserProfilingIntegration';\n    }\n    constructor() {\n      this.name = BrowserProfilingIntegration.id;\n    }\n\n    /**\n     * @inheritDoc\n     */\n    setupOnce(_addGlobalEventProcessor, getCurrentHub) {\n      this.getCurrentHub = getCurrentHub;\n      const hub = this.getCurrentHub();\n      const client = hub.getClient();\n      const scope = hub.getScope();\n      const transaction = scope.getTransaction();\n      if (transaction && (0, _utilsJs.isAutomatedPageLoadTransaction)(transaction)) {\n        if ((0, _utilsJs.shouldProfileTransaction)(transaction)) {\n          (0, _hubextensionsJs.startProfileForTransaction)(transaction);\n        }\n      }\n      if (client && typeof client.on === 'function') {\n        client.on('startTransaction', transaction => {\n          if ((0, _utilsJs.shouldProfileTransaction)(transaction)) {\n            (0, _hubextensionsJs.startProfileForTransaction)(transaction);\n          }\n        });\n        client.on('beforeEnvelope', envelope => {\n          // if not profiles are in queue, there is nothing to add to the envelope.\n          if (!(0, _utilsJs.getActiveProfilesCount)()) {\n            return;\n          }\n          const profiledTransactionEvents = (0, _utilsJs.findProfiledTransactionsFromEnvelope)(envelope);\n          if (!profiledTransactionEvents.length) {\n            return;\n          }\n          const profilesToAddToEnvelope = [];\n          for (const profiledTransaction of profiledTransactionEvents) {\n            const context = profiledTransaction && profiledTransaction.contexts;\n            const profile_id = context && context['profile'] && context['profile']['profile_id'];\n            const start_timestamp = context && context['profile'] && context['profile']['start_timestamp'];\n            if (typeof profile_id !== 'string') {\n              (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && _sentryUtils.logger.log('[Profiling] cannot find profile for a transaction without a profile context');\n              continue;\n            }\n            if (!profile_id) {\n              (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && _sentryUtils.logger.log('[Profiling] cannot find profile for a transaction without a profile context');\n              continue;\n            }\n\n            // Remove the profile from the transaction context before sending, relay will take care of the rest.\n            if (context && context['profile']) {\n              delete context.profile;\n            }\n            const profile = (0, _utilsJs.takeProfileFromGlobalCache)(profile_id);\n            if (!profile) {\n              (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && _sentryUtils.logger.log(`[Profiling] Could not retrieve profile for transaction: ${profile_id}`);\n              continue;\n            }\n            const profileEvent = (0, _utilsJs.createProfilingEvent)(profile_id, start_timestamp, profile, profiledTransaction);\n            if (profileEvent) {\n              profilesToAddToEnvelope.push(profileEvent);\n            }\n          }\n          (0, _utilsJs.addProfilesToEnvelope)(envelope, profilesToAddToEnvelope);\n        });\n      } else {\n        _sentryUtils.logger.warn('[Profiling] Client does not support hooks, profiling will be disabled');\n      }\n    }\n  }\n  BrowserProfilingIntegration.__initStatic();\n});","lineCount":98,"map":[[7,2,106,0,"Object"],[7,8,106,0],[7,9,106,0,"defineProperty"],[7,23,106,0],[7,24,106,0,"exports"],[7,31,106,0],[8,4,106,0,"enumerable"],[8,14,106,0],[9,4,106,0,"get"],[9,7,106,0],[9,18,106,0,"get"],[9,19,106,0],[10,6,106,0],[10,13,106,9,"BrowserProfilingIntegration"],[10,40,106,36],[11,4,106,36],[12,2,106,36],[13,2,1,0],[13,6,1,0,"_sentryUtils"],[13,18,1,0],[13,21,1,0,"require"],[13,28,1,0],[13,29,1,0,"_dependencyMap"],[13,43,1,0],[14,2,2,0],[14,6,2,0,"_hubextensionsJs"],[14,22,2,0],[14,25,2,0,"require"],[14,32,2,0],[14,33,2,0,"_dependencyMap"],[14,47,2,0],[15,2,3,0],[15,6,3,0,"_utilsJs"],[15,14,3,0],[15,17,3,0,"require"],[15,24,3,0],[15,25,3,0,"_dependencyMap"],[15,39,3,0],[16,2,5,0],[17,0,6,0],[18,0,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[23,0,12,0],[24,0,13,0],[25,2,14,0],[25,8,14,6,"BrowserProfilingIntegration"],[25,35,14,33],[25,36,14,35],[26,4,15,3],[26,11,15,10,"__initStatic"],[26,23,15,22,"__initStatic"],[26,24,15,22],[26,26,15,25],[27,6,15,26],[27,10,15,30],[27,11,15,31,"id"],[27,13,15,33],[27,16,15,36],[27,45,15,65],[28,4,15,66],[29,4,17,3,"constructor"],[29,15,17,14,"constructor"],[29,16,17,14],[29,18,17,17],[30,6,18,4],[30,10,18,8],[30,11,18,9,"name"],[30,15,18,13],[30,18,18,16,"BrowserProfilingIntegration"],[30,45,18,43],[30,46,18,44,"id"],[30,48,18,46],[31,4,19,2],[33,4,21,2],[34,0,22,0],[35,0,23,0],[36,4,24,3,"setupOnce"],[36,13,24,12,"setupOnce"],[36,14,24,13,"_addGlobalEventProcessor"],[36,38,24,37],[36,40,24,39,"getCurrentHub"],[36,53,24,52],[36,55,24,54],[37,6,25,4],[37,10,25,8],[37,11,25,9,"getCurrentHub"],[37,24,25,22],[37,27,25,25,"getCurrentHub"],[37,40,25,38],[38,6,27,4],[38,12,27,10,"hub"],[38,15,27,13],[38,18,27,16],[38,22,27,20],[38,23,27,21,"getCurrentHub"],[38,36,27,34],[38,37,27,35],[38,38,27,36],[39,6,28,4],[39,12,28,10,"client"],[39,18,28,16],[39,21,28,19,"hub"],[39,24,28,22],[39,25,28,23,"getClient"],[39,34,28,32],[39,35,28,33],[39,36,28,34],[40,6,29,4],[40,12,29,10,"scope"],[40,17,29,15],[40,20,29,18,"hub"],[40,23,29,21],[40,24,29,22,"getScope"],[40,32,29,30],[40,33,29,31],[40,34,29,32],[41,6,31,4],[41,12,31,10,"transaction"],[41,23,31,21],[41,26,31,24,"scope"],[41,31,31,29],[41,32,31,30,"getTransaction"],[41,46,31,44],[41,47,31,45],[41,48,31,46],[42,6,33,4],[42,10,33,8,"transaction"],[42,21,33,19],[42,25,33,23],[42,29,33,23,"isAutomatedPageLoadTransaction"],[42,37,33,53],[42,38,33,53,"isAutomatedPageLoadTransaction"],[42,68,33,53],[42,70,33,54,"transaction"],[42,81,33,65],[42,82,33,66],[42,84,33,68],[43,8,34,6],[43,12,34,10],[43,16,34,10,"shouldProfileTransaction"],[43,24,34,34],[43,25,34,34,"shouldProfileTransaction"],[43,49,34,34],[43,51,34,35,"transaction"],[43,62,34,46],[43,63,34,47],[43,65,34,49],[44,10,35,8],[44,14,35,8,"startProfileForTransaction"],[44,30,35,34],[44,31,35,34,"startProfileForTransaction"],[44,57,35,34],[44,59,35,35,"transaction"],[44,70,35,46],[44,71,35,47],[45,8,36,6],[46,6,37,4],[47,6,39,4],[47,10,39,8,"client"],[47,16,39,14],[47,20,39,18],[47,27,39,25,"client"],[47,33,39,31],[47,34,39,32,"on"],[47,36,39,34],[47,41,39,39],[47,51,39,49],[47,53,39,51],[48,8,40,6,"client"],[48,14,40,12],[48,15,40,13,"on"],[48,17,40,15],[48,18,40,16],[48,36,40,34],[48,38,40,37,"transaction"],[48,49,40,48],[48,53,40,53],[49,10,41,8],[49,14,41,12],[49,18,41,12,"shouldProfileTransaction"],[49,26,41,36],[49,27,41,36,"shouldProfileTransaction"],[49,51,41,36],[49,53,41,37,"transaction"],[49,64,41,48],[49,65,41,49],[49,67,41,51],[50,12,42,10],[50,16,42,10,"startProfileForTransaction"],[50,32,42,36],[50,33,42,36,"startProfileForTransaction"],[50,59,42,36],[50,61,42,37,"transaction"],[50,72,42,48],[50,73,42,49],[51,10,43,8],[52,8,44,6],[52,9,44,7],[52,10,44,8],[53,8,46,6,"client"],[53,14,46,12],[53,15,46,13,"on"],[53,17,46,15],[53,18,46,16],[53,34,46,32],[53,36,46,35,"envelope"],[53,44,46,43],[53,48,46,48],[54,10,47,8],[55,10,48,8],[55,14,48,12],[55,15,48,13],[55,19,48,13,"getActiveProfilesCount"],[55,27,48,35],[55,28,48,35,"getActiveProfilesCount"],[55,50,48,35],[55,52,48,36],[55,53,48,37],[55,55,48,39],[56,12,49,10],[57,10,50,8],[58,10,52,8],[58,16,52,14,"profiledTransactionEvents"],[58,41,52,39],[58,44,52,42],[58,48,52,42,"findProfiledTransactionsFromEnvelope"],[58,56,52,78],[58,57,52,78,"findProfiledTransactionsFromEnvelope"],[58,93,52,78],[58,95,52,79,"envelope"],[58,103,52,87],[58,104,52,88],[59,10,53,8],[59,14,53,12],[59,15,53,13,"profiledTransactionEvents"],[59,40,53,38],[59,41,53,39,"length"],[59,47,53,45],[59,49,53,47],[60,12,54,10],[61,10,55,8],[62,10,57,8],[62,16,57,14,"profilesToAddToEnvelope"],[62,39,57,37],[62,42,57,40],[62,44,57,42],[63,10,59,8],[63,15,59,13],[63,21,59,19,"profiledTransaction"],[63,40,59,38],[63,44,59,42,"profiledTransactionEvents"],[63,69,59,67],[63,71,59,69],[64,12,60,10],[64,18,60,16,"context"],[64,25,60,23],[64,28,60,26,"profiledTransaction"],[64,47,60,45],[64,51,60,49,"profiledTransaction"],[64,70,60,68],[64,71,60,69,"contexts"],[64,79,60,77],[65,12,61,10],[65,18,61,16,"profile_id"],[65,28,61,26],[65,31,61,29,"context"],[65,38,61,36],[65,42,61,40,"context"],[65,49,61,47],[65,50,61,48],[65,59,61,57],[65,60,61,58],[65,64,61,62,"context"],[65,71,61,69],[65,72,61,70],[65,81,61,79],[65,82,61,80],[65,83,61,81],[65,95,61,93],[65,96,61,94],[66,12,62,10],[66,18,62,16,"start_timestamp"],[66,33,62,31],[66,36,62,34,"context"],[66,43,62,41],[66,47,62,45,"context"],[66,54,62,52],[66,55,62,53],[66,64,62,62],[66,65,62,63],[66,69,62,67,"context"],[66,76,62,74],[66,77,62,75],[66,86,62,84],[66,87,62,85],[66,88,62,86],[66,105,62,103],[66,106,62,104],[67,12,64,10],[67,16,64,14],[67,23,64,21,"profile_id"],[67,33,64,31],[67,38,64,36],[67,46,64,44],[67,48,64,46],[68,14,65,12],[68,15,65,13],[68,22,65,20,"__SENTRY_DEBUG__"],[68,38,65,36],[68,43,65,41],[68,54,65,52],[68,58,65,56,"__SENTRY_DEBUG__"],[68,74,65,72],[68,79,66,14,"logger"],[68,91,66,20],[68,92,66,20,"logger"],[68,98,66,20],[68,99,66,21,"log"],[68,102,66,24],[68,103,66,25],[68,180,66,102],[68,181,66,103],[69,14,67,12],[70,12,68,10],[71,12,70,10],[71,16,70,14],[71,17,70,15,"profile_id"],[71,27,70,25],[71,29,70,27],[72,14,71,12],[72,15,71,13],[72,22,71,20,"__SENTRY_DEBUG__"],[72,38,71,36],[72,43,71,41],[72,54,71,52],[72,58,71,56,"__SENTRY_DEBUG__"],[72,74,71,72],[72,79,72,14,"logger"],[72,91,72,20],[72,92,72,20,"logger"],[72,98,72,20],[72,99,72,21,"log"],[72,102,72,24],[72,103,72,25],[72,180,72,102],[72,181,72,103],[73,14,73,12],[74,12,74,10],[76,12,76,10],[77,12,77,10],[77,16,77,14,"context"],[77,23,77,21],[77,27,77,25,"context"],[77,34,77,32],[77,35,77,33],[77,44,77,42],[77,45,77,43],[77,47,77,45],[78,14,78,12],[78,21,78,19,"context"],[78,28,78,26],[78,29,78,27,"profile"],[78,36,78,34],[79,12,79,10],[80,12,81,10],[80,18,81,16,"profile"],[80,25,81,23],[80,28,81,26],[80,32,81,26,"takeProfileFromGlobalCache"],[80,40,81,52],[80,41,81,52,"takeProfileFromGlobalCache"],[80,67,81,52],[80,69,81,53,"profile_id"],[80,79,81,63],[80,80,81,64],[81,12,82,10],[81,16,82,14],[81,17,82,15,"profile"],[81,24,82,22],[81,26,82,24],[82,14,83,12],[82,15,83,13],[82,22,83,20,"__SENTRY_DEBUG__"],[82,38,83,36],[82,43,83,41],[82,54,83,52],[82,58,83,56,"__SENTRY_DEBUG__"],[82,74,83,72],[82,79,83,77,"logger"],[82,91,83,83],[82,92,83,83,"logger"],[82,98,83,83],[82,99,83,84,"log"],[82,102,83,87],[82,103,83,88],[82,162,83,147,"profile_id"],[82,172,83,157],[82,174,83,159],[82,175,83,160],[83,14,84,12],[84,12,85,10],[85,12,87,10],[85,18,87,16,"profileEvent"],[85,30,87,28],[85,33,87,31],[85,37,87,31,"createProfilingEvent"],[85,45,87,51],[85,46,87,51,"createProfilingEvent"],[85,66,87,51],[85,68,88,12,"profile_id"],[85,78,88,22],[85,80,89,12,"start_timestamp"],[85,95,89,27],[85,97,90,12,"profile"],[85,104,90,19],[85,106,91,12,"profiledTransaction"],[85,125,92,10],[85,126,92,11],[86,12,93,10],[86,16,93,14,"profileEvent"],[86,28,93,26],[86,30,93,28],[87,14,94,12,"profilesToAddToEnvelope"],[87,37,94,35],[87,38,94,36,"push"],[87,42,94,40],[87,43,94,41,"profileEvent"],[87,55,94,53],[87,56,94,54],[88,12,95,10],[89,10,96,8],[90,10,98,8],[90,14,98,8,"addProfilesToEnvelope"],[90,22,98,29],[90,23,98,29,"addProfilesToEnvelope"],[90,44,98,29],[90,46,98,30,"envelope"],[90,54,98,38],[90,56,98,40,"profilesToAddToEnvelope"],[90,79,98,63],[90,80,98,64],[91,8,99,6],[91,9,99,7],[91,10,99,8],[92,6,100,4],[92,7,100,5],[92,13,100,11],[93,8,101,6,"logger"],[93,20,101,12],[93,21,101,12,"logger"],[93,27,101,12],[93,28,101,13,"warn"],[93,32,101,17],[93,33,101,18],[93,104,101,89],[93,105,101,90],[94,6,102,4],[95,4,103,2],[96,2,104,0],[97,2,104,2,"BrowserProfilingIntegration"],[97,29,104,29],[97,30,104,30,"__initStatic"],[97,42,104,42],[97,43,104,43],[97,44,104,44],[98,0,104,45],[98,3]],"functionMap":{"names":["<global>","BrowserProfilingIntegration","BrowserProfilingIntegration.__initStatic","BrowserProfilingIntegration#constructor","BrowserProfilingIntegration#setupOnce","client.on$argument_1"],"mappings":"AAA;ACa;GCC,gED;GEE;GFE;GGK;oCCgB;ODI;kCCE;ODqD;GHI;CDC"},"hasCjsExports":false},"type":"js/module"}]}