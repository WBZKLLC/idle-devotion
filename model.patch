diff --git a/frontend/app/_layout.tsx b/frontend/app/_layout.tsx
index c6339fe..68364d6 100644
--- a/frontend/app/_layout.tsx
+++ b/frontend/app/_layout.tsx
@@ -122,20 +122,15 @@ export default function Layout() {
 
 const styles = StyleSheet.create({
   tabBar: {
-    backgroundColor: '#FFFFFF',
-    borderTopColor: '#FF1493',
-    borderTopWidth: 2,
-    paddingTop: 8,
-    paddingBottom: 8,
+    backgroundColor: COLORS.navy.darkest,
+    borderTopColor: COLORS.gold.primary + '30',
+    borderTopWidth: 1,
     height: 60,
-    shadowColor: '#FF1493',
-    shadowOffset: { width: 0, height: -3 },
-    shadowOpacity: 0.3,
-    shadowRadius: 5,
-    elevation: 10,
+    paddingBottom: 6,
+    paddingTop: 6,
   },
   tabLabel: {
-    fontSize: 12,
-    fontWeight: '700',
+    fontSize: 10,
+    fontWeight: '600',
   },
 });
diff --git a/model.patch b/model.patch
index 5d54e2e..e69de29 100644
--- a/model.patch
+++ b/model.patch
@@ -1,3562 +0,0 @@
-diff --git a/frontend/app/index.tsx b/frontend/app/index.tsx
-index 1570c24..8348bd6 100644
---- a/frontend/app/index.tsx
-+++ b/frontend/app/index.tsx
-@@ -870,4 +870,24 @@ const styles = StyleSheet.create({
-     fontWeight: 'bold',
-     color: '#FFF',
-   },
-+  quickLinksContainer: {
-+    flexDirection: 'row',
-+    gap: 10,
-+    marginBottom: 16,
-+  },
-+  quickLinkButton: {
-+    flex: 1,
-+    borderRadius: 12,
-+    overflow: 'hidden',
-+  },
-+  quickLinkGradient: {
-+    paddingVertical: 12,
-+    alignItems: 'center',
-+    gap: 4,
-+  },
-+  quickLinkText: {
-+    color: '#FFF',
-+    fontSize: 12,
-+    fontWeight: 'bold',
-+  },
- });
-diff --git a/model.patch b/model.patch
-index e93ea35..e69de29 100644
---- a/model.patch
-+++ b/model.patch
-@@ -1,3528 +0,0 @@
--diff --git a/comprehensive_backend_test.py b/comprehensive_backend_test.py
--new file mode 100644
--index 0000000..8781f55
----- /dev/null
--+++ b/comprehensive_backend_test.py
--@@ -0,0 +1,469 @@
--+#!/usr/bin/env python3
--+"""
--+Comprehensive Divine Heroes Backend API Testing Suite
--+Tests all endpoints mentioned in the review request
--+"""
--+
--+import requests
--+import json
--+import time
--+import random
--+import string
--+from datetime import datetime
--+
--+# Backend URL from frontend/.env
--+BACKEND_URL = "https://angels-and-demons.preview.emergentagent.com/api"
--+
--+class ComprehensiveGachaGameTester:
--+    def __init__(self):
--+        self.test_username = f"TestHero_{random.randint(1000, 9999)}"
--+        self.session = requests.Session()
--+        self.test_results = []
--+        self.user_data = None
--+        self.user_heroes = []
--+        
--+    def log_test(self, test_name, success, message="", response_data=None):
--+        """Log test results"""
--+        result = {
--+            "test": test_name,
--+            "success": success,
--+            "message": message,
--+            "timestamp": datetime.now().isoformat(),
--+            "response_data": response_data
--+        }
--+        self.test_results.append(result)
--+        status = "âœ… PASS" if success else "âŒ FAIL"
--+        print(f"{status}: {test_name}")
--+        if message:
--+            print(f"   {message}")
--+        
--+    def make_request(self, method, endpoint, **kwargs):
--+        """Make HTTP request with error handling"""
--+        url = f"{BACKEND_URL}{endpoint}"
--+        try:
--+            response = requests.request(method, url, timeout=30, **kwargs)
--+            return response
--+        except requests.exceptions.RequestException as e:
--+            print(f"âŒ Request failed: {e}")
--+            return None
--+    
--+    def test_user_registration_and_authentication(self):
--+        """Test user registration & authentication endpoints"""
--+        print("\nðŸ”§ Testing User Registration & Authentication...")
--+        
--+        # 1. Register new user
--+        response = self.make_request("POST", f"/user/register", params={"username": self.test_username})
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            self.user_data = data
--+            if data.get("username") == self.test_username and data.get("crystals") == 300:
--+                self.log_test("User Registration", True, f"User {self.test_username} registered with 300 crystals")
--+            else:
--+                self.log_test("User Registration", False, "Invalid registration response")
--+                return False
--+        else:
--+            self.log_test("User Registration", False, f"Registration failed: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 2. Get user profile
--+        response = self.make_request("GET", f"/user/{self.test_username}")
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            required_fields = ["username", "crystals", "coins", "gold", "pity_counter"]
--+            missing_fields = [field for field in required_fields if field not in data]
--+            
--+            if not missing_fields:
--+                self.log_test("Get User Profile", True, f"Profile retrieved with all required fields")
--+            else:
--+                self.log_test("Get User Profile", False, f"Missing fields: {missing_fields}")
--+                return False
--+        else:
--+            self.log_test("Get User Profile", False, f"Failed to get profile: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 3. Daily login
--+        response = self.make_request("POST", f"/user/{self.test_username}/login")
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "coins" in data and "gold" in data and data.get("coins", 0) > 0:
--+                self.log_test("Daily Login", True, f"Login rewards: {data.get('coins')} coins, {data.get('gold')} gold")
--+            else:
--+                self.log_test("Daily Login", False, "Invalid login reward response")
--+                return False
--+        else:
--+            self.log_test("Daily Login", False, f"Login failed: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        return True
--+    
--+    def test_gacha_system(self):
--+        """Test gacha system endpoints"""
--+        print("\nðŸ”§ Testing Gacha System...")
--+        
--+        # 1. Get all available heroes
--+        response = self.make_request("GET", "/heroes")
--+        
--+        if response and response.status_code == 200:
--+            heroes = response.json()
--+            if isinstance(heroes, list) and len(heroes) > 0:
--+                self.log_test("Get Heroes", True, f"Retrieved {len(heroes)} heroes from pool")
--+            else:
--+                self.log_test("Get Heroes", False, "No heroes returned")
--+                return False
--+        else:
--+            self.log_test("Get Heroes", False, f"Failed to get heroes: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 2. Single pull with crystals
--+        pull_data = {"pull_type": "single", "currency_type": "crystals"}
--+        response = self.make_request("POST", f"/gacha/pull", params={"username": self.test_username}, json=pull_data)
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "heroes" in data and len(data["heroes"]) == 1 and "new_pity_counter" in data:
--+                self.log_test("Single Pull (Crystals)", True, f"Pulled 1 hero, pity: {data.get('new_pity_counter')}")
--+            else:
--+                self.log_test("Single Pull (Crystals)", False, "Invalid pull response")
--+                return False
--+        else:
--+            self.log_test("Single Pull (Crystals)", False, f"Pull failed: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 3. Single pull with coins
--+        pull_data = {"pull_type": "single", "currency_type": "coins"}
--+        response = self.make_request("POST", f"/gacha/pull", params={"username": self.test_username}, json=pull_data)
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "heroes" in data and len(data["heroes"]) == 1:
--+                self.log_test("Single Pull (Coins)", True, f"Pulled 1 hero with coins")
--+            else:
--+                self.log_test("Single Pull (Coins)", False, "Invalid coin pull response")
--+                return False
--+        else:
--+            self.log_test("Single Pull (Coins)", False, f"Coin pull failed: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 4. Multi pull with coins (should work since user has 10000+ coins)
--+        pull_data = {"pull_type": "multi", "currency_type": "coins"}
--+        response = self.make_request("POST", f"/gacha/pull", params={"username": self.test_username}, json=pull_data)
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "heroes" in data and len(data["heroes"]) == 10:
--+                self.log_test("Multi Pull (Coins)", True, f"Pulled 10 heroes with coins")
--+            else:
--+                self.log_test("Multi Pull (Coins)", False, f"Expected 10 heroes, got {len(data.get('heroes', []))}")
--+                return False
--+        else:
--+            self.log_test("Multi Pull (Coins)", False, f"Multi coin pull failed: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        return True
--+    
--+    def test_hero_management(self):
--+        """Test hero management endpoints"""
--+        print("\nðŸ”§ Testing Hero Management...")
--+        
--+        # 1. Get user's heroes
--+        response = self.make_request("GET", f"/user/{self.test_username}/heroes")
--+        
--+        if response and response.status_code == 200:
--+            heroes = response.json()
--+            self.user_heroes = heroes
--+            if isinstance(heroes, list) and len(heroes) > 0:
--+                self.log_test("Get User Heroes", True, f"Retrieved {len(heroes)} user heroes")
--+            else:
--+                self.log_test("Get User Heroes", False, "No user heroes found")
--+                return False
--+        else:
--+            self.log_test("Get User Heroes", False, f"Failed to get user heroes: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 2. Try to upgrade hero (will likely fail due to insufficient duplicates, which is expected)
--+        if self.user_heroes:
--+            hero_id = self.user_heroes[0]["id"]
--+            response = self.make_request("POST", f"/user/{self.test_username}/heroes/{hero_id}/upgrade")
--+            
--+            if response and response.status_code == 200:
--+                data = response.json()
--+                self.log_test("Hero Upgrade", True, f"Hero upgraded to rank {data.get('rank')}")
--+            elif response and response.status_code == 400:
--+                self.log_test("Hero Upgrade", True, "Upgrade correctly rejected (insufficient duplicates)")
--+            else:
--+                self.log_test("Hero Upgrade", False, f"Unexpected upgrade response: {response.status_code if response else 'No response'}")
--+                return False
--+        
--+        return True
--+    
--+    def test_vip_system(self):
--+        """Test VIP system endpoints"""
--+        print("\nðŸ”§ Testing VIP System...")
--+        
--+        # 1. Get VIP info
--+        response = self.make_request("GET", f"/vip/info/{self.test_username}")
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            required_fields = ["current_vip_level", "total_spent", "current_idle_hours"]
--+            missing_fields = [field for field in required_fields if field not in data]
--+            
--+            if not missing_fields:
--+                self.log_test("VIP Info", True, f"VIP Level: {data.get('current_vip_level')}, Idle Hours: {data.get('current_idle_hours')}")
--+            else:
--+                self.log_test("VIP Info", False, f"Missing VIP fields: {missing_fields}")
--+                return False
--+        else:
--+            self.log_test("VIP Info", False, f"Failed to get VIP info: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 2. Get VIP comparison
--+        response = self.make_request("GET", f"/vip/comparison/{self.test_username}")
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "current_vip" in data and "tiers" in data:
--+                self.log_test("VIP Comparison", True, "VIP comparison data retrieved")
--+            else:
--+                self.log_test("VIP Comparison", False, "Invalid VIP comparison response")
--+                return False
--+        else:
--+            self.log_test("VIP Comparison", False, f"Failed to get VIP comparison: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        return True
--+    
--+    def test_store_system(self):
--+        """Test store system endpoints"""
--+        print("\nðŸ”§ Testing Store System...")
--+        
--+        # 1. Get crystal packages
--+        response = self.make_request("GET", "/store/crystal-packages")
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "packages" in data and len(data["packages"]) > 0:
--+                self.log_test("Crystal Packages", True, f"Retrieved {len(data['packages'])} crystal packages")
--+            else:
--+                self.log_test("Crystal Packages", False, "No crystal packages found")
--+                return False
--+        else:
--+            self.log_test("Crystal Packages", False, f"Failed to get packages: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 2. Purchase crystals (simulated)
--+        response = self.make_request("POST", "/store/purchase-crystals", params={"username": self.test_username, "package_id": "starter"})
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "crystals_received" in data:
--+                self.log_test("Purchase Crystals", True, f"Purchased {data.get('crystals_received')} crystals")
--+            else:
--+                self.log_test("Purchase Crystals", False, "Invalid purchase response")
--+                return False
--+        else:
--+            self.log_test("Purchase Crystals", False, f"Purchase failed: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        return True
--+    
--+    def test_idle_system(self):
--+        """Test idle system endpoints"""
--+        print("\nðŸ”§ Testing Idle System...")
--+        
--+        # 1. Get idle status
--+        response = self.make_request("GET", f"/idle/status/{self.test_username}")
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "is_collecting" in data and "gold_pending" in data:
--+                self.log_test("Idle Status", True, f"Idle collecting: {data.get('is_collecting')}, Pending: {data.get('gold_pending')} gold")
--+            else:
--+                self.log_test("Idle Status", False, "Invalid idle status response")
--+                return False
--+        else:
--+            self.log_test("Idle Status", False, f"Failed to get idle status: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 2. Claim idle rewards
--+        response = self.make_request("POST", "/idle/claim", params={"username": self.test_username})
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "gold_earned" in data:
--+                self.log_test("Idle Claim", True, f"Claimed {data.get('gold_earned')} gold")
--+            else:
--+                self.log_test("Idle Claim", False, "Invalid idle claim response")
--+                return False
--+        else:
--+            self.log_test("Idle Claim", False, f"Failed to claim idle rewards: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        return True
--+    
--+    def test_leaderboards(self):
--+        """Test leaderboard endpoints"""
--+        print("\nðŸ”§ Testing Leaderboards...")
--+        
--+        leaderboard_types = ["cr", "arena", "abyss"]
--+        
--+        for lb_type in leaderboard_types:
--+            response = self.make_request("GET", f"/leaderboard/{lb_type}", params={"limit": 10})
--+            
--+            if response and response.status_code == 200:
--+                data = response.json()
--+                if isinstance(data, list):
--+                    self.log_test(f"Leaderboard {lb_type.upper()}", True, f"Retrieved {len(data)} entries")
--+                else:
--+                    self.log_test(f"Leaderboard {lb_type.upper()}", False, "Invalid leaderboard response format")
--+                    return False
--+            else:
--+                self.log_test(f"Leaderboard {lb_type.upper()}", False, f"Failed to get leaderboard: {response.status_code if response else 'No response'}")
--+                return False
--+        
--+        return True
--+    
--+    def test_abyss_mode(self):
--+        """Test abyss mode endpoints"""
--+        print("\nðŸ”§ Testing Abyss Mode...")
--+        
--+        # 1. Get abyss progress
--+        response = self.make_request("GET", f"/abyss/progress/{self.test_username}")
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "current_level" in data:
--+                self.log_test("Abyss Progress", True, f"Current abyss level: {data.get('current_level')}")
--+            else:
--+                self.log_test("Abyss Progress", False, "Invalid abyss progress response")
--+                return False
--+        else:
--+            self.log_test("Abyss Progress", False, f"Failed to get abyss progress: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 2. Battle abyss level
--+        battle_data = {"team_ids": []}
--+        response = self.make_request("POST", f"/abyss/battle/{self.test_username}/1", json=battle_data)
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            self.log_test("Abyss Battle", True, "Abyss battle completed")
--+        else:
--+            self.log_test("Abyss Battle", False, f"Abyss battle failed: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        return True
--+    
--+    def test_arena_system(self):
--+        """Test arena system endpoints"""
--+        print("\nðŸ”§ Testing Arena System...")
--+        
--+        # 1. Get arena record
--+        response = self.make_request("GET", f"/arena/record/{self.test_username}")
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "rating" in data:
--+                self.log_test("Arena Record", True, f"Arena rating: {data.get('rating')}")
--+            else:
--+                self.log_test("Arena Record", False, "Invalid arena record response")
--+                return False
--+        else:
--+            self.log_test("Arena Record", False, f"Failed to get arena record: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        # 2. Arena battle
--+        battle_data = {"team_id": "default"}
--+        response = self.make_request("POST", f"/arena/battle/{self.test_username}", json=battle_data)
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            self.log_test("Arena Battle", True, "Arena battle completed")
--+        else:
--+            self.log_test("Arena Battle", False, f"Arena battle failed: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        return True
--+    
--+    def test_character_rating(self):
--+        """Test character rating endpoint"""
--+        print("\nðŸ”§ Testing Character Rating...")
--+        
--+        response = self.make_request("GET", f"/user/{self.test_username}/cr")
--+        
--+        if response and response.status_code == 200:
--+            data = response.json()
--+            if "cr" in data and "hero_count" in data:
--+                self.log_test("Character Rating", True, f"CR: {data.get('cr')}, Heroes: {data.get('hero_count')}")
--+            else:
--+                self.log_test("Character Rating", False, "Invalid CR response")
--+                return False
--+        else:
--+            self.log_test("Character Rating", False, f"Failed to get CR: {response.status_code if response else 'No response'}")
--+            return False
--+        
--+        return True
--+    
--+    def run_all_tests(self):
--+        """Run all comprehensive backend tests"""
--+        print(f"ðŸš€ Starting Comprehensive Divine Heroes Backend API Tests")
--+        print(f"Backend URL: {BACKEND_URL}")
--+        print(f"Test User: {self.test_username}")
--+        print("=" * 80)
--+        
--+        # Test sequence based on review request
--+        test_functions = [
--+            self.test_user_registration_and_authentication,
--+            self.test_gacha_system,
--+            self.test_hero_management,
--+            self.test_vip_system,
--+            self.test_store_system,
--+            self.test_idle_system,
--+            self.test_leaderboards,
--+            self.test_abyss_mode,
--+            self.test_arena_system,
--+            self.test_character_rating
--+        ]
--+        
--+        for test_func in test_functions:
--+            try:
--+                test_func()
--+                time.sleep(0.5)  # Small delay between test groups
--+            except Exception as e:
--+                self.log_test(test_func.__name__, False, f"Exception: {str(e)}")
--+        
--+        # Summary
--+        print("\n" + "=" * 80)
--+        print("ðŸ“Š COMPREHENSIVE TEST SUMMARY")
--+        print("=" * 80)
--+        
--+        passed = sum(1 for result in self.test_results if result["success"])
--+        total = len(self.test_results)
--+        
--+        print(f"Total Tests: {total}")
--+        print(f"Passed: {passed}")
--+        print(f"Failed: {total - passed}")
--+        print(f"Success Rate: {(passed/total)*100:.1f}%")
--+        
--+        # Show failed tests
--+        failed_tests = [result for result in self.test_results if not result["success"]]
--+        if failed_tests:
--+            print("\nâŒ FAILED TESTS:")
--+            for test in failed_tests:
--+                print(f"  - {test['test']}: {test['message']}")
--+        else:
--+            print("\nðŸŽ‰ ALL TESTS PASSED!")
--+        
--+        return passed == total
--+
--+if __name__ == "__main__":
--+    tester = ComprehensiveGachaGameTester()
--+    success = tester.run_all_tests()
--+    
--+    if success:
--+        print("\nðŸŽ‰ All comprehensive tests passed!")
--+    else:
--+        print("\nâš ï¸  Some tests failed - check logs above")
--\ No newline at end of file
--diff --git a/model.patch b/model.patch
--index 22a785d..1e09674 100644
----- a/model.patch
--+++ b/model.patch
--@@ -1,2891 +0,0 @@
---diff --git a/backend/server.py b/backend/server.py
---index af62c09..95001d5 100644
------ a/backend/server.py
---+++ b/backend/server.py
---@@ -87,7 +87,7 @@ class UserHero(BaseModel):
--- class User(BaseModel):
---     id: str = Field(default_factory=lambda: str(uuid.uuid4()))
---     username: str
----    server_id: str  # Server assignment
---+    server_id: str = "server_1"  # Server assignment with default
---     crystals: int = 300  # Premium currency (renamed from gems)
---     coins: int = 10000  # Regular currency
---     gold: int = 5000  # Idle resource
---@@ -103,6 +103,7 @@ class User(BaseModel):
---     vip_level: int = 0  # 0-15
---     total_spent: float = 0.0  # Total USD spent
---     avatar_frame: str = "default"  # Avatar frame (default, gold, diamond, rainbow, legendary, divine)
---+    first_purchase_used: bool = False  # Track if first purchase bonus claimed
---     # Idle Collection System
---     idle_collection_started_at: Optional[datetime] = None
---     idle_collection_last_claimed: Optional[datetime] = None
---@@ -115,6 +116,52 @@ class User(BaseModel):
---     chat_unlocked: bool = False
---     created_at: datetime = Field(default_factory=datetime.utcnow)
--- 
---+# Crystal Store Packages
---+CRYSTAL_PACKAGES = {
---+    "starter": {
---+        "id": "starter",
---+        "price_usd": 0.99,
---+        "crystals": 100,
---+        "display_name": "Starter Pack",
---+        "bonus": 0
---+    },
---+    "small": {
---+        "id": "small",
---+        "price_usd": 4.99,
---+        "crystals": 500,
---+        "display_name": "Small Pack",
---+        "bonus": 0
---+    },
---+    "medium": {
---+        "id": "medium",
---+        "price_usd": 9.99,
---+        "crystals": 1000,
---+        "display_name": "Medium Pack",
---+        "bonus": 0
---+    },
---+    "large": {
---+        "id": "large",
---+        "price_usd": 19.99,
---+        "crystals": 2000,
---+        "display_name": "Large Pack",
---+        "bonus": 0
---+    },
---+    "premium": {
---+        "id": "premium",
---+        "price_usd": 49.99,
---+        "crystals": 3440,
---+        "display_name": "Premium Pack",
---+        "bonus": 440  # 3000 base + 440 bonus
---+    },
---+    "ultimate": {
---+        "id": "ultimate",
---+        "price_usd": 99.99,
---+        "crystals": 6880,
---+        "display_name": "Ultimate Pack",
---+        "bonus": 880  # 6000 base + 880 bonus
---+    }
---+}
---+
--- class MarqueeNotification(BaseModel):
---     id: str = Field(default_factory=lambda: str(uuid.uuid4()))
---     server_id: str
---@@ -1037,6 +1084,73 @@ async def get_vip_info(username: str):
---         "all_tiers": VIP_TIERS
---     }
--- 
---+@api_router.get("/vip/comparison/{username}")
---+async def get_vip_comparison(username: str):
---+    """Get VIP tier comparison for store display"""
---+    user = await db.users.find_one({"username": username})
---+    if not user:
---+        raise HTTPException(status_code=404, detail="User not found")
---+    
---+    total_spent = user.get("total_spent", 0)
---+    current_vip = calculate_vip_level(total_spent)
---+    
---+    # Build comparison data
---+    comparison = {
---+        "current_vip": current_vip,
---+        "total_spent": total_spent,
---+        "tiers": {}
---+    }
---+    
---+    # Previous tier (if exists)
---+    if current_vip > 0:
---+        prev_vip = current_vip - 1
---+        comparison["tiers"]["previous"] = {
---+            "level": prev_vip,
---+            "spend_required": VIP_TIERS[prev_vip]["spend"],
---+            "idle_hours": VIP_TIERS[prev_vip]["idle_hours"],
---+            "idle_rate": get_idle_gold_rate(prev_vip),
---+            "avatar_frame": get_avatar_frame(prev_vip),
---+            "status": "completed"
---+        }
---+    
---+    # Current tier
---+    comparison["tiers"]["current"] = {
---+        "level": current_vip,
---+        "spend_required": VIP_TIERS[current_vip]["spend"],
---+        "idle_hours": VIP_TIERS[current_vip]["idle_hours"],
---+        "idle_rate": get_idle_gold_rate(current_vip),
---+        "avatar_frame": get_avatar_frame(current_vip),
---+        "status": "active"
---+    }
---+    
---+    # Next tier (if exists)
---+    if current_vip < 15:
---+        next_vip = current_vip + 1
---+        comparison["tiers"]["next"] = {
---+            "level": next_vip,
---+            "spend_required": VIP_TIERS[next_vip]["spend"],
---+            "idle_hours": VIP_TIERS[next_vip]["idle_hours"],
---+            "idle_rate": get_idle_gold_rate(next_vip),
---+            "avatar_frame": get_avatar_frame(next_vip),
---+            "status": "locked",
---+            "spend_needed": VIP_TIERS[next_vip]["spend"] - total_spent
---+        }
---+    
---+    # Next 2 tiers (if exists)
---+    if current_vip < 14:
---+        next2_vip = current_vip + 2
---+        comparison["tiers"]["next2"] = {
---+            "level": next2_vip,
---+            "spend_required": VIP_TIERS[next2_vip]["spend"],
---+            "idle_hours": VIP_TIERS[next2_vip]["idle_hours"],
---+            "idle_rate": get_idle_gold_rate(next2_vip),
---+            "avatar_frame": get_avatar_frame(next2_vip),
---+            "status": "future",
---+            "spend_needed": VIP_TIERS[next2_vip]["spend"] - total_spent
---+        }
---+    
---+    return comparison
---+
--- @api_router.post("/vip/purchase")
--- async def vip_purchase(username: str, amount_usd: float):
---     """Simulate VIP purchase (in production, integrate with payment processor)"""
---@@ -1150,6 +1264,60 @@ async def purchase_vip_package(username: str, package_tier: str):
---         "remaining_crystals": update_dict["crystals"]
---     }
--- 
---+@api_router.get("/store/crystal-packages")
---+async def get_crystal_packages():
---+    """Get all available crystal packages"""
---+    return {"packages": CRYSTAL_PACKAGES}
---+
---+@api_router.post("/store/purchase-crystals")
---+async def purchase_crystals(username: str, package_id: str):
---+    """Purchase crystal package with real money (simulated)"""
---+    user = await db.users.find_one({"username": username})
---+    if not user:
---+        raise HTTPException(status_code=404, detail="User not found")
---+    
---+    if package_id not in CRYSTAL_PACKAGES:
---+        raise HTTPException(status_code=404, detail="Package not found")
---+    
---+    package = CRYSTAL_PACKAGES[package_id]
---+    crystals_to_award = package["crystals"]
---+    
---+    # Check if this is the user's first purchase
---+    is_first_purchase = not user.get("first_purchase_used", False)
---+    
---+    if is_first_purchase:
---+        # Double crystals for first purchase
---+        crystals_to_award *= 2
---+    
---+    # Update user
---+    update_dict = {
---+        "crystals": user.get("crystals", 0) + crystals_to_award,
---+        "total_spent": user.get("total_spent", 0.0) + package["price_usd"],
---+        "first_purchase_used": True
---+    }
---+    
---+    # Recalculate VIP level
---+    new_vip_level = calculate_vip_level(update_dict["total_spent"])
---+    update_dict["vip_level"] = new_vip_level
---+    update_dict["avatar_frame"] = get_avatar_frame(new_vip_level)
---+    
---+    await db.users.update_one(
---+        {"username": username},
---+        {"$set": update_dict}
---+    )
---+    
---+    return {
---+        "package_id": package_id,
---+        "package_name": package["display_name"],
---+        "price_usd": package["price_usd"],
---+        "crystals_received": crystals_to_award,
---+        "was_first_purchase": is_first_purchase,
---+        "bonus_applied": is_first_purchase,
---+        "new_crystal_total": update_dict["crystals"],
---+        "new_vip_level": new_vip_level,
---+        "new_total_spent": update_dict["total_spent"]
---+    }
---+
--- @api_router.get("/user/{username}/cr")
--- async def get_character_rating(username: str):
---     """Calculate and return user's Character Rating (CR)"""
---diff --git a/model.patch b/model.patch
---index 8a59977..96b0f81 100644
------ a/model.patch
---+++ b/model.patch
---@@ -1,2677 +0,0 @@
----diff --git a/backend/server.py b/backend/server.py
----index 82ddd69..af62c09 100644
------- a/backend/server.py
----+++ b/backend/server.py
----@@ -103,9 +103,12 @@ class User(BaseModel):
----     vip_level: int = 0  # 0-15
----     total_spent: float = 0.0  # Total USD spent
----     avatar_frame: str = "default"  # Avatar frame (default, gold, diamond, rainbow, legendary, divine)
-----    # Idle Collection
----+    # Idle Collection System
----     idle_collection_started_at: Optional[datetime] = None
----     idle_collection_last_claimed: Optional[datetime] = None
----+    # Active Button System (instant 120min collection)
----+    active_uses_today: int = 0
----+    active_last_reset: Optional[datetime] = None  # Last daily reset
----     # Chat unlock system
----     tutorial_completed: bool = False
----     chat_unlock_time: Optional[datetime] = None  # When chat becomes available
----diff --git a/model.patch b/model.patch
----index 5ad13d1..e69de29 100644
------- a/model.patch
----+++ b/model.patch
----@@ -1,2654 +0,0 @@
-----diff --git a/backend/server.py b/backend/server.py
-----index 490fbc9..82ddd69 100644
-------- a/backend/server.py
-----+++ b/backend/server.py
-----@@ -106,8 +106,21 @@ class User(BaseModel):
-----     # Idle Collection
-----     idle_collection_started_at: Optional[datetime] = None
-----     idle_collection_last_claimed: Optional[datetime] = None
-----+    # Chat unlock system
-----+    tutorial_completed: bool = False
-----+    chat_unlock_time: Optional[datetime] = None  # When chat becomes available
-----+    chat_unlocked: bool = False
-----     created_at: datetime = Field(default_factory=datetime.utcnow)
----- 
-----+class MarqueeNotification(BaseModel):
-----+    id: str = Field(default_factory=lambda: str(uuid.uuid4()))
-----+    server_id: str
-----+    username: str
-----+    hero_name: str
-----+    hero_rarity: str  # UR or UR+
-----+    timestamp: datetime = Field(default_factory=datetime.utcnow)
-----+    message: str  # e.g., "Player123 obtained UR+ Raphael the Eternal!"
-----+
----- class VIPPackage(BaseModel):
-----     id: str = Field(default_factory=lambda: str(uuid.uuid4()))
-----     vip_level: int
-----diff --git a/model.patch b/model.patch
-----index 7375c0b..e69de29 100644
-------- a/model.patch
-----+++ b/model.patch
-----@@ -1,2623 +0,0 @@
------diff --git a/backend/server.py b/backend/server.py
------index d4df3df..490fbc9 100644
--------- a/backend/server.py
------+++ b/backend/server.py
------@@ -87,6 +87,7 @@ class UserHero(BaseModel):
------ class User(BaseModel):
------     id: str = Field(default_factory=lambda: str(uuid.uuid4()))
------     username: str
------+    server_id: str  # Server assignment
------     crystals: int = 300  # Premium currency (renamed from gems)
------     coins: int = 10000  # Regular currency
------     gold: int = 5000  # Idle resource
------diff --git a/model.patch b/model.patch
------index cb16279..e69de29 100644
--------- a/model.patch
------+++ b/model.patch
------@@ -1,2606 +0,0 @@
-------diff --git a/backend/server.py b/backend/server.py
-------index d93cc99..9b6d2fa 100644
---------- a/backend/server.py
-------+++ b/backend/server.py
-------@@ -86,11 +86,12 @@ class UserHero(BaseModel):
------- class User(BaseModel):
-------     id: str = Field(default_factory=lambda: str(uuid.uuid4()))
-------     username: str
--------    gems: int = 300  # Premium currency
-------+    crystals: int = 300  # Premium currency (renamed from gems)
-------     coins: int = 10000  # Regular currency
-------     gold: int = 5000  # Idle resource
-------     friendship_points: int = 0  # Friend currency
-------     pity_counter: int = 0  # Counts towards guaranteed SSR at 50
-------+    pity_counter_premium: int = 0  # Separate pity for premium summons
-------     total_pulls: int = 0
-------     login_days: int = 0
-------     last_login: Optional[datetime] = None
-------@@ -109,7 +110,7 @@ class VIPPackage(BaseModel):
-------     id: str = Field(default_factory=lambda: str(uuid.uuid4()))
-------     vip_level: int
-------     package_tier: str  # "basic", "premium", "elite"
--------    gem_cost: int
-------+    crystal_cost: int
-------     rewards: Dict[str, int]  # {"coins": 1000, "gold": 500, etc}
-------     daily_limit: int = 3  # Can buy 3 times per day
------- 
-------@@ -123,19 +124,19 @@ class Team(BaseModel):
------- class GachaResult(BaseModel):
-------     heroes: List[UserHero]
-------     new_pity_counter: int
--------    gems_spent: int
-------+    crystals_spent: int
-------     coins_spent: int
------- 
------- class PullRequest(BaseModel):
-------     pull_type: str  # "single" or "multi"
--------    currency_type: str  # "gems" or "coins"
-------+    currency_type: str  # "crystals" or "coins"
------- 
------- class IdleRewards(BaseModel):
-------     gold_earned: int
-------     time_away: int  # seconds
------- 
------- class LoginReward(BaseModel):
--------    gems: int = 0
-------+    crystals: int = 0
-------     coins: int = 0
-------     gold: int = 0
-------     free_summons: int = 0
-------@@ -155,7 +156,7 @@ class Chapter(BaseModel):
-------     name: str
-------     required_power: int  # Minimum CR to have a chance
-------     enemy_power: int  # Enemy team power
--------    rewards: Dict[str, int]  # {"gems": 50, "coins": 1000, "gold": 500}
-------+    rewards: Dict[str, int]  # {"crystals": 50, "coins": 1000, "gold": 500}
-------     first_clear_bonus: Dict[str, int]  # Extra rewards on first clear
------- 
------- class UserProgress(BaseModel):
-------@@ -209,7 +210,7 @@ class PlayerCharacter(BaseModel):
-------     hp_buff: float = 0.0
-------     crit_buff: float = 0.0
-------     # Upgrade costs increase with level
--------    upgrade_cost_gems: int = 100
-------+    upgrade_cost_crystals: int = 100
-------     upgrade_time_hours: int = 24
------- 
------- class AbyssProgress(BaseModel):
-------@@ -285,91 +286,91 @@ def get_avatar_frame(vip_level: int) -> str:
-------     else:
-------         return "default"
------- 
--------# VIP Package configurations - can be purchased with gems
-------+# VIP Package configurations - can be purchased with crystals
------- VIP_PACKAGES = {
-------     # VIP 0-3: Early game packages
-------     0: {
--------        "basic": {"gem_cost": 200, "rewards": {"coins": 5000, "gold": 2500}},
--------        "premium": {"gem_cost": 500, "rewards": {"coins": 15000, "gold": 7500}},
--------        "elite": {"gem_cost": 1000, "rewards": {"coins": 35000, "gold": 17500, "gems": 100}}
-------+        "basic": {"crystal_cost": 200, "rewards": {"coins": 5000, "gold": 2500}},
-------+        "premium": {"crystal_cost": 500, "rewards": {"coins": 15000, "gold": 7500}},
-------+        "elite": {"crystal_cost": 1000, "rewards": {"coins": 35000, "gold": 17500, "crystals": 100}}
-------     },
-------     1: {
--------        "basic": {"gem_cost": 300, "rewards": {"coins": 8000, "gold": 4000}},
--------        "premium": {"gem_cost": 750, "rewards": {"coins": 25000, "gold": 12500}},
--------        "elite": {"gem_cost": 1500, "rewards": {"coins": 60000, "gold": 30000, "gems": 200}}
-------+        "basic": {"crystal_cost": 300, "rewards": {"coins": 8000, "gold": 4000}},
-------+        "premium": {"crystal_cost": 750, "rewards": {"coins": 25000, "gold": 12500}},
-------+        "elite": {"crystal_cost": 1500, "rewards": {"coins": 60000, "gold": 30000, "crystals": 200}}
-------     },
-------     2: {
--------        "basic": {"gem_cost": 400, "rewards": {"coins": 12000, "gold": 6000}},
--------        "premium": {"gem_cost": 1000, "rewards": {"coins": 40000, "gold": 20000}},
--------        "elite": {"gem_cost": 2000, "rewards": {"coins": 90000, "gold": 45000, "gems": 300}}
-------+        "basic": {"crystal_cost": 400, "rewards": {"coins": 12000, "gold": 6000}},
-------+        "premium": {"crystal_cost": 1000, "rewards": {"coins": 40000, "gold": 20000}},
-------+        "elite": {"crystal_cost": 2000, "rewards": {"coins": 90000, "gold": 45000, "crystals": 300}}
-------     },
-------     3: {
--------        "basic": {"gem_cost": 500, "rewards": {"coins": 18000, "gold": 9000}},
--------        "premium": {"gem_cost": 1250, "rewards": {"coins": 60000, "gold": 30000}},
--------        "elite": {"gem_cost": 2500, "rewards": {"coins": 135000, "gold": 67500, "gems": 400}}
-------+        "basic": {"crystal_cost": 500, "rewards": {"coins": 18000, "gold": 9000}},
-------+        "premium": {"crystal_cost": 1250, "rewards": {"coins": 60000, "gold": 30000}},
-------+        "elite": {"crystal_cost": 2500, "rewards": {"coins": 135000, "gold": 67500, "crystals": 400}}
-------     },
-------     # VIP 4-7: Mid game packages
-------     4: {
--------        "basic": {"gem_cost": 600, "rewards": {"coins": 25000, "gold": 12500}},
--------        "premium": {"gem_cost": 1500, "rewards": {"coins": 80000, "gold": 40000}},
--------        "elite": {"gem_cost": 3000, "rewards": {"coins": 180000, "gold": 90000, "gems": 500}}
-------+        "basic": {"crystal_cost": 600, "rewards": {"coins": 25000, "gold": 12500}},
-------+        "premium": {"crystal_cost": 1500, "rewards": {"coins": 80000, "gold": 40000}},
-------+        "elite": {"crystal_cost": 3000, "rewards": {"coins": 180000, "gold": 90000, "crystals": 500}}
-------     },
-------     5: {
--------        "basic": {"gem_cost": 750, "rewards": {"coins": 35000, "gold": 17500}},
--------        "premium": {"gem_cost": 1875, "rewards": {"coins": 110000, "gold": 55000}},
--------        "elite": {"gem_cost": 3750, "rewards": {"coins": 250000, "gold": 125000, "gems": 650}}
-------+        "basic": {"crystal_cost": 750, "rewards": {"coins": 35000, "gold": 17500}},
-------+        "premium": {"crystal_cost": 1875, "rewards": {"coins": 110000, "gold": 55000}},
-------+        "elite": {"crystal_cost": 3750, "rewards": {"coins": 250000, "gold": 125000, "crystals": 650}}
-------     },
-------     6: {
--------        "basic": {"gem_cost": 900, "rewards": {"coins": 50000, "gold": 25000}},
--------        "premium": {"gem_cost": 2250, "rewards": {"coins": 150000, "gold": 75000}},
--------        "elite": {"gem_cost": 4500, "rewards": {"coins": 350000, "gold": 175000, "gems": 800}}
-------+        "basic": {"crystal_cost": 900, "rewards": {"coins": 50000, "gold": 25000}},
-------+        "premium": {"crystal_cost": 2250, "rewards": {"coins": 150000, "gold": 75000}},
-------+        "elite": {"crystal_cost": 4500, "rewards": {"coins": 350000, "gold": 175000, "crystals": 800}}
-------     },
-------     7: {
--------        "basic": {"gem_cost": 1100, "rewards": {"coins": 70000, "gold": 35000}},
--------        "premium": {"gem_cost": 2750, "rewards": {"coins": 200000, "gold": 100000}},
--------        "elite": {"gem_cost": 5500, "rewards": {"coins": 480000, "gold": 240000, "gems": 1000}}
-------+        "basic": {"crystal_cost": 1100, "rewards": {"coins": 70000, "gold": 35000}},
-------+        "premium": {"crystal_cost": 2750, "rewards": {"coins": 200000, "gold": 100000}},
-------+        "elite": {"crystal_cost": 5500, "rewards": {"coins": 480000, "gold": 240000, "crystals": 1000}}
-------     },
-------     # VIP 8-11: High tier packages
-------     8: {
--------        "basic": {"gem_cost": 1300, "rewards": {"coins": 100000, "gold": 50000}},
--------        "premium": {"gem_cost": 3250, "rewards": {"coins": 280000, "gold": 140000}},
--------        "elite": {"gem_cost": 6500, "rewards": {"coins": 650000, "gold": 325000, "gems": 1200}}
-------+        "basic": {"crystal_cost": 1300, "rewards": {"coins": 100000, "gold": 50000}},
-------+        "premium": {"crystal_cost": 3250, "rewards": {"coins": 280000, "gold": 140000}},
-------+        "elite": {"crystal_cost": 6500, "rewards": {"coins": 650000, "gold": 325000, "crystals": 1200}}
-------     },
-------     9: {
--------        "basic": {"gem_cost": 1500, "rewards": {"coins": 140000, "gold": 70000}},
--------        "premium": {"gem_cost": 3750, "rewards": {"coins": 380000, "gold": 190000}},
--------        "elite": {"gem_cost": 7500, "rewards": {"coins": 850000, "gold": 425000, "gems": 1400}}
-------+        "basic": {"crystal_cost": 1500, "rewards": {"coins": 140000, "gold": 70000}},
-------+        "premium": {"crystal_cost": 3750, "rewards": {"coins": 380000, "gold": 190000}},
-------+        "elite": {"crystal_cost": 7500, "rewards": {"coins": 850000, "gold": 425000, "crystals": 1400}}
-------     },
-------     10: {
--------        "basic": {"gem_cost": 1750, "rewards": {"coins": 200000, "gold": 100000}},
--------        "premium": {"gem_cost": 4375, "rewards": {"coins": 520000, "gold": 260000}},
--------        "elite": {"gem_cost": 8750, "rewards": {"coins": 1150000, "gold": 575000, "gems": 1600}}
-------+        "basic": {"crystal_cost": 1750, "rewards": {"coins": 200000, "gold": 100000}},
-------+        "premium": {"crystal_cost": 4375, "rewards": {"coins": 520000, "gold": 260000}},
-------+        "elite": {"crystal_cost": 8750, "rewards": {"coins": 1150000, "gold": 575000, "crystals": 1600}}
-------     },
-------     11: {
--------        "basic": {"gem_cost": 2000, "rewards": {"coins": 280000, "gold": 140000}},
--------        "premium": {"gem_cost": 5000, "rewards": {"coins": 700000, "gold": 350000}},
--------        "elite": {"gem_cost": 10000, "rewards": {"coins": 1500000, "gold": 750000, "gems": 1800}}
-------+        "basic": {"crystal_cost": 2000, "rewards": {"coins": 280000, "gold": 140000}},
-------+        "premium": {"crystal_cost": 5000, "rewards": {"coins": 700000, "gold": 350000}},
-------+        "elite": {"crystal_cost": 10000, "rewards": {"coins": 1500000, "gold": 750000, "crystals": 1800}}
-------     },
-------     # VIP 12-15: Endgame whale packages
-------     12: {
--------        "basic": {"gem_cost": 2500, "rewards": {"coins": 400000, "gold": 200000}},
--------        "premium": {"gem_cost": 6250, "rewards": {"coins": 950000, "gold": 475000}},
--------        "elite": {"gem_cost": 12500, "rewards": {"coins": 2000000, "gold": 1000000, "gems": 2000}}
-------+        "basic": {"crystal_cost": 2500, "rewards": {"coins": 400000, "gold": 200000}},
-------+        "premium": {"crystal_cost": 6250, "rewards": {"coins": 950000, "gold": 475000}},
-------+        "elite": {"crystal_cost": 12500, "rewards": {"coins": 2000000, "gold": 1000000, "crystals": 2000}}
-------     },
-------     13: {
--------        "basic": {"gem_cost": 3000, "rewards": {"coins": 550000, "gold": 275000}},
--------        "premium": {"gem_cost": 7500, "rewards": {"coins": 1250000, "gold": 625000}},
--------        "elite": {"gem_cost": 15000, "rewards": {"coins": 2600000, "gold": 1300000, "gems": 2500}}
-------+        "basic": {"crystal_cost": 3000, "rewards": {"coins": 550000, "gold": 275000}},
-------+        "premium": {"crystal_cost": 7500, "rewards": {"coins": 1250000, "gold": 625000}},
-------+        "elite": {"crystal_cost": 15000, "rewards": {"coins": 2600000, "gold": 1300000, "crystals": 2500}}
-------     },
-------     14: {
--------        "basic": {"gem_cost": 3500, "rewards": {"coins": 750000, "gold": 375000}},
--------        "premium": {"gem_cost": 8750, "rewards": {"coins": 1600000, "gold": 800000}},
--------        "elite": {"gem_cost": 17500, "rewards": {"coins": 3300000, "gold": 1650000, "gems": 3000}}
-------+        "basic": {"crystal_cost": 3500, "rewards": {"coins": 750000, "gold": 375000}},
-------+        "premium": {"crystal_cost": 8750, "rewards": {"coins": 1600000, "gold": 800000}},
-------+        "elite": {"crystal_cost": 17500, "rewards": {"coins": 3300000, "gold": 1650000, "crystals": 3000}}
-------     },
-------     15: {
--------        "basic": {"gem_cost": 4000, "rewards": {"coins": 1000000, "gold": 500000}},
--------        "premium": {"gem_cost": 10000, "rewards": {"coins": 2100000, "gold": 1050000}},
--------        "elite": {"gem_cost": 20000, "rewards": {"coins": 4200000, "gold": 2100000, "gems": 3500}}
-------+        "basic": {"crystal_cost": 4000, "rewards": {"coins": 1000000, "gold": 500000}},
-------+        "premium": {"crystal_cost": 10000, "rewards": {"coins": 2100000, "gold": 1050000}},
-------+        "elite": {"crystal_cost": 20000, "rewards": {"coins": 4200000, "gold": 2100000, "crystals": 3500}}
-------     }
------- }
------- 
-------@@ -382,8 +383,8 @@ GACHA_RATES = {
------- }
------- 
------- PITY_THRESHOLD = 50
--------GEM_COST_SINGLE = 100
--------GEM_COST_MULTI = 900  # 10 pulls, 100 gem discount
-------+CRYSTAL_COST_SINGLE = 100
-------+CRYSTAL_COST_MULTI = 900  # 10 pulls, 100 crystal discount
------- COIN_COST_SINGLE = 1000
------- COIN_COST_MULTI = 9000
------- 
-------@@ -475,8 +476,8 @@ async def init_islands_and_chapters():
-------             name=f"Chapter {i}: Trial of Valor",
-------             required_power=required_power,
-------             enemy_power=enemy_power,
--------            rewards={"coins": 500 * i, "gold": 250 * i, "gems": 10 * (i // 5)},
--------            first_clear_bonus={"gems": 50, "coins": 2000}
-------+            rewards={"coins": 500 * i, "gold": 250 * i, "crystals": 10 * (i // 5)},
-------+            first_clear_bonus={"crystals": 50, "coins": 2000}
-------         )
-------         
-------         existing = await db.chapters.find_one({"chapter_number": i})
-------@@ -552,7 +553,7 @@ async def user_login(username: str):
-------     
-------     # Milestone rewards
-------     if user.login_days % 7 == 0:
--------        reward.gems = 50
-------+        reward.crystals = 50
-------     
-------     # Free summons schedule (10-15 per day over 250 days)
-------     # This gives roughly 3000 free summons over 250 days
-------@@ -563,7 +564,7 @@ async def user_login(username: str):
-------     # Apply rewards
-------     user.coins += reward.coins
-------     user.gold += reward.gold
--------    user.gems += reward.gems
-------+    user.crystals += reward.crystals
-------     user.last_login = now
-------     
-------     await db.users.update_one(
-------@@ -604,19 +605,19 @@ async def pull_gacha(username: str, request: PullRequest):
-------     num_pulls = 10 if request.pull_type == "multi" else 1
-------     
-------     # Calculate cost
--------    if request.currency_type == "gems":
--------        cost = GEM_COST_MULTI if request.pull_type == "multi" else GEM_COST_SINGLE
--------        if user.gems < cost:
--------            raise HTTPException(status_code=400, detail="Not enough gems")
--------        user.gems -= cost
--------        gems_spent = cost
-------+    if request.currency_type == "crystals":
-------+        cost = CRYSTAL_COST_MULTI if request.pull_type == "multi" else CRYSTAL_COST_SINGLE
-------+        if user.crystals < cost:
-------+            raise HTTPException(status_code=400, detail="Not enough crystals")
-------+        user.crystals -= cost
-------+        crystals_spent = cost
-------         coins_spent = 0
-------     else:
-------         cost = COIN_COST_MULTI if request.pull_type == "multi" else COIN_COST_SINGLE
-------         if user.coins < cost:
-------             raise HTTPException(status_code=400, detail="Not enough coins")
-------         user.coins -= cost
--------        gems_spent = 0
-------+        crystals_spent = 0
-------         coins_spent = cost
-------     
-------     # Perform pulls
-------@@ -669,7 +670,7 @@ async def pull_gacha(username: str, request: PullRequest):
-------     return GachaResult(
-------         heroes=pulled_heroes,
-------         new_pity_counter=user.pity_counter,
--------        gems_spent=gems_spent,
-------+        crystals_spent=crystals_spent,
-------         coins_spent=coins_spent
-------     )
------- 
-------@@ -929,8 +930,8 @@ async def vip_purchase(username: str, amount_usd: float):
-------     new_vip_level = calculate_vip_level(new_total_spent)
-------     new_avatar_frame = get_avatar_frame(new_vip_level)
-------     
--------    # Convert USD to gems (example: $1 = 100 gems)
--------    gems_purchased = int(amount_usd * 100)
-------+    # Convert USD to crystals (example: $1 = 100 crystals)
-------+    crystals_purchased = int(amount_usd * 100)
-------     
-------     await db.users.update_one(
-------         {"username": username},
-------@@ -940,13 +941,13 @@ async def vip_purchase(username: str, amount_usd: float):
-------                 "vip_level": new_vip_level,
-------                 "avatar_frame": new_avatar_frame
-------             },
--------            "$inc": {"gems": gems_purchased}
-------+            "$inc": {"crystals": crystals_purchased}
-------         }
-------     )
-------     
-------     return {
-------         "purchase_amount": amount_usd,
--------        "gems_received": gems_purchased,
-------+        "crystals_received": crystals_purchased,
-------         "new_total_spent": new_total_spent,
-------         "new_vip_level": new_vip_level,
-------         "new_idle_cap_hours": get_idle_cap_hours(new_vip_level),
-------@@ -984,7 +985,7 @@ async def get_vip_packages(username: str):
------- 
------- @api_router.post("/vip/package/purchase")
------- async def purchase_vip_package(username: str, package_tier: str):
--------    """Purchase a VIP package with gems"""
-------+    """Purchase a VIP package with crystals"""
-------     user = await db.users.find_one({"username": username})
-------     if not user:
-------         raise HTTPException(status_code=404, detail="User not found")
-------@@ -998,20 +999,20 @@ async def purchase_vip_package(username: str, package_tier: str):
-------         raise HTTPException(status_code=404, detail="Package tier not found")
-------     
-------     package = VIP_PACKAGES[vip_level][package_tier]
--------    gem_cost = package["gem_cost"]
-------+    crystal_cost = package["crystal_cost"]
-------     rewards = package["rewards"]
-------     
--------    # Check if user has enough gems
--------    if user.get("gems", 0) < gem_cost:
--------        raise HTTPException(status_code=400, detail=f"Not enough gems. Need {gem_cost}")
-------+    # Check if user has enough crystals
-------+    if user.get("crystals", 0) < crystal_cost:
-------+        raise HTTPException(status_code=400, detail=f"Not enough crystals. Need {crystal_cost}")
-------     
-------     # TODO: Check daily purchase limit (for now, allow unlimited)
-------     
--------    # Deduct gems and give rewards
--------    update_dict = {"gems": user.get("gems", 0) - gem_cost}
-------+    # Deduct crystals and give rewards
-------+    update_dict = {"crystals": user.get("crystals", 0) - crystal_cost}
-------     
-------     for reward_type, amount in rewards.items():
--------        if reward_type in ["coins", "gold", "gems"]:
-------+        if reward_type in ["coins", "gold", "crystals"]:
-------             current_amount = user.get(reward_type, 0)
-------             update_dict[reward_type] = current_amount + amount
-------     
-------@@ -1022,9 +1023,9 @@ async def purchase_vip_package(username: str, package_tier: str):
-------     
-------     return {
-------         "package_tier": package_tier,
--------        "gem_cost": gem_cost,
-------+        "crystal_cost": crystal_cost,
-------         "rewards": rewards,
--------        "remaining_gems": update_dict["gems"]
-------+        "remaining_crystals": update_dict["crystals"]
-------     }
------- 
------- @api_router.get("/user/{username}/cr")
-------@@ -1163,8 +1164,8 @@ async def battle_chapter(username: str, chapter_number: int):
-------         
-------         # Update user resources
-------         update_dict = {}
--------        if "gems" in rewards:
--------            update_dict["gems"] = user.get("gems", 0) + rewards["gems"]
-------+        if "crystals" in rewards:
-------+            update_dict["crystals"] = user.get("crystals", 0) + rewards["crystals"]
-------         if "coins" in rewards:
-------             update_dict["coins"] = user.get("coins", 0) + rewards["coins"]
-------         if "gold" in rewards:
-------@@ -1413,7 +1414,7 @@ async def get_player_character(username: str):
------- 
------- @api_router.post("/player-character/upgrade/{username}")
------- async def upgrade_player_character(username: str, upgrade_type: str):
--------    """Upgrade player character (costs gems, takes time or instant with gems)"""
-------+    """Upgrade player character (costs crystals, takes time or instant with crystals)"""
-------     user = await db.users.find_one({"username": username})
-------     if not user:
-------         raise HTTPException(status_code=404, detail="User not found")
-------@@ -1426,13 +1427,13 @@ async def upgrade_player_character(username: str, upgrade_type: str):
-------     base_cost = 100
-------     cost = base_cost * (player_char["level"] + 1)
-------     
--------    if user["gems"] < cost:
--------        raise HTTPException(status_code=400, detail=f"Not enough gems. Need {cost}")
-------+    if user["crystals"] < cost:
-------+        raise HTTPException(status_code=400, detail=f"Not enough crystals. Need {cost}")
-------     
--------    # Deduct gems
-------+    # Deduct crystals
-------     await db.users.update_one(
-------         {"username": username},
--------        {"$inc": {"gems": -cost}}
-------+        {"$inc": {"crystals": -cost}}
-------     )
-------     
-------     # Upgrade buffs based on type
-------@@ -1641,7 +1642,7 @@ async def battle_abyss(username: str, level: int, team_ids: List[str]):
-------         rewards = {
-------             "coins": level * 100,
-------             "gold": level * 50,
--------            "gems": level // 10 if level % 10 == 0 else 0  # Gems every 10 levels
-------+            "crystals": level // 10 if level % 10 == 0 else 0  # Crystals every 10 levels
-------         }
-------         
-------         # Update user resources
-------@@ -1651,7 +1652,7 @@ async def battle_abyss(username: str, level: int, team_ids: List[str]):
-------                 "$inc": {
-------                     "coins": rewards["coins"],
-------                     "gold": rewards["gold"],
--------                    "gems": rewards["gems"]
-------+                    "crystals": rewards["crystals"]
-------                 }
-------             }
-------         )
-------diff --git a/model.patch b/model.patch
-------index 252b36f..172c508 100644
---------- a/model.patch
-------+++ b/model.patch
-------@@ -1,2184 +0,0 @@
--------diff --git a/backend/server.py b/backend/server.py
--------index 720d07e..d93cc99 100644
----------- a/backend/server.py
--------+++ b/backend/server.py
--------@@ -99,11 +99,20 @@ class User(BaseModel):
--------     # VIP System
--------     vip_level: int = 0  # 0-15
--------     total_spent: float = 0.0  # Total USD spent
--------+    avatar_frame: str = "default"  # Avatar frame (default, gold, diamond, rainbow, legendary, divine)
--------     # Idle Collection
--------     idle_collection_started_at: Optional[datetime] = None
--------     idle_collection_last_claimed: Optional[datetime] = None
--------     created_at: datetime = Field(default_factory=datetime.utcnow)
-------- 
--------+class VIPPackage(BaseModel):
--------+    id: str = Field(default_factory=lambda: str(uuid.uuid4()))
--------+    vip_level: int
--------+    package_tier: str  # "basic", "premium", "elite"
--------+    gem_cost: int
--------+    rewards: Dict[str, int]  # {"coins": 1000, "gold": 500, etc}
--------+    daily_limit: int = 3  # Can buy 3 times per day
--------+
-------- class Team(BaseModel):
--------     id: str = Field(default_factory=lambda: str(uuid.uuid4()))
--------     user_id: str
--------@@ -255,6 +264,115 @@ def get_idle_cap_hours(vip_level: int) -> int:
--------     """Get idle collection cap hours for VIP level"""
--------     return VIP_TIERS.get(vip_level, VIP_TIERS[0])["idle_hours"]
-------- 
--------+def get_idle_gold_rate(vip_level: int) -> float:
--------+    """Get idle gold generation rate per minute based on VIP level"""
--------+    base_rate = 100.0  # 100 gold per minute at VIP 0
--------+    bonus_multiplier = 1.0 + (vip_level * 0.10)  # +10% per VIP level
--------+    return base_rate * bonus_multiplier
--------+
--------+def get_avatar_frame(vip_level: int) -> str:
--------+    """Get avatar frame based on VIP level"""
--------+    if vip_level >= 15:
--------+        return "divine"
--------+    elif vip_level >= 14:
--------+        return "legendary"
--------+    elif vip_level >= 13:
--------+        return "rainbow"
--------+    elif vip_level >= 12:
--------+        return "diamond"
--------+    elif vip_level >= 8:
--------+        return "gold"
--------+    else:
--------+        return "default"
--------+
--------+# VIP Package configurations - can be purchased with gems
--------+VIP_PACKAGES = {
--------+    # VIP 0-3: Early game packages
--------+    0: {
--------+        "basic": {"gem_cost": 200, "rewards": {"coins": 5000, "gold": 2500}},
--------+        "premium": {"gem_cost": 500, "rewards": {"coins": 15000, "gold": 7500}},
--------+        "elite": {"gem_cost": 1000, "rewards": {"coins": 35000, "gold": 17500, "gems": 100}}
--------+    },
--------+    1: {
--------+        "basic": {"gem_cost": 300, "rewards": {"coins": 8000, "gold": 4000}},
--------+        "premium": {"gem_cost": 750, "rewards": {"coins": 25000, "gold": 12500}},
--------+        "elite": {"gem_cost": 1500, "rewards": {"coins": 60000, "gold": 30000, "gems": 200}}
--------+    },
--------+    2: {
--------+        "basic": {"gem_cost": 400, "rewards": {"coins": 12000, "gold": 6000}},
--------+        "premium": {"gem_cost": 1000, "rewards": {"coins": 40000, "gold": 20000}},
--------+        "elite": {"gem_cost": 2000, "rewards": {"coins": 90000, "gold": 45000, "gems": 300}}
--------+    },
--------+    3: {
--------+        "basic": {"gem_cost": 500, "rewards": {"coins": 18000, "gold": 9000}},
--------+        "premium": {"gem_cost": 1250, "rewards": {"coins": 60000, "gold": 30000}},
--------+        "elite": {"gem_cost": 2500, "rewards": {"coins": 135000, "gold": 67500, "gems": 400}}
--------+    },
--------+    # VIP 4-7: Mid game packages
--------+    4: {
--------+        "basic": {"gem_cost": 600, "rewards": {"coins": 25000, "gold": 12500}},
--------+        "premium": {"gem_cost": 1500, "rewards": {"coins": 80000, "gold": 40000}},
--------+        "elite": {"gem_cost": 3000, "rewards": {"coins": 180000, "gold": 90000, "gems": 500}}
--------+    },
--------+    5: {
--------+        "basic": {"gem_cost": 750, "rewards": {"coins": 35000, "gold": 17500}},
--------+        "premium": {"gem_cost": 1875, "rewards": {"coins": 110000, "gold": 55000}},
--------+        "elite": {"gem_cost": 3750, "rewards": {"coins": 250000, "gold": 125000, "gems": 650}}
--------+    },
--------+    6: {
--------+        "basic": {"gem_cost": 900, "rewards": {"coins": 50000, "gold": 25000}},
--------+        "premium": {"gem_cost": 2250, "rewards": {"coins": 150000, "gold": 75000}},
--------+        "elite": {"gem_cost": 4500, "rewards": {"coins": 350000, "gold": 175000, "gems": 800}}
--------+    },
--------+    7: {
--------+        "basic": {"gem_cost": 1100, "rewards": {"coins": 70000, "gold": 35000}},
--------+        "premium": {"gem_cost": 2750, "rewards": {"coins": 200000, "gold": 100000}},
--------+        "elite": {"gem_cost": 5500, "rewards": {"coins": 480000, "gold": 240000, "gems": 1000}}
--------+    },
--------+    # VIP 8-11: High tier packages
--------+    8: {
--------+        "basic": {"gem_cost": 1300, "rewards": {"coins": 100000, "gold": 50000}},
--------+        "premium": {"gem_cost": 3250, "rewards": {"coins": 280000, "gold": 140000}},
--------+        "elite": {"gem_cost": 6500, "rewards": {"coins": 650000, "gold": 325000, "gems": 1200}}
--------+    },
--------+    9: {
--------+        "basic": {"gem_cost": 1500, "rewards": {"coins": 140000, "gold": 70000}},
--------+        "premium": {"gem_cost": 3750, "rewards": {"coins": 380000, "gold": 190000}},
--------+        "elite": {"gem_cost": 7500, "rewards": {"coins": 850000, "gold": 425000, "gems": 1400}}
--------+    },
--------+    10: {
--------+        "basic": {"gem_cost": 1750, "rewards": {"coins": 200000, "gold": 100000}},
--------+        "premium": {"gem_cost": 4375, "rewards": {"coins": 520000, "gold": 260000}},
--------+        "elite": {"gem_cost": 8750, "rewards": {"coins": 1150000, "gold": 575000, "gems": 1600}}
--------+    },
--------+    11: {
--------+        "basic": {"gem_cost": 2000, "rewards": {"coins": 280000, "gold": 140000}},
--------+        "premium": {"gem_cost": 5000, "rewards": {"coins": 700000, "gold": 350000}},
--------+        "elite": {"gem_cost": 10000, "rewards": {"coins": 1500000, "gold": 750000, "gems": 1800}}
--------+    },
--------+    # VIP 12-15: Endgame whale packages
--------+    12: {
--------+        "basic": {"gem_cost": 2500, "rewards": {"coins": 400000, "gold": 200000}},
--------+        "premium": {"gem_cost": 6250, "rewards": {"coins": 950000, "gold": 475000}},
--------+        "elite": {"gem_cost": 12500, "rewards": {"coins": 2000000, "gold": 1000000, "gems": 2000}}
--------+    },
--------+    13: {
--------+        "basic": {"gem_cost": 3000, "rewards": {"coins": 550000, "gold": 275000}},
--------+        "premium": {"gem_cost": 7500, "rewards": {"coins": 1250000, "gold": 625000}},
--------+        "elite": {"gem_cost": 15000, "rewards": {"coins": 2600000, "gold": 1300000, "gems": 2500}}
--------+    },
--------+    14: {
--------+        "basic": {"gem_cost": 3500, "rewards": {"coins": 750000, "gold": 375000}},
--------+        "premium": {"gem_cost": 8750, "rewards": {"coins": 1600000, "gold": 800000}},
--------+        "elite": {"gem_cost": 17500, "rewards": {"coins": 3300000, "gold": 1650000, "gems": 3000}}
--------+    },
--------+    15: {
--------+        "basic": {"gem_cost": 4000, "rewards": {"coins": 1000000, "gold": 500000}},
--------+        "premium": {"gem_cost": 10000, "rewards": {"coins": 2100000, "gold": 1050000}},
--------+        "elite": {"gem_cost": 20000, "rewards": {"coins": 4200000, "gold": 2100000, "gems": 3500}}
--------+    }
--------+}
--------+
-------- # Gacha rates configuration
-------- GACHA_RATES = {
--------     "SR": 60.0,   # 60%
--------@@ -696,8 +814,9 @@ async def claim_idle_rewards(username: str):
--------     max_seconds = idle_cap_hours * 3600
--------     time_away = min(time_away, max_seconds)
--------     
---------    # Calculate gold earned (100 gold per minute)
---------    gold_per_second = 100 / 60
--------+    # Calculate gold earned with VIP rate bonus
--------+    gold_per_minute = get_idle_gold_rate(vip_level)
--------+    gold_per_second = gold_per_minute / 60
--------     gold_earned = int(gold_per_second * time_away)
--------     
--------     # Update user gold and restart collection
--------@@ -746,9 +865,10 @@ async def get_idle_status(username: str):
--------     time_elapsed = (now - collection_started).total_seconds()
--------     max_seconds = idle_cap_hours * 3600
--------     
---------    # Calculate pending gold
--------+    # Calculate pending gold with VIP rate bonus
--------     capped_time = min(time_elapsed, max_seconds)
---------    gold_per_second = 100 / 60
--------+    gold_per_minute = get_idle_gold_rate(vip_level)
--------+    gold_per_second = gold_per_minute / 60
--------     gold_pending = int(gold_per_second * capped_time)
--------     
--------     return {
--------@@ -784,8 +904,12 @@ async def get_vip_info(username: str):
--------         "current_vip_level": current_vip,
--------         "total_spent": total_spent,
--------         "current_idle_hours": current_tier["idle_hours"],
--------+        "current_idle_rate": get_idle_gold_rate(current_vip),
--------+        "current_avatar_frame": get_avatar_frame(current_vip),
--------         "next_vip_level": next_vip if next_vip > current_vip else None,
--------         "next_idle_hours": next_tier["idle_hours"] if next_vip > current_vip else None,
--------+        "next_idle_rate": get_idle_gold_rate(next_vip) if next_vip > current_vip else None,
--------+        "next_avatar_frame": get_avatar_frame(next_vip) if next_vip > current_vip else None,
--------         "spend_needed_for_next": spend_needed,
--------         "all_tiers": VIP_TIERS
--------     }
--------@@ -803,6 +927,7 @@ async def vip_purchase(username: str, amount_usd: float):
--------     # Update total spent and VIP level
--------     new_total_spent = user.get("total_spent", 0) + amount_usd
--------     new_vip_level = calculate_vip_level(new_total_spent)
--------+    new_avatar_frame = get_avatar_frame(new_vip_level)
--------     
--------     # Convert USD to gems (example: $1 = 100 gems)
--------     gems_purchased = int(amount_usd * 100)
--------@@ -812,7 +937,8 @@ async def vip_purchase(username: str, amount_usd: float):
--------         {
--------             "$set": {
--------                 "total_spent": new_total_spent,
---------                "vip_level": new_vip_level
--------+                "vip_level": new_vip_level,
--------+                "avatar_frame": new_avatar_frame
--------             },
--------             "$inc": {"gems": gems_purchased}
--------         }
--------@@ -823,7 +949,82 @@ async def vip_purchase(username: str, amount_usd: float):
--------         "gems_received": gems_purchased,
--------         "new_total_spent": new_total_spent,
--------         "new_vip_level": new_vip_level,
---------        "new_idle_cap_hours": get_idle_cap_hours(new_vip_level)
--------+        "new_idle_cap_hours": get_idle_cap_hours(new_vip_level),
--------+        "new_idle_rate": get_idle_gold_rate(new_vip_level),
--------+        "new_avatar_frame": new_avatar_frame
--------+    }
--------+
--------+@api_router.get("/vip/packages/{username}")
--------+async def get_vip_packages(username: str):
--------+    """Get available VIP packages for user's current VIP level"""
--------+    user = await db.users.find_one({"username": username})
--------+    if not user:
--------+        raise HTTPException(status_code=404, detail="User not found")
--------+    
--------+    vip_level = calculate_vip_level(user.get("total_spent", 0))
--------+    
--------+    if vip_level not in VIP_PACKAGES:
--------+        raise HTTPException(status_code=404, detail="No packages available for this VIP level")
--------+    
--------+    packages = VIP_PACKAGES[vip_level]
--------+    
--------+    # Add package IDs and daily purchase tracking
--------+    result = {}
--------+    for tier, package_data in packages.items():
--------+        result[tier] = {
--------+            **package_data,
--------+            "daily_limit": 3,
--------+            "purchases_today": 0  # TODO: Track daily purchases in database
--------+        }
--------+    
--------+    return {
--------+        "vip_level": vip_level,
--------+        "packages": result
--------+    }
--------+
--------+@api_router.post("/vip/package/purchase")
--------+async def purchase_vip_package(username: str, package_tier: str):
--------+    """Purchase a VIP package with gems"""
--------+    user = await db.users.find_one({"username": username})
--------+    if not user:
--------+        raise HTTPException(status_code=404, detail="User not found")
--------+    
--------+    vip_level = calculate_vip_level(user.get("total_spent", 0))
--------+    
--------+    if vip_level not in VIP_PACKAGES:
--------+        raise HTTPException(status_code=404, detail="No packages available for this VIP level")
--------+    
--------+    if package_tier not in VIP_PACKAGES[vip_level]:
--------+        raise HTTPException(status_code=404, detail="Package tier not found")
--------+    
--------+    package = VIP_PACKAGES[vip_level][package_tier]
--------+    gem_cost = package["gem_cost"]
--------+    rewards = package["rewards"]
--------+    
--------+    # Check if user has enough gems
--------+    if user.get("gems", 0) < gem_cost:
--------+        raise HTTPException(status_code=400, detail=f"Not enough gems. Need {gem_cost}")
--------+    
--------+    # TODO: Check daily purchase limit (for now, allow unlimited)
--------+    
--------+    # Deduct gems and give rewards
--------+    update_dict = {"gems": user.get("gems", 0) - gem_cost}
--------+    
--------+    for reward_type, amount in rewards.items():
--------+        if reward_type in ["coins", "gold", "gems"]:
--------+            current_amount = user.get(reward_type, 0)
--------+            update_dict[reward_type] = current_amount + amount
--------+    
--------+    await db.users.update_one(
--------+        {"username": username},
--------+        {"$set": update_dict}
--------+    )
--------+    
--------+    return {
--------+        "package_tier": package_tier,
--------+        "gem_cost": gem_cost,
--------+        "rewards": rewards,
--------+        "remaining_gems": update_dict["gems"]
--------     }
-------- 
-------- @api_router.get("/user/{username}/cr")
--------diff --git a/model.patch b/model.patch
--------index 0ad1f49..c1dc849 100644
----------- a/model.patch
--------+++ b/model.patch
--------@@ -1,1898 +0,0 @@
---------diff --git a/backend/server.py b/backend/server.py
---------index 1cc57c5..6f74810 100644
------------ a/backend/server.py
---------+++ b/backend/server.py
---------@@ -96,6 +96,12 @@ class User(BaseModel):
---------     last_login: Optional[datetime] = None
---------     daily_summons_claimed: int = 0  # Track daily free summons
---------     profile_picture_hero_id: Optional[str] = None  # Hero ID for profile picture
---------+    # VIP System
---------+    vip_level: int = 0  # 0-15
---------+    total_spent: float = 0.0  # Total USD spent
---------+    # Idle Collection
---------+    idle_collection_started_at: Optional[datetime] = None
---------+    idle_collection_last_claimed: Optional[datetime] = None
---------     created_at: datetime = Field(default_factory=datetime.utcnow)
--------- 
--------- class Team(BaseModel):
---------diff --git a/model.patch b/model.patch
---------index 0ecc25a..e69de29 100644
------------ a/model.patch
---------+++ b/model.patch
---------@@ -1,1876 +0,0 @@
----------diff --git a/model.patch b/model.patch
----------index d3c7ab3..e69de29 100644
------------- a/model.patch
----------+++ b/model.patch
----------@@ -1,1871 +0,0 @@
-----------diff --git a/backend/server.py b/backend/server.py
-----------index db3c492..1cc57c5 100644
-------------- a/backend/server.py
-----------+++ b/backend/server.py
-----------@@ -95,6 +95,7 @@ class User(BaseModel):
-----------     login_days: int = 0
-----------     last_login: Optional[datetime] = None
-----------     daily_summons_claimed: int = 0  # Track daily free summons
-----------+    profile_picture_hero_id: Optional[str] = None  # Hero ID for profile picture
-----------     created_at: datetime = Field(default_factory=datetime.utcnow)
----------- 
----------- class Team(BaseModel):
-----------@@ -415,6 +416,26 @@ async def user_login(username: str):
-----------     
-----------     return reward
----------- 
-----------+@api_router.post("/user/{username}/profile-picture")
-----------+async def update_profile_picture(username: str, hero_id: str):
-----------+    """Update user's profile picture to a hero they own"""
-----------+    user_data = await db.users.find_one({"username": username})
-----------+    if not user_data:
-----------+        raise HTTPException(status_code=404, detail="User not found")
-----------+    
-----------+    # Verify user owns this hero
-----------+    user_hero = await db.user_heroes.find_one({"user_id": user_data["id"], "hero_id": hero_id})
-----------+    if not user_hero:
-----------+        raise HTTPException(status_code=400, detail="You don't own this hero")
-----------+    
-----------+    # Update profile picture
-----------+    await db.users.update_one(
-----------+        {"username": username},
-----------+        {"$set": {"profile_picture_hero_id": hero_id}}
-----------+    )
-----------+    
-----------+    return {"message": "Profile picture updated successfully", "hero_id": hero_id}
-----------+
----------- @api_router.post("/gacha/pull")
----------- async def pull_gacha(username: str, request: PullRequest):
-----------     """Perform gacha pull"""
-----------diff --git a/frontend/app/_layout.tsx b/frontend/app/_layout.tsx
-----------index 06391a5..942523f 100644
-------------- a/frontend/app/_layout.tsx
-----------+++ b/frontend/app/_layout.tsx
-----------@@ -40,6 +40,24 @@ export default function Layout() {
-----------           ),
-----------         }}
-----------       />
-----------+      <Tabs.Screen
-----------+        name="abyss"
-----------+        options={{
-----------+          title: 'Abyss',
-----------+          tabBarIcon: ({ color, size }) => (
-----------+            <Ionicons name="flame" size={size} color={color} />
-----------+          ),
-----------+        }}
-----------+      />
-----------+      <Tabs.Screen
-----------+        name="arena"
-----------+        options={{
-----------+          title: 'Arena',
-----------+          tabBarIcon: ({ color, size }) => (
-----------+            <Ionicons name="trophy" size={size} color={color} />
-----------+          ),
-----------+        }}
-----------+      />
-----------       <Tabs.Screen
-----------         name="heroes"
-----------         options={{
-----------diff --git a/frontend/app/abyss.tsx b/frontend/app/abyss.tsx
-----------new file mode 100644
-----------index 0000000..1ea453b
-------------- /dev/null
-----------+++ b/frontend/app/abyss.tsx
-----------@@ -0,0 +1,289 @@
-----------+import React, { useEffect, useState } from 'react';
-----------+import {
-----------+  View,
-----------+  Text,
-----------+  StyleSheet,
-----------+  SafeAreaView,
-----------+  TouchableOpacity,
-----------+  ScrollView,
-----------+  ActivityIndicator,
-----------+  Alert,
-----------+} from 'react-native';
-----------+import { useGameStore } from '../stores/gameStore';
-----------+import { Ionicons } from '@expo/vector-icons';
-----------+import { LinearGradient } from 'expo-linear-gradient';
-----------+
-----------+export default function AbyssScreen() {
-----------+  const { user } = useGameStore();
-----------+  const [progress, setProgress] = useState<any>(null);
-----------+  const [isLoading, setIsLoading] = useState(false);
-----------+
-----------+  useEffect(() => {
-----------+    if (user) {
-----------+      loadAbyssProgress();
-----------+    }
-----------+  }, [user]);
-----------+
-----------+  const loadAbyssProgress = async () => {
-----------+    try {
-----------+      const response = await fetch(`${process.env.EXPO_PUBLIC_API_URL}/abyss/progress/${user.username}`);
-----------+      const data = await response.json();
-----------+      setProgress(data);
-----------+    } catch (error) {
-----------+      console.error('Failed to load abyss progress:', error);
-----------+    }
-----------+  };
-----------+
-----------+  const battleLevel = async (level: number) => {
-----------+    setIsLoading(true);
-----------+    try {
-----------+      // For now, use a simple team setup - this would be enhanced later
-----------+      const response = await fetch(`${process.env.EXPO_PUBLIC_API_URL}/abyss/battle/${user.username}/${level}`, {
-----------+        method: 'POST',
-----------+        headers: { 'Content-Type': 'application/json' },
-----------+        body: JSON.stringify({ team_ids: [] }) // Empty for now
-----------+      });
-----------+      
-----------+      const result = await response.json();
-----------+      
-----------+      if (response.ok) {
-----------+        Alert.alert(
-----------+          result.victory ? 'ðŸŽ‰ Victory!' : 'ðŸ’€ Defeat',
-----------+          `Level ${level}\n\n` +
-----------+          `Your Power: ${result.user_power.toLocaleString()}\n` +
-----------+          `Enemy Power: ${result.enemy_power.toLocaleString()}\n\n` +
-----------+          (result.victory ? 
-----------+            `Rewards:\nðŸ’° Coins: +${result.rewards.coins}\nâ­ Gold: +${result.rewards.gold}\n${result.rewards.gems > 0 ? `ðŸ’Ž Gems: +${result.rewards.gems}` : ''}` :
-----------+            'Try again with stronger heroes!')
-----------+        );
-----------+        
-----------+        if (result.victory) {
-----------+          loadAbyssProgress();
-----------+        }
-----------+      } else {
-----------+        Alert.alert('Error', result.detail || 'Battle failed');
-----------+      }
-----------+    } catch (error) {
-----------+      Alert.alert('Error', 'Failed to battle');
-----------+    } finally {
-----------+      setIsLoading(false);
-----------+    }
-----------+  };
-----------+
-----------+  if (!user) {
-----------+    return (
-----------+      <LinearGradient colors={['#4B0082', '#8B008B', '#FF1493']} style={styles.container}>
-----------+        <SafeAreaView style={styles.container}>
-----------+          <Text style={styles.errorText}>Please log in first</Text>
-----------+        </SafeAreaView>
-----------+      </LinearGradient>
-----------+    );
-----------+  }
-----------+
-----------+  return (
-----------+    <LinearGradient colors={['#4B0082', '#8B008B', '#FF1493']} style={styles.container}>
-----------+      <SafeAreaView style={styles.container}>
-----------+        <ScrollView contentContainerStyle={styles.content}>
-----------+          <Text style={styles.title}>ðŸ”¥ Endless Abyss</Text>
-----------+          <Text style={styles.subtitle}>Test your might against infinite challenges</Text>
-----------+
-----------+          {progress && (
-----------+            <LinearGradient
-----------+              colors={['#FF6347', '#FF1493']}
-----------+              style={styles.progressCard}
-----------+            >
-----------+              <View style={styles.progressRow}>
-----------+                <View style={styles.progressItem}>
-----------+                  <Text style={styles.progressLabel}>Current Level</Text>
-----------+                  <Text style={styles.progressValue}>{progress.current_level}</Text>
-----------+                </View>
-----------+                <View style={styles.progressItem}>
-----------+                  <Text style={styles.progressLabel}>Highest Level</Text>
-----------+                  <Text style={styles.progressValue}>{progress.highest_level}</Text>
-----------+                </View>
-----------+                <View style={styles.progressItem}>
-----------+                  <Text style={styles.progressLabel}>Total Clears</Text>
-----------+                  <Text style={styles.progressValue}>{progress.total_clears}</Text>
-----------+                </View>
-----------+              </View>
-----------+            </LinearGradient>
-----------+          )}
-----------+
-----------+          <View style={styles.levelsContainer}>
-----------+            <Text style={styles.sectionTitle}>Available Levels</Text>
-----------+            
-----------+            {progress && Array.from({ length: Math.min(progress.current_level + 2, progress.current_level + 10) }, (_, i) => {
-----------+              const level = Math.max(1, progress.current_level - 5 + i);
-----------+              const isUnlocked = level <= progress.current_level || level <= progress.highest_level;
-----------+              const isCurrent = level === progress.current_level;
-----------+              
-----------+              return (
-----------+                <TouchableOpacity
-----------+                  key={level}
-----------+                  style={[styles.levelButton, !isUnlocked && styles.levelButtonLocked]}
-----------+                  onPress={() => isUnlocked ? battleLevel(level) : null}
-----------+                  disabled={!isUnlocked || isLoading}
-----------+                >
-----------+                  <LinearGradient
-----------+                    colors={
-----------+                      !isUnlocked ? ['#666', '#444'] :
-----------+                      isCurrent ? ['#FF1493', '#9400D3'] :
-----------+                      ['#32CD32', '#00CED1']
-----------+                    }
-----------+                    style={styles.levelButtonGradient}
-----------+                  >
-----------+                    <View style={styles.levelInfo}>
-----------+                      <Text style={styles.levelNumber}>Level {level}</Text>
-----------+                      <Text style={styles.levelDifficulty}>
-----------+                        {level > 1000 ? 'Nightmare' : level > 200 ? 'Hard' : 'Normal'}
-----------+                      </Text>
-----------+                    </View>
-----------+                    <View style={styles.levelRewards}>
-----------+                      <Text style={styles.rewardText}>ðŸ’° {level * 100}</Text>
-----------+                      <Text style={styles.rewardText}>â­ {level * 50}</Text>
-----------+                      {level % 10 === 0 && <Text style={styles.rewardText}>ðŸ’Ž {level / 10}</Text>}
-----------+                    </View>
-----------+                    {!isUnlocked && <Ionicons name="lock-closed" size={24} color="#FFF" />}
-----------+                    {isCurrent && <Ionicons name="play" size={24} color="#FFF" />}
-----------+                  </LinearGradient>
-----------+                </TouchableOpacity>
-----------+              );
-----------+            })}
-----------+          </View>
-----------+
-----------+          {isLoading && (
-----------+            <View style={styles.loadingOverlay}>
-----------+              <ActivityIndicator size="large" color="#FFF" />
-----------+              <Text style={styles.loadingText}>Battling...</Text>
-----------+            </View>
-----------+          )}
-----------+        </ScrollView>
-----------+      </SafeAreaView>
-----------+    </LinearGradient>
-----------+  );
-----------+}
-----------+
-----------+const styles = StyleSheet.create({
-----------+  container: {
-----------+    flex: 1,
-----------+  },
-----------+  content: {
-----------+    padding: 16,
-----------+    paddingTop: 60,
-----------+  },
-----------+  title: {
-----------+    fontSize: 32,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+    textAlign: 'center',
-----------+    marginBottom: 8,
-----------+    textShadowColor: '#000',
-----------+    textShadowOffset: { width: 2, height: 2 },
-----------+    textShadowRadius: 5,
-----------+  },
-----------+  subtitle: {
-----------+    fontSize: 16,
-----------+    color: '#FFF',
-----------+    textAlign: 'center',
-----------+    marginBottom: 24,
-----------+    opacity: 0.9,
-----------+  },
-----------+  progressCard: {
-----------+    borderRadius: 16,
-----------+    padding: 20,
-----------+    marginBottom: 24,
-----------+    shadowColor: '#000',
-----------+    shadowOffset: { width: 0, height: 4 },
-----------+    shadowOpacity: 0.3,
-----------+    shadowRadius: 8,
-----------+    elevation: 8,
-----------+  },
-----------+  progressRow: {
-----------+    flexDirection: 'row',
-----------+    justifyContent: 'space-around',
-----------+  },
-----------+  progressItem: {
-----------+    alignItems: 'center',
-----------+  },
-----------+  progressLabel: {
-----------+    fontSize: 12,
-----------+    color: '#FFF',
-----------+    opacity: 0.8,
-----------+    marginBottom: 4,
-----------+  },
-----------+  progressValue: {
-----------+    fontSize: 24,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+  },
-----------+  levelsContainer: {
-----------+    marginBottom: 24,
-----------+  },
-----------+  sectionTitle: {
-----------+    fontSize: 20,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+    marginBottom: 16,
-----------+    textShadowColor: '#000',
-----------+    textShadowOffset: { width: 1, height: 1 },
-----------+    textShadowRadius: 3,
-----------+  },
-----------+  levelButton: {
-----------+    marginBottom: 12,
-----------+    borderRadius: 16,
-----------+    overflow: 'hidden',
-----------+  },
-----------+  levelButtonLocked: {
-----------+    opacity: 0.6,
-----------+  },
-----------+  levelButtonGradient: {
-----------+    padding: 16,
-----------+    flexDirection: 'row',
-----------+    alignItems: 'center',
-----------+    justifyContent: 'space-between',
-----------+  },
-----------+  levelInfo: {
-----------+    flex: 1,
-----------+  },
-----------+  levelNumber: {
-----------+    fontSize: 18,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+    marginBottom: 4,
-----------+  },
-----------+  levelDifficulty: {
-----------+    fontSize: 12,
-----------+    color: '#FFF',
-----------+    opacity: 0.8,
-----------+  },
-----------+  levelRewards: {
-----------+    alignItems: 'flex-end',
-----------+    marginRight: 16,
-----------+  },
-----------+  rewardText: {
-----------+    fontSize: 12,
-----------+    color: '#FFF',
-----------+    marginBottom: 2,
-----------+  },
-----------+  loadingOverlay: {
-----------+    position: 'absolute',
-----------+    top: 0,
-----------+    left: 0,
-----------+    right: 0,
-----------+    bottom: 0,
-----------+    backgroundColor: 'rgba(0, 0, 0, 0.7)',
-----------+    alignItems: 'center',
-----------+    justifyContent: 'center',
-----------+  },
-----------+  loadingText: {
-----------+    color: '#FFF',
-----------+    fontSize: 16,
-----------+    marginTop: 12,
-----------+  },
-----------+  errorText: {
-----------+    color: '#FFF',
-----------+    fontSize: 18,
-----------+    textAlign: 'center',
-----------+    marginTop: 100,
-----------+  },
-----------+});
-----------\ No newline at end of file
-----------diff --git a/frontend/app/arena.tsx b/frontend/app/arena.tsx
-----------new file mode 100644
-----------index 0000000..599cc18
-------------- /dev/null
-----------+++ b/frontend/app/arena.tsx
-----------@@ -0,0 +1,371 @@
-----------+import React, { useEffect, useState } from 'react';
-----------+import {
-----------+  View,
-----------+  Text,
-----------+  StyleSheet,
-----------+  SafeAreaView,
-----------+  TouchableOpacity,
-----------+  ScrollView,
-----------+  ActivityIndicator,
-----------+  Alert,
-----------+} from 'react-native';
-----------+import { useGameStore } from '../stores/gameStore';
-----------+import { Ionicons } from '@expo/vector-icons';
-----------+import { LinearGradient } from 'expo-linear-gradient';
-----------+
-----------+export default function ArenaScreen() {
-----------+  const { user } = useGameStore();
-----------+  const [record, setRecord] = useState<any>(null);
-----------+  const [leaderboard, setLeaderboard] = useState<any[]>([]);
-----------+  const [isLoading, setIsLoading] = useState(false);
-----------+
-----------+  useEffect(() => {
-----------+    if (user) {
-----------+      loadArenaData();
-----------+    }
-----------+  }, [user]);
-----------+
-----------+  const loadArenaData = async () => {
-----------+    try {
-----------+      const [recordResponse, leaderboardResponse] = await Promise.all([
-----------+        fetch(`${process.env.EXPO_PUBLIC_API_URL}/arena/record/${user.username}`),
-----------+        fetch(`${process.env.EXPO_PUBLIC_API_URL}/leaderboard/arena?limit=10`)
-----------+      ]);
-----------+      
-----------+      const recordData = await recordResponse.json();
-----------+      const leaderboardData = await leaderboardResponse.json();
-----------+      
-----------+      setRecord(recordData);
-----------+      setLeaderboard(leaderboardData);
-----------+    } catch (error) {
-----------+      console.error('Failed to load arena data:', error);
-----------+    }
-----------+  };
-----------+
-----------+  const battle = async () => {
-----------+    setIsLoading(true);
-----------+    try {
-----------+      // For now, use a simple team setup - this would be enhanced later
-----------+      const response = await fetch(`${process.env.EXPO_PUBLIC_API_URL}/arena/battle/${user.username}`, {
-----------+        method: 'POST',
-----------+        headers: { 'Content-Type': 'application/json' },
-----------+        body: JSON.stringify({ team_id: 'default' }) // Placeholder
-----------+      });
-----------+      
-----------+      const result = await response.json();
-----------+      
-----------+      if (response.ok) {
-----------+        Alert.alert(
-----------+          result.victory ? 'ðŸ† Victory!' : 'ðŸ’€ Defeat',
-----------+          `vs ${result.opponent_username}\n\n` +
-----------+          `Your Power: ${result.user_power.toLocaleString()}\n` +
-----------+          `Opponent Power: ${result.opponent_power.toLocaleString()}\n\n` +
-----------+          `Rating Change: ${result.rating_change > 0 ? '+' : ''}${result.rating_change}\n` +
-----------+          `New Rating: ${result.new_rating}\n` +
-----------+          `Win Streak: ${result.win_streak}`
-----------+        );
-----------+        
-----------+        loadArenaData();
-----------+      } else {
-----------+        Alert.alert('Error', result.detail || 'Battle failed');
-----------+      }
-----------+    } catch (error) {
-----------+      Alert.alert('Error', 'Failed to battle');
-----------+    } finally {
-----------+      setIsLoading(false);
-----------+    }
-----------+  };
-----------+
-----------+  const getRankColor = (rank: number) => {
-----------+    if (rank === 1) return '#FFD700'; // Gold
-----------+    if (rank <= 3) return '#C0C0C0'; // Silver
-----------+    if (rank <= 10) return '#CD7F32'; // Bronze
-----------+    return '#FFF';
-----------+  };
-----------+
-----------+  if (!user) {
-----------+    return (
-----------+      <LinearGradient colors={['#FF6347', '#FF1493', '#9400D3']} style={styles.container}>
-----------+        <SafeAreaView style={styles.container}>
-----------+          <Text style={styles.errorText}>Please log in first</Text>
-----------+        </SafeAreaView>
-----------+      </LinearGradient>
-----------+    );
-----------+  }
-----------+
-----------+  return (
-----------+    <LinearGradient colors={['#FF6347', '#FF1493', '#9400D3']} style={styles.container}>
-----------+      <SafeAreaView style={styles.container}>
-----------+        <ScrollView contentContainerStyle={styles.content}>
-----------+          <Text style={styles.title}>ðŸ† PvP Arena</Text>
-----------+          <Text style={styles.subtitle}>Battle other players for glory and rewards</Text>
-----------+
-----------+          {record && (
-----------+            <LinearGradient
-----------+              colors={['#FFD700', '#FFA500']}
-----------+              style={styles.recordCard}
-----------+            >
-----------+              <View style={styles.recordHeader}>
-----------+                <Text style={styles.recordTitle}>Your Arena Record</Text>
-----------+                <View style={styles.ratingBadge}>
-----------+                  <Text style={styles.ratingValue}>{record.rating}</Text>
-----------+                  <Text style={styles.ratingLabel}>Rating</Text>
-----------+                </View>
-----------+              </View>
-----------+              
-----------+              <View style={styles.statsRow}>
-----------+                <View style={styles.statItem}>
-----------+                  <Text style={styles.statValue}>{record.wins}</Text>
-----------+                  <Text style={styles.statLabel}>Wins</Text>
-----------+                </View>
-----------+                <View style={styles.statItem}>
-----------+                  <Text style={styles.statValue}>{record.losses}</Text>
-----------+                  <Text style={styles.statLabel}>Losses</Text>
-----------+                </View>
-----------+                <View style={styles.statItem}>
-----------+                  <Text style={styles.statValue}>{record.win_streak}</Text>
-----------+                  <Text style={styles.statLabel}>Streak</Text>
-----------+                </View>
-----------+                <View style={styles.statItem}>
-----------+                  <Text style={styles.statValue}>{record.highest_rating}</Text>
-----------+                  <Text style={styles.statLabel}>Best</Text>
-----------+                </View>
-----------+              </View>
-----------+            </LinearGradient>
-----------+          )}
-----------+
-----------+          <TouchableOpacity
-----------+            style={styles.battleButton}
-----------+            onPress={battle}
-----------+            disabled={isLoading}
-----------+          >
-----------+            <LinearGradient
-----------+              colors={['#FF1493', '#9400D3']}
-----------+              style={styles.battleButtonGradient}
-----------+            >
-----------+              {isLoading ? (
-----------+                <ActivityIndicator color="#FFF" size="large" />
-----------+              ) : (
-----------+                <>
-----------+                  <Ionicons name="sword" size={32} color="#FFF" />
-----------+                  <Text style={styles.battleButtonText}>Find Match</Text>
-----------+                </>
-----------+              )}
-----------+            </LinearGradient>
-----------+          </TouchableOpacity>
-----------+
-----------+          <View style={styles.leaderboardContainer}>
-----------+            <Text style={styles.sectionTitle}>ðŸ… Top Players</Text>
-----------+            
-----------+            {leaderboard.map((player, index) => (
-----------+              <View key={player.user_id} style={styles.leaderboardItem}>
-----------+                <LinearGradient
-----------+                  colors={
-----------+                    index === 0 ? ['#FFD700', '#FFA500'] :
-----------+                    index === 1 ? ['#C0C0C0', '#A0A0A0'] :
-----------+                    index === 2 ? ['#CD7F32', '#B8860B'] :
-----------+                    ['#FFFFFF', '#F0F0F0']
-----------+                  }
-----------+                  style={styles.leaderboardGradient}
-----------+                >
-----------+                  <View style={styles.rankSection}>
-----------+                    <Text style={[styles.rankText, { color: getRankColor(player.rank) }]}>
-----------+                      #{player.rank}
-----------+                    </Text>
-----------+                    {index < 3 && (
-----------+                      <Ionicons 
-----------+                        name={index === 0 ? "trophy" : index === 1 ? "medal" : "ribbon"} 
-----------+                        size={20} 
-----------+                        color={getRankColor(player.rank)} 
-----------+                      />
-----------+                    )}
-----------+                  </View>
-----------+                  
-----------+                  <View style={styles.playerInfo}>
-----------+                    <Text style={styles.playerName}>{player.username}</Text>
-----------+                    <Text style={styles.playerStats}>
-----------+                      {player.rating} â€¢ {player.wins}W/{player.losses}L â€¢ {player.win_rate.toFixed(1)}%
-----------+                    </Text>
-----------+                  </View>
-----------+                  
-----------+                  <View style={styles.streakBadge}>
-----------+                    <Text style={styles.streakText}>{player.win_streak}</Text>
-----------+                    <Text style={styles.streakLabel}>streak</Text>
-----------+                  </View>
-----------+                </LinearGradient>
-----------+              </View>
-----------+            ))}
-----------+          </View>
-----------+        </ScrollView>
-----------+      </SafeAreaView>
-----------+    </LinearGradient>
-----------+  );
-----------+}
-----------+
-----------+const styles = StyleSheet.create({
-----------+  container: {
-----------+    flex: 1,
-----------+  },
-----------+  content: {
-----------+    padding: 16,
-----------+    paddingTop: 60,
-----------+  },
-----------+  title: {
-----------+    fontSize: 32,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+    textAlign: 'center',
-----------+    marginBottom: 8,
-----------+    textShadowColor: '#000',
-----------+    textShadowOffset: { width: 2, height: 2 },
-----------+    textShadowRadius: 5,
-----------+  },
-----------+  subtitle: {
-----------+    fontSize: 16,
-----------+    color: '#FFF',
-----------+    textAlign: 'center',
-----------+    marginBottom: 24,
-----------+    opacity: 0.9,
-----------+  },
-----------+  recordCard: {
-----------+    borderRadius: 16,
-----------+    padding: 20,
-----------+    marginBottom: 24,
-----------+    shadowColor: '#000',
-----------+    shadowOffset: { width: 0, height: 4 },
-----------+    shadowOpacity: 0.3,
-----------+    shadowRadius: 8,
-----------+    elevation: 8,
-----------+  },
-----------+  recordHeader: {
-----------+    flexDirection: 'row',
-----------+    justifyContent: 'space-between',
-----------+    alignItems: 'center',
-----------+    marginBottom: 16,
-----------+  },
-----------+  recordTitle: {
-----------+    fontSize: 18,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+  },
-----------+  ratingBadge: {
-----------+    backgroundColor: 'rgba(255, 255, 255, 0.3)',
-----------+    paddingHorizontal: 12,
-----------+    paddingVertical: 8,
-----------+    borderRadius: 12,
-----------+    alignItems: 'center',
-----------+  },
-----------+  ratingValue: {
-----------+    fontSize: 20,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+  },
-----------+  ratingLabel: {
-----------+    fontSize: 12,
-----------+    color: '#FFF',
-----------+    opacity: 0.8,
-----------+  },
-----------+  statsRow: {
-----------+    flexDirection: 'row',
-----------+    justifyContent: 'space-around',
-----------+  },
-----------+  statItem: {
-----------+    alignItems: 'center',
-----------+  },
-----------+  statValue: {
-----------+    fontSize: 18,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+    marginBottom: 4,
-----------+  },
-----------+  statLabel: {
-----------+    fontSize: 12,
-----------+    color: '#FFF',
-----------+    opacity: 0.8,
-----------+  },
-----------+  battleButton: {
-----------+    marginBottom: 24,
-----------+    borderRadius: 16,
-----------+    overflow: 'hidden',
-----------+  },
-----------+  battleButtonGradient: {
-----------+    padding: 20,
-----------+    flexDirection: 'row',
-----------+    alignItems: 'center',
-----------+    justifyContent: 'center',
-----------+    gap: 12,
-----------+  },
-----------+  battleButtonText: {
-----------+    fontSize: 20,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+  },
-----------+  leaderboardContainer: {
-----------+    marginBottom: 24,
-----------+  },
-----------+  sectionTitle: {
-----------+    fontSize: 20,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+    marginBottom: 16,
-----------+    textShadowColor: '#000',
-----------+    textShadowOffset: { width: 1, height: 1 },
-----------+    textShadowRadius: 3,
-----------+  },
-----------+  leaderboardItem: {
-----------+    marginBottom: 8,
-----------+    borderRadius: 12,
-----------+    overflow: 'hidden',
-----------+  },
-----------+  leaderboardGradient: {
-----------+    padding: 12,
-----------+    flexDirection: 'row',
-----------+    alignItems: 'center',
-----------+  },
-----------+  rankSection: {
-----------+    flexDirection: 'row',
-----------+    alignItems: 'center',
-----------+    width: 60,
-----------+    gap: 4,
-----------+  },
-----------+  rankText: {
-----------+    fontSize: 16,
-----------+    fontWeight: 'bold',
-----------+  },
-----------+  playerInfo: {
-----------+    flex: 1,
-----------+    marginLeft: 12,
-----------+  },
-----------+  playerName: {
-----------+    fontSize: 16,
-----------+    fontWeight: 'bold',
-----------+    color: '#333',
-----------+    marginBottom: 2,
-----------+  },
-----------+  playerStats: {
-----------+    fontSize: 12,
-----------+    color: '#666',
-----------+  },
-----------+  streakBadge: {
-----------+    backgroundColor: 'rgba(255, 20, 147, 0.2)',
-----------+    paddingHorizontal: 8,
-----------+    paddingVertical: 4,
-----------+    borderRadius: 8,
-----------+    alignItems: 'center',
-----------+  },
-----------+  streakText: {
-----------+    fontSize: 14,
-----------+    fontWeight: 'bold',
-----------+    color: '#FF1493',
-----------+  },
-----------+  streakLabel: {
-----------+    fontSize: 10,
-----------+    color: '#FF1493',
-----------+  },
-----------+  errorText: {
-----------+    color: '#FFF',
-----------+    fontSize: 18,
-----------+    textAlign: 'center',
-----------+    marginTop: 100,
-----------+  },
-----------+});
-----------\ No newline at end of file
-----------diff --git a/frontend/app/heroes.tsx b/frontend/app/heroes.tsx
-----------index aec4168..02fb24d 100644
-------------- a/frontend/app/heroes.tsx
-----------+++ b/frontend/app/heroes.tsx
-----------@@ -31,7 +31,7 @@ const ELEMENT_COLORS: { [key: string]: string } = {
----------- };
----------- 
----------- export default function HeroesScreen() {
------------  const { user, userHeroes, fetchUserHeroes, upgradeHero, isLoading } = useGameStore();
-----------+  const { user, userHeroes, fetchUserHeroes, upgradeHero, updateProfilePicture, isLoading } = useGameStore();
-----------   const [selectedHero, setSelectedHero] = useState<any>(null);
-----------   const [showDetail, setShowDetail] = useState(false);
-----------   const [filterRarity, setFilterRarity] = useState<string | null>(null);
-----------@@ -70,6 +70,18 @@ export default function HeroesScreen() {
-----------     }
-----------   };
----------- 
-----------+  const handleSetProfilePicture = async () => {
-----------+    if (!selectedHero) return;
-----------+
-----------+    try {
-----------+      await updateProfilePicture(selectedHero.hero_data.id);
-----------+      Alert.alert('Success!', `${selectedHero.hero_data.name} is now your profile picture!`);
-----------+      setShowDetail(false);
-----------+    } catch (error: any) {
-----------+      Alert.alert('Error', error.response?.data?.detail || 'Failed to set profile picture');
-----------+    }
-----------+  };
-----------+
-----------   const filteredHeroes = filterRarity
-----------     ? userHeroes.filter((h) => h.hero_data?.rarity === filterRarity)
-----------     : userHeroes;
-----------@@ -308,6 +320,26 @@ export default function HeroesScreen() {
-----------                   </TouchableOpacity>
-----------                 )}
----------- 
-----------+                <TouchableOpacity
-----------+                  style={[
-----------+                    styles.profilePictureButton,
-----------+                    user?.profile_picture_hero_id === selectedHero.hero_data?.id && styles.profilePictureButtonActive
-----------+                  ]}
-----------+                  onPress={handleSetProfilePicture}
-----------+                >
-----------+                  <Ionicons 
-----------+                    name={user?.profile_picture_hero_id === selectedHero.hero_data?.id ? "checkmark-circle" : "person-circle"} 
-----------+                    size={20} 
-----------+                    color={user?.profile_picture_hero_id === selectedHero.hero_data?.id ? "#4CAF50" : "#FFF"} 
-----------+                  />
-----------+                  <Text style={[
-----------+                    styles.profilePictureButtonText,
-----------+                    user?.profile_picture_hero_id === selectedHero.hero_data?.id && styles.profilePictureButtonTextActive
-----------+                  ]}>
-----------+                    {user?.profile_picture_hero_id === selectedHero.hero_data?.id ? "Current Profile Picture" : "Set as Profile Picture"}
-----------+                  </Text>
-----------+                </TouchableOpacity>
-----------+
-----------                 {selectedHero.rank === 10 && (
-----------                   <View style={styles.maxRankBadge}>
-----------                     <Ionicons name="trophy" size={24} color="#FFD700" />
-----------@@ -577,6 +609,27 @@ const styles = StyleSheet.create({
-----------     fontSize: 16,
-----------     fontWeight: 'bold',
-----------   },
-----------+  profilePictureButton: {
-----------+    backgroundColor: '#9C27B0',
-----------+    borderRadius: 8,
-----------+    padding: 12,
-----------+    flexDirection: 'row',
-----------+    alignItems: 'center',
-----------+    justifyContent: 'center',
-----------+    gap: 8,
-----------+    marginTop: 8,
-----------+  },
-----------+  profilePictureButtonActive: {
-----------+    backgroundColor: '#4CAF50',
-----------+  },
-----------+  profilePictureButtonText: {
-----------+    color: '#FFF',
-----------+    fontSize: 14,
-----------+    fontWeight: 'bold',
-----------+  },
-----------+  profilePictureButtonTextActive: {
-----------+    color: '#FFF',
-----------+  },
-----------   noUserText: {
-----------     color: '#fff',
-----------     fontSize: 18,
-----------diff --git a/frontend/app/index.tsx b/frontend/app/index.tsx
-----------index 87fdc2c..fd17c15 100644
-------------- a/frontend/app/index.tsx
-----------+++ b/frontend/app/index.tsx
-----------@@ -153,64 +153,37 @@ export default function HomeScreen() {
-----------           </LinearGradient>
-----------         </TouchableOpacity>
----------- 
------------        <ScrollView contentContainerStyle={styles.content}>
------------          {/* Header with CR */}
------------          <LinearGradient
------------            colors={['#FF6347', '#FF1493', '#8B008B']}
------------            start={{ x: 0, y: 0 }}
------------            end={{ x: 1, y: 1 }}
------------            style={styles.headerCard}
------------          >
------------            <View style={styles.headerTop}>
------------              <View>
------------                <Text style={styles.welcomeText}>Welcome, {user.username}!</Text>
------------                <View style={styles.dayBadge}>
------------                  <Ionicons name="calendar" size={16} color="#FFD700" />
------------                  <Text style={styles.dayText}>Day {user.login_days}</Text>
------------                </View>
------------              </View>
------------              <View style={styles.crBadge}>
------------                <Text style={styles.crLabel}>CR</Text>
------------                <Text style={styles.crValue}>{cr.toLocaleString()}</Text>
------------              </View>
-----------+        {/* Top Header with Welcome and Resources */}
-----------+        <View style={styles.topHeader}>
-----------+          <View style={styles.welcomeSection}>
-----------+            <Text style={styles.compactWelcomeText}>Welcome, {user.username}!</Text>
-----------+            <View style={styles.dayBadgeCompact}>
-----------+              <Ionicons name="calendar" size={12} color="#FFD700" />
-----------+              <Text style={styles.dayTextCompact}>Day {user.login_days}</Text>
-----------+            </View>
-----------+          </View>
-----------+          
-----------+          <View style={styles.resourcesSection}>
-----------+            <View style={styles.compactResource}>
-----------+              <Ionicons name="diamond" size={16} color="#FF1493" />
-----------+              <Text style={styles.compactResourceValue}>{user.gems}</Text>
-----------+            </View>
-----------+            <View style={styles.compactResource}>
-----------+              <Ionicons name="cash" size={16} color="#FFD700" />
-----------+              <Text style={styles.compactResourceValue}>{user.coins}</Text>
-----------+            </View>
-----------+            <View style={styles.compactResource}>
-----------+              <Ionicons name="star" size={16} color="#32CD32" />
-----------+              <Text style={styles.compactResourceValue}>{user.gold}</Text>
-----------+            </View>
-----------+            <View style={styles.compactCR}>
-----------+              <Text style={styles.compactCRLabel}>CR</Text>
-----------+              <Text style={styles.compactCRValue}>{cr.toLocaleString()}</Text>
-----------             </View>
------------          </LinearGradient>
------------
------------          {/* Currency Display */}
------------          <View style={styles.currencyContainer}>
------------            <LinearGradient
------------              colors={['#FF1493', '#FF69B4']}
------------              style={styles.currencyCard}
------------            >
------------              <Ionicons name="diamond" size={32} color="#FFF" />
------------              <View style={styles.currencyInfo}>
------------                <Text style={styles.currencyLabel}>Gems</Text>
------------                <Text style={styles.currencyValue}>{user.gems}</Text>
------------              </View>
------------            </LinearGradient>
------------
------------            <LinearGradient
------------              colors={['#FFD700', '#FFA500']}
------------              style={styles.currencyCard}
------------            >
------------              <Ionicons name="cash" size={32} color="#FFF" />
------------              <View style={styles.currencyInfo}>
------------                <Text style={styles.currencyLabel}>Coins</Text>
------------                <Text style={styles.currencyValue}>{user.coins}</Text>
------------              </View>
------------            </LinearGradient>
------------
------------            <LinearGradient
------------              colors={['#32CD32', '#00CED1']}
------------              style={styles.currencyCard}
------------            >
------------              <Ionicons name="star" size={32} color="#FFF" />
------------              <View style={styles.currencyInfo}>
------------                <Text style={styles.currencyLabel}>Gold</Text>
------------                <Text style={styles.currencyValue}>{user.gold}</Text>
------------              </View>
------------            </LinearGradient>
-----------           </View>
-----------+        </View>
-----------+
-----------+        <ScrollView contentContainerStyle={styles.content}>
----------- 
-----------           {/* Idle Rewards */}
-----------           {idleRewards && idleRewards.gold_earned > 0 && (
-----------@@ -590,4 +563,78 @@ const styles = StyleSheet.create({
-----------   pityFill: {
-----------     height: '100%',
-----------   },
-----------+  topHeader: {
-----------+    flexDirection: 'row',
-----------+    justifyContent: 'space-between',
-----------+    alignItems: 'flex-start',
-----------+    paddingHorizontal: 16,
-----------+    paddingTop: 60,
-----------+    paddingBottom: 12,
-----------+    backgroundColor: 'rgba(255, 255, 255, 0.1)',
-----------+  },
-----------+  welcomeSection: {
-----------+    flex: 1,
-----------+  },
-----------+  compactWelcomeText: {
-----------+    fontSize: 16,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+    textShadowColor: '#000',
-----------+    textShadowOffset: { width: 1, height: 1 },
-----------+    textShadowRadius: 2,
-----------+  },
-----------+  dayBadgeCompact: {
-----------+    flexDirection: 'row',
-----------+    alignItems: 'center',
-----------+    backgroundColor: 'rgba(255, 255, 255, 0.2)',
-----------+    paddingHorizontal: 8,
-----------+    paddingVertical: 4,
-----------+    borderRadius: 12,
-----------+    gap: 4,
-----------+    marginTop: 4,
-----------+    alignSelf: 'flex-start',
-----------+  },
-----------+  dayTextCompact: {
-----------+    color: '#FFD700',
-----------+    fontWeight: 'bold',
-----------+    fontSize: 12,
-----------+  },
-----------+  resourcesSection: {
-----------+    flexDirection: 'row',
-----------+    alignItems: 'center',
-----------+    gap: 8,
-----------+  },
-----------+  compactResource: {
-----------+    flexDirection: 'row',
-----------+    alignItems: 'center',
-----------+    backgroundColor: 'rgba(255, 255, 255, 0.2)',
-----------+    paddingHorizontal: 8,
-----------+    paddingVertical: 4,
-----------+    borderRadius: 12,
-----------+    gap: 4,
-----------+  },
-----------+  compactResourceValue: {
-----------+    color: '#FFF',
-----------+    fontWeight: 'bold',
-----------+    fontSize: 12,
-----------+  },
-----------+  compactCR: {
-----------+    backgroundColor: 'rgba(255, 215, 0, 0.3)',
-----------+    paddingHorizontal: 8,
-----------+    paddingVertical: 4,
-----------+    borderRadius: 12,
-----------+    alignItems: 'center',
-----------+    borderWidth: 1,
-----------+    borderColor: '#FFD700',
-----------+  },
-----------+  compactCRLabel: {
-----------+    fontSize: 10,
-----------+    color: '#FFD700',
-----------+    fontWeight: 'bold',
-----------+  },
-----------+  compactCRValue: {
-----------+    fontSize: 12,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+  },
----------- });
-----------diff --git a/frontend/app/story.tsx b/frontend/app/story.tsx
-----------new file mode 100644
-----------index 0000000..401e8aa
-------------- /dev/null
-----------+++ b/frontend/app/story.tsx
-----------@@ -0,0 +1,60 @@
-----------+import React from 'react';
-----------+import {
-----------+  View,
-----------+  Text,
-----------+  StyleSheet,
-----------+  SafeAreaView,
-----------+} from 'react-native';
-----------+import { LinearGradient } from 'expo-linear-gradient';
-----------+
-----------+export default function StoryScreen() {
-----------+  return (
-----------+    <LinearGradient colors={['#9370DB', '#8B008B', '#FF1493']} style={styles.container}>
-----------+      <SafeAreaView style={styles.container}>
-----------+        <View style={styles.content}>
-----------+          <Text style={styles.title}>ðŸ“– Story Mode</Text>
-----------+          <Text style={styles.subtitle}>Coming Soon!</Text>
-----------+          <Text style={styles.description}>
-----------+            Embark on epic adventures through mystical realms and uncover the secrets of the Divine Heroes.
-----------+          </Text>
-----------+        </View>
-----------+      </SafeAreaView>
-----------+    </LinearGradient>
-----------+  );
-----------+}
-----------+
-----------+const styles = StyleSheet.create({
-----------+  container: {
-----------+    flex: 1,
-----------+  },
-----------+  content: {
-----------+    flex: 1,
-----------+    alignItems: 'center',
-----------+    justifyContent: 'center',
-----------+    padding: 24,
-----------+  },
-----------+  title: {
-----------+    fontSize: 32,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+    textAlign: 'center',
-----------+    marginBottom: 16,
-----------+    textShadowColor: '#000',
-----------+    textShadowOffset: { width: 2, height: 2 },
-----------+    textShadowRadius: 5,
-----------+  },
-----------+  subtitle: {
-----------+    fontSize: 24,
-----------+    color: '#FFF',
-----------+    textAlign: 'center',
-----------+    marginBottom: 24,
-----------+    opacity: 0.9,
-----------+  },
-----------+  description: {
-----------+    fontSize: 16,
-----------+    color: '#FFF',
-----------+    textAlign: 'center',
-----------+    lineHeight: 24,
-----------+    opacity: 0.8,
-----------+  },
-----------+});
-----------\ No newline at end of file
-----------diff --git a/frontend/app/summon-hub.tsx b/frontend/app/summon-hub.tsx
-----------new file mode 100644
-----------index 0000000..743068d
-------------- /dev/null
-----------+++ b/frontend/app/summon-hub.tsx
-----------@@ -0,0 +1,114 @@
-----------+import React from 'react';
-----------+import {
-----------+  View,
-----------+  Text,
-----------+  StyleSheet,
-----------+  SafeAreaView,
-----------+  TouchableOpacity,
-----------+} from 'react-native';
-----------+import { LinearGradient } from 'expo-linear-gradient';
-----------+import { Ionicons } from '@expo/vector-icons';
-----------+import { router } from 'expo-router';
-----------+
-----------+export default function SummonHubScreen() {
-----------+  return (
-----------+    <LinearGradient colors={['#FF1493', '#FF69B4', '#FFB6C1']} style={styles.container}>
-----------+      <SafeAreaView style={styles.container}>
-----------+        <View style={styles.content}>
-----------+          <Text style={styles.title}>ðŸŽ Summon Hub</Text>
-----------+          <Text style={styles.subtitle}>Choose your summoning method</Text>
-----------+          
-----------+          <View style={styles.summonOptions}>
-----------+            <TouchableOpacity 
-----------+              style={styles.summonButton}
-----------+              onPress={() => router.push('/gacha')}
-----------+            >
-----------+              <LinearGradient
-----------+                colors={['#FF1493', '#9400D3']}
-----------+                style={styles.summonButtonGradient}
-----------+              >
-----------+                <Ionicons name="diamond" size={40} color="#FFF" />
-----------+                <Text style={styles.summonButtonTitle}>Gem Summon</Text>
-----------+                <Text style={styles.summonButtonSubtitle}>Premium Heroes</Text>
-----------+              </LinearGradient>
-----------+            </TouchableOpacity>
-----------+
-----------+            <TouchableOpacity 
-----------+              style={styles.summonButton}
-----------+              onPress={() => router.push('/gacha')}
-----------+            >
-----------+              <LinearGradient
-----------+                colors={['#FFD700', '#FFA500']}
-----------+                style={styles.summonButtonGradient}
-----------+              >
-----------+                <Ionicons name="cash" size={40} color="#FFF" />
-----------+                <Text style={styles.summonButtonTitle}>Coin Summon</Text>
-----------+                <Text style={styles.summonButtonSubtitle}>Standard Heroes</Text>
-----------+              </LinearGradient>
-----------+            </TouchableOpacity>
-----------+          </View>
-----------+        </View>
-----------+      </SafeAreaView>
-----------+    </LinearGradient>
-----------+  );
-----------+}
-----------+
-----------+const styles = StyleSheet.create({
-----------+  container: {
-----------+    flex: 1,
-----------+  },
-----------+  content: {
-----------+    flex: 1,
-----------+    alignItems: 'center',
-----------+    justifyContent: 'center',
-----------+    padding: 24,
-----------+  },
-----------+  title: {
-----------+    fontSize: 32,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+    textAlign: 'center',
-----------+    marginBottom: 16,
-----------+    textShadowColor: '#000',
-----------+    textShadowOffset: { width: 2, height: 2 },
-----------+    textShadowRadius: 5,
-----------+  },
-----------+  subtitle: {
-----------+    fontSize: 18,
-----------+    color: '#FFF',
-----------+    textAlign: 'center',
-----------+    marginBottom: 48,
-----------+    opacity: 0.9,
-----------+  },
-----------+  summonOptions: {
-----------+    width: '100%',
-----------+    gap: 24,
-----------+  },
-----------+  summonButton: {
-----------+    borderRadius: 20,
-----------+    overflow: 'hidden',
-----------+    shadowColor: '#000',
-----------+    shadowOffset: { width: 0, height: 4 },
-----------+    shadowOpacity: 0.3,
-----------+    shadowRadius: 8,
-----------+    elevation: 8,
-----------+  },
-----------+  summonButtonGradient: {
-----------+    padding: 32,
-----------+    alignItems: 'center',
-----------+    gap: 8,
-----------+  },
-----------+  summonButtonTitle: {
-----------+    fontSize: 24,
-----------+    fontWeight: 'bold',
-----------+    color: '#FFF',
-----------+    textShadowColor: '#000',
-----------+    textShadowOffset: { width: 1, height: 1 },
-----------+    textShadowRadius: 3,
-----------+  },
-----------+  summonButtonSubtitle: {
-----------+    fontSize: 16,
-----------+    color: '#FFF',
-----------+    opacity: 0.9,
-----------+  },
-----------+});
-----------\ No newline at end of file
-----------diff --git a/frontend/stores/gameStore.ts b/frontend/stores/gameStore.ts
-----------index d7f6ad8..c8f9add 100644
-------------- a/frontend/stores/gameStore.ts
-----------+++ b/frontend/stores/gameStore.ts
-----------@@ -15,6 +15,7 @@ interface User {
-----------   login_days: number;
-----------   last_login: string | null;
-----------   daily_summons_claimed: number;
-----------+  profile_picture_hero_id: string | null;
----------- }
----------- 
----------- interface Hero {
-----------@@ -61,6 +62,7 @@ interface GameState {
-----------   upgradeHero: (heroInstanceId: string) => Promise<void>;
-----------   claimIdleRewards: () => Promise<any>;
-----------   fetchCR: () => Promise<{cr: number; hero_count: number}>;
-----------+  updateProfilePicture: (heroId: string) => Promise<void>;
-----------   setUser: (user: User | null) => void;
----------- }
----------- 
-----------@@ -229,5 +231,24 @@ export const useGameStore = create<GameState>((set, get) => ({
-----------     }
-----------   },
----------- 
-----------+  updateProfilePicture: async (heroId: string) => {
-----------+    const { user } = get();
-----------+    if (!user) throw new Error('No user found');
-----------+    
-----------+    set({ isLoading: true });
-----------+    try {
-----------+      await axios.post(
-----------+        `${BACKEND_URL}/api/user/${user.username}/profile-picture?hero_id=${heroId}`
-----------+      );
-----------+      
-----------+      // Refresh user data
-----------+      await get().fetchUser();
-----------+      set({ isLoading: false });
-----------+    } catch (error: any) {
-----------+      set({ error: error.response?.data?.detail || 'Failed to update profile picture', isLoading: false });
-----------+      throw error;
-----------+    }
-----------+  },
-----------+
-----------   setUser: (user: User | null) => set({ user }),
----------- }));
-----------diff --git a/model.patch b/model.patch
-----------index 22a8d3f..aba9637 100644
-------------- a/model.patch
-----------+++ b/model.patch
-----------@@ -1,627 +0,0 @@
------------diff --git a/model.patch b/model.patch
------------index a2d9ad1..e69de29 100644
--------------- a/model.patch
------------+++ b/model.patch
------------@@ -1,622 +0,0 @@
-------------diff --git a/backend/server.py b/backend/server.py
-------------index 7b0d9be..97ece9d 100644
---------------- a/backend/server.py
-------------+++ b/backend/server.py
-------------@@ -89,6 +89,7 @@ class User(BaseModel):
-------------     gems: int = 300  # Premium currency
-------------     coins: int = 10000  # Regular currency
-------------     gold: int = 5000  # Idle resource
-------------+    friendship_points: int = 0  # Friend currency
-------------     pity_counter: int = 0  # Counts towards guaranteed SSR at 50
-------------     total_pulls: int = 0
-------------     login_days: int = 0
-------------diff --git a/model.patch b/model.patch
-------------index f57a87e..e69de29 100644
---------------- a/model.patch
-------------+++ b/model.patch
-------------@@ -1,605 +0,0 @@
--------------diff --git a/frontend/stores/gameStore.ts b/frontend/stores/gameStore.ts
--------------index 0bacd43..d7f6ad8 100644
----------------- a/frontend/stores/gameStore.ts
--------------+++ b/frontend/stores/gameStore.ts
--------------@@ -214,5 +214,20 @@ export const useGameStore = create<GameState>((set, get) => ({
--------------     }
--------------   },
-------------- 
--------------+  fetchCR: async () => {
--------------+    const { user } = get();
--------------+    if (!user) throw new Error('No user found');
--------------+    
--------------+    try {
--------------+      const response = await axios.get(
--------------+        `${BACKEND_URL}/api/user/${user.username}/cr`
--------------+      );
--------------+      return response.data;
--------------+    } catch (error) {
--------------+      console.error('Failed to fetch CR:', error);
--------------+      return { cr: 0, hero_count: 0 };
--------------+    }
--------------+  },
--------------+
--------------   setUser: (user: User | null) => set({ user }),
-------------- }));
--------------diff --git a/model.patch b/model.patch
--------------index e4c1506..e69de29 100644
----------------- a/model.patch
--------------+++ b/model.patch
--------------@@ -1,575 +0,0 @@
---------------diff --git a/backend/server.py b/backend/server.py
---------------index 91afb59..5356b13 100644
------------------ a/backend/server.py
---------------+++ b/backend/server.py
---------------@@ -568,6 +568,170 @@ async def claim_idle_rewards(username: str):
---------------     
---------------     return IdleRewards(gold_earned=gold_earned, time_away=int(time_away))
--------------- 
---------------+@api_router.get("/user/{username}/cr")
---------------+async def get_character_rating(username: str):
---------------+    """Calculate and return user's Character Rating (CR)"""
---------------+    user = await db.users.find_one({"username": username})
---------------+    if not user:
---------------+        raise HTTPException(status_code=404, detail="User not found")
---------------+    
---------------+    # Get all user heroes
---------------+    user_heroes = await db.user_heroes.find({"user_id": user["id"]}).to_list(1000)
---------------+    
---------------+    total_cr = 0
---------------+    for hero in user_heroes:
---------------+        # CR calculation: HP + (ATK * 2) + DEF + (rank * 500) + (level * 100)
---------------+        hero_cr = (
---------------+            hero["current_hp"] + 
---------------+            (hero["current_atk"] * 2) + 
---------------+            hero["current_def"] + 
---------------+            (hero["rank"] * 500) + 
---------------+            (hero["level"] * 100)
---------------+        )
---------------+        total_cr += hero_cr
---------------+    
---------------+    return {"cr": total_cr, "hero_count": len(user_heroes)}
---------------+
---------------+@api_router.get("/story/islands")
---------------+async def get_islands():
---------------+    """Get all story islands"""
---------------+    islands = await db.islands.find().sort("order", 1).to_list(100)
---------------+    return [convert_objectid(island) for island in islands]
---------------+
---------------+@api_router.get("/story/chapters")
---------------+async def get_all_chapters():
---------------+    """Get all story chapters"""
---------------+    chapters = await db.chapters.find().sort("chapter_number", 1).to_list(100)
---------------+    return [convert_objectid(chapter) for chapter in chapters]
---------------+
---------------+@api_router.get("/story/progress/{username}")
---------------+async def get_user_progress(username: str):
---------------+    """Get user's story progress"""
---------------+    user = await db.users.find_one({"username": username})
---------------+    if not user:
---------------+        raise HTTPException(status_code=404, detail="User not found")
---------------+    
---------------+    progress = await db.user_progress.find_one({"user_id": user["id"]})
---------------+    if not progress:
---------------+        # Create initial progress
---------------+        progress = UserProgress(user_id=user["id"])
---------------+        await db.user_progress.insert_one(progress.dict())
---------------+        progress = await db.user_progress.find_one({"user_id": user["id"]})
---------------+    
---------------+    return convert_objectid(progress)
---------------+
---------------+@api_router.post("/story/battle/{username}/{chapter_number}")
---------------+async def battle_chapter(username: str, chapter_number: int):
---------------+    """Battle a story chapter - server-side combat simulation"""
---------------+    user = await db.users.find_one({"username": username})
---------------+    if not user:
---------------+        raise HTTPException(status_code=404, detail="User not found")
---------------+    
---------------+    # Get user progress
---------------+    progress = await db.user_progress.find_one({"user_id": user["id"]})
---------------+    if not progress:
---------------+        progress = UserProgress(user_id=user["id"])
---------------+        await db.user_progress.insert_one(progress.dict())
---------------+    
---------------+    # Check if chapter is unlocked (previous chapter must be completed)
---------------+    if chapter_number > 1 and (chapter_number - 1) not in progress.get("completed_chapters", []):
---------------+        raise HTTPException(status_code=400, detail="Previous chapter must be completed first")
---------------+    
---------------+    # Get chapter data
---------------+    chapter = await db.chapters.find_one({"chapter_number": chapter_number})
---------------+    if not chapter:
---------------+        raise HTTPException(status_code=404, detail="Chapter not found")
---------------+    
---------------+    # Calculate user's team power (CR)
---------------+    user_heroes = await db.user_heroes.find({"user_id": user["id"]}).to_list(1000)
---------------+    
---------------+    # Get user's active team or use top 6 heroes by power
---------------+    team = await db.teams.find_one({"user_id": user["id"], "is_active": True})
---------------+    if team and team.get("hero_ids"):
---------------+        team_heroes = [h for h in user_heroes if h["id"] in team["hero_ids"]]
---------------+    else:
---------------+        # Use top 6 heroes by power
---------------+        team_heroes = sorted(
---------------+            user_heroes, 
---------------+            key=lambda h: h["current_hp"] + h["current_atk"] * 2 + h["current_def"],
---------------+            reverse=True
---------------+        )[:6]
---------------+    
---------------+    if not team_heroes:
---------------+        raise HTTPException(status_code=400, detail="You need at least 1 hero to battle")
---------------+    
---------------+    # Calculate team power
---------------+    user_power = sum(
---------------+        h["current_hp"] + (h["current_atk"] * 2) + h["current_def"] 
---------------+        for h in team_heroes
---------------+    )
---------------+    
---------------+    enemy_power = chapter["enemy_power"]
---------------+    
---------------+    # Combat simulation with RNG
---------------+    power_ratio = user_power / enemy_power
---------------+    
---------------+    # Base win chance based on power ratio
---------------+    # At equal power (1.0 ratio): 50% win chance
---------------+    # At 1.5x power: ~85% win chance
---------------+    # At 0.7x power: ~15% win chance (F2P struggle point)
---------------+    base_win_chance = min(0.95, max(0.05, 0.5 + (power_ratio - 1.0) * 0.7))
---------------+    
---------------+    # Add some RNG
---------------+    import random
---------------+    roll = random.random()
---------------+    victory = roll < base_win_chance
---------------+    
---------------+    # Calculate damage
---------------+    if victory:
---------------+        damage_dealt = int(enemy_power * 0.9)
---------------+        damage_taken = int(user_power * random.uniform(0.2, 0.4))
---------------+    else:
---------------+        damage_dealt = int(enemy_power * random.uniform(0.4, 0.7))
---------------+        damage_taken = int(user_power * random.uniform(0.6, 0.9))
---------------+    
---------------+    rewards = {}
---------------+    if victory:
---------------+        # Check if first clear
---------------+        is_first_clear = chapter_number not in progress.get("completed_chapters", [])
---------------+        
---------------+        # Give rewards
---------------+        rewards = chapter["rewards"].copy()
---------------+        if is_first_clear:
---------------+            # Add first clear bonus
---------------+            for key, value in chapter["first_clear_bonus"].items():
---------------+                rewards[key] = rewards.get(key, 0) + value
---------------+        
---------------+        # Update user resources
---------------+        update_dict = {}
---------------+        if "gems" in rewards:
---------------+            update_dict["gems"] = user.get("gems", 0) + rewards["gems"]
---------------+        if "coins" in rewards:
---------------+            update_dict["coins"] = user.get("coins", 0) + rewards["coins"]
---------------+        if "gold" in rewards:
---------------+            update_dict["gold"] = user.get("gold", 0) + rewards["gold"]
---------------+        
---------------+        await db.users.update_one({"username": username}, {"$set": update_dict})
---------------+        
---------------+        # Update progress
---------------+        if is_first_clear:
---------------+            await db.user_progress.update_one(
---------------+                {"user_id": user["id"]},
---------------+                {
---------------+                    "$addToSet": {"completed_chapters": chapter_number},
---------------+                    "$set": {"current_chapter": max(progress.get("current_chapter", 1), chapter_number + 1)}
---------------+                }
---------------+            )
---------------+    
---------------+    return BattleResult(
---------------+        victory=victory,
---------------+        rewards=rewards,
---------------+        user_power=user_power,
---------------+        enemy_power=enemy_power,
---------------+        damage_dealt=damage_dealt,
---------------+        damage_taken=damage_taken
---------------+    )
---------------+
--------------- @api_router.get("/")
--------------- async def root():
---------------     return {"message": "Gacha Game API", "version": "1.0"}
---------------diff --git a/model.patch b/model.patch
---------------index 58dcdcd..582a2ba 100644
------------------ a/model.patch
---------------+++ b/model.patch
---------------@@ -1,395 +0,0 @@
----------------diff --git a/backend/server.py b/backend/server.py
----------------index 1b7777c..4cf8b41 100644
------------------- a/backend/server.py
----------------+++ b/backend/server.py
----------------@@ -12,6 +12,20 @@ from datetime import datetime, timedelta
---------------- import random
---------------- from bson import ObjectId
---------------- 
----------------+def convert_objectid(obj):
----------------+    """Convert ObjectId to string in MongoDB documents"""
----------------+    if isinstance(obj, dict):
----------------+        for key, value in obj.items():
----------------+            if isinstance(value, ObjectId):
----------------+                obj[key] = str(value)
----------------+            elif isinstance(value, dict):
----------------+                convert_objectid(value)
----------------+            elif isinstance(value, list):
----------------+                for item in value:
----------------+                    if isinstance(item, dict):
----------------+                        convert_objectid(item)
----------------+    return obj
----------------+
---------------- ROOT_DIR = Path(__file__).parent
---------------- load_dotenv(ROOT_DIR / '.env')
---------------- 
----------------@@ -212,7 +226,7 @@ async def get_user(username: str):
----------------     user = await db.users.find_one({"username": username})
----------------     if not user:
----------------         raise HTTPException(status_code=404, detail="User not found")
-----------------    return user
----------------+    return convert_objectid(user)
---------------- 
---------------- @api_router.post("/user/{username}/login")
---------------- async def user_login(username: str):
----------------@@ -347,7 +361,7 @@ async def pull_gacha(username: str, request: PullRequest):
---------------- async def get_all_heroes():
----------------     """Get all available heroes in the pool"""
----------------     heroes = await db.heroes.find().to_list(1000)
-----------------    return heroes
----------------+    return [convert_objectid(hero) for hero in heroes]
---------------- 
---------------- @api_router.get("/user/{username}/heroes")
---------------- async def get_user_heroes(username: str):
----------------@@ -364,8 +378,8 @@ async def get_user_heroes(username: str):
----------------         hero_data = await db.heroes.find_one({"id": uh["hero_id"]})
----------------         if hero_data:
----------------             enriched_heroes.append({
-----------------                **uh,
-----------------                "hero_data": hero_data
----------------+                **convert_objectid(uh),
----------------+                "hero_data": convert_objectid(hero_data)
----------------             })
----------------     
----------------     return enriched_heroes
----------------@@ -409,7 +423,7 @@ async def upgrade_hero(username: str, hero_instance_id: str):
----------------     )
----------------     
----------------     updated_hero = await db.user_heroes.find_one({"id": hero_instance_id})
-----------------    return updated_hero
----------------+    return convert_objectid(updated_hero)
---------------- 
---------------- @api_router.post("/team/create")
---------------- async def create_team(username: str, team_name: str):
----------------@@ -430,7 +444,7 @@ async def get_user_teams(username: str):
----------------         raise HTTPException(status_code=404, detail="User not found")
----------------     
----------------     teams = await db.teams.find({"user_id": user["id"]}).to_list(100)
-----------------    return teams
----------------+    return [convert_objectid(team) for team in teams]
---------------- 
---------------- @api_router.put("/team/{team_id}/heroes")
---------------- async def update_team_heroes(team_id: str, hero_ids: List[str]):
----------------@@ -444,7 +458,7 @@ async def update_team_heroes(team_id: str, hero_ids: List[str]):
----------------     )
----------------     
----------------     updated_team = await db.teams.find_one({"id": team_id})
-----------------    return updated_team
----------------+    return convert_objectid(updated_team)
---------------- 
---------------- @api_router.post("/idle/claim")
---------------- async def claim_idle_rewards(username: str):
----------------diff --git a/final_backend_test.py b/final_backend_test.py
----------------new file mode 100644
----------------index 0000000..f4976ca
------------------- /dev/null
----------------+++ b/final_backend_test.py
----------------@@ -0,0 +1,254 @@
----------------+#!/usr/bin/env python3
----------------+"""
----------------+Final Comprehensive Backend API Test for Gacha Game
----------------+Tests all endpoints with a fresh user to ensure full functionality
----------------+"""
----------------+
----------------+import requests
----------------+import json
----------------+import time
----------------+from datetime import datetime
----------------+import sys
----------------+import random
----------------+
----------------+# Configuration
----------------+BASE_URL = "https://angels-and-demons.preview.emergentagent.com/api"
----------------+TEST_USERNAME = f"testuser_{random.randint(1000, 9999)}"
----------------+
----------------+class ComprehensiveGachaTest:
----------------+    def __init__(self):
----------------+        self.base_url = BASE_URL
----------------+        self.username = TEST_USERNAME
----------------+        self.user_data = None
----------------+        self.user_heroes = []
----------------+        self.teams = []
----------------+        self.test_results = {
----------------+            "passed": 0,
----------------+            "failed": 0,
----------------+            "errors": []
----------------+        }
----------------+    
----------------+    def log_result(self, test_name, success, message=""):
----------------+        """Log test result"""
----------------+        status = "âœ… PASS" if success else "âŒ FAIL"
----------------+        print(f"{status}: {test_name}")
----------------+        if message:
----------------+            print(f"   {message}")
----------------+        
----------------+        if success:
----------------+            self.test_results["passed"] += 1
----------------+        else:
----------------+            self.test_results["failed"] += 1
----------------+            self.test_results["errors"].append(f"{test_name}: {message}")
----------------+    
----------------+    def make_request(self, method, endpoint, **kwargs):
----------------+        """Make HTTP request with error handling"""
----------------+        url = f"{self.base_url}{endpoint}"
----------------+        try:
----------------+            response = requests.request(method, url, timeout=30, **kwargs)
----------------+            return response
----------------+        except requests.exceptions.RequestException as e:
----------------+            print(f"âŒ Request failed: {e}")
----------------+            return None
----------------+    
----------------+    def test_complete_flow(self):
----------------+        """Test the complete gacha game flow"""
----------------+        print(f"\nðŸš€ Testing Complete Gacha Game Flow with user: {self.username}")
----------------+        print("=" * 70)
----------------+        
----------------+        # 1. User Registration
----------------+        print("\n1ï¸âƒ£ Testing User Registration...")
----------------+        response = self.make_request("POST", f"/user/register?username={self.username}")
----------------+        if response and response.status_code == 200:
----------------+            self.user_data = response.json()
----------------+            self.log_result("User Registration", True, 
----------------+                          f"User created with {self.user_data['gems']} gems, {self.user_data['coins']} coins")
----------------+        else:
----------------+            self.log_result("User Registration", False, f"Failed: {response.status_code if response else 'No response'}")
----------------+            return False
----------------+        
----------------+        # 2. Get All Heroes
----------------+        print("\n2ï¸âƒ£ Testing Hero Pool...")
----------------+        response = self.make_request("GET", "/heroes")
----------------+        if response and response.status_code == 200:
----------------+            heroes = response.json()
----------------+            self.log_result("Get Heroes Pool", True, f"Retrieved {len(heroes)} heroes")
----------------+        else:
----------------+            self.log_result("Get Heroes Pool", False, "Failed to get heroes")
----------------+            return False
----------------+        
----------------+        # 3. Daily Login
----------------+        print("\n3ï¸âƒ£ Testing Daily Login...")
----------------+        response = self.make_request("POST", f"/user/{self.username}/login")
----------------+        if response and response.status_code == 200:
----------------+            rewards = response.json()
----------------+            self.log_result("Daily Login", True, f"Received {rewards['coins']} coins, {rewards['gold']} gold")
----------------+        else:
----------------+            self.log_result("Daily Login", False, "Failed")
----------------+        
----------------+        # 4. Gacha Pulls - Test all types
----------------+        print("\n4ï¸âƒ£ Testing Gacha System...")
----------------+        
----------------+        # Single pull with gems
----------------+        pull_data = {"pull_type": "single", "currency_type": "gems"}
----------------+        response = self.make_request("POST", f"/gacha/pull?username={self.username}", json=pull_data)
----------------+        if response and response.status_code == 200:
----------------+            result = response.json()
----------------+            self.log_result("Single Pull (Gems)", True, 
----------------+                          f"Pulled {len(result['heroes'])} hero, pity: {result['new_pity_counter']}")
----------------+        else:
----------------+            self.log_result("Single Pull (Gems)", False, f"Failed: {response.text if response else 'No response'}")
----------------+        
----------------+        # Multi pull with gems
----------------+        pull_data = {"pull_type": "multi", "currency_type": "gems"}
----------------+        response = self.make_request("POST", f"/gacha/pull?username={self.username}", json=pull_data)
----------------+        if response and response.status_code == 200:
----------------+            result = response.json()
----------------+            self.log_result("Multi Pull (Gems)", True, 
----------------+                          f"Pulled {len(result['heroes'])} heroes, pity: {result['new_pity_counter']}")
----------------+        else:
----------------+            self.log_result("Multi Pull (Gems)", False, f"Failed: {response.text if response else 'No response'}")
----------------+        
----------------+        # Single pull with coins
----------------+        pull_data = {"pull_type": "single", "currency_type": "coins"}
----------------+        response = self.make_request("POST", f"/gacha/pull?username={self.username}", json=pull_data)
----------------+        if response and response.status_code == 200:
----------------+            result = response.json()
----------------+            self.log_result("Single Pull (Coins)", True, 
----------------+                          f"Pulled {len(result['heroes'])} hero")
----------------+        else:
----------------+            self.log_result("Single Pull (Coins)", False, f"Failed: {response.text if response else 'No response'}")
----------------+        
----------------+        # Multi pull with coins
----------------+        pull_data = {"pull_type": "multi", "currency_type": "coins"}
----------------+        response = self.make_request("POST", f"/gacha/pull?username={self.username}", json=pull_data)
----------------+        if response and response.status_code == 200:
----------------+            result = response.json()
----------------+            self.log_result("Multi Pull (Coins)", True, 
----------------+                          f"Pulled {len(result['heroes'])} heroes")
----------------+        else:
----------------+            self.log_result("Multi Pull (Coins)", False, f"Failed: {response.text if response else 'No response'}")
----------------+        
----------------+        # 5. Get User Heroes
----------------+        print("\n5ï¸âƒ£ Testing Hero Collection...")
----------------+        response = self.make_request("GET", f"/user/{self.username}/heroes")
----------------+        if response and response.status_code == 200:
----------------+            self.user_heroes = response.json()
----------------+            self.log_result("Get User Heroes", True, f"User has {len(self.user_heroes)} heroes")
----------------+        else:
----------------+            self.log_result("Get User Heroes", False, "Failed")
----------------+        
----------------+        # 6. Team Management
----------------+        print("\n6ï¸âƒ£ Testing Team Management...")
----------------+        
----------------+        # Create team
----------------+        response = self.make_request("POST", f"/team/create?username={self.username}&team_name=MainTeam")
----------------+        if response and response.status_code == 200:
----------------+            team = response.json()
----------------+            self.log_result("Create Team", True, f"Created team: {team['name']}")
----------------+            team_id = team['id']
----------------+        else:
----------------+            self.log_result("Create Team", False, "Failed")
----------------+            return False
----------------+        
----------------+        # Get teams
----------------+        response = self.make_request("GET", f"/team/{self.username}")
----------------+        if response and response.status_code == 200:
----------------+            self.teams = response.json()
----------------+            self.log_result("Get Teams", True, f"User has {len(self.teams)} teams")
----------------+        else:
----------------+            self.log_result("Get Teams", False, "Failed")
----------------+        
----------------+        # Update team with heroes (if we have any)
----------------+        if self.user_heroes and len(self.user_heroes) > 0:
----------------+            hero_ids = [hero['id'] for hero in self.user_heroes[:6]]  # Max 6 heroes
----------------+            response = self.make_request("PUT", f"/team/{team_id}/heroes", json=hero_ids)
----------------+            if response and response.status_code == 200:
----------------+                self.log_result("Update Team Heroes", True, f"Added {len(hero_ids)} heroes to team")
----------------+            else:
----------------+                self.log_result("Update Team Heroes", False, "Failed")
----------------+        
----------------+        # 7. Hero Upgrade (if possible)
----------------+        print("\n7ï¸âƒ£ Testing Hero Upgrade...")
----------------+        if self.user_heroes:
----------------+            # Find a hero with duplicates (unlikely for new account)
----------------+            hero_to_upgrade = None
----------------+            for hero in self.user_heroes:
----------------+                if hero.get("duplicates", 0) >= 2:
----------------+                    hero_to_upgrade = hero
----------------+                    break
----------------+            
----------------+            if hero_to_upgrade:
----------------+                response = self.make_request("POST", f"/user/{self.username}/heroes/{hero_to_upgrade['id']}/upgrade")
----------------+                if response and response.status_code == 200:
----------------+                    self.log_result("Hero Upgrade", True, "Hero upgraded successfully")
----------------+                else:
----------------+                    self.log_result("Hero Upgrade", False, f"Failed: {response.text if response else 'No response'}")
----------------+            else:
----------------+                self.log_result("Hero Upgrade", True, "No heroes with sufficient duplicates (expected)")
----------------+        
----------------+        # 8. Idle Rewards
----------------+        print("\n8ï¸âƒ£ Testing Idle Rewards...")
----------------+        response = self.make_request("POST", f"/idle/claim?username={self.username}")
----------------+        if response and response.status_code == 200:
----------------+            rewards = response.json()
----------------+            self.log_result("Idle Rewards", True, f"Claimed {rewards['gold_earned']} gold")
----------------+        else:
----------------+            self.log_result("Idle Rewards", False, "Failed")
----------------+        
----------------+        # 9. Test insufficient funds
----------------+        print("\n9ï¸âƒ£ Testing Error Handling...")
----------------+        # Try to pull when out of gems
----------------+        for _ in range(10):  # Exhaust gems
----------------+            pull_data = {"pull_type": "multi", "currency_type": "gems"}
----------------+            response = self.make_request("POST", f"/gacha/pull?username={self.username}", json=pull_data)
----------------+            if response and response.status_code == 400:
----------------+                self.log_result("Insufficient Funds Error", True, "Correctly rejected pull with insufficient gems")
----------------+                break
----------------+        else:
----------------+            self.log_result("Insufficient Funds Error", False, "Did not properly handle insufficient funds")
----------------+        
----------------+        # 10. Final user state
----------------+        print("\nðŸ”Ÿ Final User State...")
----------------+        response = self.make_request("GET", f"/user/{self.username}")
----------------+        if response and response.status_code == 200:
----------------+            final_user = response.json()
----------------+            self.log_result("Final User State", True, 
----------------+                          f"Gems: {final_user['gems']}, Coins: {final_user['coins']}, Gold: {final_user['gold']}, Pulls: {final_user['total_pulls']}")
----------------+        else:
----------------+            self.log_result("Final User State", False, "Failed")
----------------+        
----------------+        return True
----------------+    
----------------+    def run_test(self):
----------------+        """Run the comprehensive test"""
----------------+        success = self.test_complete_flow()
----------------+        
----------------+        # Print summary
----------------+        print("\n" + "=" * 70)
----------------+        print("ðŸ COMPREHENSIVE TEST SUMMARY")
----------------+        print("=" * 70)
----------------+        print(f"âœ… Passed: {self.test_results['passed']}")
----------------+        print(f"âŒ Failed: {self.test_results['failed']}")
----------------+        
----------------+        if self.test_results["errors"]:
----------------+            print("\nðŸ” FAILED TESTS:")
----------------+            for error in self.test_results["errors"]:
----------------+                print(f"  â€¢ {error}")
----------------+        
----------------+        success_rate = (self.test_results["passed"] / 
----------------+                       (self.test_results["passed"] + self.test_results["failed"])) * 100
----------------+        print(f"\nðŸ“Š Success Rate: {success_rate:.1f}%")
----------------+        
----------------+        return self.test_results["failed"] == 0
----------------+
----------------+if __name__ == "__main__":
----------------+    tester = ComprehensiveGachaTest()
----------------+    success = tester.run_test()
----------------+    
----------------+    if success:
----------------+        print("\nðŸŽ‰ All tests passed! Backend is fully functional!")
----------------+        sys.exit(0)
----------------+    else:
----------------+        print("\nðŸ’¥ Some tests failed!")
----------------+        sys.exit(1)
----------------\ No newline at end of file
----------------diff --git a/quick_test.py b/quick_test.py
----------------new file mode 100644
----------------index 0000000..2dbe9e1
------------------- /dev/null
----------------+++ b/quick_test.py
----------------@@ -0,0 +1,46 @@
----------------+#!/usr/bin/env python3
----------------+"""
----------------+Quick Backend API Status Check
----------------+"""
----------------+
----------------+import requests
----------------+import json
----------------+
----------------+BASE_URL = "https://angels-and-demons.preview.emergentagent.com/api"
----------------+TEST_USERNAME = "testplayer"
----------------+
----------------+def test_endpoint(method, endpoint, **kwargs):
----------------+    """Test a single endpoint"""
----------------+    url = f"{BASE_URL}{endpoint}"
----------------+    try:
----------------+        response = requests.request(method, url, timeout=10, **kwargs)
----------------+        return response.status_code, response.text[:200]
----------------+    except Exception as e:
----------------+        return None, str(e)
----------------+
----------------+print("ðŸ” Quick Backend API Status Check")
----------------+print("=" * 50)
----------------+
----------------+# Test basic endpoints
----------------+endpoints = [
----------------+    ("GET", "/", {}),
----------------+    ("POST", f"/user/register?username=testuser2", {}),
----------------+    ("GET", f"/user/{TEST_USERNAME}", {}),
----------------+    ("POST", f"/user/{TEST_USERNAME}/login", {}),
----------------+    ("GET", "/heroes", {}),
----------------+    ("GET", f"/user/{TEST_USERNAME}/heroes", {}),
----------------+    ("POST", f"/gacha/pull?username={TEST_USERNAME}", {"json": {"pull_type": "single", "currency_type": "gems"}}),
----------------+    ("POST", f"/team/create?username={TEST_USERNAME}&team_name=TestTeam2", {}),
----------------+    ("GET", f"/team/{TEST_USERNAME}", {}),
----------------+    ("POST", f"/idle/claim?username={TEST_USERNAME}", {})
----------------+]
----------------+
----------------+for method, endpoint, kwargs in endpoints:
----------------+    status, response = test_endpoint(method, endpoint, **kwargs)
----------------+    status_icon = "âœ…" if status == 200 else "âŒ" if status else "ðŸ’¥"
----------------+    print(f"{status_icon} {method} {endpoint}: {status} - {response}")
----------------+
----------------+print("\nðŸ” Analysis:")
----------------+print("- 520 errors indicate ObjectId serialization issues in backend")
----------------+print("- Some endpoints work (registration, login, idle) - these don't return MongoDB docs")
----------------+print("- Endpoints that return MongoDB docs fail (get user, heroes, teams)")
----------------\ No newline at end of file
--diff --git a/test_result.md b/test_result.md
--index 4b3c191..17d5ea7 100644
----- a/test_result.md
--+++ b/test_result.md
--@@ -107,75 +107,129 @@ user_problem_statement: "Build an idle gacha game with strategic team building,
-- backend:
--   - task: "User registration and authentication"
--     implemented: true
---    working: "NA"
--+    working: true
--     file: "/app/backend/server.py"
--     stuck_count: 0
--     priority: "high"
---    needs_retesting: true
--+    needs_retesting: false
--     status_history:
--       - working: "NA"
--         agent: "main"
--         comment: "Implemented user registration endpoint with username-based system. Users get initial resources (300 gems, 10000 coins, 5000 gold)."
--+      - working: true
--+        agent: "testing"
--+        comment: "âœ… TESTED: User registration, profile retrieval, and daily login all working correctly. Users receive 300 crystals, 10000 coins, 5000 gold on registration. Daily login provides 1000 coins, 500 gold, and crystals on milestones."
-- 
--   - task: "Gacha pull system with pity mechanics"
--     implemented: true
---    working: "NA"
--+    working: true
--     file: "/app/backend/server.py"
--     stuck_count: 0
--     priority: "high"
---    needs_retesting: true
--+    needs_retesting: false
--     status_history:
--       - working: "NA"
--         agent: "main"
--         comment: "Implemented gacha pull endpoint with single/multi pulls, dual currency support (gems/coins), 50-pull pity system guaranteeing SSR. Pull rates: SR 60%, SSR 30%, UR 9%, UR+ 1%."
--+      - working: true
--+        agent: "testing"
--+        comment: "âœ… TESTED: Gacha system working correctly. Single/multi pulls with crystals and coins work. Pity counter increments properly. API uses 'crystals' not 'gems' as currency name."
-- 
--   - task: "Hero management and collection"
--     implemented: true
---    working: "NA"
--+    working: true
--     file: "/app/backend/server.py"
--     stuck_count: 0
--     priority: "high"
---    needs_retesting: true
--+    needs_retesting: false
--     status_history:
--       - working: "NA"
--         agent: "main"
--         comment: "Implemented hero pool initialization with 8 heroes across 4 rarities. User hero instances track level, rank (1-10), duplicates, and stats."
--+      - working: true
--+        agent: "testing"
--+        comment: "âœ… TESTED: Hero pool retrieval works (8 heroes available). User hero collection and character rating calculation working. Hero upgrade system correctly rejects upgrades without sufficient duplicates."
-- 
--   - task: "Hero upgrade/rank up system"
--     implemented: true
---    working: "NA"
--+    working: true
--     file: "/app/backend/server.py"
--     stuck_count: 0
--     priority: "high"
---    needs_retesting: true
--+    needs_retesting: false
--     status_history:
--       - working: "NA"
--         agent: "main"
--         comment: "Implemented hero rank up system requiring duplicates (rank * 2). Each rank increases stats by 15%. Max rank is 10."
--+      - working: true
--+        agent: "testing"
--+        comment: "âœ… TESTED: Hero upgrade system working correctly. Properly validates duplicate requirements and rejects upgrades when insufficient duplicates available."
-- 
--   - task: "Daily login rewards and idle resource generation"
--     implemented: true
---    working: "NA"
--+    working: true
--     file: "/app/backend/server.py"
--     stuck_count: 0
--     priority: "medium"
---    needs_retesting: true
--+    needs_retesting: false
--     status_history:
--       - working: "NA"
--         agent: "main"
--         comment: "Implemented daily login rewards (coins, gold, gems on week milestones, 10-15 free summons per day). Idle gold generation at 100 gold/minute, capped at 8 hours."
--+      - working: true
--+        agent: "testing"
--+        comment: "âœ… TESTED: Daily login rewards working (1000 coins, 500 gold per day). Idle system working with VIP-based caps. Idle status and claim endpoints functional."
-- 
--   - task: "Team management system"
--     implemented: true
---    working: "NA"
--+    working: true
--     file: "/app/backend/server.py"
--     stuck_count: 0
--     priority: "medium"
---    needs_retesting: true
--+    needs_retesting: false
--     status_history:
--       - working: "NA"
--         agent: "main"
--         comment: "Implemented team creation and hero assignment endpoints. Teams support up to 6 heroes."
--+      - working: true
--+        agent: "testing"
--+        comment: "âœ… TESTED: Team management working correctly. Team creation, retrieval, and hero assignment all functional. Supports up to 6 heroes per team."
--+
--+  - task: "VIP system and store integration"
--+    implemented: true
--+    working: true
--+    file: "/app/backend/server.py"
--+    stuck_count: 0
--+    priority: "medium"
--+    needs_retesting: false
--+    status_history:
--+      - working: true
--+        agent: "testing"
--+        comment: "âœ… TESTED: VIP system fully functional. VIP info, comparison, and crystal store working. Purchase simulation works correctly with first-purchase bonuses."
--+
--+  - task: "Leaderboard systems"
--+    implemented: true
--+    working: true
--+    file: "/app/backend/server.py"
--+    stuck_count: 0
--+    priority: "medium"
--+    needs_retesting: false
--+    status_history:
--+      - working: true
--+        agent: "testing"
--+        comment: "âœ… TESTED: All leaderboards (CR, Arena, Abyss) working correctly and returning data."
--+
--+  - task: "Arena and Abyss battle systems"
--+    implemented: true
--+    working: false
--+    file: "/app/backend/server.py"
--+    stuck_count: 1
--+    priority: "medium"
--+    needs_retesting: false
--+    status_history:
--+      - working: false
--+        agent: "testing"
--+        comment: "âŒ ISSUE: Arena and Abyss battle endpoints exist but have parameter format issues. Arena record and Abyss progress endpoints work correctly, but battle endpoints fail due to incorrect request format expectations."
-- 
-- frontend:
--   - task: "Navigation structure with tabs"
--@@ -282,4 +336,6 @@ agent_communication:
--   - agent: "main"
--     message: "Phase 1 MVP implementation complete. All core backend endpoints implemented including user registration, gacha system with pity, hero management, rank up, daily rewards, idle generation, and team management. Frontend has complete UI with 5 screens (Home, Gacha, Heroes, Team, Profile) with tab navigation. Ready for backend testing."
--   - agent: "main"
---    message: "Stability check performed: Backend is running and serving requests (200 OK responses observed). Frontend is running and viewable - confirmed via screenshot showing login screen and post-login dashboard. Ready for comprehensive backend testing before adding Store/VIP/Chat/Leaderboard UI features."
--\ No newline at end of file
--+    message: "Stability check performed: Backend is running and serving requests (200 OK responses observed). Frontend is running and viewable - confirmed via screenshot showing login screen and post-login dashboard. Ready for comprehensive backend testing before adding Store/VIP/Chat/Leaderboard UI features."
--+  - agent: "testing"
--+    message: "âœ… BACKEND TESTING COMPLETE: Comprehensive testing performed on all major endpoints. 19/22 tests passed (86.4% success rate). Core functionality working: user auth, gacha system, hero management, VIP system, store, idle system, leaderboards. Minor issues: Arena/Abyss battle endpoints have parameter format problems but core systems functional."
--\ No newline at end of file
