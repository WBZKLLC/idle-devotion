{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":11,"column":0,"index":327},"end":{"line":11,"column":33,"index":360}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"../lib/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":12,"column":0,"index":361},"end":{"line":12,"column":71,"index":432}}],"key":"cGGbCGri3M695PzY+v7ylQ+Rxt0=","exportNames":["*"],"imports":1}},{"name":"../lib/entitlements/types","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0,"index":433},"end":{"line":21,"column":35,"index":669}}],"key":"W08TkULB6K5ayFSZK0DQ51a7f14=","exportNames":["*"],"imports":1}},{"name":"../lib/entitlements/legacy","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":670},"end":{"line":26,"column":36,"index":779}}],"key":"+rKOnoh7xdxUkJQypQ3SMN7jDOc=","exportNames":["*"],"imports":1}},{"name":"../lib/api","data":{"asyncType":"async","isESMImport":true,"locs":[{"start":{"line":38,"column":22,"index":1270},"end":{"line":38,"column":42,"index":1290}}],"key":"qv6pIAfHV5HK/E8UlfJgciwW1c8=","exportNames":["*"],"imports":1}},{"name":"expo/internal/async-require-module","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":38,"column":16,"index":1264},"end":{"line":38,"column":42,"index":1290}}],"key":"y8mhXL4zKvSVvgnacXXOn0UU+QQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"useEntitlementStore\", {\n    enumerable: true,\n    get: function () {\n      return useEntitlementStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var _libStorage = require(_dependencyMap[1], \"../lib/storage\");\n  var _libEntitlementsTypes = require(_dependencyMap[2], \"../lib/entitlements/types\");\n  var _libEntitlementsLegacy = require(_dependencyMap[3], \"../lib/entitlements/legacy\");\n  /**\n   * Entitlement Store - Server Truth Model\n   * \n   * STRICT INVARIANTS:\n   * - Store NEVER grants entitlements - only server can grant\n   * - Store caches server snapshots for UX (offline/fast reads)\n   * - All reads go through gating helpers, not direct store access\n   * - Refresh from server on: startup, post-purchase, manual\n   */\n\n  // Debug logging helpers\n  const dlog = (...args) => {\n    if (__DEV__) console.log(...args);\n  };\n  const STORAGE_KEY = '@idledevotion/entitlements/v4';\n  const LEGACY_STORAGE_KEY = '@idledevotion/entitlements/v3';\n\n  // API import (lazy to avoid circular deps at module load)\n  let _getEntitlementsSnapshot = null;\n  async function getEntitlementsSnapshotApi() {\n    if (!_getEntitlementsSnapshot) {\n      const api = await require(_dependencyMap[5], \"expo/internal/async-require-module\")(_dependencyMap[4], _dependencyMap.paths, \"../lib/api\");\n      _getEntitlementsSnapshot = api.getEntitlementsSnapshot;\n    }\n    return _getEntitlementsSnapshot();\n  }\n  const useEntitlementStore = (0, _zustand.create)((set, get) => ({\n    snapshot: null,\n    entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n    lastRefreshAt: null,\n    isRefreshing: false,\n    refreshError: null,\n    /**\n     * Hydrate from cached snapshot on app startup\n     * Does NOT grant - only restores last known server state\n     */\n    hydrateEntitlements: async () => {\n      dlog('[entitlementStore] Hydrating from cache...');\n      try {\n        // Try to load cached snapshot\n        const cached = await (0, _libStorage.storageGet)(STORAGE_KEY);\n        if (cached) {\n          const parsed = JSON.parse(cached);\n          const normalized = {\n            ...(0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n            ...parsed.entitlements\n          };\n          set({\n            snapshot: parsed,\n            entitlementsByKey: normalized\n          });\n          dlog('[entitlementStore] Hydrated from cache:', Object.keys(normalized).length, 'keys');\n        }\n\n        // Migrate legacy data if present\n        await migrateLegacyData(set, get);\n      } catch (e) {\n        console.error('[entitlementStore] Hydration error:', e);\n      }\n    },\n    /**\n     * Refresh entitlements from server\n     * This is the ONLY way to get authoritative entitlement state\n     */\n    refreshFromServer: async reason => {\n      if (get().isRefreshing) {\n        dlog('[entitlementStore] Already refreshing, skipping');\n        return;\n      }\n      dlog('[entitlementStore] Refreshing from server, reason:', reason);\n      set({\n        isRefreshing: true,\n        refreshError: null\n      });\n      try {\n        const snap = await getEntitlementsSnapshotApi();\n\n        // Strict normalization: fill missing keys as not_owned\n        const normalized = {\n          ...(0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n          ...snap.entitlements\n        };\n        set({\n          snapshot: snap,\n          entitlementsByKey: normalized,\n          lastRefreshAt: Date.now(),\n          isRefreshing: false\n        });\n\n        // Persist for offline cache\n        await (0, _libStorage.storageSet)(STORAGE_KEY, JSON.stringify(snap));\n        dlog('[entitlementStore] Refreshed from server:', snap.version);\n      } catch (e) {\n        const errorMsg = e?.response?.data?.detail || e?.message || 'Failed to refresh entitlements';\n        console.error('[entitlementStore] Refresh error:', errorMsg);\n        set({\n          isRefreshing: false,\n          refreshError: errorMsg\n        });\n      }\n    },\n    /**\n     * Apply a snapshot directly (used by purchase verify flow)\n     * Skips network call - uses snapshot returned from verify endpoint\n     */\n    applySnapshot: snap => {\n      dlog('[entitlementStore] Applying snapshot directly, version:', snap.version);\n\n      // Strict normalization\n      const normalized = {\n        ...(0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n        ...snap.entitlements\n      };\n      set({\n        snapshot: snap,\n        entitlementsByKey: normalized,\n        lastRefreshAt: Date.now(),\n        refreshError: null\n      });\n\n      // Persist for offline cache\n      (0, _libStorage.storageSet)(STORAGE_KEY, JSON.stringify(snap)).catch(() => {});\n    },\n    /**\n     * Clear all entitlement state (on logout)\n     */\n    clear: () => {\n      dlog('[entitlementStore] Clearing state');\n      set({\n        snapshot: null,\n        entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n        lastRefreshAt: null,\n        refreshError: null\n      });\n      (0, _libStorage.storageRemove)(STORAGE_KEY).catch(() => {});\n    },\n    /**\n     * Check if user has entitlement (internal use)\n     * Screens should use gating helpers instead\n     */\n    hasEntitlement: key => {\n      const {\n        entitlementsByKey,\n        snapshot\n      } = get();\n      const entitlement = entitlementsByKey[key];\n      if (!entitlement || entitlement.status !== 'owned') return false;\n\n      // Check expiry using server time\n      if (entitlement.expires_at && snapshot?.server_time) {\n        const expiresAt = new Date(entitlement.expires_at).getTime();\n        const serverNow = new Date(snapshot.server_time).getTime();\n        if (serverNow > expiresAt) return false;\n      }\n      return true;\n    },\n    // ═══════════════════════════════════════════════════════════\n    // DEV ONLY METHODS - For testing paywalls/features\n    // These should NEVER be called in production code paths\n    // ═══════════════════════════════════════════════════════════\n\n    devGrantEntitlement: key => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devGrantEntitlement called in production - BLOCKED');\n        return;\n      }\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = {\n        ...entitlementsByKey,\n        [key]: {\n          key,\n          status: 'owned',\n          granted_at: new Date().toISOString(),\n          reason: 'admin'\n        }\n      };\n\n      // Create fake snapshot for dev\n      const fakeSnapshot = {\n        server_time: new Date().toISOString(),\n        version: Date.now(),\n        username: 'DEV_USER',\n        entitlements: updated,\n        source: 'database'\n      };\n      set({\n        entitlementsByKey: updated,\n        snapshot: fakeSnapshot\n      });\n      dlog('[entitlementStore] DEV: Granted', key);\n    },\n    devRevokeEntitlement: key => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devRevokeEntitlement called in production - BLOCKED');\n        return;\n      }\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = {\n        ...entitlementsByKey,\n        [key]: {\n          key,\n          status: 'not_owned'\n        }\n      };\n      set({\n        entitlementsByKey: updated\n      });\n      dlog('[entitlementStore] DEV: Revoked', key);\n    },\n    devClearAll: () => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devClearAll called in production - BLOCKED');\n        return;\n      }\n      set({\n        entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n        snapshot: null\n      });\n      (0, _libStorage.storageRemove)(STORAGE_KEY).catch(() => {});\n      dlog('[entitlementStore] DEV: Cleared all entitlements');\n    }\n  }));\n\n  /**\n   * Migrate legacy entitlement data to new format\n   */\n  async function migrateLegacyData(set, get) {\n    try {\n      const legacyData = await (0, _libStorage.storageGet)(LEGACY_STORAGE_KEY);\n      if (!legacyData) return;\n      dlog('[entitlementStore] Migrating legacy data...');\n      const legacy = JSON.parse(legacyData);\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = {\n        ...entitlementsByKey\n      };\n\n      // Migrate each legacy key\n      for (const [oldKey, value] of Object.entries(legacy)) {\n        if (value) {\n          const newKey = (0, _libEntitlementsLegacy.migrateLegacyKey)(oldKey);\n          updated[newKey] = {\n            key: newKey,\n            status: 'owned',\n            granted_at: new Date().toISOString(),\n            reason: 'unknown'\n          };\n          dlog('[entitlementStore] Migrated:', oldKey, '->', newKey);\n        }\n      }\n      set({\n        entitlementsByKey: updated\n      });\n\n      // Remove legacy data after migration\n      await (0, _libStorage.storageRemove)(LEGACY_STORAGE_KEY);\n      dlog('[entitlementStore] Legacy migration complete');\n    } catch (e) {\n      console.error('[entitlementStore] Legacy migration error:', e);\n    }\n  }\n});","lineCount":284,"map":[[7,2,71,0,"Object"],[7,8,71,0],[7,9,71,0,"defineProperty"],[7,23,71,0],[7,24,71,0,"exports"],[7,31,71,0],[8,4,71,0,"enumerable"],[8,14,71,0],[9,4,71,0,"get"],[9,7,71,0],[9,18,71,0,"get"],[9,19,71,0],[10,6,71,0],[10,13,71,0,"useEntitlementStore"],[10,32,71,0],[11,4,71,0],[12,2,71,0],[13,2,11,0],[13,6,11,0,"_zustand"],[13,14,11,0],[13,17,11,0,"require"],[13,24,11,0],[13,25,11,0,"_dependencyMap"],[13,39,11,0],[14,2,12,0],[14,6,12,0,"_libStorage"],[14,17,12,0],[14,20,12,0,"require"],[14,27,12,0],[14,28,12,0,"_dependencyMap"],[14,42,12,0],[15,2,13,0],[15,6,13,0,"_libEntitlementsTypes"],[15,27,13,0],[15,30,13,0,"require"],[15,37,13,0],[15,38,13,0,"_dependencyMap"],[15,52,13,0],[16,2,22,0],[16,6,22,0,"_libEntitlementsLegacy"],[16,28,22,0],[16,31,22,0,"require"],[16,38,22,0],[16,39,22,0,"_dependencyMap"],[16,53,22,0],[17,2,1,0],[18,0,2,0],[19,0,3,0],[20,0,4,0],[21,0,5,0],[22,0,6,0],[23,0,7,0],[24,0,8,0],[25,0,9,0],[27,2,28,0],[28,2,29,0],[28,8,29,6,"dlog"],[28,12,29,10],[28,15,29,13,"dlog"],[28,16,29,14],[28,19,29,17,"args"],[28,23,29,28],[28,28,29,33],[29,4,29,35],[29,8,29,39,"__DEV__"],[29,15,29,46],[29,17,29,48,"console"],[29,24,29,55],[29,25,29,56,"log"],[29,28,29,59],[29,29,29,60],[29,32,29,63,"args"],[29,36,29,67],[29,37,29,68],[30,2,29,70],[30,3,29,71],[31,2,31,0],[31,8,31,6,"STORAGE_KEY"],[31,19,31,17],[31,22,31,20],[31,53,31,51],[32,2,32,0],[32,8,32,6,"LEGACY_STORAGE_KEY"],[32,26,32,24],[32,29,32,27],[32,60,32,58],[34,2,34,0],[35,2,35,0],[35,6,35,4,"_getEntitlementsSnapshot"],[35,30,35,74],[35,33,35,77],[35,37,35,81],[36,2,36,0],[36,17,36,15,"getEntitlementsSnapshotApi"],[36,43,36,41,"getEntitlementsSnapshotApi"],[36,44,36,41],[36,46,36,75],[37,4,37,2],[37,8,37,6],[37,9,37,7,"_getEntitlementsSnapshot"],[37,33,37,31],[37,35,37,33],[38,6,38,4],[38,12,38,10,"api"],[38,15,38,13],[38,18,38,16],[38,24,38,16,"require"],[38,31,38,16],[38,32,38,16,"_dependencyMap"],[38,46,38,16],[38,89,38,16,"_dependencyMap"],[38,103,38,16],[38,108,38,16,"_dependencyMap"],[38,122,38,16],[38,123,38,16,"paths"],[38,128,38,16],[38,143,38,42],[39,6,39,4,"_getEntitlementsSnapshot"],[39,30,39,28],[39,33,39,31,"api"],[39,36,39,34],[39,37,39,35,"getEntitlementsSnapshot"],[39,60,39,58],[40,4,40,2],[41,4,41,2],[41,11,41,9,"_getEntitlementsSnapshot"],[41,35,41,33],[41,36,41,34],[41,37,41,35],[42,2,42,0],[43,2,71,7],[43,8,71,13,"useEntitlementStore"],[43,27,71,32],[43,30,71,35],[43,34,71,35,"create"],[43,42,71,41],[43,43,71,41,"create"],[43,49,71,41],[43,51,71,65],[43,52,71,66,"set"],[43,55,71,69],[43,57,71,71,"get"],[43,60,71,74],[43,66,71,80],[44,4,72,2,"snapshot"],[44,12,72,10],[44,14,72,12],[44,18,72,16],[45,4,73,2,"entitlementsByKey"],[45,21,73,19],[45,23,73,21],[45,27,73,21,"createEmptyEntitlementsMap"],[45,48,73,47],[45,49,73,47,"createEmptyEntitlementsMap"],[45,75,73,47],[45,77,73,48],[45,78,73,49],[46,4,74,2,"lastRefreshAt"],[46,17,74,15],[46,19,74,17],[46,23,74,21],[47,4,75,2,"isRefreshing"],[47,16,75,14],[47,18,75,16],[47,23,75,21],[48,4,76,2,"refreshError"],[48,16,76,14],[48,18,76,16],[48,22,76,20],[49,4,78,2],[50,0,79,0],[51,0,80,0],[52,0,81,0],[53,4,82,2,"hydrateEntitlements"],[53,23,82,21],[53,25,82,23],[53,31,82,23,"hydrateEntitlements"],[53,32,82,23],[53,37,82,35],[54,6,83,4,"dlog"],[54,10,83,8],[54,11,83,9],[54,55,83,53],[54,56,83,54],[55,6,85,4],[55,10,85,8],[56,8,86,6],[57,8,87,6],[57,14,87,12,"cached"],[57,20,87,18],[57,23,87,21],[57,29,87,27],[57,33,87,27,"storageGet"],[57,44,87,37],[57,45,87,37,"storageGet"],[57,55,87,37],[57,57,87,38,"STORAGE_KEY"],[57,68,87,49],[57,69,87,50],[58,8,88,6],[58,12,88,10,"cached"],[58,18,88,16],[58,20,88,18],[59,10,89,8],[59,16,89,14,"parsed"],[59,22,89,20],[59,25,89,23,"JSON"],[59,29,89,27],[59,30,89,28,"parse"],[59,35,89,33],[59,36,89,34,"cached"],[59,42,89,40],[59,43,89,65],[60,10,90,8],[60,16,90,14,"normalized"],[60,26,90,24],[60,29,90,27],[61,12,90,29],[61,15,90,32],[61,19,90,32,"createEmptyEntitlementsMap"],[61,40,90,58],[61,41,90,58,"createEmptyEntitlementsMap"],[61,67,90,58],[61,69,90,59],[61,70,90,60],[62,12,90,62],[62,15,90,65,"parsed"],[62,21,90,71],[62,22,90,72,"entitlements"],[63,10,90,85],[63,11,90,86],[64,10,91,8,"set"],[64,13,91,11],[64,14,91,12],[65,12,92,10,"snapshot"],[65,20,92,18],[65,22,92,20,"parsed"],[65,28,92,26],[66,12,93,10,"entitlementsByKey"],[66,29,93,27],[66,31,93,29,"normalized"],[67,10,94,8],[67,11,94,9],[67,12,94,10],[68,10,95,8,"dlog"],[68,14,95,12],[68,15,95,13],[68,56,95,54],[68,58,95,56,"Object"],[68,64,95,62],[68,65,95,63,"keys"],[68,69,95,67],[68,70,95,68,"normalized"],[68,80,95,78],[68,81,95,79],[68,82,95,80,"length"],[68,88,95,86],[68,90,95,88],[68,96,95,94],[68,97,95,95],[69,8,96,6],[71,8,98,6],[72,8,99,6],[72,14,99,12,"migrateLegacyData"],[72,31,99,29],[72,32,99,30,"set"],[72,35,99,33],[72,37,99,35,"get"],[72,40,99,38],[72,41,99,39],[73,6,101,4],[73,7,101,5],[73,8,101,6],[73,15,101,13,"e"],[73,16,101,14],[73,18,101,16],[74,8,102,6,"console"],[74,15,102,13],[74,16,102,14,"error"],[74,21,102,19],[74,22,102,20],[74,59,102,57],[74,61,102,59,"e"],[74,62,102,60],[74,63,102,61],[75,6,103,4],[76,4,104,2],[76,5,104,3],[77,4,106,2],[78,0,107,0],[79,0,108,0],[80,0,109,0],[81,4,110,2,"refreshFromServer"],[81,21,110,19],[81,23,110,21],[81,29,110,28,"reason"],[81,35,110,34],[81,39,110,39],[82,6,111,4],[82,10,111,8,"get"],[82,13,111,11],[82,14,111,12],[82,15,111,13],[82,16,111,14,"isRefreshing"],[82,28,111,26],[82,30,111,28],[83,8,112,6,"dlog"],[83,12,112,10],[83,13,112,11],[83,62,112,60],[83,63,112,61],[84,8,113,6],[85,6,114,4],[86,6,116,4,"dlog"],[86,10,116,8],[86,11,116,9],[86,63,116,61],[86,65,116,63,"reason"],[86,71,116,69],[86,72,116,70],[87,6,117,4,"set"],[87,9,117,7],[87,10,117,8],[88,8,117,10,"isRefreshing"],[88,20,117,22],[88,22,117,24],[88,26,117,28],[89,8,117,30,"refreshError"],[89,20,117,42],[89,22,117,44],[90,6,117,49],[90,7,117,50],[90,8,117,51],[91,6,119,4],[91,10,119,8],[92,8,120,6],[92,14,120,12,"snap"],[92,18,120,16],[92,21,120,19],[92,27,120,25,"getEntitlementsSnapshotApi"],[92,53,120,51],[92,54,120,52],[92,55,120,53],[94,8,122,6],[95,8,123,6],[95,14,123,12,"normalized"],[95,24,123,22],[95,27,123,25],[96,10,123,27],[96,13,123,30],[96,17,123,30,"createEmptyEntitlementsMap"],[96,38,123,56],[96,39,123,56,"createEmptyEntitlementsMap"],[96,65,123,56],[96,67,123,57],[96,68,123,58],[97,10,123,60],[97,13,123,63,"snap"],[97,17,123,67],[97,18,123,68,"entitlements"],[98,8,123,81],[98,9,123,82],[99,8,125,6,"set"],[99,11,125,9],[99,12,125,10],[100,10,126,8,"snapshot"],[100,18,126,16],[100,20,126,18,"snap"],[100,24,126,22],[101,10,127,8,"entitlementsByKey"],[101,27,127,25],[101,29,127,27,"normalized"],[101,39,127,37],[102,10,128,8,"lastRefreshAt"],[102,23,128,21],[102,25,128,23,"Date"],[102,29,128,27],[102,30,128,28,"now"],[102,33,128,31],[102,34,128,32],[102,35,128,33],[103,10,129,8,"isRefreshing"],[103,22,129,20],[103,24,129,22],[104,8,130,6],[104,9,130,7],[104,10,130,8],[106,8,132,6],[107,8,133,6],[107,14,133,12],[107,18,133,12,"storageSet"],[107,29,133,22],[107,30,133,22,"storageSet"],[107,40,133,22],[107,42,133,23,"STORAGE_KEY"],[107,53,133,34],[107,55,133,36,"JSON"],[107,59,133,40],[107,60,133,41,"stringify"],[107,69,133,50],[107,70,133,51,"snap"],[107,74,133,55],[107,75,133,56],[107,76,133,57],[108,8,135,6,"dlog"],[108,12,135,10],[108,13,135,11],[108,56,135,54],[108,58,135,56,"snap"],[108,62,135,60],[108,63,135,61,"version"],[108,70,135,68],[108,71,135,69],[109,6,137,4],[109,7,137,5],[109,8,137,6],[109,15,137,13,"e"],[109,16,137,19],[109,18,137,21],[110,8,138,6],[110,14,138,12,"errorMsg"],[110,22,138,20],[110,25,138,23,"e"],[110,26,138,24],[110,28,138,26,"response"],[110,36,138,34],[110,38,138,36,"data"],[110,42,138,40],[110,44,138,42,"detail"],[110,50,138,48],[110,54,138,52,"e"],[110,55,138,53],[110,57,138,55,"message"],[110,64,138,62],[110,68,138,66],[110,100,138,98],[111,8,139,6,"console"],[111,15,139,13],[111,16,139,14,"error"],[111,21,139,19],[111,22,139,20],[111,57,139,55],[111,59,139,57,"errorMsg"],[111,67,139,65],[111,68,139,66],[112,8,140,6,"set"],[112,11,140,9],[112,12,140,10],[113,10,141,8,"isRefreshing"],[113,22,141,20],[113,24,141,22],[113,29,141,27],[114,10,142,8,"refreshError"],[114,22,142,20],[114,24,142,22,"errorMsg"],[115,8,143,6],[115,9,143,7],[115,10,143,8],[116,6,144,4],[117,4,145,2],[117,5,145,3],[118,4,147,2],[119,0,148,0],[120,0,149,0],[121,0,150,0],[122,4,151,2,"applySnapshot"],[122,17,151,15],[122,19,151,18,"snap"],[122,23,151,44],[122,27,151,49],[123,6,152,4,"dlog"],[123,10,152,8],[123,11,152,9],[123,68,152,66],[123,70,152,68,"snap"],[123,74,152,72],[123,75,152,73,"version"],[123,82,152,80],[123,83,152,81],[125,6,154,4],[126,6,155,4],[126,12,155,10,"normalized"],[126,22,155,20],[126,25,155,23],[127,8,155,25],[127,11,155,28],[127,15,155,28,"createEmptyEntitlementsMap"],[127,36,155,54],[127,37,155,54,"createEmptyEntitlementsMap"],[127,63,155,54],[127,65,155,55],[127,66,155,56],[128,8,155,58],[128,11,155,61,"snap"],[128,15,155,65],[128,16,155,66,"entitlements"],[129,6,155,79],[129,7,155,80],[130,6,157,4,"set"],[130,9,157,7],[130,10,157,8],[131,8,158,6,"snapshot"],[131,16,158,14],[131,18,158,16,"snap"],[131,22,158,20],[132,8,159,6,"entitlementsByKey"],[132,25,159,23],[132,27,159,25,"normalized"],[132,37,159,35],[133,8,160,6,"lastRefreshAt"],[133,21,160,19],[133,23,160,21,"Date"],[133,27,160,25],[133,28,160,26,"now"],[133,31,160,29],[133,32,160,30],[133,33,160,31],[134,8,161,6,"refreshError"],[134,20,161,18],[134,22,161,20],[135,6,162,4],[135,7,162,5],[135,8,162,6],[137,6,164,4],[138,6,165,4],[138,10,165,4,"storageSet"],[138,21,165,14],[138,22,165,14,"storageSet"],[138,32,165,14],[138,34,165,15,"STORAGE_KEY"],[138,45,165,26],[138,47,165,28,"JSON"],[138,51,165,32],[138,52,165,33,"stringify"],[138,61,165,42],[138,62,165,43,"snap"],[138,66,165,47],[138,67,165,48],[138,68,165,49],[138,69,165,50,"catch"],[138,74,165,55],[138,75,165,56],[138,81,165,62],[138,82,165,63],[138,83,165,64],[138,84,165,65],[139,4,166,2],[139,5,166,3],[140,4,168,2],[141,0,169,0],[142,0,170,0],[143,4,171,2,"clear"],[143,9,171,7],[143,11,171,9,"clear"],[143,12,171,9],[143,17,171,15],[144,6,172,4,"dlog"],[144,10,172,8],[144,11,172,9],[144,46,172,44],[144,47,172,45],[145,6,173,4,"set"],[145,9,173,7],[145,10,173,8],[146,8,174,6,"snapshot"],[146,16,174,14],[146,18,174,16],[146,22,174,20],[147,8,175,6,"entitlementsByKey"],[147,25,175,23],[147,27,175,25],[147,31,175,25,"createEmptyEntitlementsMap"],[147,52,175,51],[147,53,175,51,"createEmptyEntitlementsMap"],[147,79,175,51],[147,81,175,52],[147,82,175,53],[148,8,176,6,"lastRefreshAt"],[148,21,176,19],[148,23,176,21],[148,27,176,25],[149,8,177,6,"refreshError"],[149,20,177,18],[149,22,177,20],[150,6,178,4],[150,7,178,5],[150,8,178,6],[151,6,179,4],[151,10,179,4,"storageRemove"],[151,21,179,17],[151,22,179,17,"storageRemove"],[151,35,179,17],[151,37,179,18,"STORAGE_KEY"],[151,48,179,29],[151,49,179,30],[151,50,179,31,"catch"],[151,55,179,36],[151,56,179,37],[151,62,179,43],[151,63,179,44],[151,64,179,45],[151,65,179,46],[152,4,180,2],[152,5,180,3],[153,4,182,2],[154,0,183,0],[155,0,184,0],[156,0,185,0],[157,4,186,2,"hasEntitlement"],[157,18,186,16],[157,20,186,19,"key"],[157,23,186,30],[157,27,186,35],[158,6,187,4],[158,12,187,10],[159,8,187,12,"entitlementsByKey"],[159,25,187,29],[160,8,187,31,"snapshot"],[161,6,187,40],[161,7,187,41],[161,10,187,44,"get"],[161,13,187,47],[161,14,187,48],[161,15,187,49],[162,6,188,4],[162,12,188,10,"entitlement"],[162,23,188,21],[162,26,188,24,"entitlementsByKey"],[162,43,188,41],[162,44,188,42,"key"],[162,47,188,45],[162,48,188,46],[163,6,189,4],[163,10,189,8],[163,11,189,9,"entitlement"],[163,22,189,20],[163,26,189,24,"entitlement"],[163,37,189,35],[163,38,189,36,"status"],[163,44,189,42],[163,49,189,47],[163,56,189,54],[163,58,189,56],[163,65,189,63],[163,70,189,68],[165,6,191,4],[166,6,192,4],[166,10,192,8,"entitlement"],[166,21,192,19],[166,22,192,20,"expires_at"],[166,32,192,30],[166,36,192,34,"snapshot"],[166,44,192,42],[166,46,192,44,"server_time"],[166,57,192,55],[166,59,192,57],[167,8,193,6],[167,14,193,12,"expiresAt"],[167,23,193,21],[167,26,193,24],[167,30,193,28,"Date"],[167,34,193,32],[167,35,193,33,"entitlement"],[167,46,193,44],[167,47,193,45,"expires_at"],[167,57,193,55],[167,58,193,56],[167,59,193,57,"getTime"],[167,66,193,64],[167,67,193,65],[167,68,193,66],[168,8,194,6],[168,14,194,12,"serverNow"],[168,23,194,21],[168,26,194,24],[168,30,194,28,"Date"],[168,34,194,32],[168,35,194,33,"snapshot"],[168,43,194,41],[168,44,194,42,"server_time"],[168,55,194,53],[168,56,194,54],[168,57,194,55,"getTime"],[168,64,194,62],[168,65,194,63],[168,66,194,64],[169,8,195,6],[169,12,195,10,"serverNow"],[169,21,195,19],[169,24,195,22,"expiresAt"],[169,33,195,31],[169,35,195,33],[169,42,195,40],[169,47,195,45],[170,6,196,4],[171,6,198,4],[171,13,198,11],[171,17,198,15],[172,4,199,2],[172,5,199,3],[173,4,201,2],[174,4,202,2],[175,4,203,2],[176,4,204,2],[178,4,206,2,"devGrantEntitlement"],[178,23,206,21],[178,25,206,24,"key"],[178,28,206,35],[178,32,206,40],[179,6,207,4],[179,10,207,8],[179,11,207,9,"__DEV__"],[179,18,207,16],[179,20,207,18],[180,8,208,6,"console"],[180,15,208,13],[180,16,208,14,"warn"],[180,20,208,18],[180,21,208,19],[180,92,208,90],[180,93,208,91],[181,8,209,6],[182,6,210,4],[183,6,212,4],[183,12,212,10],[184,8,212,12,"entitlementsByKey"],[185,6,212,30],[185,7,212,31],[185,10,212,34,"get"],[185,13,212,37],[185,14,212,38],[185,15,212,39],[186,6,213,4],[186,12,213,10,"updated"],[186,19,213,17],[186,22,213,20],[187,8,214,6],[187,11,214,9,"entitlementsByKey"],[187,28,214,26],[188,8,215,6],[188,9,215,7,"key"],[188,12,215,10],[188,15,215,13],[189,10,216,8,"key"],[189,13,216,11],[190,10,217,8,"status"],[190,16,217,14],[190,18,217,16],[190,25,217,32],[191,10,218,8,"granted_at"],[191,20,218,18],[191,22,218,20],[191,26,218,24,"Date"],[191,30,218,28],[191,31,218,29],[191,32,218,30],[191,33,218,31,"toISOString"],[191,44,218,42],[191,45,218,43],[191,46,218,44],[192,10,219,8,"reason"],[192,16,219,14],[192,18,219,16],[193,8,220,6],[194,6,221,4],[194,7,221,5],[196,6,223,4],[197,6,224,4],[197,12,224,10,"fakeSnapshot"],[197,24,224,44],[197,27,224,47],[198,8,225,6,"server_time"],[198,19,225,17],[198,21,225,19],[198,25,225,23,"Date"],[198,29,225,27],[198,30,225,28],[198,31,225,29],[198,32,225,30,"toISOString"],[198,43,225,41],[198,44,225,42],[198,45,225,43],[199,8,226,6,"version"],[199,15,226,13],[199,17,226,15,"Date"],[199,21,226,19],[199,22,226,20,"now"],[199,25,226,23],[199,26,226,24],[199,27,226,25],[200,8,227,6,"username"],[200,16,227,14],[200,18,227,16],[200,28,227,26],[201,8,228,6,"entitlements"],[201,20,228,18],[201,22,228,20,"updated"],[201,29,228,27],[202,8,229,6,"source"],[202,14,229,12],[202,16,229,14],[203,6,230,4],[203,7,230,5],[204,6,232,4,"set"],[204,9,232,7],[204,10,232,8],[205,8,233,6,"entitlementsByKey"],[205,25,233,23],[205,27,233,25,"updated"],[205,34,233,32],[206,8,234,6,"snapshot"],[206,16,234,14],[206,18,234,16,"fakeSnapshot"],[207,6,235,4],[207,7,235,5],[207,8,235,6],[208,6,236,4,"dlog"],[208,10,236,8],[208,11,236,9],[208,44,236,42],[208,46,236,44,"key"],[208,49,236,47],[208,50,236,48],[209,4,237,2],[209,5,237,3],[210,4,239,2,"devRevokeEntitlement"],[210,24,239,22],[210,26,239,25,"key"],[210,29,239,36],[210,33,239,41],[211,6,240,4],[211,10,240,8],[211,11,240,9,"__DEV__"],[211,18,240,16],[211,20,240,18],[212,8,241,6,"console"],[212,15,241,13],[212,16,241,14,"warn"],[212,20,241,18],[212,21,241,19],[212,93,241,91],[212,94,241,92],[213,8,242,6],[214,6,243,4],[215,6,245,4],[215,12,245,10],[216,8,245,12,"entitlementsByKey"],[217,6,245,30],[217,7,245,31],[217,10,245,34,"get"],[217,13,245,37],[217,14,245,38],[217,15,245,39],[218,6,246,4],[218,12,246,10,"updated"],[218,19,246,17],[218,22,246,20],[219,8,247,6],[219,11,247,9,"entitlementsByKey"],[219,28,247,26],[220,8,248,6],[220,9,248,7,"key"],[220,12,248,10],[220,15,248,13],[221,10,249,8,"key"],[221,13,249,11],[222,10,250,8,"status"],[222,16,250,14],[222,18,250,16],[223,8,251,6],[224,6,252,4],[224,7,252,5],[225,6,254,4,"set"],[225,9,254,7],[225,10,254,8],[226,8,254,10,"entitlementsByKey"],[226,25,254,27],[226,27,254,29,"updated"],[227,6,254,37],[227,7,254,38],[227,8,254,39],[228,6,255,4,"dlog"],[228,10,255,8],[228,11,255,9],[228,44,255,42],[228,46,255,44,"key"],[228,49,255,47],[228,50,255,48],[229,4,256,2],[229,5,256,3],[230,4,258,2,"devClearAll"],[230,15,258,13],[230,17,258,15,"devClearAll"],[230,18,258,15],[230,23,258,21],[231,6,259,4],[231,10,259,8],[231,11,259,9,"__DEV__"],[231,18,259,16],[231,20,259,18],[232,8,260,6,"console"],[232,15,260,13],[232,16,260,14,"warn"],[232,20,260,18],[232,21,260,19],[232,84,260,82],[232,85,260,83],[233,8,261,6],[234,6,262,4],[235,6,264,4,"set"],[235,9,264,7],[235,10,264,8],[236,8,265,6,"entitlementsByKey"],[236,25,265,23],[236,27,265,25],[236,31,265,25,"createEmptyEntitlementsMap"],[236,52,265,51],[236,53,265,51,"createEmptyEntitlementsMap"],[236,79,265,51],[236,81,265,52],[236,82,265,53],[237,8,266,6,"snapshot"],[237,16,266,14],[237,18,266,16],[238,6,267,4],[238,7,267,5],[238,8,267,6],[239,6,268,4],[239,10,268,4,"storageRemove"],[239,21,268,17],[239,22,268,17,"storageRemove"],[239,35,268,17],[239,37,268,18,"STORAGE_KEY"],[239,48,268,29],[239,49,268,30],[239,50,268,31,"catch"],[239,55,268,36],[239,56,268,37],[239,62,268,43],[239,63,268,44],[239,64,268,45],[239,65,268,46],[240,6,269,4,"dlog"],[240,10,269,8],[240,11,269,9],[240,61,269,59],[240,62,269,60],[241,4,270,2],[242,2,271,0],[242,3,271,1],[242,4,271,2],[242,5,271,3],[244,2,273,0],[245,0,274,0],[246,0,275,0],[247,2,276,0],[247,17,276,15,"migrateLegacyData"],[247,34,276,32,"migrateLegacyData"],[247,35,277,2,"set"],[247,38,277,54],[247,40,278,2,"get"],[247,43,278,34],[247,45,279,2],[248,4,280,2],[248,8,280,6],[249,6,281,4],[249,12,281,10,"legacyData"],[249,22,281,20],[249,25,281,23],[249,31,281,29],[249,35,281,29,"storageGet"],[249,46,281,39],[249,47,281,39,"storageGet"],[249,57,281,39],[249,59,281,40,"LEGACY_STORAGE_KEY"],[249,77,281,58],[249,78,281,59],[250,6,282,4],[250,10,282,8],[250,11,282,9,"legacyData"],[250,21,282,19],[250,23,282,21],[251,6,284,4,"dlog"],[251,10,284,8],[251,11,284,9],[251,56,284,54],[251,57,284,55],[252,6,286,4],[252,12,286,10,"legacy"],[252,18,286,16],[252,21,286,19,"JSON"],[252,25,286,23],[252,26,286,24,"parse"],[252,31,286,29],[252,32,286,30,"legacyData"],[252,42,286,40],[252,43,286,41],[253,6,287,4],[253,12,287,10],[254,8,287,12,"entitlementsByKey"],[255,6,287,30],[255,7,287,31],[255,10,287,34,"get"],[255,13,287,37],[255,14,287,38],[255,15,287,39],[256,6,288,4],[256,12,288,10,"updated"],[256,19,288,17],[256,22,288,20],[257,8,288,22],[257,11,288,25,"entitlementsByKey"],[258,6,288,43],[258,7,288,44],[260,6,290,4],[261,6,291,4],[261,11,291,9],[261,17,291,15],[261,18,291,16,"oldKey"],[261,24,291,22],[261,26,291,24,"value"],[261,31,291,29],[261,32,291,30],[261,36,291,34,"Object"],[261,42,291,40],[261,43,291,41,"entries"],[261,50,291,48],[261,51,291,49,"legacy"],[261,57,291,55],[261,58,291,56],[261,60,291,58],[262,8,292,6],[262,12,292,10,"value"],[262,17,292,15],[262,19,292,17],[263,10,293,8],[263,16,293,14,"newKey"],[263,22,293,20],[263,25,293,23],[263,29,293,23,"migrateLegacyKey"],[263,51,293,39],[263,52,293,39,"migrateLegacyKey"],[263,68,293,39],[263,70,293,40,"oldKey"],[263,76,293,46],[263,77,293,47],[264,10,294,8,"updated"],[264,17,294,15],[264,18,294,16,"newKey"],[264,24,294,22],[264,25,294,23],[264,28,294,26],[265,12,295,10,"key"],[265,15,295,13],[265,17,295,15,"newKey"],[265,23,295,21],[266,12,296,10,"status"],[266,18,296,16],[266,20,296,18],[266,27,296,25],[267,12,297,10,"granted_at"],[267,22,297,20],[267,24,297,22],[267,28,297,26,"Date"],[267,32,297,30],[267,33,297,31],[267,34,297,32],[267,35,297,33,"toISOString"],[267,46,297,44],[267,47,297,45],[267,48,297,46],[268,12,298,10,"reason"],[268,18,298,16],[268,20,298,18],[269,10,299,8],[269,11,299,9],[270,10,300,8,"dlog"],[270,14,300,12],[270,15,300,13],[270,45,300,43],[270,47,300,45,"oldKey"],[270,53,300,51],[270,55,300,53],[270,59,300,57],[270,61,300,59,"newKey"],[270,67,300,65],[270,68,300,66],[271,8,301,6],[272,6,302,4],[273,6,304,4,"set"],[273,9,304,7],[273,10,304,8],[274,8,304,10,"entitlementsByKey"],[274,25,304,27],[274,27,304,29,"updated"],[275,6,304,37],[275,7,304,38],[275,8,304,39],[277,6,306,4],[278,6,307,4],[278,12,307,10],[278,16,307,10,"storageRemove"],[278,27,307,23],[278,28,307,23,"storageRemove"],[278,41,307,23],[278,43,307,24,"LEGACY_STORAGE_KEY"],[278,61,307,42],[278,62,307,43],[279,6,308,4,"dlog"],[279,10,308,8],[279,11,308,9],[279,57,308,55],[279,58,308,56],[280,4,310,2],[280,5,310,3],[280,6,310,4],[280,13,310,11,"e"],[280,14,310,12],[280,16,310,14],[281,6,311,4,"console"],[281,13,311,11],[281,14,311,12,"error"],[281,19,311,17],[281,20,311,18],[281,64,311,62],[281,66,311,64,"e"],[281,67,311,65],[281,68,311,66],[282,4,312,2],[283,2,313,0],[284,0,313,1],[284,3]],"functionMap":{"names":["<global>","dlog","getEntitlementsSnapshotApi","create$argument_0","hydrateEntitlements","refreshFromServer","applySnapshot","storageSet._catch$argument_0","clear","storageRemove._catch$argument_0","hasEntitlement","devGrantEntitlement","devRevokeEntitlement","devClearAll","migrateLegacyData"],"mappings":"AAA;aC4B,0DD;AEO;CFM;iEG6B;uBCW;GDsB;qBEM;GFmC;iBGM;wDCc,QD;GHC;SKK;qCCQ,QD;GLC;kBOM;GPa;uBQO;GR+B;wBSE;GTiB;eUE;qCJU,QI;GVE;EHC;AcK;CdqC"},"hasCjsExports":false},"type":"js/module"}]}