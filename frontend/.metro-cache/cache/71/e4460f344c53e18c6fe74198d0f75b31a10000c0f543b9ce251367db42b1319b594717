{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"../authStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":201},"end":{"line":9,"column":47,"index":248}}],"key":"8h7N/7sKemAZqrgZg8dH/jTl5ys=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"API_BASE\", {\n    enumerable: true,\n    get: function () {\n      return API_BASE;\n    }\n  });\n  exports.apiUrl = apiUrl;\n  exports.getAuthHeaders = getAuthHeaders;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[1], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _authStorage = require(_dependencyMap[2], \"../authStorage\");\n  /**\n   * Centralized API Configuration\n   * \n   * Single source of truth for API base URL across all platforms.\n   * Web preview, device, and tunnel all use this.\n   */\n\n  /**\n   * Get the API base URL based on platform and environment.\n   * \n   * Priority:\n   * 1. EXPO_PUBLIC_BACKEND_URL (if set)\n   * 2. EXPO_PUBLIC_API_URL (legacy fallback)\n   * 3. Platform-specific defaults\n   */\n  function getApiBaseUrl() {\n    // Check environment variables - normalize trailing slashes\n    const RAW = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL ?? _expoVirtualEnv.env.EXPO_PUBLIC_API_URL ?? '';\n\n    // Use explicitly set URLs first (trimmed of trailing slashes)\n    if (RAW) {\n      return RAW.replace(/\\/+$/, '');\n    }\n\n    // Platform-specific defaults when no env var is set\n    if (Platform.default.OS === 'web') {\n      // Web preview: use relative paths (assumes proxy is configured)\n      // If no proxy, this will fail - but that's expected\n      return '';\n    }\n\n    // Native device: default to localhost:8001 (won't work on real device without tunnel)\n    // In production, EXPO_PUBLIC_BACKEND_URL should always be set\n    return 'http://localhost:8001';\n  }\n\n  /**\n   * The API base URL - use this everywhere instead of hardcoding.\n   * \n   * Usage:\n   *   import { API_BASE } from '@/lib/api/config';\n   *   fetch(`${API_BASE}/api/endpoint`, { ... });\n   */\n  const API_BASE = getApiBaseUrl();\n\n  /**\n   * Construct a full API URL.\n   * \n   * @param path - The API path (e.g., '/api/daily/status')\n   * @returns Full URL with base\n   */\n  function apiUrl(path) {\n    // Ensure path starts with /\n    const normalizedPath = path.startsWith('/') ? path : `/${path}`;\n    return `${API_BASE}${normalizedPath}`;\n  }\n\n  /**\n   * Get auth headers for API requests.\n   * Single source of truth - all API modules should use this.\n   * Returns empty object if no token (prevents \"Bearer undefined\").\n   * \n   * @returns Headers object with Authorization if token exists\n   */\n  async function getAuthHeaders() {\n    const token = await (0, _authStorage.loadAuthToken)();\n    if (token) {\n      return {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`\n      };\n    }\n    return {\n      'Content-Type': 'application/json'\n    };\n  }\n\n  // Log the API base URL in development for debugging\n  if (__DEV__) {\n    console.log('[API Config] Base URL:', API_BASE || '(relative paths)');\n    console.log('[API Config] Platform:', Platform.default.OS);\n\n    // WARN if API_BASE is empty - likely means env var not picked up\n    if (!API_BASE) {\n      console.warn('[API Config] ⚠️ API_BASE is empty! ' + 'Set EXPO_PUBLIC_BACKEND_URL in .env for web preview to work. ' + 'Falling back to relative paths (will 404 if no proxy configured).');\n    }\n  }\n});","lineCount":111,"map":[[12,2,49,0,"Object"],[12,8,49,0],[12,9,49,0,"defineProperty"],[12,23,49,0],[12,24,49,0,"exports"],[12,31,49,0],[13,4,49,0,"enumerable"],[13,14,49,0],[14,4,49,0,"get"],[14,7,49,0],[14,18,49,0,"get"],[14,19,49,0],[15,6,49,0],[15,13,49,0,"API_BASE"],[15,21,49,0],[16,4,49,0],[17,2,49,0],[18,2,57,0,"exports"],[18,9,57,0],[18,10,57,0,"apiUrl"],[18,16,57,0],[18,19,57,0,"apiUrl"],[18,25,57,0],[19,2,70,0,"exports"],[19,9,70,0],[19,10,70,0,"getAuthHeaders"],[19,24,70,0],[19,27,70,0,"getAuthHeaders"],[19,41,70,0],[20,2,79,1],[20,6,79,1,"_expoVirtualEnv"],[20,21,79,1],[20,24,79,1,"require"],[20,31,79,1],[20,32,79,1,"_dependencyMap"],[20,46,79,1],[21,2,79,1],[21,6,79,1,"_reactNativeWebDistExportsPlatform"],[21,40,79,1],[21,43,79,1,"require"],[21,50,79,1],[21,51,79,1,"_dependencyMap"],[21,65,79,1],[22,2,79,1],[22,6,79,1,"Platform"],[22,14,79,1],[22,17,79,1,"_interopDefault"],[22,32,79,1],[22,33,79,1,"_reactNativeWebDistExportsPlatform"],[22,67,79,1],[23,2,9,0],[23,6,9,0,"_authStorage"],[23,18,9,0],[23,21,9,0,"require"],[23,28,9,0],[23,29,9,0,"_dependencyMap"],[23,43,9,0],[24,2,1,0],[25,0,2,0],[26,0,3,0],[27,0,4,0],[28,0,5,0],[29,0,6,0],[31,2,11,0],[32,0,12,0],[33,0,13,0],[34,0,14,0],[35,0,15,0],[36,0,16,0],[37,0,17,0],[38,0,18,0],[39,2,19,0],[39,11,19,9,"getApiBaseUrl"],[39,24,19,22,"getApiBaseUrl"],[39,25,19,22],[39,27,19,33],[40,4,20,2],[41,4,21,2],[41,10,21,8,"RAW"],[41,13,21,11],[41,16,21,14,"_expoVirtualEnv"],[41,31,21,14],[41,32,21,14,"env"],[41,35,21,14],[41,36,21,14,"EXPO_PUBLIC_BACKEND_URL"],[41,59,21,14],[41,63,21,14,"_expoVirtualEnv"],[41,78,21,14],[41,79,21,14,"env"],[41,82,21,14],[41,83,21,14,"EXPO_PUBLIC_API_URL"],[41,102,22,38],[41,106,23,7],[41,108,23,9],[43,4,25,2],[44,4,26,2],[44,8,26,6,"RAW"],[44,11,26,9],[44,13,26,11],[45,6,27,4],[45,13,27,11,"RAW"],[45,16,27,14],[45,17,27,15,"replace"],[45,24,27,22],[45,25,27,23],[45,31,27,29],[45,33,27,31],[45,35,27,33],[45,36,27,34],[46,4,28,2],[48,4,30,2],[49,4,31,2],[49,8,31,6,"Platform"],[49,16,31,14],[49,17,31,14,"default"],[49,24,31,14],[49,25,31,15,"OS"],[49,27,31,17],[49,32,31,22],[49,37,31,27],[49,39,31,29],[50,6,32,4],[51,6,33,4],[52,6,34,4],[52,13,34,11],[52,15,34,13],[53,4,35,2],[55,4,37,2],[56,4,38,2],[57,4,39,2],[57,11,39,9],[57,34,39,32],[58,2,40,0],[60,2,42,0],[61,0,43,0],[62,0,44,0],[63,0,45,0],[64,0,46,0],[65,0,47,0],[66,0,48,0],[67,2,49,7],[67,8,49,13,"API_BASE"],[67,16,49,21],[67,19,49,24,"getApiBaseUrl"],[67,32,49,37],[67,33,49,38],[67,34,49,39],[69,2,51,0],[70,0,52,0],[71,0,53,0],[72,0,54,0],[73,0,55,0],[74,0,56,0],[75,2,57,7],[75,11,57,16,"apiUrl"],[75,17,57,22,"apiUrl"],[75,18,57,23,"path"],[75,22,57,35],[75,24,57,45],[76,4,58,2],[77,4,59,2],[77,10,59,8,"normalizedPath"],[77,24,59,22],[77,27,59,25,"path"],[77,31,59,29],[77,32,59,30,"startsWith"],[77,42,59,40],[77,43,59,41],[77,46,59,44],[77,47,59,45],[77,50,59,48,"path"],[77,54,59,52],[77,57,59,55],[77,61,59,59,"path"],[77,65,59,63],[77,67,59,65],[78,4,60,2],[78,11,60,9],[78,14,60,12,"API_BASE"],[78,22,60,20],[78,25,60,23,"normalizedPath"],[78,39,60,37],[78,41,60,39],[79,2,61,0],[81,2,63,0],[82,0,64,0],[83,0,65,0],[84,0,66,0],[85,0,67,0],[86,0,68,0],[87,0,69,0],[88,2,70,7],[88,17,70,22,"getAuthHeaders"],[88,31,70,36,"getAuthHeaders"],[88,32,70,36],[88,34,70,72],[89,4,71,2],[89,10,71,8,"token"],[89,15,71,13],[89,18,71,16],[89,24,71,22],[89,28,71,22,"loadAuthToken"],[89,40,71,35],[89,41,71,35,"loadAuthToken"],[89,54,71,35],[89,56,71,36],[89,57,71,37],[90,4,72,2],[90,8,72,6,"token"],[90,13,72,11],[90,15,72,13],[91,6,73,4],[91,13,73,11],[92,8,74,6],[92,22,74,20],[92,24,74,22],[92,42,74,40],[93,8,75,6],[93,23,75,21],[93,25,75,23],[93,35,75,33,"token"],[93,40,75,38],[94,6,76,4],[94,7,76,5],[95,4,77,2],[96,4,78,2],[96,11,78,9],[97,6,78,11],[97,20,78,25],[97,22,78,27],[98,4,78,46],[98,5,78,47],[99,2,79,0],[101,2,81,0],[102,2,82,0],[102,6,82,4,"__DEV__"],[102,13,82,11],[102,15,82,13],[103,4,83,2,"console"],[103,11,83,9],[103,12,83,10,"log"],[103,15,83,13],[103,16,83,14],[103,40,83,38],[103,42,83,40,"API_BASE"],[103,50,83,48],[103,54,83,52],[103,72,83,70],[103,73,83,71],[104,4,84,2,"console"],[104,11,84,9],[104,12,84,10,"log"],[104,15,84,13],[104,16,84,14],[104,40,84,38],[104,42,84,40,"Platform"],[104,50,84,48],[104,51,84,48,"default"],[104,58,84,48],[104,59,84,49,"OS"],[104,61,84,51],[104,62,84,52],[106,4,86,2],[107,4,87,2],[107,8,87,6],[107,9,87,7,"API_BASE"],[107,17,87,15],[107,19,87,17],[108,6,88,4,"console"],[108,13,88,11],[108,14,88,12,"warn"],[108,18,88,16],[108,19,89,6],[108,56,89,43],[108,59,90,6],[108,122,90,69],[108,125,91,6],[108,192,92,4],[108,193,92,5],[109,4,93,2],[110,2,94,0],[111,0,94,1],[111,3]],"functionMap":{"names":["<global>","getApiBaseUrl","apiUrl","getAuthHeaders"],"mappings":"AAA;ACkB;CDqB;OEiB;CFI;OGS;CHS"},"hasCjsExports":false},"type":"js/module"}]}