{"dependencies":[{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":47,"index":47}}],"key":"m+kcirlwHAgMIuUoyR2vCxbhWD4=","exportNames":["*"],"imports":1}},{"name":"./utils/node-utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":118},"end":{"line":3,"column":73,"index":191}}],"key":"P5a/WZsfI6fXR126iSDKjdcy1Kk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"Postgres\", {\n    enumerable: true,\n    get: function () {\n      return Postgres;\n    }\n  });\n  var _sentryUtils = require(_dependencyMap[0], \"@sentry/utils\");\n  var _utilsNodeUtilsJs = require(_dependencyMap[1], \"./utils/node-utils.js\");\n  /** Tracing integration for node-postgres package */\n  class Postgres {\n    /**\n     * @inheritDoc\n     */\n    static __initStatic() {\n      this.id = 'Postgres';\n    }\n\n    /**\n     * @inheritDoc\n     */\n\n    constructor(options = {}) {\n      this.name = Postgres.id;\n      this._usePgNative = !!options.usePgNative;\n      this._module = options.module;\n    }\n\n    /** @inheritdoc */\n    loadDependency() {\n      return this._module = this._module || (0, _sentryUtils.loadModule)('pg');\n    }\n\n    /**\n     * @inheritDoc\n     */\n    setupOnce(_, getCurrentHub) {\n      if ((0, _utilsNodeUtilsJs.shouldDisableAutoInstrumentation)(getCurrentHub)) {\n        (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && _sentryUtils.logger.log('Postgres Integration is skipped because of instrumenter configuration.');\n        return;\n      }\n      const pkg = this.loadDependency();\n      if (!pkg) {\n        (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && _sentryUtils.logger.error('Postgres Integration was unable to require `pg` package.');\n        return;\n      }\n      const Client = this._usePgNative ? (0, _sentryUtils._optionalChain)([pkg, 'access', _2 => _2.native, 'optionalAccess', _3 => _3.Client]) : pkg.Client;\n      if (!Client) {\n        (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && _sentryUtils.logger.error(\"Postgres Integration was unable to access 'pg-native' bindings.\");\n        return;\n      }\n\n      /**\n       * function (query, callback) => void\n       * function (query, params, callback) => void\n       * function (query) => Promise\n       * function (query, params) => Promise\n       * function (pg.Cursor) => pg.Cursor\n       */\n      (0, _sentryUtils.fill)(Client.prototype, 'query', function (orig) {\n        return function (config, values, callback) {\n          const scope = getCurrentHub().getScope();\n          const parentSpan = scope.getSpan();\n          const data = {\n            'db.system': 'postgresql'\n          };\n          try {\n            if (this.database) {\n              data['db.name'] = this.database;\n            }\n            if (this.host) {\n              data['server.address'] = this.host;\n            }\n            if (this.port) {\n              data['server.port'] = this.port;\n            }\n            if (this.user) {\n              data['db.user'] = this.user;\n            }\n          } catch (e) {\n            // ignore\n          }\n          const span = (0, _sentryUtils._optionalChain)([parentSpan, 'optionalAccess', _4 => _4.startChild, 'call', _5 => _5({\n            description: typeof config === 'string' ? config : config.text,\n            op: 'db',\n            origin: 'auto.db.postgres',\n            data\n          })]);\n          if (typeof callback === 'function') {\n            return orig.call(this, config, values, function (err, result) {\n              (0, _sentryUtils._optionalChain)([span, 'optionalAccess', _6 => _6.finish, 'call', _7 => _7()]);\n              callback(err, result);\n            });\n          }\n          if (typeof values === 'function') {\n            return orig.call(this, config, function (err, result) {\n              (0, _sentryUtils._optionalChain)([span, 'optionalAccess', _8 => _8.finish, 'call', _9 => _9()]);\n              values(err, result);\n            });\n          }\n          const rv = typeof values !== 'undefined' ? orig.call(this, config, values) : orig.call(this, config);\n          if ((0, _sentryUtils.isThenable)(rv)) {\n            return rv.then(res => {\n              (0, _sentryUtils._optionalChain)([span, 'optionalAccess', _10 => _10.finish, 'call', _11 => _11()]);\n              return res;\n            });\n          }\n          (0, _sentryUtils._optionalChain)([span, 'optionalAccess', _12 => _12.finish, 'call', _13 => _13()]);\n          return rv;\n        };\n      });\n    }\n  }\n  Postgres.__initStatic();\n});","lineCount":120,"map":[[7,2,120,0,"Object"],[7,8,120,0],[7,9,120,0,"defineProperty"],[7,23,120,0],[7,24,120,0,"exports"],[7,31,120,0],[8,4,120,0,"enumerable"],[8,14,120,0],[9,4,120,0,"get"],[9,7,120,0],[9,18,120,0,"get"],[9,19,120,0],[10,6,120,0],[10,13,120,9,"Postgres"],[10,21,120,17],[11,4,120,17],[12,2,120,17],[13,2,1,0],[13,6,1,0,"_sentryUtils"],[13,18,1,0],[13,21,1,0,"require"],[13,28,1,0],[13,29,1,0,"_dependencyMap"],[13,43,1,0],[14,2,3,0],[14,6,3,0,"_utilsNodeUtilsJs"],[14,23,3,0],[14,26,3,0,"require"],[14,33,3,0],[14,34,3,0,"_dependencyMap"],[14,48,3,0],[15,2,5,0],[16,2,6,0],[16,8,6,6,"Postgres"],[16,16,6,14],[16,17,6,16],[17,4,7,2],[18,0,8,0],[19,0,9,0],[20,4,10,3],[20,11,10,10,"__initStatic"],[20,23,10,22,"__initStatic"],[20,24,10,22],[20,26,10,25],[21,6,10,26],[21,10,10,30],[21,11,10,31,"id"],[21,13,10,33],[21,16,10,36],[21,26,10,46],[22,4,10,47],[24,4,12,2],[25,0,13,0],[26,0,14,0],[28,4,16,3,"constructor"],[28,15,16,14,"constructor"],[28,16,16,15,"options"],[28,23,16,22],[28,26,16,25],[28,27,16,26],[28,28,16,27],[28,30,16,29],[29,6,17,4],[29,10,17,8],[29,11,17,9,"name"],[29,15,17,13],[29,18,17,16,"Postgres"],[29,26,17,24],[29,27,17,25,"id"],[29,29,17,27],[30,6,18,4],[30,10,18,8],[30,11,18,9,"_usePgNative"],[30,23,18,21],[30,26,18,24],[30,27,18,25],[30,28,18,26,"options"],[30,35,18,33],[30,36,18,34,"usePgNative"],[30,47,18,45],[31,6,19,4],[31,10,19,8],[31,11,19,9,"_module"],[31,18,19,16],[31,21,19,19,"options"],[31,28,19,26],[31,29,19,27,"module"],[31,35,19,33],[32,4,20,2],[34,4,22,2],[35,4,23,3,"loadDependency"],[35,18,23,17,"loadDependency"],[35,19,23,17],[35,21,23,20],[36,6,24,4],[36,13,24,12],[36,17,24,16],[36,18,24,17,"_module"],[36,25,24,24],[36,28,24,27],[36,32,24,31],[36,33,24,32,"_module"],[36,40,24,39],[36,44,24,43],[36,48,24,43,"loadModule"],[36,60,24,53],[36,61,24,53,"loadModule"],[36,71,24,53],[36,73,24,54],[36,77,24,58],[36,78,24,59],[37,4,25,2],[39,4,27,2],[40,0,28,0],[41,0,29,0],[42,4,30,3,"setupOnce"],[42,13,30,12,"setupOnce"],[42,14,30,13,"_"],[42,15,30,14],[42,17,30,16,"getCurrentHub"],[42,30,30,29],[42,32,30,31],[43,6,31,4],[43,10,31,8],[43,14,31,8,"shouldDisableAutoInstrumentation"],[43,31,31,40],[43,32,31,40,"shouldDisableAutoInstrumentation"],[43,64,31,40],[43,66,31,41,"getCurrentHub"],[43,79,31,54],[43,80,31,55],[43,82,31,57],[44,8,32,6],[44,9,32,7],[44,16,32,14,"__SENTRY_DEBUG__"],[44,32,32,30],[44,37,32,35],[44,48,32,46],[44,52,32,50,"__SENTRY_DEBUG__"],[44,68,32,66],[44,73,32,71,"logger"],[44,85,32,77],[44,86,32,77,"logger"],[44,92,32,77],[44,93,32,78,"log"],[44,96,32,81],[44,97,32,82],[44,169,32,154],[44,170,32,155],[45,8,33,6],[46,6,34,4],[47,6,36,4],[47,12,36,10,"pkg"],[47,15,36,13],[47,18,36,16],[47,22,36,20],[47,23,36,21,"loadDependency"],[47,37,36,35],[47,38,36,36],[47,39,36,37],[48,6,38,4],[48,10,38,8],[48,11,38,9,"pkg"],[48,14,38,12],[48,16,38,14],[49,8,39,6],[49,9,39,7],[49,16,39,14,"__SENTRY_DEBUG__"],[49,32,39,30],[49,37,39,35],[49,48,39,46],[49,52,39,50,"__SENTRY_DEBUG__"],[49,68,39,66],[49,73,39,71,"logger"],[49,85,39,77],[49,86,39,77,"logger"],[49,92,39,77],[49,93,39,78,"error"],[49,98,39,83],[49,99,39,84],[49,157,39,142],[49,158,39,143],[50,8,40,6],[51,6,41,4],[52,6,43,4],[52,12,43,10,"Client"],[52,18,43,16],[52,21,43,19],[52,25,43,23],[52,26,43,24,"_usePgNative"],[52,38,43,36],[52,41,43,39],[52,45,43,39,"_optionalChain"],[52,57,43,53],[52,58,43,53,"_optionalChain"],[52,72,43,53],[52,74,43,54],[52,75,43,55,"pkg"],[52,78,43,58],[52,80,43,60],[52,88,43,68],[52,90,43,70,"_2"],[52,92,43,72],[52,96,43,76,"_2"],[52,98,43,78],[52,99,43,79,"native"],[52,105,43,85],[52,107,43,87],[52,123,43,103],[52,125,43,105,"_3"],[52,127,43,107],[52,131,43,111,"_3"],[52,133,43,113],[52,134,43,114,"Client"],[52,140,43,120],[52,141,43,121],[52,142,43,122],[52,145,43,125,"pkg"],[52,148,43,128],[52,149,43,129,"Client"],[52,155,43,135],[53,6,45,4],[53,10,45,8],[53,11,45,9,"Client"],[53,17,45,15],[53,19,45,17],[54,8,46,6],[54,9,46,7],[54,16,46,14,"__SENTRY_DEBUG__"],[54,32,46,30],[54,37,46,35],[54,48,46,46],[54,52,46,50,"__SENTRY_DEBUG__"],[54,68,46,66],[54,73,46,71,"logger"],[54,85,46,77],[54,86,46,77,"logger"],[54,92,46,77],[54,93,46,78,"error"],[54,98,46,83],[54,99,46,84],[54,164,46,149],[54,165,46,150],[55,8,47,6],[56,6,48,4],[58,6,50,4],[59,0,51,0],[60,0,52,0],[61,0,53,0],[62,0,54,0],[63,0,55,0],[64,0,56,0],[65,6,57,4],[65,10,57,4,"fill"],[65,22,57,8],[65,23,57,8,"fill"],[65,27,57,8],[65,29,57,9,"Client"],[65,35,57,15],[65,36,57,16,"prototype"],[65,45,57,25],[65,47,57,27],[65,54,57,34],[65,56,57,36],[65,66,57,46,"orig"],[65,70,57,50],[65,72,57,52],[66,8,58,6],[66,15,58,13],[66,25,58,24,"config"],[66,31,58,30],[66,33,58,32,"values"],[66,39,58,38],[66,41,58,40,"callback"],[66,49,58,48],[66,51,58,50],[67,10,59,8],[67,16,59,14,"scope"],[67,21,59,19],[67,24,59,22,"getCurrentHub"],[67,37,59,35],[67,38,59,36],[67,39,59,37],[67,40,59,38,"getScope"],[67,48,59,46],[67,49,59,47],[67,50,59,48],[68,10,60,8],[68,16,60,14,"parentSpan"],[68,26,60,24],[68,29,60,27,"scope"],[68,34,60,32],[68,35,60,33,"getSpan"],[68,42,60,40],[68,43,60,41],[68,44,60,42],[69,10,62,8],[69,16,62,14,"data"],[69,20,62,18],[69,23,62,21],[70,12,63,10],[70,23,63,21],[70,25,63,23],[71,10,64,8],[71,11,64,9],[72,10,66,8],[72,14,66,12],[73,12,67,10],[73,16,67,14],[73,20,67,18],[73,21,67,19,"database"],[73,29,67,27],[73,31,67,29],[74,14,68,12,"data"],[74,18,68,16],[74,19,68,17],[74,28,68,26],[74,29,68,27],[74,32,68,30],[74,36,68,34],[74,37,68,35,"database"],[74,45,68,43],[75,12,69,10],[76,12,70,10],[76,16,70,14],[76,20,70,18],[76,21,70,19,"host"],[76,25,70,23],[76,27,70,25],[77,14,71,12,"data"],[77,18,71,16],[77,19,71,17],[77,35,71,33],[77,36,71,34],[77,39,71,37],[77,43,71,41],[77,44,71,42,"host"],[77,48,71,46],[78,12,72,10],[79,12,73,10],[79,16,73,14],[79,20,73,18],[79,21,73,19,"port"],[79,25,73,23],[79,27,73,25],[80,14,74,12,"data"],[80,18,74,16],[80,19,74,17],[80,32,74,30],[80,33,74,31],[80,36,74,34],[80,40,74,38],[80,41,74,39,"port"],[80,45,74,43],[81,12,75,10],[82,12,76,10],[82,16,76,14],[82,20,76,18],[82,21,76,19,"user"],[82,25,76,23],[82,27,76,25],[83,14,77,12,"data"],[83,18,77,16],[83,19,77,17],[83,28,77,26],[83,29,77,27],[83,32,77,30],[83,36,77,34],[83,37,77,35,"user"],[83,41,77,39],[84,12,78,10],[85,10,79,8],[85,11,79,9],[85,12,79,10],[85,19,79,17,"e"],[85,20,79,18],[85,22,79,20],[86,12,80,10],[87,10,80,10],[88,10,83,8],[88,16,83,14,"span"],[88,20,83,18],[88,23,83,21],[88,27,83,21,"_optionalChain"],[88,39,83,35],[88,40,83,35,"_optionalChain"],[88,54,83,35],[88,56,83,36],[88,57,83,37,"parentSpan"],[88,67,83,47],[88,69,83,49],[88,85,83,65],[88,87,83,67,"_4"],[88,89,83,69],[88,93,83,73,"_4"],[88,95,83,75],[88,96,83,76,"startChild"],[88,106,83,86],[88,108,83,88],[88,114,83,94],[88,116,83,96,"_5"],[88,118,83,98],[88,122,83,102,"_5"],[88,124,83,104],[88,125,83,105],[89,12,84,10,"description"],[89,23,84,21],[89,25,84,23],[89,32,84,30,"config"],[89,38,84,36],[89,43,84,41],[89,51,84,49],[89,54,84,52,"config"],[89,60,84,58],[89,63,84,62,"config"],[89,69,84,68],[89,70,84,71,"text"],[89,74,84,75],[90,12,85,10,"op"],[90,14,85,12],[90,16,85,14],[90,20,85,18],[91,12,86,10,"origin"],[91,18,86,16],[91,20,86,18],[91,38,86,36],[92,12,87,10,"data"],[93,10,88,8],[93,11,88,9],[93,12,88,10],[93,13,88,11],[93,14,88,12],[94,10,90,8],[94,14,90,12],[94,21,90,19,"callback"],[94,29,90,27],[94,34,90,32],[94,44,90,42],[94,46,90,44],[95,12,91,10],[95,19,91,17,"orig"],[95,23,91,21],[95,24,91,22,"call"],[95,28,91,26],[95,29,91,27],[95,33,91,31],[95,35,91,33,"config"],[95,41,91,39],[95,43,91,41,"values"],[95,49,91,47],[95,51,91,49],[95,61,91,59,"err"],[95,64,91,62],[95,66,91,64,"result"],[95,72,91,70],[95,74,91,72],[96,14,92,12],[96,18,92,12,"_optionalChain"],[96,30,92,26],[96,31,92,26,"_optionalChain"],[96,45,92,26],[96,47,92,27],[96,48,92,28,"span"],[96,52,92,32],[96,54,92,34],[96,70,92,50],[96,72,92,52,"_6"],[96,74,92,54],[96,78,92,58,"_6"],[96,80,92,60],[96,81,92,61,"finish"],[96,87,92,67],[96,89,92,69],[96,95,92,75],[96,97,92,77,"_7"],[96,99,92,79],[96,103,92,83,"_7"],[96,105,92,85],[96,106,92,86],[96,107,92,87],[96,108,92,88],[96,109,92,89],[97,14,93,12,"callback"],[97,22,93,20],[97,23,93,21,"err"],[97,26,93,24],[97,28,93,26,"result"],[97,34,93,32],[97,35,93,33],[98,12,94,10],[98,13,94,11],[98,14,94,12],[99,10,95,8],[100,10,97,8],[100,14,97,12],[100,21,97,19,"values"],[100,27,97,25],[100,32,97,30],[100,42,97,40],[100,44,97,42],[101,12,98,10],[101,19,98,17,"orig"],[101,23,98,21],[101,24,98,22,"call"],[101,28,98,26],[101,29,98,27],[101,33,98,31],[101,35,98,33,"config"],[101,41,98,39],[101,43,98,41],[101,53,98,51,"err"],[101,56,98,54],[101,58,98,56,"result"],[101,64,98,62],[101,66,98,64],[102,14,99,12],[102,18,99,12,"_optionalChain"],[102,30,99,26],[102,31,99,26,"_optionalChain"],[102,45,99,26],[102,47,99,27],[102,48,99,28,"span"],[102,52,99,32],[102,54,99,34],[102,70,99,50],[102,72,99,52,"_8"],[102,74,99,54],[102,78,99,58,"_8"],[102,80,99,60],[102,81,99,61,"finish"],[102,87,99,67],[102,89,99,69],[102,95,99,75],[102,97,99,77,"_9"],[102,99,99,79],[102,103,99,83,"_9"],[102,105,99,85],[102,106,99,86],[102,107,99,87],[102,108,99,88],[102,109,99,89],[103,14,100,12,"values"],[103,20,100,18],[103,21,100,19,"err"],[103,24,100,22],[103,26,100,24,"result"],[103,32,100,30],[103,33,100,31],[104,12,101,10],[104,13,101,11],[104,14,101,12],[105,10,102,8],[106,10,104,8],[106,16,104,14,"rv"],[106,18,104,16],[106,21,104,19],[106,28,104,26,"values"],[106,34,104,32],[106,39,104,37],[106,50,104,48],[106,53,104,51,"orig"],[106,57,104,55],[106,58,104,56,"call"],[106,62,104,60],[106,63,104,61],[106,67,104,65],[106,69,104,67,"config"],[106,75,104,73],[106,77,104,75,"values"],[106,83,104,81],[106,84,104,82],[106,87,104,85,"orig"],[106,91,104,89],[106,92,104,90,"call"],[106,96,104,94],[106,97,104,95],[106,101,104,99],[106,103,104,101,"config"],[106,109,104,107],[106,110,104,108],[107,10,106,8],[107,14,106,12],[107,18,106,12,"isThenable"],[107,30,106,22],[107,31,106,22,"isThenable"],[107,41,106,22],[107,43,106,23,"rv"],[107,45,106,25],[107,46,106,26],[107,48,106,28],[108,12,107,10],[108,19,107,17,"rv"],[108,21,107,19],[108,22,107,20,"then"],[108,26,107,24],[108,27,107,26,"res"],[108,30,107,29],[108,34,107,34],[109,14,108,12],[109,18,108,12,"_optionalChain"],[109,30,108,26],[109,31,108,26,"_optionalChain"],[109,45,108,26],[109,47,108,27],[109,48,108,28,"span"],[109,52,108,32],[109,54,108,34],[109,70,108,50],[109,72,108,52,"_10"],[109,75,108,55],[109,79,108,59,"_10"],[109,82,108,62],[109,83,108,63,"finish"],[109,89,108,69],[109,91,108,71],[109,97,108,77],[109,99,108,79,"_11"],[109,102,108,82],[109,106,108,86,"_11"],[109,109,108,89],[109,110,108,90],[109,111,108,91],[109,112,108,92],[109,113,108,93],[110,14,109,12],[110,21,109,19,"res"],[110,24,109,22],[111,12,110,10],[111,13,110,11],[111,14,110,12],[112,10,111,8],[113,10,113,8],[113,14,113,8,"_optionalChain"],[113,26,113,22],[113,27,113,22,"_optionalChain"],[113,41,113,22],[113,43,113,23],[113,44,113,24,"span"],[113,48,113,28],[113,50,113,30],[113,66,113,46],[113,68,113,48,"_12"],[113,71,113,51],[113,75,113,55,"_12"],[113,78,113,58],[113,79,113,59,"finish"],[113,85,113,65],[113,87,113,67],[113,93,113,73],[113,95,113,75,"_13"],[113,98,113,78],[113,102,113,82,"_13"],[113,105,113,85],[113,106,113,86],[113,107,113,87],[113,108,113,88],[113,109,113,89],[114,10,114,8],[114,17,114,15,"rv"],[114,19,114,17],[115,8,115,6],[115,9,115,7],[116,6,116,4],[116,7,116,5],[116,8,116,6],[117,4,117,2],[118,2,118,0],[119,2,118,1,"Postgres"],[119,10,118,9],[119,11,118,10,"__initStatic"],[119,23,118,22],[119,24,118,23],[119,25,118,24],[120,0,118,25],[120,3]],"functionMap":{"names":["<global>","Postgres","Postgres.__initStatic","Postgres#constructor","Postgres#loadDependency","Postgres#setupOnce","<anonymous>","fill$argument_2","orig.call$argument_3","orig.call$argument_2","rv.then$argument_0"],"mappings":"AAA;ACK;GCI,6CD;GEM;GFI;GGG;GHE;GIK;sECa,eD,oBC,eD;oCEc;aDC;iDEiC;oDFC,eE,UF,UE;WFE;yCGI;oDHC,eG,UH,UG;WHE;yBIM;oDJC,iBI,UJ,YI;WJE;OCK;KFC;GJC;CDC"},"hasCjsExports":false},"type":"js/module"}]}