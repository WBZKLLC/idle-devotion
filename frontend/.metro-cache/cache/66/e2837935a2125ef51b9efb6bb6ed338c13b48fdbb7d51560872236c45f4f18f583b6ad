{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n\n  /**\n   * Recursively traverses an object to update an existing nested key.\n   * Note: The provided key path must include existing properties,\n   * the function will not create objects while traversing.\n   *\n   * @param obj An object to update\n   * @param value The value to update the nested key with\n   * @param keyPath The path to the key to update ex. fizz.buzz.foo\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  function setNestedKey(obj, keyPath, value) {\n    // Ex. foo.bar.zoop will extract foo and bar.zoop\n    const match = keyPath.match(/([a-z_]+)\\.(.*)/i);\n    // The match will be null when there's no more recursing to do, i.e., when we've reached the right level of the object\n    if (match === null) {\n      obj[keyPath] = value;\n    } else {\n      // `match[1]` is the initial segment of the path, and `match[2]` is the remainder of the path\n      const innerObj = obj[match[1]];\n      setNestedKey(innerObj, match[2], value);\n    }\n  }\n\n  /**\n   * Enforces inclusion of a given integration with specified options in an integration array originally determined by the\n   * user, by either including the given default instance or by patching an existing user instance with the given options.\n   *\n   * Ideally this would happen when integrations are set up, but there isn't currently a mechanism there for merging\n   * options from a default integration instance with those from a user-provided instance of the same integration, only\n   * for allowing the user to override a default instance entirely. (TODO: Fix that.)\n   *\n   * @param defaultIntegrationInstance An instance of the integration with the correct options already set\n   * @param userIntegrations Integrations defined by the user.\n   * @param forcedOptions Options with which to patch an existing user-derived instance on the integration.\n   * @returns A final integrations array.\n   */\n  function addOrUpdateIntegration(defaultIntegrationInstance, userIntegrations, forcedOptions = {}) {\n    return Array.isArray(userIntegrations) ? addOrUpdateIntegrationInArray(defaultIntegrationInstance, userIntegrations, forcedOptions) : addOrUpdateIntegrationInFunction(defaultIntegrationInstance,\n    // Somehow TS can't figure out that not being an array makes this necessarily a function\n    userIntegrations, forcedOptions);\n  }\n  function addOrUpdateIntegrationInArray(defaultIntegrationInstance, userIntegrations, forcedOptions) {\n    const userInstance = userIntegrations.find(integration => integration.name === defaultIntegrationInstance.name);\n    if (userInstance) {\n      for (const [keyPath, value] of Object.entries(forcedOptions)) {\n        setNestedKey(userInstance, keyPath, value);\n      }\n      return userIntegrations;\n    }\n    return [...userIntegrations, defaultIntegrationInstance];\n  }\n  function addOrUpdateIntegrationInFunction(defaultIntegrationInstance, userIntegrationsFunc, forcedOptions) {\n    const wrapper = defaultIntegrations => {\n      const userFinalIntegrations = userIntegrationsFunc(defaultIntegrations);\n\n      // There are instances where we want the user to be able to prevent an integration from appearing at all, which they\n      // would do by providing a function which filters out the integration in question. If that's happened in one of\n      // those cases, don't add our default back in.\n      if (defaultIntegrationInstance.allowExclusionByUser) {\n        const userFinalInstance = userFinalIntegrations.find(integration => integration.name === defaultIntegrationInstance.name);\n        if (!userFinalInstance) {\n          return userFinalIntegrations;\n        }\n      }\n      return addOrUpdateIntegrationInArray(defaultIntegrationInstance, userFinalIntegrations, forcedOptions);\n    };\n    return wrapper;\n  }\n  exports.addOrUpdateIntegration = addOrUpdateIntegration;\n});","lineCount":75,"map":[[2,2,1,0,"Object"],[2,8,1,6],[2,9,1,7,"defineProperty"],[2,23,1,21],[2,24,1,22,"exports"],[2,31,1,29],[2,33,1,31],[2,45,1,43],[2,47,1,45],[3,4,1,47,"value"],[3,9,1,52],[3,11,1,54],[4,2,1,59],[4,3,1,60],[4,4,1,61],[6,2,3,0],[7,0,4,0],[8,0,5,0],[9,0,6,0],[10,0,7,0],[11,0,8,0],[12,0,9,0],[13,0,10,0],[14,0,11,0],[15,2,12,0],[16,2,13,0],[16,11,13,9,"setNestedKey"],[16,23,13,21,"setNestedKey"],[16,24,13,22,"obj"],[16,27,13,25],[16,29,13,27,"keyPath"],[16,36,13,34],[16,38,13,36,"value"],[16,43,13,41],[16,45,13,43],[17,4,14,2],[18,4,15,2],[18,10,15,8,"match"],[18,15,15,13],[18,18,15,16,"keyPath"],[18,25,15,23],[18,26,15,24,"match"],[18,31,15,29],[18,32,15,30],[18,50,15,48],[18,51,15,49],[19,4,16,2],[20,4,17,2],[20,8,17,6,"match"],[20,13,17,11],[20,18,17,16],[20,22,17,20],[20,24,17,22],[21,6,18,4,"obj"],[21,9,18,7],[21,10,18,8,"keyPath"],[21,17,18,15],[21,18,18,16],[21,21,18,19,"value"],[21,26,18,24],[22,4,19,2],[22,5,19,3],[22,11,19,9],[23,6,20,4],[24,6,21,4],[24,12,21,10,"innerObj"],[24,20,21,18],[24,23,21,21,"obj"],[24,26,21,24],[24,27,21,25,"match"],[24,32,21,30],[24,33,21,31],[24,34,21,32],[24,35,21,33],[24,36,21,34],[25,6,22,4,"setNestedKey"],[25,18,22,16],[25,19,22,17,"innerObj"],[25,27,22,25],[25,29,22,27,"match"],[25,34,22,32],[25,35,22,33],[25,36,22,34],[25,37,22,35],[25,39,22,37,"value"],[25,44,22,42],[25,45,22,43],[26,4,23,2],[27,2,24,0],[29,2,26,0],[30,0,27,0],[31,0,28,0],[32,0,29,0],[33,0,30,0],[34,0,31,0],[35,0,32,0],[36,0,33,0],[37,0,34,0],[38,0,35,0],[39,0,36,0],[40,0,37,0],[41,0,38,0],[42,2,39,0],[42,11,39,9,"addOrUpdateIntegration"],[42,33,39,31,"addOrUpdateIntegration"],[42,34,40,2,"defaultIntegrationInstance"],[42,60,40,28],[42,62,41,2,"userIntegrations"],[42,78,41,18],[42,80,42,2,"forcedOptions"],[42,93,42,15],[42,96,42,18],[42,97,42,19],[42,98,42,20],[42,100,43,2],[43,4,44,2],[43,11,45,4,"Array"],[43,16,45,9],[43,17,45,10,"isArray"],[43,24,45,17],[43,25,45,18,"userIntegrations"],[43,41,45,34],[43,42,45,35],[43,45,46,8,"addOrUpdateIntegrationInArray"],[43,74,46,37],[43,75,46,38,"defaultIntegrationInstance"],[43,101,46,64],[43,103,46,66,"userIntegrations"],[43,119,46,82],[43,121,46,84,"forcedOptions"],[43,134,46,97],[43,135,46,98],[43,138,47,8,"addOrUpdateIntegrationInFunction"],[43,170,47,40],[43,171,48,10,"defaultIntegrationInstance"],[43,197,48,36],[44,4,49,10],[45,4,50,10,"userIntegrations"],[45,20,50,26],[45,22,51,10,"forcedOptions"],[45,35,52,8],[45,36,52,9],[46,2,54,0],[47,2,56,0],[47,11,56,9,"addOrUpdateIntegrationInArray"],[47,40,56,38,"addOrUpdateIntegrationInArray"],[47,41,57,2,"defaultIntegrationInstance"],[47,67,57,28],[47,69,58,2,"userIntegrations"],[47,85,58,18],[47,87,59,2,"forcedOptions"],[47,100,59,15],[47,102,60,2],[48,4,61,2],[48,10,61,8,"userInstance"],[48,22,61,20],[48,25,61,23,"userIntegrations"],[48,41,61,39],[48,42,61,40,"find"],[48,46,61,44],[48,47,61,45,"integration"],[48,58,61,56],[48,62,61,60,"integration"],[48,73,61,71],[48,74,61,72,"name"],[48,78,61,76],[48,83,61,81,"defaultIntegrationInstance"],[48,109,61,107],[48,110,61,108,"name"],[48,114,61,112],[48,115,61,113],[49,4,63,2],[49,8,63,6,"userInstance"],[49,20,63,18],[49,22,63,20],[50,6,64,4],[50,11,64,9],[50,17,64,15],[50,18,64,16,"keyPath"],[50,25,64,23],[50,27,64,25,"value"],[50,32,64,30],[50,33,64,31],[50,37,64,35,"Object"],[50,43,64,41],[50,44,64,42,"entries"],[50,51,64,49],[50,52,64,50,"forcedOptions"],[50,65,64,63],[50,66,64,64],[50,68,64,66],[51,8,65,6,"setNestedKey"],[51,20,65,18],[51,21,65,19,"userInstance"],[51,33,65,31],[51,35,65,33,"keyPath"],[51,42,65,40],[51,44,65,42,"value"],[51,49,65,47],[51,50,65,48],[52,6,66,4],[53,6,68,4],[53,13,68,11,"userIntegrations"],[53,29,68,27],[54,4,69,2],[55,4,71,2],[55,11,71,9],[55,12,71,10],[55,15,71,13,"userIntegrations"],[55,31,71,29],[55,33,71,31,"defaultIntegrationInstance"],[55,59,71,57],[55,60,71,58],[56,2,72,0],[57,2,74,0],[57,11,74,9,"addOrUpdateIntegrationInFunction"],[57,43,74,41,"addOrUpdateIntegrationInFunction"],[57,44,75,2,"defaultIntegrationInstance"],[57,70,75,28],[57,72,76,2,"userIntegrationsFunc"],[57,92,76,22],[57,94,77,2,"forcedOptions"],[57,107,77,15],[57,109,78,2],[58,4,79,2],[58,10,79,8,"wrapper"],[58,17,79,15],[58,20,79,18,"defaultIntegrations"],[58,39,79,37],[58,43,79,41],[59,6,80,4],[59,12,80,10,"userFinalIntegrations"],[59,33,80,31],[59,36,80,34,"userIntegrationsFunc"],[59,56,80,54],[59,57,80,55,"defaultIntegrations"],[59,76,80,74],[59,77,80,75],[61,6,82,4],[62,6,83,4],[63,6,84,4],[64,6,85,4],[64,10,85,8,"defaultIntegrationInstance"],[64,36,85,34],[64,37,85,35,"allowExclusionByUser"],[64,57,85,55],[64,59,85,57],[65,8,86,6],[65,14,86,12,"userFinalInstance"],[65,31,86,29],[65,34,86,32,"userFinalIntegrations"],[65,55,86,53],[65,56,86,54,"find"],[65,60,86,58],[65,61,87,8,"integration"],[65,72,87,19],[65,76,87,23,"integration"],[65,87,87,34],[65,88,87,35,"name"],[65,92,87,39],[65,97,87,44,"defaultIntegrationInstance"],[65,123,87,70],[65,124,87,71,"name"],[65,128,88,6],[65,129,88,7],[66,8,89,6],[66,12,89,10],[66,13,89,11,"userFinalInstance"],[66,30,89,28],[66,32,89,30],[67,10,90,8],[67,17,90,15,"userFinalIntegrations"],[67,38,90,36],[68,8,91,6],[69,6,92,4],[70,6,94,4],[70,13,94,11,"addOrUpdateIntegrationInArray"],[70,42,94,40],[70,43,94,41,"defaultIntegrationInstance"],[70,69,94,67],[70,71,94,69,"userFinalIntegrations"],[70,92,94,90],[70,94,94,92,"forcedOptions"],[70,107,94,105],[70,108,94,106],[71,4,95,2],[71,5,95,3],[72,4,97,2],[72,11,97,9,"wrapper"],[72,18,97,16],[73,2,98,0],[74,2,100,0,"exports"],[74,9,100,7],[74,10,100,8,"addOrUpdateIntegration"],[74,32,100,30],[74,35,100,33,"addOrUpdateIntegration"],[74,57,100,55],[75,0,100,56],[75,3]],"functionMap":{"names":["<global>","setNestedKey","addOrUpdateIntegration","addOrUpdateIntegrationInArray","find$argument_0","addOrUpdateIntegrationInFunction","wrapper","userFinalIntegrations.find$argument_0"],"mappings":"AAA;ACY;CDW;AEe;CFe;AGE;6CCK,mED;CHW;AKE;kBCK;QCQ,mED;GDQ;CLG"},"hasCjsExports":true},"type":"js/module"}]}