{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":11,"column":0,"index":282},"end":{"line":11,"column":33,"index":315}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"../lib/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":12,"column":0,"index":316},"end":{"line":12,"column":71,"index":387}}],"key":"cGGbCGri3M695PzY+v7ylQ+Rxt0=","exportNames":["*"],"imports":1}},{"name":"../lib/entitlements","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0,"index":388},"end":{"line":13,"column":56,"index":444}}],"key":"9bldRk12goaus0AAGJjvc7/sjm0=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"useEntitlementStore\", {\n    enumerable: true,\n    get: function () {\n      return useEntitlementStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var _libStorage = require(_dependencyMap[1], \"../lib/storage\");\n  var _libEntitlements = require(_dependencyMap[2], \"../lib/entitlements\");\n  /**\n   * Entitlement Store\n   * \n   * Manages paid feature entitlements (offline-first, cached).\n   * Supports both global keys (PAID_CINEMATICS_PACK) and\n   * dynamic per-hero keys (CINEMATIC_OWNED:<heroId>).\n   * \n   * Future: will integrate with StoreKit/Play Billing for real purchases.\n   */\n\n  const STORAGE_KEY = '@idledevotion/entitlements/v2';\n  const useEntitlementStore = (0, _zustand.create)((set, get) => ({\n    entitlements: {},\n    isHydrated: false,\n    hydrateEntitlements: async () => {\n      try {\n        const raw = await (0, _libStorage.storageGet)(STORAGE_KEY);\n        if (!raw) {\n          set({\n            isHydrated: true\n          });\n          return;\n        }\n        const parsed = JSON.parse(raw);\n        set({\n          entitlements: parsed?.entitlements ?? {},\n          isHydrated: true\n        });\n        if (__DEV__) {\n          console.log('[entitlementStore] Hydrated:', Object.keys(parsed?.entitlements ?? {}));\n        }\n      } catch (e) {\n        console.error('[entitlementStore] Hydration error:', e);\n        set({\n          isHydrated: true\n        });\n      }\n    },\n    hasEntitlement: key => Boolean(get().entitlements[key]),\n    setEntitlement: async (key, value) => {\n      const current = get().entitlements;\n      const next = Object.assign({}, current);\n      if (value) {\n        next[key] = true;\n      } else {\n        delete next[key];\n      }\n      set({\n        entitlements: next\n      });\n      await (0, _libStorage.storageSet)(STORAGE_KEY, JSON.stringify({\n        entitlements: next\n      }));\n      if (__DEV__) {\n        console.log(`[entitlementStore] Set ${key} = ${value}`);\n      }\n    },\n    // Convenience: per-hero cinematic ownership\n    hasHeroCinematicOwned: heroId => {\n      const key = (0, _libEntitlements.cinematicOwnedKey)(heroId);\n      return Boolean(get().entitlements[key]);\n    },\n    setHeroCinematicOwned: async (heroId, owned) => {\n      const key = (0, _libEntitlements.cinematicOwnedKey)(heroId);\n      await get().setEntitlement(key, owned);\n    },\n    // DEV ONLY: Grant entitlement for testing\n    grantEntitlementDevOnly: async key => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] grantEntitlementDevOnly called in production!');\n        return;\n      }\n      await get().setEntitlement(key, true);\n      console.log('[entitlementStore] DEV: Granted', key);\n    },\n    // DEV ONLY: Revoke entitlement for testing\n    revokeEntitlementDevOnly: async key => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] revokeEntitlementDevOnly called in production!');\n        return;\n      }\n      await get().setEntitlement(key, false);\n      console.log('[entitlementStore] DEV: Revoked', key);\n    },\n    // DEV ONLY: Clear all entitlements\n    clearAllEntitlementsDevOnly: async () => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] clearAllEntitlementsDevOnly called in production!');\n        return;\n      }\n      set({\n        entitlements: {}\n      });\n      await (0, _libStorage.storageRemove)(STORAGE_KEY);\n      console.log('[entitlementStore] DEV: Cleared all entitlements');\n    }\n  }));\n});","lineCount":113,"map":[[7,2,39,0,"Object"],[7,8,39,0],[7,9,39,0,"defineProperty"],[7,23,39,0],[7,24,39,0,"exports"],[7,31,39,0],[8,4,39,0,"enumerable"],[8,14,39,0],[9,4,39,0,"get"],[9,7,39,0],[9,18,39,0,"get"],[9,19,39,0],[10,6,39,0],[10,13,39,0,"useEntitlementStore"],[10,32,39,0],[11,4,39,0],[12,2,39,0],[13,2,11,0],[13,6,11,0,"_zustand"],[13,14,11,0],[13,17,11,0,"require"],[13,24,11,0],[13,25,11,0,"_dependencyMap"],[13,39,11,0],[14,2,12,0],[14,6,12,0,"_libStorage"],[14,17,12,0],[14,20,12,0,"require"],[14,27,12,0],[14,28,12,0,"_dependencyMap"],[14,42,12,0],[15,2,13,0],[15,6,13,0,"_libEntitlements"],[15,22,13,0],[15,25,13,0,"require"],[15,32,13,0],[15,33,13,0,"_dependencyMap"],[15,47,13,0],[16,2,1,0],[17,0,2,0],[18,0,3,0],[19,0,4,0],[20,0,5,0],[21,0,6,0],[22,0,7,0],[23,0,8,0],[24,0,9,0],[26,2,15,0],[26,8,15,6,"STORAGE_KEY"],[26,19,15,17],[26,22,15,20],[26,53,15,51],[27,2,39,7],[27,8,39,13,"useEntitlementStore"],[27,27,39,32],[27,30,39,35],[27,34,39,35,"create"],[27,42,39,41],[27,43,39,41,"create"],[27,49,39,41],[27,51,39,60],[27,52,39,61,"set"],[27,55,39,64],[27,57,39,66,"get"],[27,60,39,69],[27,66,39,75],[28,4,40,2,"entitlements"],[28,16,40,14],[28,18,40,16],[28,19,40,17],[28,20,40,18],[29,4,41,2,"isHydrated"],[29,14,41,12],[29,16,41,14],[29,21,41,19],[30,4,43,2,"hydrateEntitlements"],[30,23,43,21],[30,25,43,23],[30,31,43,23,"hydrateEntitlements"],[30,32,43,23],[30,37,43,35],[31,6,44,4],[31,10,44,8],[32,8,45,6],[32,14,45,12,"raw"],[32,17,45,15],[32,20,45,18],[32,26,45,24],[32,30,45,24,"storageGet"],[32,41,45,34],[32,42,45,34,"storageGet"],[32,52,45,34],[32,54,45,35,"STORAGE_KEY"],[32,65,45,46],[32,66,45,47],[33,8,46,6],[33,12,46,10],[33,13,46,11,"raw"],[33,16,46,14],[33,18,46,16],[34,10,47,8,"set"],[34,13,47,11],[34,14,47,12],[35,12,47,14,"isHydrated"],[35,22,47,24],[35,24,47,26],[36,10,47,31],[36,11,47,32],[36,12,47,33],[37,10,48,8],[38,8,49,6],[39,8,50,6],[39,14,50,12,"parsed"],[39,20,50,18],[39,23,50,21,"JSON"],[39,27,50,25],[39,28,50,26,"parse"],[39,33,50,31],[39,34,50,32,"raw"],[39,37,50,35],[39,38,50,36],[40,8,51,6,"set"],[40,11,51,9],[40,12,51,10],[41,10,51,12,"entitlements"],[41,22,51,24],[41,24,51,26,"parsed"],[41,30,51,32],[41,32,51,34,"entitlements"],[41,44,51,46],[41,48,51,50],[41,49,51,51],[41,50,51,52],[42,10,51,54,"isHydrated"],[42,20,51,64],[42,22,51,66],[43,8,51,71],[43,9,51,72],[43,10,51,73],[44,8,52,6],[44,12,52,10,"__DEV__"],[44,19,52,17],[44,21,52,19],[45,10,53,8,"console"],[45,17,53,15],[45,18,53,16,"log"],[45,21,53,19],[45,22,53,20],[45,52,53,50],[45,54,53,52,"Object"],[45,60,53,58],[45,61,53,59,"keys"],[45,65,53,63],[45,66,53,64,"parsed"],[45,72,53,70],[45,74,53,72,"entitlements"],[45,86,53,84],[45,90,53,88],[45,91,53,89],[45,92,53,90],[45,93,53,91],[45,94,53,92],[46,8,54,6],[47,6,55,4],[47,7,55,5],[47,8,55,6],[47,15,55,13,"e"],[47,16,55,14],[47,18,55,16],[48,8,56,6,"console"],[48,15,56,13],[48,16,56,14,"error"],[48,21,56,19],[48,22,56,20],[48,59,56,57],[48,61,56,59,"e"],[48,62,56,60],[48,63,56,61],[49,8,57,6,"set"],[49,11,57,9],[49,12,57,10],[50,10,57,12,"isHydrated"],[50,20,57,22],[50,22,57,24],[51,8,57,29],[51,9,57,30],[51,10,57,31],[52,6,58,4],[53,4,59,2],[53,5,59,3],[54,4,61,2,"hasEntitlement"],[54,18,61,16],[54,20,61,19,"key"],[54,23,61,30],[54,27,61,35,"Boolean"],[54,34,61,42],[54,35,61,43,"get"],[54,38,61,46],[54,39,61,47],[54,40,61,48],[54,41,61,49,"entitlements"],[54,53,61,61],[54,54,61,62,"key"],[54,57,61,65],[54,58,61,66],[54,59,61,67],[55,4,63,2,"setEntitlement"],[55,18,63,16],[55,20,63,18],[55,26,63,18,"setEntitlement"],[55,27,63,25,"key"],[55,30,63,36],[55,32,63,38,"value"],[55,37,63,52],[55,42,63,57],[56,6,64,4],[56,12,64,10,"current"],[56,19,64,17],[56,22,64,20,"get"],[56,25,64,23],[56,26,64,24],[56,27,64,25],[56,28,64,26,"entitlements"],[56,40,64,38],[57,6,65,4],[57,12,65,10,"next"],[57,16,65,14],[57,19,65,14,"Object"],[57,25,65,14],[57,26,65,14,"assign"],[57,32,65,14],[57,37,65,22,"current"],[57,44,65,29],[57,45,65,31],[58,6,66,4],[58,10,66,8,"value"],[58,15,66,13],[58,17,66,15],[59,8,67,6,"next"],[59,12,67,10],[59,13,67,11,"key"],[59,16,67,14],[59,17,67,15],[59,20,67,18],[59,24,67,22],[60,6,68,4],[60,7,68,5],[60,13,68,11],[61,8,69,6],[61,15,69,13,"next"],[61,19,69,17],[61,20,69,18,"key"],[61,23,69,21],[61,24,69,22],[62,6,70,4],[63,6,71,4,"set"],[63,9,71,7],[63,10,71,8],[64,8,71,10,"entitlements"],[64,20,71,22],[64,22,71,24,"next"],[65,6,71,29],[65,7,71,30],[65,8,71,31],[66,6,72,4],[66,12,72,10],[66,16,72,10,"storageSet"],[66,27,72,20],[66,28,72,20,"storageSet"],[66,38,72,20],[66,40,72,21,"STORAGE_KEY"],[66,51,72,32],[66,53,72,34,"JSON"],[66,57,72,38],[66,58,72,39,"stringify"],[66,67,72,48],[66,68,72,49],[67,8,72,51,"entitlements"],[67,20,72,63],[67,22,72,65,"next"],[68,6,72,70],[68,7,72,71],[68,8,72,72],[68,9,72,73],[69,6,73,4],[69,10,73,8,"__DEV__"],[69,17,73,15],[69,19,73,17],[70,8,74,6,"console"],[70,15,74,13],[70,16,74,14,"log"],[70,19,74,17],[70,20,74,18],[70,46,74,44,"key"],[70,49,74,47],[70,55,74,53,"value"],[70,60,74,58],[70,62,74,60],[70,63,74,61],[71,6,75,4],[72,4,76,2],[72,5,76,3],[73,4,78,2],[74,4,79,2,"hasHeroCinematicOwned"],[74,25,79,23],[74,27,79,26,"heroId"],[74,33,79,40],[74,37,79,45],[75,6,80,4],[75,12,80,10,"key"],[75,15,80,13],[75,18,80,16],[75,22,80,16,"cinematicOwnedKey"],[75,38,80,33],[75,39,80,33,"cinematicOwnedKey"],[75,56,80,33],[75,58,80,34,"heroId"],[75,64,80,40],[75,65,80,41],[76,6,81,4],[76,13,81,11,"Boolean"],[76,20,81,18],[76,21,81,19,"get"],[76,24,81,22],[76,25,81,23],[76,26,81,24],[76,27,81,25,"entitlements"],[76,39,81,37],[76,40,81,38,"key"],[76,43,81,41],[76,44,81,42],[76,45,81,43],[77,4,82,2],[77,5,82,3],[78,4,84,2,"setHeroCinematicOwned"],[78,25,84,23],[78,27,84,25],[78,33,84,25,"setHeroCinematicOwned"],[78,34,84,32,"heroId"],[78,40,84,46],[78,42,84,48,"owned"],[78,47,84,62],[78,52,84,67],[79,6,85,4],[79,12,85,10,"key"],[79,15,85,13],[79,18,85,16],[79,22,85,16,"cinematicOwnedKey"],[79,38,85,33],[79,39,85,33,"cinematicOwnedKey"],[79,56,85,33],[79,58,85,34,"heroId"],[79,64,85,40],[79,65,85,41],[80,6,86,4],[80,12,86,10,"get"],[80,15,86,13],[80,16,86,14],[80,17,86,15],[80,18,86,16,"setEntitlement"],[80,32,86,30],[80,33,86,31,"key"],[80,36,86,34],[80,38,86,36,"owned"],[80,43,86,41],[80,44,86,42],[81,4,87,2],[81,5,87,3],[82,4,89,2],[83,4,90,2,"grantEntitlementDevOnly"],[83,27,90,25],[83,29,90,27],[83,35,90,34,"key"],[83,38,90,45],[83,42,90,50],[84,6,91,4],[84,10,91,8],[84,11,91,9,"__DEV__"],[84,18,91,16],[84,20,91,18],[85,8,92,6,"console"],[85,15,92,13],[85,16,92,14,"warn"],[85,20,92,18],[85,21,92,19],[85,87,92,85],[85,88,92,86],[86,8,93,6],[87,6,94,4],[88,6,95,4],[88,12,95,10,"get"],[88,15,95,13],[88,16,95,14],[88,17,95,15],[88,18,95,16,"setEntitlement"],[88,32,95,30],[88,33,95,31,"key"],[88,36,95,34],[88,38,95,36],[88,42,95,40],[88,43,95,41],[89,6,96,4,"console"],[89,13,96,11],[89,14,96,12,"log"],[89,17,96,15],[89,18,96,16],[89,51,96,49],[89,53,96,51,"key"],[89,56,96,54],[89,57,96,55],[90,4,97,2],[90,5,97,3],[91,4,99,2],[92,4,100,2,"revokeEntitlementDevOnly"],[92,28,100,26],[92,30,100,28],[92,36,100,35,"key"],[92,39,100,46],[92,43,100,51],[93,6,101,4],[93,10,101,8],[93,11,101,9,"__DEV__"],[93,18,101,16],[93,20,101,18],[94,8,102,6,"console"],[94,15,102,13],[94,16,102,14,"warn"],[94,20,102,18],[94,21,102,19],[94,88,102,86],[94,89,102,87],[95,8,103,6],[96,6,104,4],[97,6,105,4],[97,12,105,10,"get"],[97,15,105,13],[97,16,105,14],[97,17,105,15],[97,18,105,16,"setEntitlement"],[97,32,105,30],[97,33,105,31,"key"],[97,36,105,34],[97,38,105,36],[97,43,105,41],[97,44,105,42],[98,6,106,4,"console"],[98,13,106,11],[98,14,106,12,"log"],[98,17,106,15],[98,18,106,16],[98,51,106,49],[98,53,106,51,"key"],[98,56,106,54],[98,57,106,55],[99,4,107,2],[99,5,107,3],[100,4,109,2],[101,4,110,2,"clearAllEntitlementsDevOnly"],[101,31,110,29],[101,33,110,31],[101,39,110,31,"clearAllEntitlementsDevOnly"],[101,40,110,31],[101,45,110,43],[102,6,111,4],[102,10,111,8],[102,11,111,9,"__DEV__"],[102,18,111,16],[102,20,111,18],[103,8,112,6,"console"],[103,15,112,13],[103,16,112,14,"warn"],[103,20,112,18],[103,21,112,19],[103,91,112,89],[103,92,112,90],[104,8,113,6],[105,6,114,4],[106,6,115,4,"set"],[106,9,115,7],[106,10,115,8],[107,8,115,10,"entitlements"],[107,20,115,22],[107,22,115,24],[107,23,115,25],[108,6,115,27],[108,7,115,28],[108,8,115,29],[109,6,116,4],[109,12,116,10],[109,16,116,10,"storageRemove"],[109,27,116,23],[109,28,116,23,"storageRemove"],[109,41,116,23],[109,43,116,24,"STORAGE_KEY"],[109,54,116,35],[109,55,116,36],[110,6,117,4,"console"],[110,13,117,11],[110,14,117,12,"log"],[110,17,117,15],[110,18,117,16],[110,68,117,66],[110,69,117,67],[111,4,118,2],[112,2,119,0],[112,3,119,1],[112,4,119,2],[112,5,119,3],[113,0,119,4],[113,3]],"functionMap":{"names":["<global>","create$argument_0","hydrateEntitlements","hasEntitlement","setEntitlement","hasHeroCinematicOwned","setHeroCinematicOwned","grantEntitlementDevOnly","revokeEntitlementDevOnly","clearAllEntitlementsDevOnly"],"mappings":"AAA;4DCsC;uBCI;GDgB;kBEE,iDF;kBGE;GHa;yBIG;GJG;yBKE;GLG;2BMG;GNO;4BOG;GPO;+BQG;GRQ;EDC"},"hasCjsExports":false},"type":"js/module"}]}