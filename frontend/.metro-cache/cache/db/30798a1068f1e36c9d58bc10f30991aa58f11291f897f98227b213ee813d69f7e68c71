{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"../authStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":201},"end":{"line":9,"column":47,"index":248}}],"key":"8h7N/7sKemAZqrgZg8dH/jTl5ys=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"API_BASE\", {\n    enumerable: true,\n    get: function () {\n      return API_BASE;\n    }\n  });\n  exports.apiUrl = apiUrl;\n  exports.getAuthHeaders = getAuthHeaders;\n  exports.getJsonHeaders = getJsonHeaders;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[1], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _authStorage = require(_dependencyMap[2], \"../authStorage\");\n  /**\n   * Centralized API Configuration\n   * \n   * Single source of truth for API base URL across all platforms.\n   * Web preview, device, and tunnel all use this.\n   */\n\n  /**\n   * Get the API base URL based on platform and environment.\n   * \n   * Priority:\n   * 1. EXPO_PUBLIC_BACKEND_URL (if set)\n   * 2. EXPO_PUBLIC_API_URL (legacy fallback)\n   * 3. Platform-specific defaults\n   */\n  function getApiBaseUrl() {\n    // Check environment variables - normalize trailing slashes\n    const RAW = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL ?? _expoVirtualEnv.env.EXPO_PUBLIC_API_URL ?? '';\n\n    // Use explicitly set URLs first (trimmed of trailing slashes)\n    if (RAW) {\n      return RAW.replace(/\\/+$/, '');\n    }\n\n    // Platform-specific defaults when no env var is set\n    if (Platform.default.OS === 'web') {\n      // Web preview: use relative paths (assumes proxy is configured)\n      // If no proxy, this will fail - but that's expected\n      return '';\n    }\n\n    // Native device: default to localhost:8001 (won't work on real device without tunnel)\n    // In production, EXPO_PUBLIC_BACKEND_URL should always be set\n    return 'http://localhost:8001';\n  }\n\n  /**\n   * The API base URL - use this everywhere instead of hardcoding.\n   * \n   * Usage:\n   *   import { API_BASE } from '@/lib/api/config';\n   *   fetch(`${API_BASE}/api/endpoint`, { ... });\n   */\n  const API_BASE = getApiBaseUrl();\n\n  /**\n   * Construct a full API URL.\n   * \n   * @param path - The API path (e.g., '/api/daily/status')\n   * @returns Full URL with base\n   */\n  function apiUrl(path) {\n    // Ensure path starts with /\n    const normalizedPath = path.startsWith('/') ? path : `/${path}`;\n    return `${API_BASE}${normalizedPath}`;\n  }\n\n  /**\n   * Get auth headers for API requests (without Content-Type).\n   * Use this for FormData uploads where browser sets Content-Type automatically.\n   * \n   * @returns Headers object with Authorization if token exists\n   */\n  async function getAuthHeaders() {\n    const token = await (0, _authStorage.loadAuthToken)();\n    if (token) {\n      return {\n        'Authorization': `Bearer ${token}`\n      };\n    }\n    return {};\n  }\n\n  /**\n   * Get auth + JSON headers for typical API requests.\n   * Single source of truth - all API modules should use this for JSON endpoints.\n   * \n   * @returns Headers object with Authorization (if token) + Content-Type\n   */\n  async function getJsonHeaders() {\n    const auth = await getAuthHeaders();\n    return Object.assign({}, auth, {\n      'Content-Type': 'application/json'\n    });\n  }\n\n  // Log the API base URL in development for debugging\n  if (__DEV__) {\n    console.log('[API Config] Base URL:', API_BASE || '(relative paths)');\n    console.log('[API Config] Platform:', Platform.default.OS);\n\n    // WARN if API_BASE is empty - likely means env var not picked up\n    if (!API_BASE) {\n      console.warn('[API Config] ⚠️ API_BASE is empty! ' + 'Set EXPO_PUBLIC_BACKEND_URL in .env for web preview to work. ' + 'Falling back to relative paths (will 404 if no proxy configured).');\n    }\n  }\n});","lineCount":121,"map":[[12,2,49,0,"Object"],[12,8,49,0],[12,9,49,0,"defineProperty"],[12,23,49,0],[12,24,49,0,"exports"],[12,31,49,0],[13,4,49,0,"enumerable"],[13,14,49,0],[14,4,49,0,"get"],[14,7,49,0],[14,18,49,0,"get"],[14,19,49,0],[15,6,49,0],[15,13,49,0,"API_BASE"],[15,21,49,0],[16,4,49,0],[17,2,49,0],[18,2,57,0,"exports"],[18,9,57,0],[18,10,57,0,"apiUrl"],[18,16,57,0],[18,19,57,0,"apiUrl"],[18,25,57,0],[19,2,69,0,"exports"],[19,9,69,0],[19,10,69,0,"getAuthHeaders"],[19,24,69,0],[19,27,69,0,"getAuthHeaders"],[19,41,69,0],[20,2,83,0,"exports"],[20,9,83,0],[20,10,83,0,"getJsonHeaders"],[20,24,83,0],[20,27,83,0,"getJsonHeaders"],[20,41,83,0],[21,2,89,1],[21,6,89,1,"_expoVirtualEnv"],[21,21,89,1],[21,24,89,1,"require"],[21,31,89,1],[21,32,89,1,"_dependencyMap"],[21,46,89,1],[22,2,89,1],[22,6,89,1,"_reactNativeWebDistExportsPlatform"],[22,40,89,1],[22,43,89,1,"require"],[22,50,89,1],[22,51,89,1,"_dependencyMap"],[22,65,89,1],[23,2,89,1],[23,6,89,1,"Platform"],[23,14,89,1],[23,17,89,1,"_interopDefault"],[23,32,89,1],[23,33,89,1,"_reactNativeWebDistExportsPlatform"],[23,67,89,1],[24,2,9,0],[24,6,9,0,"_authStorage"],[24,18,9,0],[24,21,9,0,"require"],[24,28,9,0],[24,29,9,0,"_dependencyMap"],[24,43,9,0],[25,2,1,0],[26,0,2,0],[27,0,3,0],[28,0,4,0],[29,0,5,0],[30,0,6,0],[32,2,11,0],[33,0,12,0],[34,0,13,0],[35,0,14,0],[36,0,15,0],[37,0,16,0],[38,0,17,0],[39,0,18,0],[40,2,19,0],[40,11,19,9,"getApiBaseUrl"],[40,24,19,22,"getApiBaseUrl"],[40,25,19,22],[40,27,19,33],[41,4,20,2],[42,4,21,2],[42,10,21,8,"RAW"],[42,13,21,11],[42,16,21,14,"_expoVirtualEnv"],[42,31,21,14],[42,32,21,14,"env"],[42,35,21,14],[42,36,21,14,"EXPO_PUBLIC_BACKEND_URL"],[42,59,21,14],[42,63,21,14,"_expoVirtualEnv"],[42,78,21,14],[42,79,21,14,"env"],[42,82,21,14],[42,83,21,14,"EXPO_PUBLIC_API_URL"],[42,102,22,38],[42,106,23,7],[42,108,23,9],[44,4,25,2],[45,4,26,2],[45,8,26,6,"RAW"],[45,11,26,9],[45,13,26,11],[46,6,27,4],[46,13,27,11,"RAW"],[46,16,27,14],[46,17,27,15,"replace"],[46,24,27,22],[46,25,27,23],[46,31,27,29],[46,33,27,31],[46,35,27,33],[46,36,27,34],[47,4,28,2],[49,4,30,2],[50,4,31,2],[50,8,31,6,"Platform"],[50,16,31,14],[50,17,31,14,"default"],[50,24,31,14],[50,25,31,15,"OS"],[50,27,31,17],[50,32,31,22],[50,37,31,27],[50,39,31,29],[51,6,32,4],[52,6,33,4],[53,6,34,4],[53,13,34,11],[53,15,34,13],[54,4,35,2],[56,4,37,2],[57,4,38,2],[58,4,39,2],[58,11,39,9],[58,34,39,32],[59,2,40,0],[61,2,42,0],[62,0,43,0],[63,0,44,0],[64,0,45,0],[65,0,46,0],[66,0,47,0],[67,0,48,0],[68,2,49,7],[68,8,49,13,"API_BASE"],[68,16,49,21],[68,19,49,24,"getApiBaseUrl"],[68,32,49,37],[68,33,49,38],[68,34,49,39],[70,2,51,0],[71,0,52,0],[72,0,53,0],[73,0,54,0],[74,0,55,0],[75,0,56,0],[76,2,57,7],[76,11,57,16,"apiUrl"],[76,17,57,22,"apiUrl"],[76,18,57,23,"path"],[76,22,57,35],[76,24,57,45],[77,4,58,2],[78,4,59,2],[78,10,59,8,"normalizedPath"],[78,24,59,22],[78,27,59,25,"path"],[78,31,59,29],[78,32,59,30,"startsWith"],[78,42,59,40],[78,43,59,41],[78,46,59,44],[78,47,59,45],[78,50,59,48,"path"],[78,54,59,52],[78,57,59,55],[78,61,59,59,"path"],[78,65,59,63],[78,67,59,65],[79,4,60,2],[79,11,60,9],[79,14,60,12,"API_BASE"],[79,22,60,20],[79,25,60,23,"normalizedPath"],[79,39,60,37],[79,41,60,39],[80,2,61,0],[82,2,63,0],[83,0,64,0],[84,0,65,0],[85,0,66,0],[86,0,67,0],[87,0,68,0],[88,2,69,7],[88,17,69,22,"getAuthHeaders"],[88,31,69,36,"getAuthHeaders"],[88,32,69,36],[88,34,69,72],[89,4,70,2],[89,10,70,8,"token"],[89,15,70,13],[89,18,70,16],[89,24,70,22],[89,28,70,22,"loadAuthToken"],[89,40,70,35],[89,41,70,35,"loadAuthToken"],[89,54,70,35],[89,56,70,36],[89,57,70,37],[90,4,71,2],[90,8,71,6,"token"],[90,13,71,11],[90,15,71,13],[91,6,72,4],[91,13,72,11],[92,8,72,13],[92,23,72,28],[92,25,72,30],[92,35,72,40,"token"],[92,40,72,45],[93,6,72,48],[93,7,72,49],[94,4,73,2],[95,4,74,2],[95,11,74,9],[95,12,74,10],[95,13,74,11],[96,2,75,0],[98,2,77,0],[99,0,78,0],[100,0,79,0],[101,0,80,0],[102,0,81,0],[103,0,82,0],[104,2,83,7],[104,17,83,22,"getJsonHeaders"],[104,31,83,36,"getJsonHeaders"],[104,32,83,36],[104,34,83,72],[105,4,84,2],[105,10,84,8,"auth"],[105,14,84,12],[105,17,84,15],[105,23,84,21,"getAuthHeaders"],[105,37,84,35],[105,38,84,36],[105,39,84,37],[106,4,85,2],[106,11,85,2,"Object"],[106,17,85,2],[106,18,85,2,"assign"],[106,24,85,2],[106,29,86,7,"auth"],[106,33,86,11],[107,6,87,4],[107,20,87,18],[107,22,87,20],[108,4,87,38],[109,2,89,0],[111,2,91,0],[112,2,92,0],[112,6,92,4,"__DEV__"],[112,13,92,11],[112,15,92,13],[113,4,93,2,"console"],[113,11,93,9],[113,12,93,10,"log"],[113,15,93,13],[113,16,93,14],[113,40,93,38],[113,42,93,40,"API_BASE"],[113,50,93,48],[113,54,93,52],[113,72,93,70],[113,73,93,71],[114,4,94,2,"console"],[114,11,94,9],[114,12,94,10,"log"],[114,15,94,13],[114,16,94,14],[114,40,94,38],[114,42,94,40,"Platform"],[114,50,94,48],[114,51,94,48,"default"],[114,58,94,48],[114,59,94,49,"OS"],[114,61,94,51],[114,62,94,52],[116,4,96,2],[117,4,97,2],[117,8,97,6],[117,9,97,7,"API_BASE"],[117,17,97,15],[117,19,97,17],[118,6,98,4,"console"],[118,13,98,11],[118,14,98,12,"warn"],[118,18,98,16],[118,19,99,6],[118,56,99,43],[118,59,100,6],[118,122,100,69],[118,125,101,6],[118,192,102,4],[118,193,102,5],[119,4,103,2],[120,2,104,0],[121,0,104,1],[121,3]],"functionMap":{"names":["<global>","getApiBaseUrl","apiUrl","getAuthHeaders","getJsonHeaders"],"mappings":"AAA;ACkB;CDqB;OEiB;CFI;OGQ;CHM;OIQ;CJM"},"hasCjsExports":false},"type":"js/module"}]}