{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":149},"end":{"line":5,"column":26,"index":175}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"api\", {\n    enumerable: true,\n    get: function () {\n      return api;\n    }\n  });\n  exports.requireUsername = requireUsername;\n  exports.fetchUserHeroes = fetchUserHeroes;\n  exports.promoteHeroStar = promoteHeroStar;\n  exports.getHeroProgression = getHeroProgression;\n  exports.getUserHeroById = getUserHeroById;\n  exports.fetchUser = fetchUser;\n  exports.performSummon = performSummon;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _axios = require(_dependencyMap[1], \"axios\");\n  var axios = _interopDefault(_axios);\n  // /app/frontend/lib/api.ts\n  // SINGLE SOURCE OF TRUTH for all backend API calls\n  // Screens should import from here to prevent endpoint string drift\n\n  const API_BASE = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL ? `${_expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL}/api` : '/api';\n  const api = axios.default.create({\n    baseURL: API_BASE,\n    timeout: 20000\n  });\n  function requireUsername(username) {\n    if (!username) throw new Error('Missing username');\n    return username;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // USER HEROES\n  // ─────────────────────────────────────────────────────────────\n\n  async function fetchUserHeroes(username) {\n    const u = requireUsername(username);\n    const res = await api.get(`/user/${encodeURIComponent(u)}/heroes`);\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // STAR PROMOTION (canonical endpoint)\n  // POST /api/hero/{user_hero_id}/promote-star?username=...\n  // ─────────────────────────────────────────────────────────────\n\n  async function promoteHeroStar(userHeroId, username) {\n    const u = requireUsername(username);\n    const res = await api.post(`/hero/${encodeURIComponent(userHeroId)}/promote-star`, null, {\n      params: {\n        username: u\n      }\n    });\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // HERO PROGRESSION (read model for hero-progression screen)\n  // GET /api/hero/{username}/hero/{heroId}/progression\n  // NOTE: Falls back gracefully if endpoint doesn't exist\n  // ─────────────────────────────────────────────────────────────\n\n  async function getHeroProgression(username, heroId) {\n    const u = requireUsername(username);\n    const res = await api.get(`/hero/${encodeURIComponent(u)}/hero/${encodeURIComponent(heroId)}/progression`);\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // SINGLE HERO FETCH (fallback when hero not in store cache)\n  // NOTE: Temporary implementation - fetches full list and filters.\n  // Replace with GET /user/{username}/heroes/{userHeroId} once backend exists.\n  // Screens call getUserHeroById() and never hit list endpoints directly.\n  // ─────────────────────────────────────────────────────────────\n\n  async function getUserHeroById(username, userHeroId) {\n    const u = requireUsername(username);\n    const res = await api.get(`/user/${encodeURIComponent(u)}/heroes`);\n    const list = Array.isArray(res.data) ? res.data : res.data?.heroes ?? res.data ?? [];\n    const found = list.find(h => String(h?.id) === String(userHeroId));\n    if (!found) throw new Error('Hero not found');\n    return found;\n  }\n\n  // RULE: All hero endpoints live here.\n  // Screens should not build URLs manually (prevents drift).\n\n  // ─────────────────────────────────────────────────────────────\n  // USER AUTH / PROFILE\n  // ─────────────────────────────────────────────────────────────\n\n  async function fetchUser(username) {\n    const u = requireUsername(username);\n    const res = await api.get(`/user/${encodeURIComponent(u)}`);\n    return res.data;\n  }\n\n  // ─────────────────────────────────────────────────────────────\n  // GACHA / SUMMON\n  // ─────────────────────────────────────────────────────────────\n\n  async function performSummon(username, summonType) {\n    const u = requireUsername(username);\n    const res = await api.post(`/gacha/summon`, null, {\n      params: {\n        username: u,\n        summon_type: summonType\n      }\n    });\n    return res.data;\n  }\n\n  // Add more hero endpoints here ONLY.\n  // Screens should import from lib/api.ts so route strings never drift again.\n});","lineCount":125,"map":[[12,2,11,0,"Object"],[12,8,11,0],[12,9,11,0,"defineProperty"],[12,23,11,0],[12,24,11,0,"exports"],[12,31,11,0],[13,4,11,0,"enumerable"],[13,14,11,0],[14,4,11,0,"get"],[14,7,11,0],[14,18,11,0,"get"],[14,19,11,0],[15,6,11,0],[15,13,11,0,"api"],[15,16,11,0],[16,4,11,0],[17,2,11,0],[18,2,16,0,"exports"],[18,9,16,0],[18,10,16,0,"requireUsername"],[18,25,16,0],[18,28,16,0,"requireUsername"],[18,43,16,0],[19,2,25,0,"exports"],[19,9,25,0],[19,10,25,0,"fetchUserHeroes"],[19,25,25,0],[19,28,25,0,"fetchUserHeroes"],[19,43,25,0],[20,2,36,0,"exports"],[20,9,36,0],[20,10,36,0,"promoteHeroStar"],[20,25,36,0],[20,28,36,0,"promoteHeroStar"],[20,43,36,0],[21,2,57,0,"exports"],[21,9,57,0],[21,10,57,0,"getHeroProgression"],[21,28,57,0],[21,31,57,0,"getHeroProgression"],[21,49,57,0],[22,2,70,0,"exports"],[22,9,70,0],[22,10,70,0,"getUserHeroById"],[22,25,70,0],[22,28,70,0,"getUserHeroById"],[22,43,70,0],[23,2,86,0,"exports"],[23,9,86,0],[23,10,86,0,"fetchUser"],[23,19,86,0],[23,22,86,0,"fetchUser"],[23,31,86,0],[24,2,96,0,"exports"],[24,9,96,0],[24,10,96,0,"performSummon"],[24,23,96,0],[24,26,96,0,"performSummon"],[24,39,96,0],[25,2,102,1],[25,6,102,1,"_expoVirtualEnv"],[25,21,102,1],[25,24,102,1,"require"],[25,31,102,1],[25,32,102,1,"_dependencyMap"],[25,46,102,1],[26,2,5,0],[26,6,5,0,"_axios"],[26,12,5,0],[26,15,5,0,"require"],[26,22,5,0],[26,23,5,0,"_dependencyMap"],[26,37,5,0],[27,2,5,0],[27,6,5,0,"axios"],[27,11,5,0],[27,14,5,0,"_interopDefault"],[27,29,5,0],[27,30,5,0,"_axios"],[27,36,5,0],[28,2,1,0],[29,2,2,0],[30,2,3,0],[32,2,7,0],[32,8,7,6,"API_BASE"],[32,16,7,14],[32,19,7,17,"_expoVirtualEnv"],[32,34,7,17],[32,35,7,17,"env"],[32,38,7,17],[32,39,7,17,"EXPO_PUBLIC_BACKEND_URL"],[32,62,7,17],[32,65,8,4],[32,68,8,4,"_expoVirtualEnv"],[32,83,8,4],[32,84,8,4,"env"],[32,87,8,4],[32,88,8,4,"EXPO_PUBLIC_BACKEND_URL"],[32,111,8,4],[32,117,8,48],[32,120,9,4],[32,126,9,10],[33,2,11,7],[33,8,11,13,"api"],[33,11,11,16],[33,14,11,19,"axios"],[33,19,11,24],[33,20,11,24,"default"],[33,27,11,24],[33,28,11,25,"create"],[33,34,11,31],[33,35,11,32],[34,4,12,2,"baseURL"],[34,11,12,9],[34,13,12,11,"API_BASE"],[34,21,12,19],[35,4,13,2,"timeout"],[35,11,13,9],[35,13,13,11],[36,2,14,0],[36,3,14,1],[36,4,14,2],[37,2,16,7],[37,11,16,16,"requireUsername"],[37,26,16,31,"requireUsername"],[37,27,16,32,"username"],[37,35,16,49],[37,37,16,51],[38,4,17,2],[38,8,17,6],[38,9,17,7,"username"],[38,17,17,15],[38,19,17,17],[38,25,17,23],[38,29,17,27,"Error"],[38,34,17,32],[38,35,17,33],[38,53,17,51],[38,54,17,52],[39,4,18,2],[39,11,18,9,"username"],[39,19,18,17],[40,2,19,0],[42,2,21,0],[43,2,22,0],[44,2,23,0],[46,2,25,7],[46,17,25,22,"fetchUserHeroes"],[46,32,25,37,"fetchUserHeroes"],[46,33,25,38,"username"],[46,41,25,54],[46,43,25,56],[47,4,26,2],[47,10,26,8,"u"],[47,11,26,9],[47,14,26,12,"requireUsername"],[47,29,26,27],[47,30,26,28,"username"],[47,38,26,36],[47,39,26,37],[48,4,27,2],[48,10,27,8,"res"],[48,13,27,11],[48,16,27,14],[48,22,27,20,"api"],[48,25,27,23],[48,26,27,24,"get"],[48,29,27,27],[48,30,27,28],[48,39,27,37,"encodeURIComponent"],[48,57,27,55],[48,58,27,56,"u"],[48,59,27,57],[48,60,27,58],[48,69,27,67],[48,70,27,68],[49,4,28,2],[49,11,28,9,"res"],[49,14,28,12],[49,15,28,13,"data"],[49,19,28,17],[50,2,29,0],[52,2,31,0],[53,2,32,0],[54,2,33,0],[55,2,34,0],[57,2,36,7],[57,17,36,22,"promoteHeroStar"],[57,32,36,37,"promoteHeroStar"],[57,33,36,38,"userHeroId"],[57,43,36,56],[57,45,36,58,"username"],[57,53,36,74],[57,55,36,76],[58,4,37,2],[58,10,37,8,"u"],[58,11,37,9],[58,14,37,12,"requireUsername"],[58,29,37,27],[58,30,37,28,"username"],[58,38,37,36],[58,39,37,37],[59,4,38,2],[59,10,38,8,"res"],[59,13,38,11],[59,16,38,14],[59,22,38,20,"api"],[59,25,38,23],[59,26,38,24,"post"],[59,30,38,28],[59,31,39,4],[59,40,39,13,"encodeURIComponent"],[59,58,39,31],[59,59,39,32,"userHeroId"],[59,69,39,42],[59,70,39,43],[59,85,39,58],[59,87,40,4],[59,91,40,8],[59,93,41,4],[60,6,41,6,"params"],[60,12,41,12],[60,14,41,14],[61,8,41,16,"username"],[61,16,41,24],[61,18,41,26,"u"],[62,6,41,28],[63,4,41,30],[63,5,42,2],[63,6,42,3],[64,4,43,2],[64,11,43,9,"res"],[64,14,43,12],[64,15,43,13,"data"],[64,19,43,17],[65,2,49,0],[67,2,51,0],[68,2,52,0],[69,2,53,0],[70,2,54,0],[71,2,55,0],[73,2,57,7],[73,17,57,22,"getHeroProgression"],[73,35,57,40,"getHeroProgression"],[73,36,57,41,"username"],[73,44,57,57],[73,46,57,59,"heroId"],[73,52,57,73],[73,54,57,75],[74,4,58,2],[74,10,58,8,"u"],[74,11,58,9],[74,14,58,12,"requireUsername"],[74,29,58,27],[74,30,58,28,"username"],[74,38,58,36],[74,39,58,37],[75,4,59,2],[75,10,59,8,"res"],[75,13,59,11],[75,16,59,14],[75,22,59,20,"api"],[75,25,59,23],[75,26,59,24,"get"],[75,29,59,27],[75,30,59,28],[75,39,59,37,"encodeURIComponent"],[75,57,59,55],[75,58,59,56,"u"],[75,59,59,57],[75,60,59,58],[75,69,59,67,"encodeURIComponent"],[75,87,59,85],[75,88,59,86,"heroId"],[75,94,59,92],[75,95,59,93],[75,109,59,107],[75,110,59,108],[76,4,60,2],[76,11,60,9,"res"],[76,14,60,12],[76,15,60,13,"data"],[76,19,60,17],[77,2,61,0],[79,2,63,0],[80,2,64,0],[81,2,65,0],[82,2,66,0],[83,2,67,0],[84,2,68,0],[86,2,70,7],[86,17,70,22,"getUserHeroById"],[86,32,70,37,"getUserHeroById"],[86,33,70,38,"username"],[86,41,70,54],[86,43,70,56,"userHeroId"],[86,53,70,74],[86,55,70,76],[87,4,71,2],[87,10,71,8,"u"],[87,11,71,9],[87,14,71,12,"requireUsername"],[87,29,71,27],[87,30,71,28,"username"],[87,38,71,36],[87,39,71,37],[88,4,72,2],[88,10,72,8,"res"],[88,13,72,11],[88,16,72,14],[88,22,72,20,"api"],[88,25,72,23],[88,26,72,24,"get"],[88,29,72,27],[88,30,72,28],[88,39,72,37,"encodeURIComponent"],[88,57,72,55],[88,58,72,56,"u"],[88,59,72,57],[88,60,72,58],[88,69,72,67],[88,70,72,68],[89,4,73,2],[89,10,73,8,"list"],[89,14,73,12],[89,17,73,15,"Array"],[89,22,73,20],[89,23,73,21,"isArray"],[89,30,73,28],[89,31,73,29,"res"],[89,34,73,32],[89,35,73,33,"data"],[89,39,73,37],[89,40,73,38],[89,43,73,41,"res"],[89,46,73,44],[89,47,73,45,"data"],[89,51,73,49],[89,54,73,53,"res"],[89,57,73,56],[89,58,73,57,"data"],[89,62,73,61],[89,64,73,63,"heroes"],[89,70,73,69],[89,74,73,73,"res"],[89,77,73,76],[89,78,73,77,"data"],[89,82,73,81],[89,86,73,85],[89,88,73,88],[90,4,74,2],[90,10,74,8,"found"],[90,15,74,13],[90,18,74,16,"list"],[90,22,74,20],[90,23,74,21,"find"],[90,27,74,25],[90,28,74,27,"h"],[90,29,74,33],[90,33,74,38,"String"],[90,39,74,44],[90,40,74,45,"h"],[90,41,74,46],[90,43,74,48,"id"],[90,45,74,50],[90,46,74,51],[90,51,74,56,"String"],[90,57,74,62],[90,58,74,63,"userHeroId"],[90,68,74,73],[90,69,74,74],[90,70,74,75],[91,4,75,2],[91,8,75,6],[91,9,75,7,"found"],[91,14,75,12],[91,16,75,14],[91,22,75,20],[91,26,75,24,"Error"],[91,31,75,29],[91,32,75,30],[91,48,75,46],[91,49,75,47],[92,4,76,2],[92,11,76,9,"found"],[92,16,76,14],[93,2,77,0],[95,2,79,0],[96,2,80,0],[98,2,82,0],[99,2,83,0],[100,2,84,0],[102,2,86,7],[102,17,86,22,"fetchUser"],[102,26,86,31,"fetchUser"],[102,27,86,32,"username"],[102,35,86,48],[102,37,86,50],[103,4,87,2],[103,10,87,8,"u"],[103,11,87,9],[103,14,87,12,"requireUsername"],[103,29,87,27],[103,30,87,28,"username"],[103,38,87,36],[103,39,87,37],[104,4,88,2],[104,10,88,8,"res"],[104,13,88,11],[104,16,88,14],[104,22,88,20,"api"],[104,25,88,23],[104,26,88,24,"get"],[104,29,88,27],[104,30,88,28],[104,39,88,37,"encodeURIComponent"],[104,57,88,55],[104,58,88,56,"u"],[104,59,88,57],[104,60,88,58],[104,62,88,60],[104,63,88,61],[105,4,89,2],[105,11,89,9,"res"],[105,14,89,12],[105,15,89,13,"data"],[105,19,89,17],[106,2,90,0],[108,2,92,0],[109,2,93,0],[110,2,94,0],[112,2,96,7],[112,17,96,22,"performSummon"],[112,30,96,35,"performSummon"],[112,31,96,36,"username"],[112,39,96,52],[112,41,96,54,"summonType"],[112,51,96,84],[112,53,96,86],[113,4,97,2],[113,10,97,8,"u"],[113,11,97,9],[113,14,97,12,"requireUsername"],[113,29,97,27],[113,30,97,28,"username"],[113,38,97,36],[113,39,97,37],[114,4,98,2],[114,10,98,8,"res"],[114,13,98,11],[114,16,98,14],[114,22,98,20,"api"],[114,25,98,23],[114,26,98,24,"post"],[114,30,98,28],[114,31,98,29],[114,46,98,44],[114,48,98,46],[114,52,98,50],[114,54,98,52],[115,6,99,4,"params"],[115,12,99,10],[115,14,99,12],[116,8,99,14,"username"],[116,16,99,22],[116,18,99,24,"u"],[116,19,99,25],[117,8,99,27,"summon_type"],[117,19,99,38],[117,21,99,40,"summonType"],[118,6,99,51],[119,4,100,2],[119,5,100,3],[119,6,100,4],[120,4,101,2],[120,11,101,9,"res"],[120,14,101,12],[120,15,101,13,"data"],[120,19,101,17],[121,2,102,0],[123,2,104,0],[124,2,105,0],[125,0,105,0],[125,3]],"functionMap":{"names":["<global>","requireUsername","fetchUserHeroes","promoteHeroStar","getHeroProgression","getUserHeroById","list.find$argument_0","fetchUser","performSummon"],"mappings":"AAA;OCe;CDG;OEM;CFI;OGO;CHa;OIQ;CJI;OKS;0BCI,gDD;CLG;OOS;CPI;OQM;CRM"},"hasCjsExports":false},"type":"js/module"}]}