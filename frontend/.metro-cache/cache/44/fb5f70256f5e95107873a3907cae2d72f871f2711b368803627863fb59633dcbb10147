{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.isValidReceipt = isValidReceipt;\n  exports.assertValidReceipt = assertValidReceipt;\n  exports.getReceiptItemCount = getReceiptItemCount;\n  exports.formatReceiptItems = formatReceiptItems;\n  // /app/frontend/lib/types/receipt.ts\n  // Phase 3.24: Canonical Reward Receipt Type\n  // Phase 3.26: Added mail_receipt_claim source\n  //\n  // Single source of truth for receipt shape.\n  // All reward-granting endpoints return this shape.\n  // Frontend MUST use this type for all receipt handling.\n  //\n  // LOCKED source values:\n  // - bond_tribute\n  // - mail_reward_claim\n  // - mail_gift_claim\n  // - mail_receipt_claim (Phase 3.26)\n  // - daily_login_claim\n  // - idle_claim\n  // - admin_grant\n\n  /**\n   * Valid reward source types (matches backend RewardSource)\n   */\n\n  // Phase 3.30: Store dev redeem\n\n  /**\n   * Single reward item in a receipt\n   */\n\n  /**\n   * User balance snapshot\n   */\n\n  /**\n   * Canonical receipt shape for all reward grants (Phase 3.24)\n   * \n   * REQUIRED fields: source, sourceId, items, balances\n   * All reward endpoints MUST return this shape.\n   */\n\n  /**\n   * Type guard: Check if an object is a valid RewardReceipt\n   */\n  function isValidReceipt(obj) {\n    if (!obj || typeof obj !== 'object') return false;\n    const receipt = obj;\n    return typeof receipt.source === 'string' && typeof receipt.sourceId === 'string' && Array.isArray(receipt.items) && typeof receipt.balances === 'object' && receipt.balances !== null;\n  }\n\n  /**\n   * Validate and assert receipt shape (throws if invalid)\n   */\n  function assertValidReceipt(obj, context) {\n    if (!isValidReceipt(obj)) {\n      const msg = `Invalid receipt shape${context ? ` in ${context}` : ''}: ` + `missing source, sourceId, items, or balances`;\n      console.error('[RECEIPT_GUARD_FAILED]', msg, obj);\n      throw new Error(msg);\n    }\n  }\n\n  /**\n   * Extract total reward count from receipt\n   */\n  function getReceiptItemCount(receipt) {\n    return receipt.items.reduce((sum, item) => sum + item.amount, 0);\n  }\n\n  /**\n   * Format reward items for display\n   */\n  function formatReceiptItems(receipt) {\n    if (receipt.items.length === 0) {\n      return receipt.alreadyClaimed ? 'Already claimed' : 'No rewards';\n    }\n    return receipt.items.filter(item => item.amount > 0).map(item => `${item.amount.toLocaleString()} ${formatRewardType(item.type)}`).join(', ');\n  }\n\n  /**\n   * Format reward type for display\n   */\n  function formatRewardType(type) {\n    const typeMap = {\n      gold: 'Gold',\n      coins: 'Coins',\n      gems: 'Gems',\n      divine_gems: 'Divine Gems',\n      crystals: 'Crystals',\n      stamina: 'Stamina',\n      divine_essence: 'Divine Essence',\n      soul_dust: 'Soul Dust',\n      skill_essence: 'Skill Essence',\n      enhancement_stones: 'Enhancement Stones',\n      hero_shards: 'Hero Shards',\n      rune_essence: 'Rune Essence'\n    };\n    return typeMap[type] || type.replace(/_/g, ' ').replace(/\\b\\w/g, c => c.toUpperCase());\n  }\n});","lineCount":106,"map":[[7,2,80,0,"exports"],[7,9,80,0],[7,10,80,0,"isValidReceipt"],[7,24,80,0],[7,27,80,0,"isValidReceipt"],[7,41,80,0],[8,2,96,0,"exports"],[8,9,96,0],[8,10,96,0,"assertValidReceipt"],[8,28,96,0],[8,31,96,0,"assertValidReceipt"],[8,49,96,0],[9,2,108,0,"exports"],[9,9,108,0],[9,10,108,0,"getReceiptItemCount"],[9,29,108,0],[9,32,108,0,"getReceiptItemCount"],[9,51,108,0],[10,2,115,0,"exports"],[10,9,115,0],[10,10,115,0,"formatReceiptItems"],[10,28,115,0],[10,31,115,0,"formatReceiptItems"],[10,49,115,0],[11,2,1,0],[12,2,2,0],[13,2,3,0],[14,2,4,0],[15,2,5,0],[16,2,6,0],[17,2,7,0],[18,2,8,0],[19,2,9,0],[20,2,10,0],[21,2,11,0],[22,2,12,0],[23,2,13,0],[24,2,14,0],[25,2,15,0],[26,2,16,0],[28,2,18,0],[29,0,19,0],[30,0,20,0],[32,2,31,21],[34,2,33,0],[35,0,34,0],[36,0,35,0],[38,2,43,0],[39,0,44,0],[40,0,45,0],[42,2,62,0],[43,0,63,0],[44,0,64,0],[45,0,65,0],[46,0,66,0],[47,0,67,0],[49,2,77,0],[50,0,78,0],[51,0,79,0],[52,2,80,7],[52,11,80,16,"isValidReceipt"],[52,25,80,30,"isValidReceipt"],[52,26,80,31,"obj"],[52,29,80,43],[52,31,80,67],[53,4,81,2],[53,8,81,6],[53,9,81,7,"obj"],[53,12,81,10],[53,16,81,14],[53,23,81,21,"obj"],[53,26,81,24],[53,31,81,29],[53,39,81,37],[53,41,81,39],[53,48,81,46],[53,53,81,51],[54,4,82,2],[54,10,82,8,"receipt"],[54,17,82,15],[54,20,82,18,"obj"],[54,23,82,48],[55,4,84,2],[55,11,85,4],[55,18,85,11,"receipt"],[55,25,85,18],[55,26,85,19,"source"],[55,32,85,25],[55,37,85,30],[55,45,85,38],[55,49,86,4],[55,56,86,11,"receipt"],[55,63,86,18],[55,64,86,19,"sourceId"],[55,72,86,27],[55,77,86,32],[55,85,86,40],[55,89,87,4,"Array"],[55,94,87,9],[55,95,87,10,"isArray"],[55,102,87,17],[55,103,87,18,"receipt"],[55,110,87,25],[55,111,87,26,"items"],[55,116,87,31],[55,117,87,32],[55,121,88,4],[55,128,88,11,"receipt"],[55,135,88,18],[55,136,88,19,"balances"],[55,144,88,27],[55,149,88,32],[55,157,88,40],[55,161,89,4,"receipt"],[55,168,89,11],[55,169,89,12,"balances"],[55,177,89,20],[55,182,89,25],[55,186,89,29],[56,2,91,0],[58,2,93,0],[59,0,94,0],[60,0,95,0],[61,2,96,7],[61,11,96,16,"assertValidReceipt"],[61,29,96,34,"assertValidReceipt"],[61,30,96,35,"obj"],[61,33,96,47],[61,35,96,49,"context"],[61,42,96,65],[61,44,96,97],[62,4,97,2],[62,8,97,6],[62,9,97,7,"isValidReceipt"],[62,23,97,21],[62,24,97,22,"obj"],[62,27,97,25],[62,28,97,26],[62,30,97,28],[63,6,98,4],[63,12,98,10,"msg"],[63,15,98,13],[63,18,98,16],[63,42,98,40,"context"],[63,49,98,47],[63,52,98,50],[63,59,98,57,"context"],[63,66,98,64],[63,68,98,66],[63,71,98,69],[63,73,98,71],[63,77,98,75],[63,80,99,6],[63,126,99,52],[64,6,100,4,"console"],[64,13,100,11],[64,14,100,12,"error"],[64,19,100,17],[64,20,100,18],[64,44,100,42],[64,46,100,44,"msg"],[64,49,100,47],[64,51,100,49,"obj"],[64,54,100,52],[64,55,100,53],[65,6,101,4],[65,12,101,10],[65,16,101,14,"Error"],[65,21,101,19],[65,22,101,20,"msg"],[65,25,101,23],[65,26,101,24],[66,4,102,2],[67,2,103,0],[69,2,105,0],[70,0,106,0],[71,0,107,0],[72,2,108,7],[72,11,108,16,"getReceiptItemCount"],[72,30,108,35,"getReceiptItemCount"],[72,31,108,36,"receipt"],[72,38,108,58],[72,40,108,68],[73,4,109,2],[73,11,109,9,"receipt"],[73,18,109,16],[73,19,109,17,"items"],[73,24,109,22],[73,25,109,23,"reduce"],[73,31,109,29],[73,32,109,30],[73,33,109,31,"sum"],[73,36,109,34],[73,38,109,36,"item"],[73,42,109,40],[73,47,109,45,"sum"],[73,50,109,48],[73,53,109,51,"item"],[73,57,109,55],[73,58,109,56,"amount"],[73,64,109,62],[73,66,109,64],[73,67,109,65],[73,68,109,66],[74,2,110,0],[76,2,112,0],[77,0,113,0],[78,0,114,0],[79,2,115,7],[79,11,115,16,"formatReceiptItems"],[79,29,115,34,"formatReceiptItems"],[79,30,115,35,"receipt"],[79,37,115,57],[79,39,115,67],[80,4,116,2],[80,8,116,6,"receipt"],[80,15,116,13],[80,16,116,14,"items"],[80,21,116,19],[80,22,116,20,"length"],[80,28,116,26],[80,33,116,31],[80,34,116,32],[80,36,116,34],[81,6,117,4],[81,13,117,11,"receipt"],[81,20,117,18],[81,21,117,19,"alreadyClaimed"],[81,35,117,33],[81,38,117,36],[81,55,117,53],[81,58,117,56],[81,70,117,68],[82,4,118,2],[83,4,120,2],[83,11,120,9,"receipt"],[83,18,120,16],[83,19,120,17,"items"],[83,24,120,22],[83,25,121,5,"filter"],[83,31,121,11],[83,32,121,12,"item"],[83,36,121,16],[83,40,121,20,"item"],[83,44,121,24],[83,45,121,25,"amount"],[83,51,121,31],[83,54,121,34],[83,55,121,35],[83,56,121,36],[83,57,122,5,"map"],[83,60,122,8],[83,61,122,9,"item"],[83,65,122,13],[83,69,122,17],[83,72,122,20,"item"],[83,76,122,24],[83,77,122,25,"amount"],[83,83,122,31],[83,84,122,32,"toLocaleString"],[83,98,122,46],[83,99,122,47],[83,100,122,48],[83,104,122,52,"formatRewardType"],[83,120,122,68],[83,121,122,69,"item"],[83,125,122,73],[83,126,122,74,"type"],[83,130,122,78],[83,131,122,79],[83,133,122,81],[83,134,122,82],[83,135,123,5,"join"],[83,139,123,9],[83,140,123,10],[83,144,123,14],[83,145,123,15],[84,2,124,0],[86,2,126,0],[87,0,127,0],[88,0,128,0],[89,2,129,0],[89,11,129,9,"formatRewardType"],[89,27,129,25,"formatRewardType"],[89,28,129,26,"type"],[89,32,129,38],[89,34,129,48],[90,4,130,2],[90,10,130,8,"typeMap"],[90,17,130,39],[90,20,130,42],[91,6,131,4,"gold"],[91,10,131,8],[91,12,131,10],[91,18,131,16],[92,6,132,4,"coins"],[92,11,132,9],[92,13,132,11],[92,20,132,18],[93,6,133,4,"gems"],[93,10,133,8],[93,12,133,10],[93,18,133,16],[94,6,134,4,"divine_gems"],[94,17,134,15],[94,19,134,17],[94,32,134,30],[95,6,135,4,"crystals"],[95,14,135,12],[95,16,135,14],[95,26,135,24],[96,6,136,4,"stamina"],[96,13,136,11],[96,15,136,13],[96,24,136,22],[97,6,137,4,"divine_essence"],[97,20,137,18],[97,22,137,20],[97,38,137,36],[98,6,138,4,"soul_dust"],[98,15,138,13],[98,17,138,15],[98,28,138,26],[99,6,139,4,"skill_essence"],[99,19,139,17],[99,21,139,19],[99,36,139,34],[100,6,140,4,"enhancement_stones"],[100,24,140,22],[100,26,140,24],[100,46,140,44],[101,6,141,4,"hero_shards"],[101,17,141,15],[101,19,141,17],[101,32,141,30],[102,6,142,4,"rune_essence"],[102,18,142,16],[102,20,142,18],[103,4,143,2],[103,5,143,3],[104,4,145,2],[104,11,145,9,"typeMap"],[104,18,145,16],[104,19,145,17,"type"],[104,23,145,21],[104,24,145,22],[104,28,145,26,"type"],[104,32,145,30],[104,33,145,31,"replace"],[104,40,145,38],[104,41,145,39],[104,45,145,43],[104,47,145,45],[104,50,145,48],[104,51,145,49],[104,52,145,50,"replace"],[104,59,145,57],[104,60,145,58],[104,67,145,65],[104,69,145,67,"c"],[104,70,145,68],[104,74,145,72,"c"],[104,75,145,73],[104,76,145,74,"toUpperCase"],[104,87,145,85],[104,88,145,86],[104,89,145,87],[104,90,145,88],[105,2,146,0],[106,0,146,1],[106,3]],"functionMap":{"names":["<global>","isValidReceipt","assertValidReceipt","getReceiptItemCount","items.reduce$argument_0","formatReceiptItems","items.filter$argument_0","items.filter.map$argument_0","formatRewardType","type.replace.replace$argument_1"],"mappings":"AAA;OC+E;CDW;OEK;CFO;OGK;8BCC,gCD;CHC;OKK;YCM,uBD;SEC,wEF;CLE;AQK;mECgB,oBD;CRC"},"hasCjsExports":false},"type":"js/module"}]}