{"dependencies":[{"name":"./lib/bindReporter.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":53,"index":53}}],"key":"yZXTUsWh1M46DyxIbZ88NUHRymg=","exportNames":["*"],"imports":1}},{"name":"./lib/initMetric.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":54},"end":{"line":2,"column":49,"index":103}}],"key":"3h8m+kvAV2o3xN93IHHrmBqzs4s=","exportNames":["*"],"imports":1}},{"name":"./lib/observe.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":104},"end":{"line":3,"column":43,"index":147}}],"key":"Cz2RoRvLyGQyofIDJmcgFo6dicM=","exportNames":["*"],"imports":1}},{"name":"./lib/onHidden.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":148},"end":{"line":4,"column":45,"index":193}}],"key":"Me8dIXVCoQX50hAKyNiBvASIs+8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"onCLS\", {\n    enumerable: true,\n    get: function () {\n      return onCLS;\n    }\n  });\n  var _libBindReporterJs = require(_dependencyMap[0], \"./lib/bindReporter.js\");\n  var _libInitMetricJs = require(_dependencyMap[1], \"./lib/initMetric.js\");\n  var _libObserveJs = require(_dependencyMap[2], \"./lib/observe.js\");\n  var _libOnHiddenJs = require(_dependencyMap[3], \"./lib/onHidden.js\");\n  /*\n   * Copyright 2020 Google LLC\n   *\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   *     https://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /**\n   * Calculates the [CLS](https://web.dev/cls/) value for the current page and\n   * calls the `callback` function once the value is ready to be reported, along\n   * with all `layout-shift` performance entries that were used in the metric\n   * value calculation. The reported value is a `double` (corresponding to a\n   * [layout shift score](https://web.dev/cls/#layout-shift-score)).\n   *\n   * If the `reportAllChanges` configuration option is set to `true`, the\n   * `callback` function will be called as soon as the value is initially\n   * determined as well as any time the value changes throughout the page\n   * lifespan.\n   *\n   * _**Important:** CLS should be continually monitored for changes throughout\n   * the entire lifespan of a pageâ€”including if the user returns to the page after\n   * it's been hidden/backgrounded. However, since browsers often [will not fire\n   * additional callbacks once the user has backgrounded a\n   * page](https://developer.chrome.com/blog/page-lifecycle-api/#advice-hidden),\n   * `callback` is always called when the page's visibility state changes to\n   * hidden. As a result, the `callback` function might be called multiple times\n   * during the same page load._\n   */\n  const onCLS = onReport => {\n    const metric = (0, _libInitMetricJs.initMetric)('CLS', 0);\n    let report;\n    let sessionValue = 0;\n    let sessionEntries = [];\n\n    // const handleEntries = (entries: Metric['entries']) => {\n    const handleEntries = entries => {\n      entries.forEach(entry => {\n        // Only count layout shifts without recent user input.\n        if (!entry.hadRecentInput) {\n          const firstSessionEntry = sessionEntries[0];\n          const lastSessionEntry = sessionEntries[sessionEntries.length - 1];\n\n          // If the entry occurred less than 1 second after the previous entry and\n          // less than 5 seconds after the first entry in the session, include the\n          // entry in the current session. Otherwise, start a new session.\n          if (sessionValue && sessionEntries.length !== 0 && entry.startTime - lastSessionEntry.startTime < 1000 && entry.startTime - firstSessionEntry.startTime < 5000) {\n            sessionValue += entry.value;\n            sessionEntries.push(entry);\n          } else {\n            sessionValue = entry.value;\n            sessionEntries = [entry];\n          }\n\n          // If the current session value is larger than the current CLS value,\n          // update CLS and the entries contributing to it.\n          if (sessionValue > metric.value) {\n            metric.value = sessionValue;\n            metric.entries = sessionEntries;\n            if (report) {\n              report();\n            }\n          }\n        }\n      });\n    };\n    const po = (0, _libObserveJs.observe)('layout-shift', handleEntries);\n    if (po) {\n      report = (0, _libBindReporterJs.bindReporter)(onReport, metric);\n      const stopListening = () => {\n        handleEntries(po.takeRecords());\n        report(true);\n      };\n      (0, _libOnHiddenJs.onHidden)(stopListening);\n      return stopListening;\n    }\n    return;\n  };\n});","lineCount":103,"map":[[7,2,104,0,"Object"],[7,8,104,0],[7,9,104,0,"defineProperty"],[7,23,104,0],[7,24,104,0,"exports"],[7,31,104,0],[8,4,104,0,"enumerable"],[8,14,104,0],[9,4,104,0,"get"],[9,7,104,0],[9,18,104,0,"get"],[9,19,104,0],[10,6,104,0],[10,13,104,9,"onCLS"],[10,18,104,14],[11,4,104,14],[12,2,104,14],[13,2,1,0],[13,6,1,0,"_libBindReporterJs"],[13,24,1,0],[13,27,1,0,"require"],[13,34,1,0],[13,35,1,0,"_dependencyMap"],[13,49,1,0],[14,2,2,0],[14,6,2,0,"_libInitMetricJs"],[14,22,2,0],[14,25,2,0,"require"],[14,32,2,0],[14,33,2,0,"_dependencyMap"],[14,47,2,0],[15,2,3,0],[15,6,3,0,"_libObserveJs"],[15,19,3,0],[15,22,3,0,"require"],[15,29,3,0],[15,30,3,0,"_dependencyMap"],[15,44,3,0],[16,2,4,0],[16,6,4,0,"_libOnHiddenJs"],[16,20,4,0],[16,23,4,0,"require"],[16,30,4,0],[16,31,4,0,"_dependencyMap"],[16,45,4,0],[17,2,6,0],[18,0,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[23,0,12,0],[24,0,13,0],[25,0,14,0],[26,0,15,0],[27,0,16,0],[28,0,17,0],[29,0,18,0],[30,0,19,0],[31,0,20,0],[33,2,22,0],[34,0,23,0],[35,0,24,0],[36,0,25,0],[37,0,26,0],[38,0,27,0],[39,0,28,0],[40,0,29,0],[41,0,30,0],[42,0,31,0],[43,0,32,0],[44,0,33,0],[45,0,34,0],[46,0,35,0],[47,0,36,0],[48,0,37,0],[49,0,38,0],[50,0,39,0],[51,0,40,0],[52,0,41,0],[53,0,42,0],[54,2,43,0],[54,8,43,6,"onCLS"],[54,13,43,11],[54,16,43,15,"onReport"],[54,24,43,23],[54,28,43,28],[55,4,44,2],[55,10,44,8,"metric"],[55,16,44,14],[55,19,44,17],[55,23,44,17,"initMetric"],[55,39,44,27],[55,40,44,27,"initMetric"],[55,50,44,27],[55,52,44,28],[55,57,44,33],[55,59,44,35],[55,60,44,36],[55,61,44,37],[56,4,45,2],[56,8,45,6,"report"],[56,14,45,12],[57,4,47,2],[57,8,47,6,"sessionValue"],[57,20,47,18],[57,23,47,21],[57,24,47,22],[58,4,48,2],[58,8,48,6,"sessionEntries"],[58,22,48,20],[58,25,48,23],[58,27,48,25],[60,4,50,2],[61,4,51,2],[61,10,51,8,"handleEntries"],[61,23,51,21],[61,26,51,25,"entries"],[61,33,51,32],[61,37,51,37],[62,6,52,4,"entries"],[62,13,52,11],[62,14,52,12,"forEach"],[62,21,52,19],[62,22,52,20,"entry"],[62,27,52,25],[62,31,52,29],[63,8,53,6],[64,8,54,6],[64,12,54,10],[64,13,54,11,"entry"],[64,18,54,16],[64,19,54,17,"hadRecentInput"],[64,33,54,31],[64,35,54,33],[65,10,55,8],[65,16,55,14,"firstSessionEntry"],[65,33,55,31],[65,36,55,34,"sessionEntries"],[65,50,55,48],[65,51,55,49],[65,52,55,50],[65,53,55,51],[66,10,56,8],[66,16,56,14,"lastSessionEntry"],[66,32,56,30],[66,35,56,33,"sessionEntries"],[66,49,56,47],[66,50,56,48,"sessionEntries"],[66,64,56,62],[66,65,56,63,"length"],[66,71,56,69],[66,74,56,72],[66,75,56,73],[66,76,56,74],[68,10,58,8],[69,10,59,8],[70,10,60,8],[71,10,61,8],[71,14,62,10,"sessionValue"],[71,26,62,22],[71,30,63,10,"sessionEntries"],[71,44,63,24],[71,45,63,25,"length"],[71,51,63,31],[71,56,63,36],[71,57,63,37],[71,61,64,10,"entry"],[71,66,64,15],[71,67,64,16,"startTime"],[71,76,64,25],[71,79,64,28,"lastSessionEntry"],[71,95,64,44],[71,96,64,45,"startTime"],[71,105,64,54],[71,108,64,57],[71,112,64,61],[71,116,65,10,"entry"],[71,121,65,15],[71,122,65,16,"startTime"],[71,131,65,25],[71,134,65,28,"firstSessionEntry"],[71,151,65,45],[71,152,65,46,"startTime"],[71,161,65,55],[71,164,65,58],[71,168,65,62],[71,170,66,10],[72,12,67,10,"sessionValue"],[72,24,67,22],[72,28,67,26,"entry"],[72,33,67,31],[72,34,67,32,"value"],[72,39,67,37],[73,12,68,10,"sessionEntries"],[73,26,68,24],[73,27,68,25,"push"],[73,31,68,29],[73,32,68,30,"entry"],[73,37,68,35],[73,38,68,36],[74,10,69,8],[74,11,69,9],[74,17,69,15],[75,12,70,10,"sessionValue"],[75,24,70,22],[75,27,70,25,"entry"],[75,32,70,30],[75,33,70,31,"value"],[75,38,70,36],[76,12,71,10,"sessionEntries"],[76,26,71,24],[76,29,71,27],[76,30,71,28,"entry"],[76,35,71,33],[76,36,71,34],[77,10,72,8],[79,10,74,8],[80,10,75,8],[81,10,76,8],[81,14,76,12,"sessionValue"],[81,26,76,24],[81,29,76,27,"metric"],[81,35,76,33],[81,36,76,34,"value"],[81,41,76,39],[81,43,76,41],[82,12,77,10,"metric"],[82,18,77,16],[82,19,77,17,"value"],[82,24,77,22],[82,27,77,25,"sessionValue"],[82,39,77,37],[83,12,78,10,"metric"],[83,18,78,16],[83,19,78,17,"entries"],[83,26,78,24],[83,29,78,27,"sessionEntries"],[83,43,78,41],[84,12,79,10],[84,16,79,14,"report"],[84,22,79,20],[84,24,79,22],[85,14,80,12,"report"],[85,20,80,18],[85,21,80,19],[85,22,80,20],[86,12,81,10],[87,10,82,8],[88,8,83,6],[89,6,84,4],[89,7,84,5],[89,8,84,6],[90,4,85,2],[90,5,85,3],[91,4,87,2],[91,10,87,8,"po"],[91,12,87,10],[91,15,87,13],[91,19,87,13,"observe"],[91,32,87,20],[91,33,87,20,"observe"],[91,40,87,20],[91,42,87,21],[91,56,87,35],[91,58,87,37,"handleEntries"],[91,71,87,50],[91,72,87,51],[92,4,88,2],[92,8,88,6,"po"],[92,10,88,8],[92,12,88,10],[93,6,89,4,"report"],[93,12,89,10],[93,15,89,13],[93,19,89,13,"bindReporter"],[93,37,89,25],[93,38,89,25,"bindReporter"],[93,50,89,25],[93,52,89,26,"onReport"],[93,60,89,34],[93,62,89,36,"metric"],[93,68,89,42],[93,69,89,43],[94,6,91,4],[94,12,91,10,"stopListening"],[94,25,91,23],[94,28,91,26,"stopListening"],[94,29,91,26],[94,34,91,32],[95,8,92,6,"handleEntries"],[95,21,92,19],[95,22,92,20,"po"],[95,24,92,22],[95,25,92,23,"takeRecords"],[95,36,92,34],[95,37,92,35],[95,38,92,37],[95,39,92,38],[96,8,93,6,"report"],[96,14,93,12],[96,15,93,13],[96,19,93,17],[96,20,93,18],[97,6,94,4],[97,7,94,5],[98,6,96,4],[98,10,96,4,"onHidden"],[98,24,96,12],[98,25,96,12,"onHidden"],[98,33,96,12],[98,35,96,13,"stopListening"],[98,48,96,26],[98,49,96,27],[99,6,98,4],[99,13,98,11,"stopListening"],[99,26,98,24],[100,4,99,2],[101,4,101,2],[102,2,102,0],[102,3,102,1],[103,0,102,2],[103,3]],"functionMap":{"names":["<global>","onCLS","handleEntries","entries.forEach$argument_0","stopListening"],"mappings":"AAA;cC0C;wBCQ;oBCC;KDgC;GDC;0BGM;KHG;CDQ"},"hasCjsExports":false},"type":"js/module"}]}