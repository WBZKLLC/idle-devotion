{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":11,"column":0,"index":327},"end":{"line":11,"column":33,"index":360}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"../lib/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":12,"column":0,"index":361},"end":{"line":12,"column":71,"index":432}}],"key":"cGGbCGri3M695PzY+v7ylQ+Rxt0=","exportNames":["*"],"imports":1}},{"name":"../lib/entitlements/types","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0,"index":433},"end":{"line":21,"column":35,"index":669}}],"key":"W08TkULB6K5ayFSZK0DQ51a7f14=","exportNames":["*"],"imports":1}},{"name":"../lib/entitlements/legacy","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":670},"end":{"line":26,"column":36,"index":779}}],"key":"+rKOnoh7xdxUkJQypQ3SMN7jDOc=","exportNames":["*"],"imports":1}},{"name":"../lib/api","data":{"asyncType":"async","isESMImport":true,"locs":[{"start":{"line":38,"column":22,"index":1270},"end":{"line":38,"column":42,"index":1290}}],"key":"qv6pIAfHV5HK/E8UlfJgciwW1c8=","exportNames":["*"],"imports":1}},{"name":"expo/internal/async-require-module","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":38,"column":16,"index":1264},"end":{"line":38,"column":42,"index":1290}}],"key":"y8mhXL4zKvSVvgnacXXOn0UU+QQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"useEntitlementStore\", {\n    enumerable: true,\n    get: function () {\n      return useEntitlementStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var _libStorage = require(_dependencyMap[1], \"../lib/storage\");\n  var _libEntitlementsTypes = require(_dependencyMap[2], \"../lib/entitlements/types\");\n  var _libEntitlementsLegacy = require(_dependencyMap[3], \"../lib/entitlements/legacy\");\n  /**\n   * Entitlement Store - Server Truth Model\n   * \n   * STRICT INVARIANTS:\n   * - Store NEVER grants entitlements - only server can grant\n   * - Store caches server snapshots for UX (offline/fast reads)\n   * - All reads go through gating helpers, not direct store access\n   * - Refresh from server on: startup, post-purchase, manual\n   */\n\n  // Debug logging helpers\n  const dlog = (...args) => {\n    if (__DEV__) console.log(...args);\n  };\n  const STORAGE_KEY = '@idledevotion/entitlements/v4';\n  const LEGACY_STORAGE_KEY = '@idledevotion/entitlements/v3';\n\n  // API import (lazy to avoid circular deps at module load)\n  let _getEntitlementsSnapshot = null;\n  async function getEntitlementsSnapshotApi() {\n    if (!_getEntitlementsSnapshot) {\n      const api = await require(_dependencyMap[5], \"expo/internal/async-require-module\")(_dependencyMap[4], _dependencyMap.paths, \"../lib/api\");\n      _getEntitlementsSnapshot = api.getEntitlementsSnapshot;\n    }\n    return _getEntitlementsSnapshot();\n  }\n  const useEntitlementStore = (0, _zustand.create)((set, get) => ({\n    snapshot: null,\n    entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n    lastRefreshAt: null,\n    isRefreshing: false,\n    refreshError: null,\n    entitlementEpoch: 0,\n    // Bumped on clear() to invalidate in-flight requests\n\n    /**\n     * Hydrate from cached snapshot on app startup\n     * Does NOT grant - only restores last known server state\n     */\n    hydrateEntitlements: async () => {\n      dlog('[entitlementStore] Hydrating from cache...');\n      try {\n        // Try to load cached snapshot\n        const cached = await (0, _libStorage.storageGet)(STORAGE_KEY);\n        if (cached) {\n          const parsed = JSON.parse(cached);\n          const normalized = {\n            ...(0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n            ...parsed.entitlements\n          };\n          set({\n            snapshot: parsed,\n            entitlementsByKey: normalized\n          });\n          dlog('[entitlementStore] Hydrated from cache:', Object.keys(normalized).length, 'keys');\n        }\n\n        // Migrate legacy data if present\n        await migrateLegacyData(set, get);\n      } catch (e) {\n        console.error('[entitlementStore] Hydration error:', e);\n      }\n    },\n    /**\n     * Refresh entitlements from server\n     * This is the ONLY way to get authoritative entitlement state\n     */\n    refreshFromServer: async reason => {\n      if (get().isRefreshing) {\n        dlog('[entitlementStore] Already refreshing, skipping');\n        return;\n      }\n      const epochAtStart = get().entitlementEpoch;\n      dlog('[entitlementStore] Refreshing from server, reason:', reason);\n      set({\n        isRefreshing: true,\n        refreshError: null\n      });\n      try {\n        const snap = await getEntitlementsSnapshotApi();\n\n        // Epoch check: ignore late response if clear() was called (logout)\n        if (get().entitlementEpoch !== epochAtStart) {\n          dlog('[entitlementStore] Epoch mismatch - discarding stale response');\n          set({\n            isRefreshing: false\n          });\n          return;\n        }\n\n        // Strict normalization: fill missing keys as not_owned\n        const normalized = {\n          ...(0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n          ...snap.entitlements\n        };\n        set({\n          snapshot: snap,\n          entitlementsByKey: normalized,\n          lastRefreshAt: Date.now(),\n          isRefreshing: false\n        });\n\n        // Persist for offline cache\n        await (0, _libStorage.storageSet)(STORAGE_KEY, JSON.stringify(snap));\n        dlog('[entitlementStore] Refreshed from server:', snap.version);\n      } catch (e) {\n        // Epoch check before setting error state\n        if (get().entitlementEpoch !== epochAtStart) {\n          dlog('[entitlementStore] Epoch mismatch in error handler - discarding');\n          set({\n            isRefreshing: false\n          });\n          return;\n        }\n        const errorMsg = e?.response?.data?.detail || e?.message || 'Failed to refresh entitlements';\n        console.error('[entitlementStore] Refresh error:', errorMsg);\n        set({\n          isRefreshing: false,\n          refreshError: errorMsg\n        });\n      }\n    },\n    /**\n     * Apply a snapshot directly (used by purchase verify flow)\n     * Skips network call - uses snapshot returned from verify endpoint\n     */\n    applySnapshot: snap => {\n      dlog('[entitlementStore] Applying snapshot directly, version:', snap.version);\n\n      // Strict normalization\n      const normalized = {\n        ...(0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n        ...snap.entitlements\n      };\n      set({\n        snapshot: snap,\n        entitlementsByKey: normalized,\n        lastRefreshAt: Date.now(),\n        refreshError: null\n      });\n\n      // Persist for offline cache\n      (0, _libStorage.storageSet)(STORAGE_KEY, JSON.stringify(snap)).catch(() => {});\n    },\n    /**\n     * Clear all entitlement state (on logout)\n     * Bumps epoch to invalidate any in-flight requests\n     */\n    clear: () => {\n      dlog('[entitlementStore] Clearing state');\n      set(s => ({\n        snapshot: null,\n        entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n        lastRefreshAt: null,\n        refreshError: null,\n        entitlementEpoch: s.entitlementEpoch + 1 // Bump to invalidate in-flight requests\n      }));\n      (0, _libStorage.storageRemove)(STORAGE_KEY).catch(() => {});\n    },\n    /**\n     * Check if user has entitlement (internal use)\n     * Screens should use gating helpers instead\n     */\n    hasEntitlement: key => {\n      const {\n        entitlementsByKey,\n        snapshot\n      } = get();\n      const entitlement = entitlementsByKey[key];\n      if (!entitlement || entitlement.status !== 'owned') return false;\n\n      // Check expiry using server time\n      if (entitlement.expires_at && snapshot?.server_time) {\n        const expiresAt = new Date(entitlement.expires_at).getTime();\n        const serverNow = new Date(snapshot.server_time).getTime();\n        if (serverNow > expiresAt) return false;\n      }\n      return true;\n    },\n    // ═══════════════════════════════════════════════════════════\n    // DEV ONLY METHODS - For testing paywalls/features\n    // These should NEVER be called in production code paths\n    // ═══════════════════════════════════════════════════════════\n\n    devGrantEntitlement: key => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devGrantEntitlement called in production - BLOCKED');\n        return;\n      }\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = {\n        ...entitlementsByKey,\n        [key]: {\n          key,\n          status: 'owned',\n          granted_at: new Date().toISOString(),\n          reason: 'admin'\n        }\n      };\n\n      // Create fake snapshot for dev\n      const fakeSnapshot = {\n        server_time: new Date().toISOString(),\n        version: Date.now(),\n        username: 'DEV_USER',\n        entitlements: updated,\n        source: 'database'\n      };\n      set({\n        entitlementsByKey: updated,\n        snapshot: fakeSnapshot\n      });\n      dlog('[entitlementStore] DEV: Granted', key);\n    },\n    devRevokeEntitlement: key => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devRevokeEntitlement called in production - BLOCKED');\n        return;\n      }\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = {\n        ...entitlementsByKey,\n        [key]: {\n          key,\n          status: 'not_owned'\n        }\n      };\n      set({\n        entitlementsByKey: updated\n      });\n      dlog('[entitlementStore] DEV: Revoked', key);\n    },\n    devClearAll: () => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devClearAll called in production - BLOCKED');\n        return;\n      }\n      set({\n        entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n        snapshot: null\n      });\n      (0, _libStorage.storageRemove)(STORAGE_KEY).catch(() => {});\n      dlog('[entitlementStore] DEV: Cleared all entitlements');\n    }\n  }));\n\n  /**\n   * Migrate legacy entitlement data to new format\n   */\n  async function migrateLegacyData(set, get) {\n    try {\n      const legacyData = await (0, _libStorage.storageGet)(LEGACY_STORAGE_KEY);\n      if (!legacyData) return;\n      dlog('[entitlementStore] Migrating legacy data...');\n      const legacy = JSON.parse(legacyData);\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = {\n        ...entitlementsByKey\n      };\n\n      // Migrate each legacy key\n      for (const [oldKey, value] of Object.entries(legacy)) {\n        if (value) {\n          const newKey = (0, _libEntitlementsLegacy.migrateLegacyKey)(oldKey);\n          updated[newKey] = {\n            key: newKey,\n            status: 'owned',\n            granted_at: new Date().toISOString(),\n            reason: 'unknown'\n          };\n          dlog('[entitlementStore] Migrated:', oldKey, '->', newKey);\n        }\n      }\n      set({\n        entitlementsByKey: updated\n      });\n\n      // Remove legacy data after migration\n      await (0, _libStorage.storageRemove)(LEGACY_STORAGE_KEY);\n      dlog('[entitlementStore] Legacy migration complete');\n    } catch (e) {\n      console.error('[entitlementStore] Legacy migration error:', e);\n    }\n  }\n});","lineCount":307,"map":[[7,2,74,0,"Object"],[7,8,74,0],[7,9,74,0,"defineProperty"],[7,23,74,0],[7,24,74,0,"exports"],[7,31,74,0],[8,4,74,0,"enumerable"],[8,14,74,0],[9,4,74,0,"get"],[9,7,74,0],[9,18,74,0,"get"],[9,19,74,0],[10,6,74,0],[10,13,74,0,"useEntitlementStore"],[10,32,74,0],[11,4,74,0],[12,2,74,0],[13,2,11,0],[13,6,11,0,"_zustand"],[13,14,11,0],[13,17,11,0,"require"],[13,24,11,0],[13,25,11,0,"_dependencyMap"],[13,39,11,0],[14,2,12,0],[14,6,12,0,"_libStorage"],[14,17,12,0],[14,20,12,0,"require"],[14,27,12,0],[14,28,12,0,"_dependencyMap"],[14,42,12,0],[15,2,13,0],[15,6,13,0,"_libEntitlementsTypes"],[15,27,13,0],[15,30,13,0,"require"],[15,37,13,0],[15,38,13,0,"_dependencyMap"],[15,52,13,0],[16,2,22,0],[16,6,22,0,"_libEntitlementsLegacy"],[16,28,22,0],[16,31,22,0,"require"],[16,38,22,0],[16,39,22,0,"_dependencyMap"],[16,53,22,0],[17,2,1,0],[18,0,2,0],[19,0,3,0],[20,0,4,0],[21,0,5,0],[22,0,6,0],[23,0,7,0],[24,0,8,0],[25,0,9,0],[27,2,28,0],[28,2,29,0],[28,8,29,6,"dlog"],[28,12,29,10],[28,15,29,13,"dlog"],[28,16,29,14],[28,19,29,17,"args"],[28,23,29,28],[28,28,29,33],[29,4,29,35],[29,8,29,39,"__DEV__"],[29,15,29,46],[29,17,29,48,"console"],[29,24,29,55],[29,25,29,56,"log"],[29,28,29,59],[29,29,29,60],[29,32,29,63,"args"],[29,36,29,67],[29,37,29,68],[30,2,29,70],[30,3,29,71],[31,2,31,0],[31,8,31,6,"STORAGE_KEY"],[31,19,31,17],[31,22,31,20],[31,53,31,51],[32,2,32,0],[32,8,32,6,"LEGACY_STORAGE_KEY"],[32,26,32,24],[32,29,32,27],[32,60,32,58],[34,2,34,0],[35,2,35,0],[35,6,35,4,"_getEntitlementsSnapshot"],[35,30,35,74],[35,33,35,77],[35,37,35,81],[36,2,36,0],[36,17,36,15,"getEntitlementsSnapshotApi"],[36,43,36,41,"getEntitlementsSnapshotApi"],[36,44,36,41],[36,46,36,75],[37,4,37,2],[37,8,37,6],[37,9,37,7,"_getEntitlementsSnapshot"],[37,33,37,31],[37,35,37,33],[38,6,38,4],[38,12,38,10,"api"],[38,15,38,13],[38,18,38,16],[38,24,38,16,"require"],[38,31,38,16],[38,32,38,16,"_dependencyMap"],[38,46,38,16],[38,89,38,16,"_dependencyMap"],[38,103,38,16],[38,108,38,16,"_dependencyMap"],[38,122,38,16],[38,123,38,16,"paths"],[38,128,38,16],[38,143,38,42],[39,6,39,4,"_getEntitlementsSnapshot"],[39,30,39,28],[39,33,39,31,"api"],[39,36,39,34],[39,37,39,35,"getEntitlementsSnapshot"],[39,60,39,58],[40,4,40,2],[41,4,41,2],[41,11,41,9,"_getEntitlementsSnapshot"],[41,35,41,33],[41,36,41,34],[41,37,41,35],[42,2,42,0],[43,2,74,7],[43,8,74,13,"useEntitlementStore"],[43,27,74,32],[43,30,74,35],[43,34,74,35,"create"],[43,42,74,41],[43,43,74,41,"create"],[43,49,74,41],[43,51,74,65],[43,52,74,66,"set"],[43,55,74,69],[43,57,74,71,"get"],[43,60,74,74],[43,66,74,80],[44,4,75,2,"snapshot"],[44,12,75,10],[44,14,75,12],[44,18,75,16],[45,4,76,2,"entitlementsByKey"],[45,21,76,19],[45,23,76,21],[45,27,76,21,"createEmptyEntitlementsMap"],[45,48,76,47],[45,49,76,47,"createEmptyEntitlementsMap"],[45,75,76,47],[45,77,76,48],[45,78,76,49],[46,4,77,2,"lastRefreshAt"],[46,17,77,15],[46,19,77,17],[46,23,77,21],[47,4,78,2,"isRefreshing"],[47,16,78,14],[47,18,78,16],[47,23,78,21],[48,4,79,2,"refreshError"],[48,16,79,14],[48,18,79,16],[48,22,79,20],[49,4,80,2,"entitlementEpoch"],[49,20,80,18],[49,22,80,20],[49,23,80,21],[50,4,80,24],[52,4,82,2],[53,0,83,0],[54,0,84,0],[55,0,85,0],[56,4,86,2,"hydrateEntitlements"],[56,23,86,21],[56,25,86,23],[56,31,86,23,"hydrateEntitlements"],[56,32,86,23],[56,37,86,35],[57,6,87,4,"dlog"],[57,10,87,8],[57,11,87,9],[57,55,87,53],[57,56,87,54],[58,6,89,4],[58,10,89,8],[59,8,90,6],[60,8,91,6],[60,14,91,12,"cached"],[60,20,91,18],[60,23,91,21],[60,29,91,27],[60,33,91,27,"storageGet"],[60,44,91,37],[60,45,91,37,"storageGet"],[60,55,91,37],[60,57,91,38,"STORAGE_KEY"],[60,68,91,49],[60,69,91,50],[61,8,92,6],[61,12,92,10,"cached"],[61,18,92,16],[61,20,92,18],[62,10,93,8],[62,16,93,14,"parsed"],[62,22,93,20],[62,25,93,23,"JSON"],[62,29,93,27],[62,30,93,28,"parse"],[62,35,93,33],[62,36,93,34,"cached"],[62,42,93,40],[62,43,93,65],[63,10,94,8],[63,16,94,14,"normalized"],[63,26,94,24],[63,29,94,27],[64,12,94,29],[64,15,94,32],[64,19,94,32,"createEmptyEntitlementsMap"],[64,40,94,58],[64,41,94,58,"createEmptyEntitlementsMap"],[64,67,94,58],[64,69,94,59],[64,70,94,60],[65,12,94,62],[65,15,94,65,"parsed"],[65,21,94,71],[65,22,94,72,"entitlements"],[66,10,94,85],[66,11,94,86],[67,10,95,8,"set"],[67,13,95,11],[67,14,95,12],[68,12,96,10,"snapshot"],[68,20,96,18],[68,22,96,20,"parsed"],[68,28,96,26],[69,12,97,10,"entitlementsByKey"],[69,29,97,27],[69,31,97,29,"normalized"],[70,10,98,8],[70,11,98,9],[70,12,98,10],[71,10,99,8,"dlog"],[71,14,99,12],[71,15,99,13],[71,56,99,54],[71,58,99,56,"Object"],[71,64,99,62],[71,65,99,63,"keys"],[71,69,99,67],[71,70,99,68,"normalized"],[71,80,99,78],[71,81,99,79],[71,82,99,80,"length"],[71,88,99,86],[71,90,99,88],[71,96,99,94],[71,97,99,95],[72,8,100,6],[74,8,102,6],[75,8,103,6],[75,14,103,12,"migrateLegacyData"],[75,31,103,29],[75,32,103,30,"set"],[75,35,103,33],[75,37,103,35,"get"],[75,40,103,38],[75,41,103,39],[76,6,105,4],[76,7,105,5],[76,8,105,6],[76,15,105,13,"e"],[76,16,105,14],[76,18,105,16],[77,8,106,6,"console"],[77,15,106,13],[77,16,106,14,"error"],[77,21,106,19],[77,22,106,20],[77,59,106,57],[77,61,106,59,"e"],[77,62,106,60],[77,63,106,61],[78,6,107,4],[79,4,108,2],[79,5,108,3],[80,4,110,2],[81,0,111,0],[82,0,112,0],[83,0,113,0],[84,4,114,2,"refreshFromServer"],[84,21,114,19],[84,23,114,21],[84,29,114,28,"reason"],[84,35,114,34],[84,39,114,39],[85,6,115,4],[85,10,115,8,"get"],[85,13,115,11],[85,14,115,12],[85,15,115,13],[85,16,115,14,"isRefreshing"],[85,28,115,26],[85,30,115,28],[86,8,116,6,"dlog"],[86,12,116,10],[86,13,116,11],[86,62,116,60],[86,63,116,61],[87,8,117,6],[88,6,118,4],[89,6,120,4],[89,12,120,10,"epochAtStart"],[89,24,120,22],[89,27,120,25,"get"],[89,30,120,28],[89,31,120,29],[89,32,120,30],[89,33,120,31,"entitlementEpoch"],[89,49,120,47],[90,6,121,4,"dlog"],[90,10,121,8],[90,11,121,9],[90,63,121,61],[90,65,121,63,"reason"],[90,71,121,69],[90,72,121,70],[91,6,122,4,"set"],[91,9,122,7],[91,10,122,8],[92,8,122,10,"isRefreshing"],[92,20,122,22],[92,22,122,24],[92,26,122,28],[93,8,122,30,"refreshError"],[93,20,122,42],[93,22,122,44],[94,6,122,49],[94,7,122,50],[94,8,122,51],[95,6,124,4],[95,10,124,8],[96,8,125,6],[96,14,125,12,"snap"],[96,18,125,16],[96,21,125,19],[96,27,125,25,"getEntitlementsSnapshotApi"],[96,53,125,51],[96,54,125,52],[96,55,125,53],[98,8,127,6],[99,8,128,6],[99,12,128,10,"get"],[99,15,128,13],[99,16,128,14],[99,17,128,15],[99,18,128,16,"entitlementEpoch"],[99,34,128,32],[99,39,128,37,"epochAtStart"],[99,51,128,49],[99,53,128,51],[100,10,129,8,"dlog"],[100,14,129,12],[100,15,129,13],[100,78,129,76],[100,79,129,77],[101,10,130,8,"set"],[101,13,130,11],[101,14,130,12],[102,12,130,14,"isRefreshing"],[102,24,130,26],[102,26,130,28],[103,10,130,34],[103,11,130,35],[103,12,130,36],[104,10,131,8],[105,8,132,6],[107,8,134,6],[108,8,135,6],[108,14,135,12,"normalized"],[108,24,135,22],[108,27,135,25],[109,10,135,27],[109,13,135,30],[109,17,135,30,"createEmptyEntitlementsMap"],[109,38,135,56],[109,39,135,56,"createEmptyEntitlementsMap"],[109,65,135,56],[109,67,135,57],[109,68,135,58],[110,10,135,60],[110,13,135,63,"snap"],[110,17,135,67],[110,18,135,68,"entitlements"],[111,8,135,81],[111,9,135,82],[112,8,137,6,"set"],[112,11,137,9],[112,12,137,10],[113,10,138,8,"snapshot"],[113,18,138,16],[113,20,138,18,"snap"],[113,24,138,22],[114,10,139,8,"entitlementsByKey"],[114,27,139,25],[114,29,139,27,"normalized"],[114,39,139,37],[115,10,140,8,"lastRefreshAt"],[115,23,140,21],[115,25,140,23,"Date"],[115,29,140,27],[115,30,140,28,"now"],[115,33,140,31],[115,34,140,32],[115,35,140,33],[116,10,141,8,"isRefreshing"],[116,22,141,20],[116,24,141,22],[117,8,142,6],[117,9,142,7],[117,10,142,8],[119,8,144,6],[120,8,145,6],[120,14,145,12],[120,18,145,12,"storageSet"],[120,29,145,22],[120,30,145,22,"storageSet"],[120,40,145,22],[120,42,145,23,"STORAGE_KEY"],[120,53,145,34],[120,55,145,36,"JSON"],[120,59,145,40],[120,60,145,41,"stringify"],[120,69,145,50],[120,70,145,51,"snap"],[120,74,145,55],[120,75,145,56],[120,76,145,57],[121,8,147,6,"dlog"],[121,12,147,10],[121,13,147,11],[121,56,147,54],[121,58,147,56,"snap"],[121,62,147,60],[121,63,147,61,"version"],[121,70,147,68],[121,71,147,69],[122,6,149,4],[122,7,149,5],[122,8,149,6],[122,15,149,13,"e"],[122,16,149,19],[122,18,149,21],[123,8,150,6],[124,8,151,6],[124,12,151,10,"get"],[124,15,151,13],[124,16,151,14],[124,17,151,15],[124,18,151,16,"entitlementEpoch"],[124,34,151,32],[124,39,151,37,"epochAtStart"],[124,51,151,49],[124,53,151,51],[125,10,152,8,"dlog"],[125,14,152,12],[125,15,152,13],[125,80,152,78],[125,81,152,79],[126,10,153,8,"set"],[126,13,153,11],[126,14,153,12],[127,12,153,14,"isRefreshing"],[127,24,153,26],[127,26,153,28],[128,10,153,34],[128,11,153,35],[128,12,153,36],[129,10,154,8],[130,8,155,6],[131,8,157,6],[131,14,157,12,"errorMsg"],[131,22,157,20],[131,25,157,23,"e"],[131,26,157,24],[131,28,157,26,"response"],[131,36,157,34],[131,38,157,36,"data"],[131,42,157,40],[131,44,157,42,"detail"],[131,50,157,48],[131,54,157,52,"e"],[131,55,157,53],[131,57,157,55,"message"],[131,64,157,62],[131,68,157,66],[131,100,157,98],[132,8,158,6,"console"],[132,15,158,13],[132,16,158,14,"error"],[132,21,158,19],[132,22,158,20],[132,57,158,55],[132,59,158,57,"errorMsg"],[132,67,158,65],[132,68,158,66],[133,8,159,6,"set"],[133,11,159,9],[133,12,159,10],[134,10,160,8,"isRefreshing"],[134,22,160,20],[134,24,160,22],[134,29,160,27],[135,10,161,8,"refreshError"],[135,22,161,20],[135,24,161,22,"errorMsg"],[136,8,162,6],[136,9,162,7],[136,10,162,8],[137,6,163,4],[138,4,164,2],[138,5,164,3],[139,4,166,2],[140,0,167,0],[141,0,168,0],[142,0,169,0],[143,4,170,2,"applySnapshot"],[143,17,170,15],[143,19,170,18,"snap"],[143,23,170,44],[143,27,170,49],[144,6,171,4,"dlog"],[144,10,171,8],[144,11,171,9],[144,68,171,66],[144,70,171,68,"snap"],[144,74,171,72],[144,75,171,73,"version"],[144,82,171,80],[144,83,171,81],[146,6,173,4],[147,6,174,4],[147,12,174,10,"normalized"],[147,22,174,20],[147,25,174,23],[148,8,174,25],[148,11,174,28],[148,15,174,28,"createEmptyEntitlementsMap"],[148,36,174,54],[148,37,174,54,"createEmptyEntitlementsMap"],[148,63,174,54],[148,65,174,55],[148,66,174,56],[149,8,174,58],[149,11,174,61,"snap"],[149,15,174,65],[149,16,174,66,"entitlements"],[150,6,174,79],[150,7,174,80],[151,6,176,4,"set"],[151,9,176,7],[151,10,176,8],[152,8,177,6,"snapshot"],[152,16,177,14],[152,18,177,16,"snap"],[152,22,177,20],[153,8,178,6,"entitlementsByKey"],[153,25,178,23],[153,27,178,25,"normalized"],[153,37,178,35],[154,8,179,6,"lastRefreshAt"],[154,21,179,19],[154,23,179,21,"Date"],[154,27,179,25],[154,28,179,26,"now"],[154,31,179,29],[154,32,179,30],[154,33,179,31],[155,8,180,6,"refreshError"],[155,20,180,18],[155,22,180,20],[156,6,181,4],[156,7,181,5],[156,8,181,6],[158,6,183,4],[159,6,184,4],[159,10,184,4,"storageSet"],[159,21,184,14],[159,22,184,14,"storageSet"],[159,32,184,14],[159,34,184,15,"STORAGE_KEY"],[159,45,184,26],[159,47,184,28,"JSON"],[159,51,184,32],[159,52,184,33,"stringify"],[159,61,184,42],[159,62,184,43,"snap"],[159,66,184,47],[159,67,184,48],[159,68,184,49],[159,69,184,50,"catch"],[159,74,184,55],[159,75,184,56],[159,81,184,62],[159,82,184,63],[159,83,184,64],[159,84,184,65],[160,4,185,2],[160,5,185,3],[161,4,187,2],[162,0,188,0],[163,0,189,0],[164,0,190,0],[165,4,191,2,"clear"],[165,9,191,7],[165,11,191,9,"clear"],[165,12,191,9],[165,17,191,15],[166,6,192,4,"dlog"],[166,10,192,8],[166,11,192,9],[166,46,192,44],[166,47,192,45],[167,6,193,4,"set"],[167,9,193,7],[167,10,193,9,"s"],[167,11,193,10],[167,16,193,16],[168,8,194,6,"snapshot"],[168,16,194,14],[168,18,194,16],[168,22,194,20],[169,8,195,6,"entitlementsByKey"],[169,25,195,23],[169,27,195,25],[169,31,195,25,"createEmptyEntitlementsMap"],[169,52,195,51],[169,53,195,51,"createEmptyEntitlementsMap"],[169,79,195,51],[169,81,195,52],[169,82,195,53],[170,8,196,6,"lastRefreshAt"],[170,21,196,19],[170,23,196,21],[170,27,196,25],[171,8,197,6,"refreshError"],[171,20,197,18],[171,22,197,20],[171,26,197,24],[172,8,198,6,"entitlementEpoch"],[172,24,198,22],[172,26,198,24,"s"],[172,27,198,25],[172,28,198,26,"entitlementEpoch"],[172,44,198,42],[172,47,198,45],[172,48,198,46],[172,49,198,49],[173,6,199,4],[173,7,199,5],[173,8,199,6],[173,9,199,7],[174,6,200,4],[174,10,200,4,"storageRemove"],[174,21,200,17],[174,22,200,17,"storageRemove"],[174,35,200,17],[174,37,200,18,"STORAGE_KEY"],[174,48,200,29],[174,49,200,30],[174,50,200,31,"catch"],[174,55,200,36],[174,56,200,37],[174,62,200,43],[174,63,200,44],[174,64,200,45],[174,65,200,46],[175,4,201,2],[175,5,201,3],[176,4,203,2],[177,0,204,0],[178,0,205,0],[179,0,206,0],[180,4,207,2,"hasEntitlement"],[180,18,207,16],[180,20,207,19,"key"],[180,23,207,30],[180,27,207,35],[181,6,208,4],[181,12,208,10],[182,8,208,12,"entitlementsByKey"],[182,25,208,29],[183,8,208,31,"snapshot"],[184,6,208,40],[184,7,208,41],[184,10,208,44,"get"],[184,13,208,47],[184,14,208,48],[184,15,208,49],[185,6,209,4],[185,12,209,10,"entitlement"],[185,23,209,21],[185,26,209,24,"entitlementsByKey"],[185,43,209,41],[185,44,209,42,"key"],[185,47,209,45],[185,48,209,46],[186,6,210,4],[186,10,210,8],[186,11,210,9,"entitlement"],[186,22,210,20],[186,26,210,24,"entitlement"],[186,37,210,35],[186,38,210,36,"status"],[186,44,210,42],[186,49,210,47],[186,56,210,54],[186,58,210,56],[186,65,210,63],[186,70,210,68],[188,6,212,4],[189,6,213,4],[189,10,213,8,"entitlement"],[189,21,213,19],[189,22,213,20,"expires_at"],[189,32,213,30],[189,36,213,34,"snapshot"],[189,44,213,42],[189,46,213,44,"server_time"],[189,57,213,55],[189,59,213,57],[190,8,214,6],[190,14,214,12,"expiresAt"],[190,23,214,21],[190,26,214,24],[190,30,214,28,"Date"],[190,34,214,32],[190,35,214,33,"entitlement"],[190,46,214,44],[190,47,214,45,"expires_at"],[190,57,214,55],[190,58,214,56],[190,59,214,57,"getTime"],[190,66,214,64],[190,67,214,65],[190,68,214,66],[191,8,215,6],[191,14,215,12,"serverNow"],[191,23,215,21],[191,26,215,24],[191,30,215,28,"Date"],[191,34,215,32],[191,35,215,33,"snapshot"],[191,43,215,41],[191,44,215,42,"server_time"],[191,55,215,53],[191,56,215,54],[191,57,215,55,"getTime"],[191,64,215,62],[191,65,215,63],[191,66,215,64],[192,8,216,6],[192,12,216,10,"serverNow"],[192,21,216,19],[192,24,216,22,"expiresAt"],[192,33,216,31],[192,35,216,33],[192,42,216,40],[192,47,216,45],[193,6,217,4],[194,6,219,4],[194,13,219,11],[194,17,219,15],[195,4,220,2],[195,5,220,3],[196,4,222,2],[197,4,223,2],[198,4,224,2],[199,4,225,2],[201,4,227,2,"devGrantEntitlement"],[201,23,227,21],[201,25,227,24,"key"],[201,28,227,35],[201,32,227,40],[202,6,228,4],[202,10,228,8],[202,11,228,9,"__DEV__"],[202,18,228,16],[202,20,228,18],[203,8,229,6,"console"],[203,15,229,13],[203,16,229,14,"warn"],[203,20,229,18],[203,21,229,19],[203,92,229,90],[203,93,229,91],[204,8,230,6],[205,6,231,4],[206,6,233,4],[206,12,233,10],[207,8,233,12,"entitlementsByKey"],[208,6,233,30],[208,7,233,31],[208,10,233,34,"get"],[208,13,233,37],[208,14,233,38],[208,15,233,39],[209,6,234,4],[209,12,234,10,"updated"],[209,19,234,17],[209,22,234,20],[210,8,235,6],[210,11,235,9,"entitlementsByKey"],[210,28,235,26],[211,8,236,6],[211,9,236,7,"key"],[211,12,236,10],[211,15,236,13],[212,10,237,8,"key"],[212,13,237,11],[213,10,238,8,"status"],[213,16,238,14],[213,18,238,16],[213,25,238,32],[214,10,239,8,"granted_at"],[214,20,239,18],[214,22,239,20],[214,26,239,24,"Date"],[214,30,239,28],[214,31,239,29],[214,32,239,30],[214,33,239,31,"toISOString"],[214,44,239,42],[214,45,239,43],[214,46,239,44],[215,10,240,8,"reason"],[215,16,240,14],[215,18,240,16],[216,8,241,6],[217,6,242,4],[217,7,242,5],[219,6,244,4],[220,6,245,4],[220,12,245,10,"fakeSnapshot"],[220,24,245,44],[220,27,245,47],[221,8,246,6,"server_time"],[221,19,246,17],[221,21,246,19],[221,25,246,23,"Date"],[221,29,246,27],[221,30,246,28],[221,31,246,29],[221,32,246,30,"toISOString"],[221,43,246,41],[221,44,246,42],[221,45,246,43],[222,8,247,6,"version"],[222,15,247,13],[222,17,247,15,"Date"],[222,21,247,19],[222,22,247,20,"now"],[222,25,247,23],[222,26,247,24],[222,27,247,25],[223,8,248,6,"username"],[223,16,248,14],[223,18,248,16],[223,28,248,26],[224,8,249,6,"entitlements"],[224,20,249,18],[224,22,249,20,"updated"],[224,29,249,27],[225,8,250,6,"source"],[225,14,250,12],[225,16,250,14],[226,6,251,4],[226,7,251,5],[227,6,253,4,"set"],[227,9,253,7],[227,10,253,8],[228,8,254,6,"entitlementsByKey"],[228,25,254,23],[228,27,254,25,"updated"],[228,34,254,32],[229,8,255,6,"snapshot"],[229,16,255,14],[229,18,255,16,"fakeSnapshot"],[230,6,256,4],[230,7,256,5],[230,8,256,6],[231,6,257,4,"dlog"],[231,10,257,8],[231,11,257,9],[231,44,257,42],[231,46,257,44,"key"],[231,49,257,47],[231,50,257,48],[232,4,258,2],[232,5,258,3],[233,4,260,2,"devRevokeEntitlement"],[233,24,260,22],[233,26,260,25,"key"],[233,29,260,36],[233,33,260,41],[234,6,261,4],[234,10,261,8],[234,11,261,9,"__DEV__"],[234,18,261,16],[234,20,261,18],[235,8,262,6,"console"],[235,15,262,13],[235,16,262,14,"warn"],[235,20,262,18],[235,21,262,19],[235,93,262,91],[235,94,262,92],[236,8,263,6],[237,6,264,4],[238,6,266,4],[238,12,266,10],[239,8,266,12,"entitlementsByKey"],[240,6,266,30],[240,7,266,31],[240,10,266,34,"get"],[240,13,266,37],[240,14,266,38],[240,15,266,39],[241,6,267,4],[241,12,267,10,"updated"],[241,19,267,17],[241,22,267,20],[242,8,268,6],[242,11,268,9,"entitlementsByKey"],[242,28,268,26],[243,8,269,6],[243,9,269,7,"key"],[243,12,269,10],[243,15,269,13],[244,10,270,8,"key"],[244,13,270,11],[245,10,271,8,"status"],[245,16,271,14],[245,18,271,16],[246,8,272,6],[247,6,273,4],[247,7,273,5],[248,6,275,4,"set"],[248,9,275,7],[248,10,275,8],[249,8,275,10,"entitlementsByKey"],[249,25,275,27],[249,27,275,29,"updated"],[250,6,275,37],[250,7,275,38],[250,8,275,39],[251,6,276,4,"dlog"],[251,10,276,8],[251,11,276,9],[251,44,276,42],[251,46,276,44,"key"],[251,49,276,47],[251,50,276,48],[252,4,277,2],[252,5,277,3],[253,4,279,2,"devClearAll"],[253,15,279,13],[253,17,279,15,"devClearAll"],[253,18,279,15],[253,23,279,21],[254,6,280,4],[254,10,280,8],[254,11,280,9,"__DEV__"],[254,18,280,16],[254,20,280,18],[255,8,281,6,"console"],[255,15,281,13],[255,16,281,14,"warn"],[255,20,281,18],[255,21,281,19],[255,84,281,82],[255,85,281,83],[256,8,282,6],[257,6,283,4],[258,6,285,4,"set"],[258,9,285,7],[258,10,285,8],[259,8,286,6,"entitlementsByKey"],[259,25,286,23],[259,27,286,25],[259,31,286,25,"createEmptyEntitlementsMap"],[259,52,286,51],[259,53,286,51,"createEmptyEntitlementsMap"],[259,79,286,51],[259,81,286,52],[259,82,286,53],[260,8,287,6,"snapshot"],[260,16,287,14],[260,18,287,16],[261,6,288,4],[261,7,288,5],[261,8,288,6],[262,6,289,4],[262,10,289,4,"storageRemove"],[262,21,289,17],[262,22,289,17,"storageRemove"],[262,35,289,17],[262,37,289,18,"STORAGE_KEY"],[262,48,289,29],[262,49,289,30],[262,50,289,31,"catch"],[262,55,289,36],[262,56,289,37],[262,62,289,43],[262,63,289,44],[262,64,289,45],[262,65,289,46],[263,6,290,4,"dlog"],[263,10,290,8],[263,11,290,9],[263,61,290,59],[263,62,290,60],[264,4,291,2],[265,2,292,0],[265,3,292,1],[265,4,292,2],[265,5,292,3],[267,2,294,0],[268,0,295,0],[269,0,296,0],[270,2,297,0],[270,17,297,15,"migrateLegacyData"],[270,34,297,32,"migrateLegacyData"],[270,35,298,2,"set"],[270,38,298,54],[270,40,299,2,"get"],[270,43,299,34],[270,45,300,2],[271,4,301,2],[271,8,301,6],[272,6,302,4],[272,12,302,10,"legacyData"],[272,22,302,20],[272,25,302,23],[272,31,302,29],[272,35,302,29,"storageGet"],[272,46,302,39],[272,47,302,39,"storageGet"],[272,57,302,39],[272,59,302,40,"LEGACY_STORAGE_KEY"],[272,77,302,58],[272,78,302,59],[273,6,303,4],[273,10,303,8],[273,11,303,9,"legacyData"],[273,21,303,19],[273,23,303,21],[274,6,305,4,"dlog"],[274,10,305,8],[274,11,305,9],[274,56,305,54],[274,57,305,55],[275,6,307,4],[275,12,307,10,"legacy"],[275,18,307,16],[275,21,307,19,"JSON"],[275,25,307,23],[275,26,307,24,"parse"],[275,31,307,29],[275,32,307,30,"legacyData"],[275,42,307,40],[275,43,307,41],[276,6,308,4],[276,12,308,10],[277,8,308,12,"entitlementsByKey"],[278,6,308,30],[278,7,308,31],[278,10,308,34,"get"],[278,13,308,37],[278,14,308,38],[278,15,308,39],[279,6,309,4],[279,12,309,10,"updated"],[279,19,309,17],[279,22,309,20],[280,8,309,22],[280,11,309,25,"entitlementsByKey"],[281,6,309,43],[281,7,309,44],[283,6,311,4],[284,6,312,4],[284,11,312,9],[284,17,312,15],[284,18,312,16,"oldKey"],[284,24,312,22],[284,26,312,24,"value"],[284,31,312,29],[284,32,312,30],[284,36,312,34,"Object"],[284,42,312,40],[284,43,312,41,"entries"],[284,50,312,48],[284,51,312,49,"legacy"],[284,57,312,55],[284,58,312,56],[284,60,312,58],[285,8,313,6],[285,12,313,10,"value"],[285,17,313,15],[285,19,313,17],[286,10,314,8],[286,16,314,14,"newKey"],[286,22,314,20],[286,25,314,23],[286,29,314,23,"migrateLegacyKey"],[286,51,314,39],[286,52,314,39,"migrateLegacyKey"],[286,68,314,39],[286,70,314,40,"oldKey"],[286,76,314,46],[286,77,314,47],[287,10,315,8,"updated"],[287,17,315,15],[287,18,315,16,"newKey"],[287,24,315,22],[287,25,315,23],[287,28,315,26],[288,12,316,10,"key"],[288,15,316,13],[288,17,316,15,"newKey"],[288,23,316,21],[289,12,317,10,"status"],[289,18,317,16],[289,20,317,18],[289,27,317,25],[290,12,318,10,"granted_at"],[290,22,318,20],[290,24,318,22],[290,28,318,26,"Date"],[290,32,318,30],[290,33,318,31],[290,34,318,32],[290,35,318,33,"toISOString"],[290,46,318,44],[290,47,318,45],[290,48,318,46],[291,12,319,10,"reason"],[291,18,319,16],[291,20,319,18],[292,10,320,8],[292,11,320,9],[293,10,321,8,"dlog"],[293,14,321,12],[293,15,321,13],[293,45,321,43],[293,47,321,45,"oldKey"],[293,53,321,51],[293,55,321,53],[293,59,321,57],[293,61,321,59,"newKey"],[293,67,321,65],[293,68,321,66],[294,8,322,6],[295,6,323,4],[296,6,325,4,"set"],[296,9,325,7],[296,10,325,8],[297,8,325,10,"entitlementsByKey"],[297,25,325,27],[297,27,325,29,"updated"],[298,6,325,37],[298,7,325,38],[298,8,325,39],[300,6,327,4],[301,6,328,4],[301,12,328,10],[301,16,328,10,"storageRemove"],[301,27,328,23],[301,28,328,23,"storageRemove"],[301,41,328,23],[301,43,328,24,"LEGACY_STORAGE_KEY"],[301,61,328,42],[301,62,328,43],[302,6,329,4,"dlog"],[302,10,329,8],[302,11,329,9],[302,57,329,55],[302,58,329,56],[303,4,331,2],[303,5,331,3],[303,6,331,4],[303,13,331,11,"e"],[303,14,331,12],[303,16,331,14],[304,6,332,4,"console"],[304,13,332,11],[304,14,332,12,"error"],[304,19,332,17],[304,20,332,18],[304,64,332,62],[304,66,332,64,"e"],[304,67,332,65],[304,68,332,66],[305,4,333,2],[306,2,334,0],[307,0,334,1],[307,3]],"functionMap":{"names":["<global>","dlog","getEntitlementsSnapshotApi","create$argument_0","hydrateEntitlements","refreshFromServer","applySnapshot","storageSet._catch$argument_0","clear","set$argument_0","storageRemove._catch$argument_0","hasEntitlement","devGrantEntitlement","devRevokeEntitlement","devClearAll","migrateLegacyData"],"mappings":"AAA;aC4B,0DD;AEO;CFM;iEGgC;uBCY;GDsB;qBEM;GFkD;iBGM;wDCc,QD;GHC;SKM;QCE;MDM;qCEC,QF;GLC;kBQM;GRa;uBSO;GT+B;wBUE;GViB;eWE;qCJU,QI;GXE;EHC;AeK;CfqC"},"hasCjsExports":false},"type":"js/module"}]}