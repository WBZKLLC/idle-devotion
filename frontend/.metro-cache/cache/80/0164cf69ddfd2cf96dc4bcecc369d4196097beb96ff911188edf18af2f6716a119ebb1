{"dependencies":[{"name":"./featureUtils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":34},"end":{"line":8,"column":24,"index":162}}],"key":"FACoi85IMzpe+kZO3DG9/H6Umsk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"DEFAULT_FLAGS\", {\n    enumerable: true,\n    get: function () {\n      return DEFAULT_FLAGS;\n    }\n  });\n  exports.setDevFeatureOverride = setDevFeatureOverride;\n  exports.clearDevFeatureOverride = clearDevFeatureOverride;\n  exports.clearAllDevFeatureOverrides = clearAllDevFeatureOverrides;\n  exports.setRemoteFeatures = setRemoteFeatures;\n  exports.clearRemoteFeatures = clearRemoteFeatures;\n  exports.getRemoteFeaturesSnapshot = getRemoteFeaturesSnapshot;\n  exports.isFeatureEnabled = isFeatureEnabled;\n  var _featureUtils = require(_dependencyMap[0], \"./featureUtils\");\n  // /app/frontend/lib/features.ts\n\n  /**\n   * Single source of truth for KNOWN flags (compile-time defaults).\n   * Add new flags here first.\n   */\n  const DEFAULT_FLAGS = {\n    AWAKENING_PREVIEW_UI: false,\n    GACHA_PITY_UI: true,\n    NEW_LOGIN_FLOW: false,\n    MAINTENANCE_MODE: false,\n    CAMPAIGN_SWEEP: true,\n    HERO_CINEMATICS: true\n  };\n  let remoteFlags = {};\n  let remoteVersion = null;\n\n  /**\n   * Dev overrides: ONLY applied in __DEV__.\n   * Stored in-memory; you can optionally add persistence later.\n   */\n  const devOverrides = {};\n  function setDevFeatureOverride(flag, enabled) {\n    if (!__DEV__) return;\n    devOverrides[flag] = enabled;\n  }\n  function clearDevFeatureOverride(flag) {\n    if (!__DEV__) return;\n    delete devOverrides[flag];\n  }\n  function clearAllDevFeatureOverrides() {\n    if (!__DEV__) return;\n    for (const k of Object.keys(devOverrides)) delete devOverrides[k];\n  }\n\n  /**\n   * Called by the feature store after hydration/fetch.\n   */\n  function setRemoteFeatures(payload) {\n    remoteVersion = payload.version ?? null;\n    remoteFlags = (0, _featureUtils.normalizeRemoteFlags)(payload.flags);\n  }\n  function clearRemoteFeatures() {\n    remoteVersion = null;\n    remoteFlags = {};\n  }\n  function getRemoteFeaturesSnapshot() {\n    return {\n      version: remoteVersion,\n      flags: remoteFlags\n    };\n  }\n\n  /**\n   * Main entrypoint used by UI.\n   * Keep usage standardized: isFeatureEnabled('FLAG', { stableId: userId })\n   */\n\n  function isFeatureEnabled(flag, ctx) {\n    // 1) dev override wins (dev-only)\n    if (__DEV__ && Object.prototype.hasOwnProperty.call(devOverrides, flag)) {\n      return !!devOverrides[flag];\n    }\n\n    // 2) remote override next\n    const r = remoteFlags[flag];\n    if (r) {\n      if (!r.enabled) return false;\n      if (typeof r.rollout === 'number') {\n        const stableId = ctx?.stableId;\n        if (!stableId) return true; // enabled but no stableId => treat as on\n        const b = (0, _featureUtils.bucket01)(`${flag}:${stableId}`);\n        return b < r.rollout;\n      }\n      return true;\n    }\n\n    // 3) local default fallback (known flags)\n    if (Object.prototype.hasOwnProperty.call(DEFAULT_FLAGS, flag)) {\n      return !!DEFAULT_FLAGS[flag];\n    }\n\n    // 4) unknown flag => safe off\n    return false;\n  }\n});","lineCount":106,"map":[[7,2,14,0,"Object"],[7,8,14,0],[7,9,14,0,"defineProperty"],[7,23,14,0],[7,24,14,0,"exports"],[7,31,14,0],[8,4,14,0,"enumerable"],[8,14,14,0],[9,4,14,0,"get"],[9,7,14,0],[9,18,14,0,"get"],[9,19,14,0],[10,6,14,0],[10,13,14,0,"DEFAULT_FLAGS"],[10,26,14,0],[11,4,14,0],[12,2,14,0],[13,2,42,0,"exports"],[13,9,42,0],[13,10,42,0,"setDevFeatureOverride"],[13,31,42,0],[13,34,42,0,"setDevFeatureOverride"],[13,55,42,0],[14,2,47,0,"exports"],[14,9,47,0],[14,10,47,0,"clearDevFeatureOverride"],[14,33,47,0],[14,36,47,0,"clearDevFeatureOverride"],[14,59,47,0],[15,2,52,0,"exports"],[15,9,52,0],[15,10,52,0,"clearAllDevFeatureOverrides"],[15,37,52,0],[15,40,52,0,"clearAllDevFeatureOverrides"],[15,67,52,0],[16,2,60,0,"exports"],[16,9,60,0],[16,10,60,0,"setRemoteFeatures"],[16,27,60,0],[16,30,60,0,"setRemoteFeatures"],[16,47,60,0],[17,2,65,0,"exports"],[17,9,65,0],[17,10,65,0,"clearRemoteFeatures"],[17,29,65,0],[17,32,65,0,"clearRemoteFeatures"],[17,51,65,0],[18,2,70,0,"exports"],[18,9,70,0],[18,10,70,0,"getRemoteFeaturesSnapshot"],[18,35,70,0],[18,38,70,0,"getRemoteFeaturesSnapshot"],[18,63,70,0],[19,2,83,0,"exports"],[19,9,83,0],[19,10,83,0,"isFeatureEnabled"],[19,26,83,0],[19,29,83,0,"isFeatureEnabled"],[19,45,83,0],[20,2,3,0],[20,6,3,0,"_featureUtils"],[20,19,3,0],[20,22,3,0,"require"],[20,29,3,0],[20,30,3,0,"_dependencyMap"],[20,44,3,0],[21,2,1,0],[23,2,10,0],[24,0,11,0],[25,0,12,0],[26,0,13,0],[27,2,14,7],[27,8,14,13,"DEFAULT_FLAGS"],[27,21,14,26],[27,24,14,29],[28,4,15,2,"AWAKENING_PREVIEW_UI"],[28,24,15,22],[28,26,15,24],[28,31,15,29],[29,4,16,2,"GACHA_PITY_UI"],[29,17,16,15],[29,19,16,17],[29,23,16,21],[30,4,17,2,"NEW_LOGIN_FLOW"],[30,18,17,16],[30,20,17,18],[30,25,17,23],[31,4,18,2,"MAINTENANCE_MODE"],[31,20,18,18],[31,22,18,20],[31,27,18,25],[32,4,19,2,"CAMPAIGN_SWEEP"],[32,18,19,16],[32,20,19,18],[32,24,19,22],[33,4,20,2,"HERO_CINEMATICS"],[33,19,20,17],[33,21,20,19],[34,2,21,0],[34,3,21,10],[35,2,33,0],[35,6,33,4,"remoteFlags"],[35,17,33,53],[35,20,33,56],[35,21,33,57],[35,22,33,58],[36,2,34,0],[36,6,34,4,"remoteVersion"],[36,19,34,32],[36,22,34,35],[36,26,34,39],[38,2,36,0],[39,0,37,0],[40,0,38,0],[41,0,39,0],[42,2,40,0],[42,8,40,6,"devOverrides"],[42,20,40,43],[42,23,40,46],[42,24,40,47],[42,25,40,48],[43,2,42,7],[43,11,42,16,"setDevFeatureOverride"],[43,32,42,37,"setDevFeatureOverride"],[43,33,42,38,"flag"],[43,37,42,50],[43,39,42,52,"enabled"],[43,46,42,68],[43,48,42,76],[44,4,43,2],[44,8,43,6],[44,9,43,7,"__DEV__"],[44,16,43,14],[44,18,43,16],[45,4,44,2,"devOverrides"],[45,16,44,14],[45,17,44,15,"flag"],[45,21,44,19],[45,22,44,20],[45,25,44,23,"enabled"],[45,32,44,30],[46,2,45,0],[47,2,47,7],[47,11,47,16,"clearDevFeatureOverride"],[47,34,47,39,"clearDevFeatureOverride"],[47,35,47,40,"flag"],[47,39,47,52],[47,41,47,60],[48,4,48,2],[48,8,48,6],[48,9,48,7,"__DEV__"],[48,16,48,14],[48,18,48,16],[49,4,49,2],[49,11,49,9,"devOverrides"],[49,23,49,21],[49,24,49,22,"flag"],[49,28,49,26],[49,29,49,27],[50,2,50,0],[51,2,52,7],[51,11,52,16,"clearAllDevFeatureOverrides"],[51,38,52,43,"clearAllDevFeatureOverrides"],[51,39,52,43],[51,41,52,52],[52,4,53,2],[52,8,53,6],[52,9,53,7,"__DEV__"],[52,16,53,14],[52,18,53,16],[53,4,54,2],[53,9,54,7],[53,15,54,13,"k"],[53,16,54,14],[53,20,54,18,"Object"],[53,26,54,24],[53,27,54,25,"keys"],[53,31,54,29],[53,32,54,30,"devOverrides"],[53,44,54,42],[53,45,54,43],[53,47,54,45],[53,54,54,52,"devOverrides"],[53,66,54,64],[53,67,54,65,"k"],[53,68,54,66],[53,69,54,67],[54,2,55,0],[56,2,57,0],[57,0,58,0],[58,0,59,0],[59,2,60,7],[59,11,60,16,"setRemoteFeatures"],[59,28,60,33,"setRemoteFeatures"],[59,29,60,34,"payload"],[59,36,60,64],[59,38,60,72],[60,4,61,2,"remoteVersion"],[60,17,61,15],[60,20,61,18,"payload"],[60,27,61,25],[60,28,61,26,"version"],[60,35,61,33],[60,39,61,37],[60,43,61,41],[61,4,62,2,"remoteFlags"],[61,15,62,13],[61,18,62,16],[61,22,62,16,"normalizeRemoteFlags"],[61,35,62,36],[61,36,62,36,"normalizeRemoteFlags"],[61,56,62,36],[61,58,62,37,"payload"],[61,65,62,44],[61,66,62,45,"flags"],[61,71,62,50],[61,72,62,51],[62,2,63,0],[63,2,65,7],[63,11,65,16,"clearRemoteFeatures"],[63,30,65,35,"clearRemoteFeatures"],[63,31,65,35],[63,33,65,44],[64,4,66,2,"remoteVersion"],[64,17,66,15],[64,20,66,18],[64,24,66,22],[65,4,67,2,"remoteFlags"],[65,15,67,13],[65,18,67,16],[65,19,67,17],[65,20,67,18],[66,2,68,0],[67,2,70,7],[67,11,70,16,"getRemoteFeaturesSnapshot"],[67,36,70,41,"getRemoteFeaturesSnapshot"],[67,37,70,41],[67,39,73,2],[68,4,74,2],[68,11,74,9],[69,6,74,11,"version"],[69,13,74,18],[69,15,74,20,"remoteVersion"],[69,28,74,33],[70,6,74,35,"flags"],[70,11,74,40],[70,13,74,42,"remoteFlags"],[71,4,74,54],[71,5,74,55],[72,2,75,0],[74,2,77,0],[75,0,78,0],[76,0,79,0],[77,0,80,0],[79,2,83,7],[79,11,83,16,"isFeatureEnabled"],[79,27,83,32,"isFeatureEnabled"],[79,28,83,33,"flag"],[79,32,83,45],[79,34,83,47,"ctx"],[79,37,83,71],[79,39,83,82],[80,4,84,2],[81,4,85,2],[81,8,85,6,"__DEV__"],[81,15,85,13],[81,19,85,17,"Object"],[81,25,85,23],[81,26,85,24,"prototype"],[81,35,85,33],[81,36,85,34,"hasOwnProperty"],[81,50,85,48],[81,51,85,49,"call"],[81,55,85,53],[81,56,85,54,"devOverrides"],[81,68,85,66],[81,70,85,68,"flag"],[81,74,85,72],[81,75,85,73],[81,77,85,75],[82,6,86,4],[82,13,86,11],[82,14,86,12],[82,15,86,13,"devOverrides"],[82,27,86,25],[82,28,86,26,"flag"],[82,32,86,30],[82,33,86,31],[83,4,87,2],[85,4,89,2],[86,4,90,2],[86,10,90,8,"r"],[86,11,90,9],[86,14,90,12,"remoteFlags"],[86,25,90,23],[86,26,90,24,"flag"],[86,30,90,28],[86,31,90,29],[87,4,91,2],[87,8,91,6,"r"],[87,9,91,7],[87,11,91,9],[88,6,92,4],[88,10,92,8],[88,11,92,9,"r"],[88,12,92,10],[88,13,92,11,"enabled"],[88,20,92,18],[88,22,92,20],[88,29,92,27],[88,34,92,32],[89,6,93,4],[89,10,93,8],[89,17,93,15,"r"],[89,18,93,16],[89,19,93,17,"rollout"],[89,26,93,24],[89,31,93,29],[89,39,93,37],[89,41,93,39],[90,8,94,6],[90,14,94,12,"stableId"],[90,22,94,20],[90,25,94,23,"ctx"],[90,28,94,26],[90,30,94,28,"stableId"],[90,38,94,36],[91,8,95,6],[91,12,95,10],[91,13,95,11,"stableId"],[91,21,95,19],[91,23,95,21],[91,30,95,28],[91,34,95,32],[91,35,95,33],[91,36,95,34],[92,8,96,6],[92,14,96,12,"b"],[92,15,96,13],[92,18,96,16],[92,22,96,16,"bucket01"],[92,35,96,24],[92,36,96,24,"bucket01"],[92,44,96,24],[92,46,96,25],[92,49,96,28,"flag"],[92,53,96,32],[92,57,96,36,"stableId"],[92,65,96,44],[92,67,96,46],[92,68,96,47],[93,8,97,6],[93,15,97,13,"b"],[93,16,97,14],[93,19,97,17,"r"],[93,20,97,18],[93,21,97,19,"rollout"],[93,28,97,26],[94,6,98,4],[95,6,99,4],[95,13,99,11],[95,17,99,15],[96,4,100,2],[98,4,102,2],[99,4,103,2],[99,8,103,6,"Object"],[99,14,103,12],[99,15,103,13,"prototype"],[99,24,103,22],[99,25,103,23,"hasOwnProperty"],[99,39,103,37],[99,40,103,38,"call"],[99,44,103,42],[99,45,103,43,"DEFAULT_FLAGS"],[99,58,103,56],[99,60,103,58,"flag"],[99,64,103,62],[99,65,103,63],[99,67,103,65],[100,6,104,4],[100,13,104,11],[100,14,104,12],[100,15,104,14,"DEFAULT_FLAGS"],[100,28,104,27],[100,29,104,56,"flag"],[100,33,104,60],[100,34,104,61],[101,4,105,2],[103,4,107,2],[104,4,108,2],[104,11,108,9],[104,16,108,14],[105,2,109,0],[106,0,109,1],[106,3]],"functionMap":{"names":["<global>","setDevFeatureOverride","clearDevFeatureOverride","clearAllDevFeatureOverrides","setRemoteFeatures","clearRemoteFeatures","getRemoteFeaturesSnapshot","isFeatureEnabled"],"mappings":"AAA;OCyC;CDG;OEE;CFG;OGE;CHG;OIK;CJG;OKE;CLG;OME;CNK;OOQ;CP0B"},"hasCjsExports":false},"type":"js/module"}]}