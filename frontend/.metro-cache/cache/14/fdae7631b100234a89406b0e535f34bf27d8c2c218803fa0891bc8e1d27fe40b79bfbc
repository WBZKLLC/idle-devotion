{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":14,"index":78},"end":{"line":3,"column":38,"index":102}}],"key":"ud8OE6Lg8Q81+bS6ynZj2uyMPdA=","exportNames":["*"],"imports":1}},{"name":"../api.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":12,"index":116},"end":{"line":4,"column":32,"index":136}}],"key":"+eGiiNBp9LiioqcKgPq/GmiVEfQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _asyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\").default;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  var utils = require(_dependencyMap[1], \"@sentry/utils\");\n  var api = require(_dependencyMap[2], \"../api.js\");\n\n  /**\n   * Gets an event from an envelope.\n   *\n   * This is only exported for use in the tests\n   */\n  function eventFromEnvelope(env, types) {\n    var event;\n    utils.forEachEnvelopeItem(env, (item, type) => {\n      if (types.includes(type)) {\n        event = Array.isArray(item) ? item[1] : undefined;\n      }\n      // bail out if we found an event\n      return !!event;\n    });\n    return event;\n  }\n\n  /**\n   * Creates a transport that overrides the release on all events.\n   */\n  function makeOverrideReleaseTransport(createTransport, release) {\n    return options => {\n      var transport = createTransport(options);\n      return {\n        send: function () {\n          var _ref = _asyncToGenerator(function* (envelope) {\n            var event = eventFromEnvelope(envelope, ['event', 'transaction', 'profile', 'replay_event']);\n            if (event) {\n              event.release = release;\n            }\n            return transport.send(envelope);\n          });\n          return function send(_x) {\n            return _ref.apply(this, arguments);\n          };\n        }(),\n        flush: timeout => transport.flush(timeout)\n      };\n    };\n  }\n\n  /**\n   * Creates a transport that can send events to different DSNs depending on the envelope contents.\n   */\n  function makeMultiplexedTransport(createTransport, matcher) {\n    return options => {\n      var fallbackTransport = createTransport(options);\n      var otherTransports = {};\n      function getTransport(dsn, release) {\n        // We create a transport for every unique dsn/release combination as there may be code from multiple releases in\n        // use at the same time\n        var key = release ? `${dsn}:${release}` : dsn;\n        if (!otherTransports[key]) {\n          var validatedDsn = utils.dsnFromString(dsn);\n          if (!validatedDsn) {\n            return undefined;\n          }\n          var url = api.getEnvelopeEndpointWithUrlEncodedAuth(validatedDsn);\n          otherTransports[key] = release ? makeOverrideReleaseTransport(createTransport, release)({\n            ...options,\n            url\n          }) : createTransport({\n            ...options,\n            url\n          });\n        }\n        return otherTransports[key];\n      }\n      function send(_x2) {\n        return _send.apply(this, arguments);\n      }\n      function _send() {\n        _send = _asyncToGenerator(function* (envelope) {\n          function getEvent(types) {\n            var eventTypes = types && types.length ? types : ['event'];\n            return eventFromEnvelope(envelope, eventTypes);\n          }\n          var transports = matcher({\n            envelope,\n            getEvent\n          }).map(result => {\n            if (typeof result === 'string') {\n              return getTransport(result, undefined);\n            } else {\n              return getTransport(result.dsn, result.release);\n            }\n          }).filter(t => !!t);\n\n          // If we have no transports to send to, use the fallback transport\n          if (transports.length === 0) {\n            transports.push(fallbackTransport);\n          }\n          var results = yield Promise.all(transports.map(transport => transport.send(envelope)));\n          return results[0];\n        });\n        return _send.apply(this, arguments);\n      }\n      function flush(_x3) {\n        return _flush.apply(this, arguments);\n      }\n      function _flush() {\n        _flush = _asyncToGenerator(function* (timeout) {\n          var allTransports = [...Object.keys(otherTransports).map(dsn => otherTransports[dsn]), fallbackTransport];\n          var results = yield Promise.all(allTransports.map(transport => transport.flush(timeout)));\n          return results.every(r => r);\n        });\n        return _flush.apply(this, arguments);\n      }\n      return {\n        send,\n        flush\n      };\n    };\n  }\n  exports.eventFromEnvelope = eventFromEnvelope;\n  exports.makeMultiplexedTransport = makeMultiplexedTransport;\n});","lineCount":125,"map":[[3,2,1,0,"Object"],[3,8,1,6],[3,9,1,7,"defineProperty"],[3,23,1,21],[3,24,1,22,"exports"],[3,31,1,29],[3,33,1,31],[3,45,1,43],[3,47,1,45],[4,4,1,47,"value"],[4,9,1,52],[4,11,1,54],[5,2,1,59],[5,3,1,60],[5,4,1,61],[6,2,3,0],[6,6,3,6,"utils"],[6,11,3,11],[6,14,3,14,"require"],[6,21,3,21],[6,22,3,21,"_dependencyMap"],[6,36,3,21],[6,56,3,37],[6,57,3,38],[7,2,4,0],[7,6,4,6,"api"],[7,9,4,9],[7,12,4,12,"require"],[7,19,4,19],[7,20,4,19,"_dependencyMap"],[7,34,4,19],[7,50,4,31],[7,51,4,32],[9,2,6,0],[10,0,7,0],[11,0,8,0],[12,0,9,0],[13,0,10,0],[14,2,11,0],[14,11,11,9,"eventFromEnvelope"],[14,28,11,26,"eventFromEnvelope"],[14,29,11,27,"env"],[14,32,11,30],[14,34,11,32,"types"],[14,39,11,37],[14,41,11,39],[15,4,12,2],[15,8,12,6,"event"],[15,13,12,11],[16,4,14,2,"utils"],[16,9,14,7],[16,10,14,8,"forEachEnvelopeItem"],[16,29,14,27],[16,30,14,28,"env"],[16,33,14,31],[16,35,14,33],[16,36,14,34,"item"],[16,40,14,38],[16,42,14,40,"type"],[16,46,14,44],[16,51,14,49],[17,6,15,4],[17,10,15,8,"types"],[17,15,15,13],[17,16,15,14,"includes"],[17,24,15,22],[17,25,15,23,"type"],[17,29,15,27],[17,30,15,28],[17,32,15,30],[18,8,16,6,"event"],[18,13,16,11],[18,16,16,14,"Array"],[18,21,16,19],[18,22,16,20,"isArray"],[18,29,16,27],[18,30,16,28,"item"],[18,34,16,32],[18,35,16,33],[18,38,16,37,"item"],[18,42,16,41],[18,43,16,44],[18,44,16,45],[18,45,16,46],[18,48,16,49,"undefined"],[18,57,16,58],[19,6,17,4],[20,6,18,4],[21,6,19,4],[21,13,19,11],[21,14,19,12],[21,15,19,13,"event"],[21,20,19,18],[22,4,20,2],[22,5,20,3],[22,6,20,4],[23,4,22,2],[23,11,22,9,"event"],[23,16,22,14],[24,2,23,0],[26,2,25,0],[27,0,26,0],[28,0,27,0],[29,2,28,0],[29,11,28,9,"makeOverrideReleaseTransport"],[29,39,28,37,"makeOverrideReleaseTransport"],[29,40,29,2,"createTransport"],[29,55,29,17],[29,57,30,2,"release"],[29,64,30,9],[29,66,31,2],[30,4,32,2],[30,11,32,9,"options"],[30,18,32,16],[30,22,32,20],[31,6,33,4],[31,10,33,10,"transport"],[31,19,33,19],[31,22,33,22,"createTransport"],[31,37,33,37],[31,38,33,38,"options"],[31,45,33,45],[31,46,33,46],[32,6,35,4],[32,13,35,11],[33,8,36,6,"send"],[33,12,36,10],[34,10,36,10],[34,14,36,10,"_ref"],[34,18,36,10],[34,21,36,10,"_asyncToGenerator"],[34,38,36,10],[34,39,36,12],[34,50,36,19,"envelope"],[34,58,36,27],[34,60,36,32],[35,12,37,8],[35,16,37,14,"event"],[35,21,37,19],[35,24,37,22,"eventFromEnvelope"],[35,41,37,39],[35,42,37,40,"envelope"],[35,50,37,48],[35,52,37,50],[35,53,37,51],[35,60,37,58],[35,62,37,60],[35,75,37,73],[35,77,37,75],[35,86,37,84],[35,88,37,86],[35,102,37,100],[35,103,37,101],[35,104,37,102],[36,12,39,8],[36,16,39,12,"event"],[36,21,39,17],[36,23,39,19],[37,14,40,10,"event"],[37,19,40,15],[37,20,40,16,"release"],[37,27,40,23],[37,30,40,26,"release"],[37,37,40,33],[38,12,41,8],[39,12,42,8],[39,19,42,15,"transport"],[39,28,42,24],[39,29,42,25,"send"],[39,33,42,29],[39,34,42,30,"envelope"],[39,42,42,38],[39,43,42,39],[40,10,43,6],[40,11,43,7],[41,10,43,7],[41,26,36,6,"send"],[41,30,36,10,"send"],[41,31,36,10,"_x"],[41,33,36,10],[42,12,36,10],[42,19,36,10,"_ref"],[42,23,36,10],[42,24,36,10,"apply"],[42,29,36,10],[42,36,36,10,"arguments"],[42,45,36,10],[43,10,36,10],[44,8,36,10],[44,11,43,7],[45,8,44,6,"flush"],[45,13,44,11],[45,15,44,13,"timeout"],[45,22,44,20],[45,26,44,24,"transport"],[45,35,44,33],[45,36,44,34,"flush"],[45,41,44,39],[45,42,44,40,"timeout"],[45,49,44,47],[46,6,45,4],[46,7,45,5],[47,4,46,2],[47,5,46,3],[48,2,47,0],[50,2,49,0],[51,0,50,0],[52,0,51,0],[53,2,52,0],[53,11,52,9,"makeMultiplexedTransport"],[53,35,52,33,"makeMultiplexedTransport"],[53,36,53,2,"createTransport"],[53,51,53,17],[53,53,54,2,"matcher"],[53,60,54,9],[53,62,55,2],[54,4,56,2],[54,11,56,9,"options"],[54,18,56,16],[54,22,56,20],[55,6,57,4],[55,10,57,10,"fallbackTransport"],[55,27,57,27],[55,30,57,30,"createTransport"],[55,45,57,45],[55,46,57,46,"options"],[55,53,57,53],[55,54,57,54],[56,6,58,4],[56,10,58,10,"otherTransports"],[56,25,58,25],[56,28,58,28],[56,29,58,29],[56,30,58,30],[57,6,60,4],[57,15,60,13,"getTransport"],[57,27,60,25,"getTransport"],[57,28,60,26,"dsn"],[57,31,60,29],[57,33,60,31,"release"],[57,40,60,38],[57,42,60,40],[58,8,61,6],[59,8,62,6],[60,8,63,6],[60,12,63,12,"key"],[60,15,63,15],[60,18,63,18,"release"],[60,25,63,25],[60,28,63,28],[60,31,63,31,"dsn"],[60,34,63,34],[60,38,63,38,"release"],[60,45,63,45],[60,47,63,47],[60,50,63,50,"dsn"],[60,53,63,53],[61,8,65,6],[61,12,65,10],[61,13,65,11,"otherTransports"],[61,28,65,26],[61,29,65,27,"key"],[61,32,65,30],[61,33,65,31],[61,35,65,33],[62,10,66,8],[62,14,66,14,"validatedDsn"],[62,26,66,26],[62,29,66,29,"utils"],[62,34,66,34],[62,35,66,35,"dsnFromString"],[62,48,66,48],[62,49,66,49,"dsn"],[62,52,66,52],[62,53,66,53],[63,10,67,8],[63,14,67,12],[63,15,67,13,"validatedDsn"],[63,27,67,25],[63,29,67,27],[64,12,68,10],[64,19,68,17,"undefined"],[64,28,68,26],[65,10,69,8],[66,10,70,8],[66,14,70,14,"url"],[66,17,70,17],[66,20,70,20,"api"],[66,23,70,23],[66,24,70,24,"getEnvelopeEndpointWithUrlEncodedAuth"],[66,61,70,61],[66,62,70,62,"validatedDsn"],[66,74,70,74],[66,75,70,75],[67,10,72,8,"otherTransports"],[67,25,72,23],[67,26,72,24,"key"],[67,29,72,27],[67,30,72,28],[67,33,72,31,"release"],[67,40,72,38],[67,43,73,12,"makeOverrideReleaseTransport"],[67,71,73,40],[67,72,73,41,"createTransport"],[67,87,73,56],[67,89,73,58,"release"],[67,96,73,65],[67,97,73,66],[67,98,73,67],[68,12,73,69],[68,15,73,72,"options"],[68,22,73,79],[69,12,73,81,"url"],[70,10,73,85],[70,11,73,86],[70,12,73,87],[70,15,74,12,"createTransport"],[70,30,74,27],[70,31,74,28],[71,12,74,30],[71,15,74,33,"options"],[71,22,74,40],[72,12,74,42,"url"],[73,10,74,46],[73,11,74,47],[73,12,74,48],[74,8,75,6],[75,8,77,6],[75,15,77,13,"otherTransports"],[75,30,77,28],[75,31,77,29,"key"],[75,34,77,32],[75,35,77,33],[76,6,78,4],[77,6,78,5],[77,15,80,19,"send"],[77,19,80,23,"send"],[77,20,80,23,"_x2"],[77,23,80,23],[78,8,80,23],[78,15,80,23,"_send"],[78,20,80,23],[78,21,80,23,"apply"],[78,26,80,23],[78,33,80,23,"arguments"],[78,42,80,23],[79,6,80,23],[80,6,80,23],[80,15,80,23,"_send"],[80,21,80,23],[81,8,80,23,"_send"],[81,13,80,23],[81,16,80,23,"_asyncToGenerator"],[81,33,80,23],[81,34,80,4],[81,45,80,24,"envelope"],[81,53,80,32],[81,55,80,34],[82,10,81,6],[82,19,81,15,"getEvent"],[82,27,81,23,"getEvent"],[82,28,81,24,"types"],[82,33,81,29],[82,35,81,31],[83,12,82,8],[83,16,82,14,"eventTypes"],[83,26,82,24],[83,29,82,27,"types"],[83,34,82,32],[83,38,82,36,"types"],[83,43,82,41],[83,44,82,42,"length"],[83,50,82,48],[83,53,82,51,"types"],[83,58,82,56],[83,61,82,59],[83,62,82,60],[83,69,82,67],[83,70,82,68],[84,12,83,8],[84,19,83,15,"eventFromEnvelope"],[84,36,83,32],[84,37,83,33,"envelope"],[84,45,83,41],[84,47,83,43,"eventTypes"],[84,57,83,53],[84,58,83,54],[85,10,84,6],[86,10,86,6],[86,14,86,12,"transports"],[86,24,86,22],[86,27,86,25,"matcher"],[86,34,86,32],[86,35,86,33],[87,12,86,35,"envelope"],[87,20,86,43],[88,12,86,45,"getEvent"],[89,10,86,54],[89,11,86,55],[89,12,86,56],[89,13,87,9,"map"],[89,16,87,12],[89,17,87,13,"result"],[89,23,87,19],[89,27,87,23],[90,12,88,10],[90,16,88,14],[90,23,88,21,"result"],[90,29,88,27],[90,34,88,32],[90,42,88,40],[90,44,88,42],[91,14,89,12],[91,21,89,19,"getTransport"],[91,33,89,31],[91,34,89,32,"result"],[91,40,89,38],[91,42,89,40,"undefined"],[91,51,89,49],[91,52,89,50],[92,12,90,10],[92,13,90,11],[92,19,90,17],[93,14,91,12],[93,21,91,19,"getTransport"],[93,33,91,31],[93,34,91,32,"result"],[93,40,91,38],[93,41,91,39,"dsn"],[93,44,91,42],[93,46,91,44,"result"],[93,52,91,50],[93,53,91,51,"release"],[93,60,91,58],[93,61,91,59],[94,12,92,10],[95,10,93,8],[95,11,93,9],[95,12,93,10],[95,13,94,9,"filter"],[95,19,94,15],[95,20,94,17,"t"],[95,21,94,18],[95,25,94,23],[95,26,94,24],[95,27,94,25,"t"],[95,28,94,26],[95,29,94,27],[97,10,96,6],[98,10,97,6],[98,14,97,10,"transports"],[98,24,97,20],[98,25,97,21,"length"],[98,31,97,27],[98,36,97,32],[98,37,97,33],[98,39,97,35],[99,12,98,8,"transports"],[99,22,98,18],[99,23,98,19,"push"],[99,27,98,23],[99,28,98,24,"fallbackTransport"],[99,45,98,41],[99,46,98,42],[100,10,99,6],[101,10,101,6],[101,14,101,12,"results"],[101,21,101,19],[101,30,101,28,"Promise"],[101,37,101,35],[101,38,101,36,"all"],[101,41,101,39],[101,42,101,40,"transports"],[101,52,101,50],[101,53,101,51,"map"],[101,56,101,54],[101,57,101,55,"transport"],[101,66,101,64],[101,70,101,68,"transport"],[101,79,101,77],[101,80,101,78,"send"],[101,84,101,82],[101,85,101,83,"envelope"],[101,93,101,91],[101,94,101,92],[101,95,101,93],[101,96,101,94],[102,10,103,6],[102,17,103,13,"results"],[102,24,103,20],[102,25,103,21],[102,26,103,22],[102,27,103,23],[103,8,104,4],[103,9,104,5],[104,8,104,5],[104,15,104,5,"_send"],[104,20,104,5],[104,21,104,5,"apply"],[104,26,104,5],[104,33,104,5,"arguments"],[104,42,104,5],[105,6,104,5],[106,6,104,5],[106,15,106,19,"flush"],[106,20,106,24,"flush"],[106,21,106,24,"_x3"],[106,24,106,24],[107,8,106,24],[107,15,106,24,"_flush"],[107,21,106,24],[107,22,106,24,"apply"],[107,27,106,24],[107,34,106,24,"arguments"],[107,43,106,24],[108,6,106,24],[109,6,106,24],[109,15,106,24,"_flush"],[109,22,106,24],[110,8,106,24,"_flush"],[110,14,106,24],[110,17,106,24,"_asyncToGenerator"],[110,34,106,24],[110,35,106,4],[110,46,106,25,"timeout"],[110,53,106,32],[110,55,106,34],[111,10,107,6],[111,14,107,12,"allTransports"],[111,27,107,25],[111,30,107,28],[111,31,107,29],[111,34,107,32,"Object"],[111,40,107,38],[111,41,107,39,"keys"],[111,45,107,43],[111,46,107,44,"otherTransports"],[111,61,107,59],[111,62,107,60],[111,63,107,61,"map"],[111,66,107,64],[111,67,107,65,"dsn"],[111,70,107,68],[111,74,107,72,"otherTransports"],[111,89,107,87],[111,90,107,88,"dsn"],[111,93,107,91],[111,94,107,92],[111,95,107,93],[111,97,107,95,"fallbackTransport"],[111,114,107,112],[111,115,107,113],[112,10,108,6],[112,14,108,12,"results"],[112,21,108,19],[112,30,108,28,"Promise"],[112,37,108,35],[112,38,108,36,"all"],[112,41,108,39],[112,42,108,40,"allTransports"],[112,55,108,53],[112,56,108,54,"map"],[112,59,108,57],[112,60,108,58,"transport"],[112,69,108,67],[112,73,108,71,"transport"],[112,82,108,80],[112,83,108,81,"flush"],[112,88,108,86],[112,89,108,87,"timeout"],[112,96,108,94],[112,97,108,95],[112,98,108,96],[112,99,108,97],[113,10,109,6],[113,17,109,13,"results"],[113,24,109,20],[113,25,109,21,"every"],[113,30,109,26],[113,31,109,27,"r"],[113,32,109,28],[113,36,109,32,"r"],[113,37,109,33],[113,38,109,34],[114,8,110,4],[114,9,110,5],[115,8,110,5],[115,15,110,5,"_flush"],[115,21,110,5],[115,22,110,5,"apply"],[115,27,110,5],[115,34,110,5,"arguments"],[115,43,110,5],[116,6,110,5],[117,6,112,4],[117,13,112,11],[118,8,113,6,"send"],[118,12,113,10],[119,8,114,6,"flush"],[120,6,115,4],[120,7,115,5],[121,4,116,2],[121,5,116,3],[122,2,117,0],[123,2,119,0,"exports"],[123,9,119,7],[123,10,119,8,"eventFromEnvelope"],[123,27,119,25],[123,30,119,28,"eventFromEnvelope"],[123,47,119,45],[124,2,120,0,"exports"],[124,9,120,7],[124,10,120,8,"makeMultiplexedTransport"],[124,34,120,32],[124,37,120,35,"makeMultiplexedTransport"],[124,61,120,59],[125,0,120,60],[125,3]],"functionMap":{"names":["<global>","eventFromEnvelope","utils.forEachEnvelopeItem$argument_1","makeOverrideReleaseTransport","<anonymous>","send","flush","makeMultiplexedTransport","getTransport","getEvent","matcher.map$argument_0","matcher.map.filter$argument_0","transports.map$argument_0","Object.keys.map$argument_0","allTransports.map$argument_0","results.every$argument_0"],"mappings":"AAA;ACU;iCCG;GDM;CDG;AGK;SCI;YCI;ODO;aEC,mCF;GDE;CHC;AOK;SHI;III;KJkB;ICE;MIC;OJG;aKG;SLM;gBMC,UN;uDOO,qCP;KDG;IEE;iEOC,2BP;0DQC,qCR;2BSC,MT;KFC;GGM;CPC"},"hasCjsExports":true},"type":"js/module"}]}