{"dependencies":[{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _slicedToArray = require(_dependencyMap[0], \"@babel/runtime/helpers/slicedToArray\").default;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n\n  /**\n   * Recursively traverses an object to update an existing nested key.\n   * Note: The provided key path must include existing properties,\n   * the function will not create objects while traversing.\n   *\n   * @param obj An object to update\n   * @param value The value to update the nested key with\n   * @param keyPath The path to the key to update ex. fizz.buzz.foo\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  function setNestedKey(obj, keyPath, value) {\n    // Ex. foo.bar.zoop will extract foo and bar.zoop\n    var match = keyPath.match(/([a-z_]+)\\.(.*)/i);\n    // The match will be null when there's no more recursing to do, i.e., when we've reached the right level of the object\n    if (match === null) {\n      obj[keyPath] = value;\n    } else {\n      // `match[1]` is the initial segment of the path, and `match[2]` is the remainder of the path\n      var innerObj = obj[match[1]];\n      setNestedKey(innerObj, match[2], value);\n    }\n  }\n\n  /**\n   * Enforces inclusion of a given integration with specified options in an integration array originally determined by the\n   * user, by either including the given default instance or by patching an existing user instance with the given options.\n   *\n   * Ideally this would happen when integrations are set up, but there isn't currently a mechanism there for merging\n   * options from a default integration instance with those from a user-provided instance of the same integration, only\n   * for allowing the user to override a default instance entirely. (TODO: Fix that.)\n   *\n   * @param defaultIntegrationInstance An instance of the integration with the correct options already set\n   * @param userIntegrations Integrations defined by the user.\n   * @param forcedOptions Options with which to patch an existing user-derived instance on the integration.\n   * @returns A final integrations array.\n   */\n  function addOrUpdateIntegration(defaultIntegrationInstance, userIntegrations) {\n    var forcedOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return Array.isArray(userIntegrations) ? addOrUpdateIntegrationInArray(defaultIntegrationInstance, userIntegrations, forcedOptions) : addOrUpdateIntegrationInFunction(defaultIntegrationInstance,\n    // Somehow TS can't figure out that not being an array makes this necessarily a function\n    userIntegrations, forcedOptions);\n  }\n  function addOrUpdateIntegrationInArray(defaultIntegrationInstance, userIntegrations, forcedOptions) {\n    var userInstance = userIntegrations.find(integration => integration.name === defaultIntegrationInstance.name);\n    if (userInstance) {\n      for (var _ref of Object.entries(forcedOptions)) {\n        var _ref2 = _slicedToArray(_ref, 2);\n        var keyPath = _ref2[0];\n        var value = _ref2[1];\n        setNestedKey(userInstance, keyPath, value);\n      }\n      return userIntegrations;\n    }\n    return [...userIntegrations, defaultIntegrationInstance];\n  }\n  function addOrUpdateIntegrationInFunction(defaultIntegrationInstance, userIntegrationsFunc, forcedOptions) {\n    var wrapper = defaultIntegrations => {\n      var userFinalIntegrations = userIntegrationsFunc(defaultIntegrations);\n\n      // There are instances where we want the user to be able to prevent an integration from appearing at all, which they\n      // would do by providing a function which filters out the integration in question. If that's happened in one of\n      // those cases, don't add our default back in.\n      if (defaultIntegrationInstance.allowExclusionByUser) {\n        var userFinalInstance = userFinalIntegrations.find(integration => integration.name === defaultIntegrationInstance.name);\n        if (!userFinalInstance) {\n          return userFinalIntegrations;\n        }\n      }\n      return addOrUpdateIntegrationInArray(defaultIntegrationInstance, userFinalIntegrations, forcedOptions);\n    };\n    return wrapper;\n  }\n  exports.addOrUpdateIntegration = addOrUpdateIntegration;\n});","lineCount":80,"map":[[3,2,1,0,"Object"],[3,8,1,6],[3,9,1,7,"defineProperty"],[3,23,1,21],[3,24,1,22,"exports"],[3,31,1,29],[3,33,1,31],[3,45,1,43],[3,47,1,45],[4,4,1,47,"value"],[4,9,1,52],[4,11,1,54],[5,2,1,59],[5,3,1,60],[5,4,1,61],[7,2,3,0],[8,0,4,0],[9,0,5,0],[10,0,6,0],[11,0,7,0],[12,0,8,0],[13,0,9,0],[14,0,10,0],[15,0,11,0],[16,2,12,0],[17,2,13,0],[17,11,13,9,"setNestedKey"],[17,23,13,21,"setNestedKey"],[17,24,13,22,"obj"],[17,27,13,25],[17,29,13,27,"keyPath"],[17,36,13,34],[17,38,13,36,"value"],[17,43,13,41],[17,45,13,43],[18,4,14,2],[19,4,15,2],[19,8,15,8,"match"],[19,13,15,13],[19,16,15,16,"keyPath"],[19,23,15,23],[19,24,15,24,"match"],[19,29,15,29],[19,30,15,30],[19,48,15,48],[19,49,15,49],[20,4,16,2],[21,4,17,2],[21,8,17,6,"match"],[21,13,17,11],[21,18,17,16],[21,22,17,20],[21,24,17,22],[22,6,18,4,"obj"],[22,9,18,7],[22,10,18,8,"keyPath"],[22,17,18,15],[22,18,18,16],[22,21,18,19,"value"],[22,26,18,24],[23,4,19,2],[23,5,19,3],[23,11,19,9],[24,6,20,4],[25,6,21,4],[25,10,21,10,"innerObj"],[25,18,21,18],[25,21,21,21,"obj"],[25,24,21,24],[25,25,21,25,"match"],[25,30,21,30],[25,31,21,31],[25,32,21,32],[25,33,21,33],[25,34,21,34],[26,6,22,4,"setNestedKey"],[26,18,22,16],[26,19,22,17,"innerObj"],[26,27,22,25],[26,29,22,27,"match"],[26,34,22,32],[26,35,22,33],[26,36,22,34],[26,37,22,35],[26,39,22,37,"value"],[26,44,22,42],[26,45,22,43],[27,4,23,2],[28,2,24,0],[30,2,26,0],[31,0,27,0],[32,0,28,0],[33,0,29,0],[34,0,30,0],[35,0,31,0],[36,0,32,0],[37,0,33,0],[38,0,34,0],[39,0,35,0],[40,0,36,0],[41,0,37,0],[42,0,38,0],[43,2,39,0],[43,11,39,9,"addOrUpdateIntegration"],[43,33,39,31,"addOrUpdateIntegration"],[43,34,40,2,"defaultIntegrationInstance"],[43,60,40,28],[43,62,41,2,"userIntegrations"],[43,78,41,18],[43,80,43,2],[44,4,43,2],[44,8,42,2,"forcedOptions"],[44,21,42,15],[44,24,42,15,"arguments"],[44,33,42,15],[44,34,42,15,"length"],[44,40,42,15],[44,48,42,15,"arguments"],[44,57,42,15],[44,65,42,15,"undefined"],[44,74,42,15],[44,77,42,15,"arguments"],[44,86,42,15],[44,92,42,18],[44,93,42,19],[44,94,42,20],[45,4,44,2],[45,11,45,4,"Array"],[45,16,45,9],[45,17,45,10,"isArray"],[45,24,45,17],[45,25,45,18,"userIntegrations"],[45,41,45,34],[45,42,45,35],[45,45,46,8,"addOrUpdateIntegrationInArray"],[45,74,46,37],[45,75,46,38,"defaultIntegrationInstance"],[45,101,46,64],[45,103,46,66,"userIntegrations"],[45,119,46,82],[45,121,46,84,"forcedOptions"],[45,134,46,97],[45,135,46,98],[45,138,47,8,"addOrUpdateIntegrationInFunction"],[45,170,47,40],[45,171,48,10,"defaultIntegrationInstance"],[45,197,48,36],[46,4,49,10],[47,4,50,10,"userIntegrations"],[47,20,50,26],[47,22,51,10,"forcedOptions"],[47,35,52,8],[47,36,52,9],[48,2,54,0],[49,2,56,0],[49,11,56,9,"addOrUpdateIntegrationInArray"],[49,40,56,38,"addOrUpdateIntegrationInArray"],[49,41,57,2,"defaultIntegrationInstance"],[49,67,57,28],[49,69,58,2,"userIntegrations"],[49,85,58,18],[49,87,59,2,"forcedOptions"],[49,100,59,15],[49,102,60,2],[50,4,61,2],[50,8,61,8,"userInstance"],[50,20,61,20],[50,23,61,23,"userIntegrations"],[50,39,61,39],[50,40,61,40,"find"],[50,44,61,44],[50,45,61,45,"integration"],[50,56,61,56],[50,60,61,60,"integration"],[50,71,61,71],[50,72,61,72,"name"],[50,76,61,76],[50,81,61,81,"defaultIntegrationInstance"],[50,107,61,107],[50,108,61,108,"name"],[50,112,61,112],[50,113,61,113],[51,4,63,2],[51,8,63,6,"userInstance"],[51,20,63,18],[51,22,63,20],[52,6,64,4],[52,15,64,4,"_ref"],[52,19,64,4],[52,23,64,35,"Object"],[52,29,64,41],[52,30,64,42,"entries"],[52,37,64,49],[52,38,64,50,"forcedOptions"],[52,51,64,63],[52,52,64,64],[52,54,64,66],[53,8,64,66],[53,12,64,66,"_ref2"],[53,17,64,66],[53,20,64,66,"_slicedToArray"],[53,34,64,66],[53,35,64,66,"_ref"],[53,39,64,66],[54,8,64,66],[54,12,64,16,"keyPath"],[54,19,64,23],[54,22,64,23,"_ref2"],[54,27,64,23],[55,8,64,23],[55,12,64,25,"value"],[55,17,64,30],[55,20,64,30,"_ref2"],[55,25,64,30],[56,8,65,6,"setNestedKey"],[56,20,65,18],[56,21,65,19,"userInstance"],[56,33,65,31],[56,35,65,33,"keyPath"],[56,42,65,40],[56,44,65,42,"value"],[56,49,65,47],[56,50,65,48],[57,6,66,4],[58,6,68,4],[58,13,68,11,"userIntegrations"],[58,29,68,27],[59,4,69,2],[60,4,71,2],[60,11,71,9],[60,12,71,10],[60,15,71,13,"userIntegrations"],[60,31,71,29],[60,33,71,31,"defaultIntegrationInstance"],[60,59,71,57],[60,60,71,58],[61,2,72,0],[62,2,74,0],[62,11,74,9,"addOrUpdateIntegrationInFunction"],[62,43,74,41,"addOrUpdateIntegrationInFunction"],[62,44,75,2,"defaultIntegrationInstance"],[62,70,75,28],[62,72,76,2,"userIntegrationsFunc"],[62,92,76,22],[62,94,77,2,"forcedOptions"],[62,107,77,15],[62,109,78,2],[63,4,79,2],[63,8,79,8,"wrapper"],[63,15,79,15],[63,18,79,18,"defaultIntegrations"],[63,37,79,37],[63,41,79,41],[64,6,80,4],[64,10,80,10,"userFinalIntegrations"],[64,31,80,31],[64,34,80,34,"userIntegrationsFunc"],[64,54,80,54],[64,55,80,55,"defaultIntegrations"],[64,74,80,74],[64,75,80,75],[66,6,82,4],[67,6,83,4],[68,6,84,4],[69,6,85,4],[69,10,85,8,"defaultIntegrationInstance"],[69,36,85,34],[69,37,85,35,"allowExclusionByUser"],[69,57,85,55],[69,59,85,57],[70,8,86,6],[70,12,86,12,"userFinalInstance"],[70,29,86,29],[70,32,86,32,"userFinalIntegrations"],[70,53,86,53],[70,54,86,54,"find"],[70,58,86,58],[70,59,87,8,"integration"],[70,70,87,19],[70,74,87,23,"integration"],[70,85,87,34],[70,86,87,35,"name"],[70,90,87,39],[70,95,87,44,"defaultIntegrationInstance"],[70,121,87,70],[70,122,87,71,"name"],[70,126,88,6],[70,127,88,7],[71,8,89,6],[71,12,89,10],[71,13,89,11,"userFinalInstance"],[71,30,89,28],[71,32,89,30],[72,10,90,8],[72,17,90,15,"userFinalIntegrations"],[72,38,90,36],[73,8,91,6],[74,6,92,4],[75,6,94,4],[75,13,94,11,"addOrUpdateIntegrationInArray"],[75,42,94,40],[75,43,94,41,"defaultIntegrationInstance"],[75,69,94,67],[75,71,94,69,"userFinalIntegrations"],[75,92,94,90],[75,94,94,92,"forcedOptions"],[75,107,94,105],[75,108,94,106],[76,4,95,2],[76,5,95,3],[77,4,97,2],[77,11,97,9,"wrapper"],[77,18,97,16],[78,2,98,0],[79,2,100,0,"exports"],[79,9,100,7],[79,10,100,8,"addOrUpdateIntegration"],[79,32,100,30],[79,35,100,33,"addOrUpdateIntegration"],[79,57,100,55],[80,0,100,56],[80,3]],"functionMap":{"names":["<global>","setNestedKey","addOrUpdateIntegration","addOrUpdateIntegrationInArray","find$argument_0","addOrUpdateIntegrationInFunction","wrapper","userFinalIntegrations.find$argument_0"],"mappings":"AAA;ACY;CDW;AEe;CFe;AGE;6CCK,mED;CHW;AKE;kBCK;QCQ,mED;GDQ;CLG"},"hasCjsExports":true},"type":"js/module"}]}