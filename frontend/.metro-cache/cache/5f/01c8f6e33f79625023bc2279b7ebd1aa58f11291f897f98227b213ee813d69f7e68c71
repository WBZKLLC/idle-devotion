{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":160},"end":{"line":8,"column":40,"index":200}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"../authStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":201},"end":{"line":9,"column":47,"index":248}}],"key":"8h7N/7sKemAZqrgZg8dH/jTl5ys=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"API_BASE\", {\n    enumerable: true,\n    get: function () {\n      return API_BASE;\n    }\n  });\n  exports.apiUrl = apiUrl;\n  exports.getAuthHeaders = getAuthHeaders;\n  exports.getJsonHeaders = getJsonHeaders;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _expoVirtualEnv = require(_dependencyMap[1], \"expo/virtual/env\");\n  var _reactNative = require(_dependencyMap[2], \"react-native\");\n  var _authStorage = require(_dependencyMap[3], \"../authStorage\");\n  /**\n   * Centralized API Configuration\n   * \n   * Single source of truth for API base URL across all platforms.\n   * Web preview, device, and tunnel all use this.\n   */\n\n  /**\n   * Get the API base URL based on platform and environment.\n   * \n   * Priority:\n   * 1. EXPO_PUBLIC_BACKEND_URL (if set)\n   * 2. EXPO_PUBLIC_API_URL (legacy fallback)\n   * 3. Platform-specific defaults\n   */\n  function getApiBaseUrl() {\n    // Check environment variables - normalize trailing slashes\n    var RAW = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL ?? _expoVirtualEnv.env.EXPO_PUBLIC_API_URL ?? '';\n\n    // Use explicitly set URLs first (trimmed of trailing slashes)\n    if (RAW) {\n      return RAW.replace(/\\/+$/, '');\n    }\n\n    // Platform-specific defaults when no env var is set\n    if (_reactNative.Platform.OS === 'web') {\n      // Web preview: use relative paths (assumes proxy is configured)\n      // If no proxy, this will fail - but that's expected\n      return '';\n    }\n\n    // Native device: default to localhost:8001 (won't work on real device without tunnel)\n    // In production, EXPO_PUBLIC_BACKEND_URL should always be set\n    return 'http://localhost:8001';\n  }\n\n  /**\n   * The API base URL - use this everywhere instead of hardcoding.\n   * \n   * Usage:\n   *   import { API_BASE } from '@/lib/api/config';\n   *   fetch(`${API_BASE}/api/endpoint`, { ... });\n   */\n  var API_BASE = getApiBaseUrl();\n\n  /**\n   * Construct a full API URL.\n   * \n   * @param path - The API path (e.g., '/api/daily/status')\n   * @returns Full URL with base\n   */\n  function apiUrl(path) {\n    // Ensure path starts with /\n    var normalizedPath = path.startsWith('/') ? path : `/${path}`;\n    return `${API_BASE}${normalizedPath}`;\n  }\n\n  /**\n   * Get auth headers for API requests (without Content-Type).\n   * Use this for FormData uploads where browser sets Content-Type automatically.\n   * \n   * @returns Headers object with Authorization if token exists\n   */\n  function getAuthHeaders() {\n    return _getAuthHeaders.apply(this, arguments);\n  }\n  /**\n   * Get auth + JSON headers for typical API requests.\n   * Single source of truth - all API modules should use this for JSON endpoints.\n   * \n   * @returns Headers object with Authorization (if token) + Content-Type\n   */\n  function _getAuthHeaders() {\n    _getAuthHeaders = (0, _asyncToGenerator.default)(function* () {\n      var token = yield (0, _authStorage.loadAuthToken)();\n      if (token) {\n        return {\n          'Authorization': `Bearer ${token}`\n        };\n      }\n      return {};\n    });\n    return _getAuthHeaders.apply(this, arguments);\n  }\n  function getJsonHeaders() {\n    return _getJsonHeaders.apply(this, arguments);\n  } // Log the API base URL in development for debugging\n  function _getJsonHeaders() {\n    _getJsonHeaders = (0, _asyncToGenerator.default)(function* () {\n      var auth = yield getAuthHeaders();\n      return {\n        ...auth,\n        'Content-Type': 'application/json'\n      };\n    });\n    return _getJsonHeaders.apply(this, arguments);\n  }\n  if (__DEV__) {\n    console.log('[API Config] Base URL:', API_BASE || '(relative paths)');\n    console.log('[API Config] Platform:', _reactNative.Platform.OS);\n\n    // WARN if API_BASE is empty - likely means env var not picked up\n    if (!API_BASE) {\n      console.warn('[API Config] ⚠️ API_BASE is empty! ' + 'Set EXPO_PUBLIC_BACKEND_URL in .env for web preview to work. ' + 'Falling back to relative paths (will 404 if no proxy configured).');\n    }\n  }\n});","lineCount":132,"map":[[12,2,49,0,"Object"],[12,8,49,0],[12,9,49,0,"defineProperty"],[12,23,49,0],[12,24,49,0,"exports"],[12,31,49,0],[13,4,49,0,"enumerable"],[13,14,49,0],[14,4,49,0,"get"],[14,7,49,0],[14,18,49,0,"get"],[14,19,49,0],[15,6,49,0],[15,13,49,0,"API_BASE"],[15,21,49,0],[16,4,49,0],[17,2,49,0],[18,2,57,0,"exports"],[18,9,57,0],[18,10,57,0,"apiUrl"],[18,16,57,0],[18,19,57,0,"apiUrl"],[18,25,57,0],[19,2,69,0,"exports"],[19,9,69,0],[19,10,69,0,"getAuthHeaders"],[19,24,69,0],[19,27,69,0,"getAuthHeaders"],[19,41,69,0],[20,2,83,0,"exports"],[20,9,83,0],[20,10,83,0,"getJsonHeaders"],[20,24,83,0],[20,27,83,0,"getJsonHeaders"],[20,41,83,0],[21,2,89,1],[21,6,89,1,"_babelRuntimeHelpersAsyncToGenerator"],[21,42,89,1],[21,45,89,1,"require"],[21,52,89,1],[21,53,89,1,"_dependencyMap"],[21,67,89,1],[22,2,89,1],[22,6,89,1,"_asyncToGenerator"],[22,23,89,1],[22,26,89,1,"_interopDefault"],[22,41,89,1],[22,42,89,1,"_babelRuntimeHelpersAsyncToGenerator"],[22,78,89,1],[23,2,89,1],[23,6,89,1,"_expoVirtualEnv"],[23,21,89,1],[23,24,89,1,"require"],[23,31,89,1],[23,32,89,1,"_dependencyMap"],[23,46,89,1],[24,2,8,0],[24,6,8,0,"_reactNative"],[24,18,8,0],[24,21,8,0,"require"],[24,28,8,0],[24,29,8,0,"_dependencyMap"],[24,43,8,0],[25,2,9,0],[25,6,9,0,"_authStorage"],[25,18,9,0],[25,21,9,0,"require"],[25,28,9,0],[25,29,9,0,"_dependencyMap"],[25,43,9,0],[26,2,1,0],[27,0,2,0],[28,0,3,0],[29,0,4,0],[30,0,5,0],[31,0,6,0],[33,2,11,0],[34,0,12,0],[35,0,13,0],[36,0,14,0],[37,0,15,0],[38,0,16,0],[39,0,17,0],[40,0,18,0],[41,2,19,0],[41,11,19,9,"getApiBaseUrl"],[41,24,19,22,"getApiBaseUrl"],[41,25,19,22],[41,27,19,33],[42,4,20,2],[43,4,21,2],[43,8,21,8,"RAW"],[43,11,21,11],[43,14,21,14,"_expoVirtualEnv"],[43,29,21,14],[43,30,21,14,"env"],[43,33,21,14],[43,34,21,14,"EXPO_PUBLIC_BACKEND_URL"],[43,57,21,14],[43,61,21,14,"_expoVirtualEnv"],[43,76,21,14],[43,77,21,14,"env"],[43,80,21,14],[43,81,21,14,"EXPO_PUBLIC_API_URL"],[43,100,22,38],[43,104,23,7],[43,106,23,9],[45,4,25,2],[46,4,26,2],[46,8,26,6,"RAW"],[46,11,26,9],[46,13,26,11],[47,6,27,4],[47,13,27,11,"RAW"],[47,16,27,14],[47,17,27,15,"replace"],[47,24,27,22],[47,25,27,23],[47,31,27,29],[47,33,27,31],[47,35,27,33],[47,36,27,34],[48,4,28,2],[50,4,30,2],[51,4,31,2],[51,8,31,6,"Platform"],[51,20,31,14],[51,21,31,14,"Platform"],[51,29,31,14],[51,30,31,15,"OS"],[51,32,31,17],[51,37,31,22],[51,42,31,27],[51,44,31,29],[52,6,32,4],[53,6,33,4],[54,6,34,4],[54,13,34,11],[54,15,34,13],[55,4,35,2],[57,4,37,2],[58,4,38,2],[59,4,39,2],[59,11,39,9],[59,34,39,32],[60,2,40,0],[62,2,42,0],[63,0,43,0],[64,0,44,0],[65,0,45,0],[66,0,46,0],[67,0,47,0],[68,0,48,0],[69,2,49,7],[69,6,49,13,"API_BASE"],[69,14,49,21],[69,17,49,24,"getApiBaseUrl"],[69,30,49,37],[69,31,49,38],[69,32,49,39],[71,2,51,0],[72,0,52,0],[73,0,53,0],[74,0,54,0],[75,0,55,0],[76,0,56,0],[77,2,57,7],[77,11,57,16,"apiUrl"],[77,17,57,22,"apiUrl"],[77,18,57,23,"path"],[77,22,57,35],[77,24,57,45],[78,4,58,2],[79,4,59,2],[79,8,59,8,"normalizedPath"],[79,22,59,22],[79,25,59,25,"path"],[79,29,59,29],[79,30,59,30,"startsWith"],[79,40,59,40],[79,41,59,41],[79,44,59,44],[79,45,59,45],[79,48,59,48,"path"],[79,52,59,52],[79,55,59,55],[79,59,59,59,"path"],[79,63,59,63],[79,65,59,65],[80,4,60,2],[80,11,60,9],[80,14,60,12,"API_BASE"],[80,22,60,20],[80,25,60,23,"normalizedPath"],[80,39,60,37],[80,41,60,39],[81,2,61,0],[83,2,63,0],[84,0,64,0],[85,0,65,0],[86,0,66,0],[87,0,67,0],[88,0,68,0],[89,2,63,0],[89,11,69,22,"getAuthHeaders"],[89,25,69,36,"getAuthHeaders"],[89,26,69,36],[90,4,69,36],[90,11,69,36,"_getAuthHeaders"],[90,26,69,36],[90,27,69,36,"apply"],[90,32,69,36],[90,39,69,36,"arguments"],[90,48,69,36],[91,2,69,36],[92,2,77,0],[93,0,78,0],[94,0,79,0],[95,0,80,0],[96,0,81,0],[97,0,82,0],[98,2,77,0],[98,11,77,0,"_getAuthHeaders"],[98,27,77,0],[99,4,77,0,"_getAuthHeaders"],[99,19,77,0],[99,26,77,0,"_asyncToGenerator"],[99,43,77,0],[99,44,77,0,"default"],[99,51,77,0],[99,53,69,7],[99,66,69,72],[100,6,70,2],[100,10,70,8,"token"],[100,15,70,13],[100,24,70,22],[100,28,70,22,"loadAuthToken"],[100,40,70,35],[100,41,70,35,"loadAuthToken"],[100,54,70,35],[100,56,70,36],[100,57,70,37],[101,6,71,2],[101,10,71,6,"token"],[101,15,71,11],[101,17,71,13],[102,8,72,4],[102,15,72,11],[103,10,72,13],[103,25,72,28],[103,27,72,30],[103,37,72,40,"token"],[103,42,72,45],[104,8,72,48],[104,9,72,49],[105,6,73,2],[106,6,74,2],[106,13,74,9],[106,14,74,10],[106,15,74,11],[107,4,75,0],[107,5,75,1],[108,4,75,1],[108,11,75,1,"_getAuthHeaders"],[108,26,75,1],[108,27,75,1,"apply"],[108,32,75,1],[108,39,75,1,"arguments"],[108,48,75,1],[109,2,75,1],[110,2,75,1],[110,11,83,22,"getJsonHeaders"],[110,25,83,36,"getJsonHeaders"],[110,26,83,36],[111,4,83,36],[111,11,83,36,"_getJsonHeaders"],[111,26,83,36],[111,27,83,36,"apply"],[111,32,83,36],[111,39,83,36,"arguments"],[111,48,83,36],[112,2,83,36],[112,4,91,0],[113,2,91,0],[113,11,91,0,"_getJsonHeaders"],[113,27,91,0],[114,4,91,0,"_getJsonHeaders"],[114,19,91,0],[114,26,91,0,"_asyncToGenerator"],[114,43,91,0],[114,44,91,0,"default"],[114,51,91,0],[114,53,83,7],[114,66,83,72],[115,6,84,2],[115,10,84,8,"auth"],[115,14,84,12],[115,23,84,21,"getAuthHeaders"],[115,37,84,35],[115,38,84,36],[115,39,84,37],[116,6,85,2],[116,13,85,9],[117,8,86,4],[117,11,86,7,"auth"],[117,15,86,11],[118,8,87,4],[118,22,87,18],[118,24,87,20],[119,6,88,2],[119,7,88,3],[120,4,89,0],[120,5,89,1],[121,4,89,1],[121,11,89,1,"_getJsonHeaders"],[121,26,89,1],[121,27,89,1,"apply"],[121,32,89,1],[121,39,89,1,"arguments"],[121,48,89,1],[122,2,89,1],[123,2,92,0],[123,6,92,4,"__DEV__"],[123,13,92,11],[123,15,92,13],[124,4,93,2,"console"],[124,11,93,9],[124,12,93,10,"log"],[124,15,93,13],[124,16,93,14],[124,40,93,38],[124,42,93,40,"API_BASE"],[124,50,93,48],[124,54,93,52],[124,72,93,70],[124,73,93,71],[125,4,94,2,"console"],[125,11,94,9],[125,12,94,10,"log"],[125,15,94,13],[125,16,94,14],[125,40,94,38],[125,42,94,40,"Platform"],[125,54,94,48],[125,55,94,48,"Platform"],[125,63,94,48],[125,64,94,49,"OS"],[125,66,94,51],[125,67,94,52],[127,4,96,2],[128,4,97,2],[128,8,97,6],[128,9,97,7,"API_BASE"],[128,17,97,15],[128,19,97,17],[129,6,98,4,"console"],[129,13,98,11],[129,14,98,12,"warn"],[129,18,98,16],[129,19,99,6],[129,56,99,43],[129,59,100,6],[129,122,100,69],[129,125,101,6],[129,192,102,4],[129,193,102,5],[130,4,103,2],[131,2,104,0],[132,0,104,1],[132,3]],"functionMap":{"names":["<global>","getApiBaseUrl","apiUrl","getAuthHeaders","getJsonHeaders"],"mappings":"AAA;ACkB;CDqB;OEiB;CFI;OGQ;CHM;OIQ;CJM"},"hasCjsExports":false},"type":"js/module"}]}