{"dependencies":[{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"../authStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":201},"end":{"line":9,"column":47,"index":248}}],"key":"8h7N/7sKemAZqrgZg8dH/jTl5ys=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"API_BASE\", {\n    enumerable: true,\n    get: function () {\n      return API_BASE;\n    }\n  });\n  exports.apiUrl = apiUrl;\n  exports.getAuthHeaders = getAuthHeaders;\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[0], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _authStorage = require(_dependencyMap[1], \"../authStorage\");\n  /**\n   * Centralized API Configuration\n   * \n   * Single source of truth for API base URL across all platforms.\n   * Web preview, device, and tunnel all use this.\n   */\n\n  /**\n   * Get the API base URL based on platform and environment.\n   * \n   * Priority:\n   * 1. EXPO_PUBLIC_BACKEND_URL (if set)\n   * 2. EXPO_PUBLIC_API_URL (legacy fallback)\n   * 3. Platform-specific defaults\n   */\n  function getApiBaseUrl() {\n    // Check environment variables - normalize trailing slashes\n    const RAW = process.env.EXPO_PUBLIC_BACKEND_URL ?? process.env.EXPO_PUBLIC_API_URL ?? '';\n\n    // Use explicitly set URLs first (trimmed of trailing slashes)\n    if (RAW) {\n      return RAW.replace(/\\/+$/, '');\n    }\n\n    // Platform-specific defaults when no env var is set\n    if (Platform.default.OS === 'web') {\n      // Web preview: use relative paths (assumes proxy is configured)\n      // If no proxy, this will fail - but that's expected\n      return '';\n    }\n\n    // Native device: default to localhost:8001 (won't work on real device without tunnel)\n    // In production, EXPO_PUBLIC_BACKEND_URL should always be set\n    return 'http://localhost:8001';\n  }\n\n  /**\n   * The API base URL - use this everywhere instead of hardcoding.\n   * \n   * Usage:\n   *   import { API_BASE } from '@/lib/api/config';\n   *   fetch(`${API_BASE}/api/endpoint`, { ... });\n   */\n  const API_BASE = getApiBaseUrl();\n\n  /**\n   * Construct a full API URL.\n   * \n   * @param path - The API path (e.g., '/api/daily/status')\n   * @returns Full URL with base\n   */\n  function apiUrl(path) {\n    // Ensure path starts with /\n    const normalizedPath = path.startsWith('/') ? path : `/${path}`;\n    return `${API_BASE}${normalizedPath}`;\n  }\n\n  /**\n   * Get auth headers for API requests.\n   * Single source of truth - all API modules should use this.\n   * Returns empty object if no token (prevents \"Bearer undefined\").\n   * \n   * @returns Headers object with Authorization if token exists\n   */\n  async function getAuthHeaders() {\n    const token = await (0, _authStorage.loadAuthToken)();\n    if (token) {\n      return {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`\n      };\n    }\n    return {\n      'Content-Type': 'application/json'\n    };\n  }\n\n  // Log the API base URL in development for debugging\n  if (__DEV__) {\n    console.log('[API Config] Base URL:', API_BASE || '(relative paths)');\n    console.log('[API Config] Platform:', Platform.default.OS);\n\n    // WARN if API_BASE is empty - likely means env var not picked up\n    if (!API_BASE) {\n      console.warn('[API Config] ⚠️ API_BASE is empty! ' + 'Set EXPO_PUBLIC_BACKEND_URL in .env for web preview to work. ' + 'Falling back to relative paths (will 404 if no proxy configured).');\n    }\n  }\n});","lineCount":110,"map":[[12,2,49,0,"Object"],[12,8,49,0],[12,9,49,0,"defineProperty"],[12,23,49,0],[12,24,49,0,"exports"],[12,31,49,0],[13,4,49,0,"enumerable"],[13,14,49,0],[14,4,49,0,"get"],[14,7,49,0],[14,18,49,0,"get"],[14,19,49,0],[15,6,49,0],[15,13,49,0,"API_BASE"],[15,21,49,0],[16,4,49,0],[17,2,49,0],[18,2,57,0,"exports"],[18,9,57,0],[18,10,57,0,"apiUrl"],[18,16,57,0],[18,19,57,0,"apiUrl"],[18,25,57,0],[19,2,70,0,"exports"],[19,9,70,0],[19,10,70,0,"getAuthHeaders"],[19,24,70,0],[19,27,70,0,"getAuthHeaders"],[19,41,70,0],[20,2,79,1],[20,6,79,1,"_reactNativeWebDistExportsPlatform"],[20,40,79,1],[20,43,79,1,"require"],[20,50,79,1],[20,51,79,1,"_dependencyMap"],[20,65,79,1],[21,2,79,1],[21,6,79,1,"Platform"],[21,14,79,1],[21,17,79,1,"_interopDefault"],[21,32,79,1],[21,33,79,1,"_reactNativeWebDistExportsPlatform"],[21,67,79,1],[22,2,9,0],[22,6,9,0,"_authStorage"],[22,18,9,0],[22,21,9,0,"require"],[22,28,9,0],[22,29,9,0,"_dependencyMap"],[22,43,9,0],[23,2,1,0],[24,0,2,0],[25,0,3,0],[26,0,4,0],[27,0,5,0],[28,0,6,0],[30,2,11,0],[31,0,12,0],[32,0,13,0],[33,0,14,0],[34,0,15,0],[35,0,16,0],[36,0,17,0],[37,0,18,0],[38,2,19,0],[38,11,19,9,"getApiBaseUrl"],[38,24,19,22,"getApiBaseUrl"],[38,25,19,22],[38,27,19,33],[39,4,20,2],[40,4,21,2],[40,10,21,8,"RAW"],[40,13,21,11],[40,16,21,14,"process"],[40,23,21,21],[40,24,21,22,"env"],[40,27,21,25],[40,28,21,26,"EXPO_PUBLIC_BACKEND_URL"],[40,51,21,49],[40,55,22,7,"process"],[40,62,22,14],[40,63,22,15,"env"],[40,66,22,18],[40,67,22,19,"EXPO_PUBLIC_API_URL"],[40,86,22,38],[40,90,23,7],[40,92,23,9],[42,4,25,2],[43,4,26,2],[43,8,26,6,"RAW"],[43,11,26,9],[43,13,26,11],[44,6,27,4],[44,13,27,11,"RAW"],[44,16,27,14],[44,17,27,15,"replace"],[44,24,27,22],[44,25,27,23],[44,31,27,29],[44,33,27,31],[44,35,27,33],[44,36,27,34],[45,4,28,2],[47,4,30,2],[48,4,31,2],[48,8,31,6,"Platform"],[48,16,31,14],[48,17,31,14,"default"],[48,24,31,14],[48,25,31,15,"OS"],[48,27,31,17],[48,32,31,22],[48,37,31,27],[48,39,31,29],[49,6,32,4],[50,6,33,4],[51,6,34,4],[51,13,34,11],[51,15,34,13],[52,4,35,2],[54,4,37,2],[55,4,38,2],[56,4,39,2],[56,11,39,9],[56,34,39,32],[57,2,40,0],[59,2,42,0],[60,0,43,0],[61,0,44,0],[62,0,45,0],[63,0,46,0],[64,0,47,0],[65,0,48,0],[66,2,49,7],[66,8,49,13,"API_BASE"],[66,16,49,21],[66,19,49,24,"getApiBaseUrl"],[66,32,49,37],[66,33,49,38],[66,34,49,39],[68,2,51,0],[69,0,52,0],[70,0,53,0],[71,0,54,0],[72,0,55,0],[73,0,56,0],[74,2,57,7],[74,11,57,16,"apiUrl"],[74,17,57,22,"apiUrl"],[74,18,57,23,"path"],[74,22,57,35],[74,24,57,45],[75,4,58,2],[76,4,59,2],[76,10,59,8,"normalizedPath"],[76,24,59,22],[76,27,59,25,"path"],[76,31,59,29],[76,32,59,30,"startsWith"],[76,42,59,40],[76,43,59,41],[76,46,59,44],[76,47,59,45],[76,50,59,48,"path"],[76,54,59,52],[76,57,59,55],[76,61,59,59,"path"],[76,65,59,63],[76,67,59,65],[77,4,60,2],[77,11,60,9],[77,14,60,12,"API_BASE"],[77,22,60,20],[77,25,60,23,"normalizedPath"],[77,39,60,37],[77,41,60,39],[78,2,61,0],[80,2,63,0],[81,0,64,0],[82,0,65,0],[83,0,66,0],[84,0,67,0],[85,0,68,0],[86,0,69,0],[87,2,70,7],[87,17,70,22,"getAuthHeaders"],[87,31,70,36,"getAuthHeaders"],[87,32,70,36],[87,34,70,72],[88,4,71,2],[88,10,71,8,"token"],[88,15,71,13],[88,18,71,16],[88,24,71,22],[88,28,71,22,"loadAuthToken"],[88,40,71,35],[88,41,71,35,"loadAuthToken"],[88,54,71,35],[88,56,71,36],[88,57,71,37],[89,4,72,2],[89,8,72,6,"token"],[89,13,72,11],[89,15,72,13],[90,6,73,4],[90,13,73,11],[91,8,74,6],[91,22,74,20],[91,24,74,22],[91,42,74,40],[92,8,75,6],[92,23,75,21],[92,25,75,23],[92,35,75,33,"token"],[92,40,75,38],[93,6,76,4],[93,7,76,5],[94,4,77,2],[95,4,78,2],[95,11,78,9],[96,6,78,11],[96,20,78,25],[96,22,78,27],[97,4,78,46],[97,5,78,47],[98,2,79,0],[100,2,81,0],[101,2,82,0],[101,6,82,4,"__DEV__"],[101,13,82,11],[101,15,82,13],[102,4,83,2,"console"],[102,11,83,9],[102,12,83,10,"log"],[102,15,83,13],[102,16,83,14],[102,40,83,38],[102,42,83,40,"API_BASE"],[102,50,83,48],[102,54,83,52],[102,72,83,70],[102,73,83,71],[103,4,84,2,"console"],[103,11,84,9],[103,12,84,10,"log"],[103,15,84,13],[103,16,84,14],[103,40,84,38],[103,42,84,40,"Platform"],[103,50,84,48],[103,51,84,48,"default"],[103,58,84,48],[103,59,84,49,"OS"],[103,61,84,51],[103,62,84,52],[105,4,86,2],[106,4,87,2],[106,8,87,6],[106,9,87,7,"API_BASE"],[106,17,87,15],[106,19,87,17],[107,6,88,4,"console"],[107,13,88,11],[107,14,88,12,"warn"],[107,18,88,16],[107,19,89,6],[107,56,89,43],[107,59,90,6],[107,122,90,69],[107,125,91,6],[107,192,92,4],[107,193,92,5],[108,4,93,2],[109,2,94,0],[110,0,94,1],[110,3]],"functionMap":{"names":["<global>","getApiBaseUrl","apiUrl","getAuthHeaders"],"mappings":"AAA;ACkB;CDqB;OEiB;CFI;OGS;CHS"},"hasCjsExports":false},"type":"js/module"}]}