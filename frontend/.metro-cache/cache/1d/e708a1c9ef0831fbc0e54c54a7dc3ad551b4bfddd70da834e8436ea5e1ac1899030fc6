{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.isValidReceipt = isValidReceipt;\n  exports.assertValidReceipt = assertValidReceipt;\n  exports.getReceiptItemCount = getReceiptItemCount;\n  exports.formatReceiptItems = formatReceiptItems;\n  // /app/frontend/lib/types/receipt.ts\n  // Phase 3.24: Canonical Reward Receipt Type\n  // Phase 3.26: Added mail_receipt_claim source\n  //\n  // Single source of truth for receipt shape.\n  // All reward-granting endpoints return this shape.\n  // Frontend MUST use this type for all receipt handling.\n  //\n  // LOCKED source values:\n  // - bond_tribute\n  // - mail_reward_claim\n  // - mail_gift_claim\n  // - mail_receipt_claim (Phase 3.26)\n  // - daily_login_claim\n  // - idle_claim\n  // - admin_grant\n\n  /**\n   * Valid reward source types (matches backend RewardSource)\n   */\n\n  // Phase 3.29: Events/Quests\n\n  /**\n   * Single reward item in a receipt\n   */\n\n  /**\n   * User balance snapshot\n   */\n\n  /**\n   * Canonical receipt shape for all reward grants (Phase 3.24)\n   * \n   * REQUIRED fields: source, sourceId, items, balances\n   * All reward endpoints MUST return this shape.\n   */\n\n  /**\n   * Type guard: Check if an object is a valid RewardReceipt\n   */\n  function isValidReceipt(obj) {\n    if (!obj || typeof obj !== 'object') return false;\n    const receipt = obj;\n    return typeof receipt.source === 'string' && typeof receipt.sourceId === 'string' && Array.isArray(receipt.items) && typeof receipt.balances === 'object' && receipt.balances !== null;\n  }\n\n  /**\n   * Validate and assert receipt shape (throws if invalid)\n   */\n  function assertValidReceipt(obj, context) {\n    if (!isValidReceipt(obj)) {\n      const msg = `Invalid receipt shape${context ? ` in ${context}` : ''}: ` + `missing source, sourceId, items, or balances`;\n      console.error('[RECEIPT_GUARD_FAILED]', msg, obj);\n      throw new Error(msg);\n    }\n  }\n\n  /**\n   * Extract total reward count from receipt\n   */\n  function getReceiptItemCount(receipt) {\n    return receipt.items.reduce((sum, item) => sum + item.amount, 0);\n  }\n\n  /**\n   * Format reward items for display\n   */\n  function formatReceiptItems(receipt) {\n    if (receipt.items.length === 0) {\n      return receipt.alreadyClaimed ? 'Already claimed' : 'No rewards';\n    }\n    return receipt.items.filter(item => item.amount > 0).map(item => `${item.amount.toLocaleString()} ${formatRewardType(item.type)}`).join(', ');\n  }\n\n  /**\n   * Format reward type for display\n   */\n  function formatRewardType(type) {\n    const typeMap = {\n      gold: 'Gold',\n      coins: 'Coins',\n      gems: 'Gems',\n      divine_gems: 'Divine Gems',\n      crystals: 'Crystals',\n      stamina: 'Stamina',\n      divine_essence: 'Divine Essence',\n      soul_dust: 'Soul Dust',\n      skill_essence: 'Skill Essence',\n      enhancement_stones: 'Enhancement Stones',\n      hero_shards: 'Hero Shards',\n      rune_essence: 'Rune Essence'\n    };\n    return typeMap[type] || type.replace(/_/g, ' ').replace(/\\b\\w/g, c => c.toUpperCase());\n  }\n});","lineCount":106,"map":[[7,2,78,0,"exports"],[7,9,78,0],[7,10,78,0,"isValidReceipt"],[7,24,78,0],[7,27,78,0,"isValidReceipt"],[7,41,78,0],[8,2,94,0,"exports"],[8,9,94,0],[8,10,94,0,"assertValidReceipt"],[8,28,94,0],[8,31,94,0,"assertValidReceipt"],[8,49,94,0],[9,2,106,0,"exports"],[9,9,106,0],[9,10,106,0,"getReceiptItemCount"],[9,29,106,0],[9,32,106,0,"getReceiptItemCount"],[9,51,106,0],[10,2,113,0,"exports"],[10,9,113,0],[10,10,113,0,"formatReceiptItems"],[10,28,113,0],[10,31,113,0,"formatReceiptItems"],[10,49,113,0],[11,2,1,0],[12,2,2,0],[13,2,3,0],[14,2,4,0],[15,2,5,0],[16,2,6,0],[17,2,7,0],[18,2,8,0],[19,2,9,0],[20,2,10,0],[21,2,11,0],[22,2,12,0],[23,2,13,0],[24,2,14,0],[25,2,15,0],[26,2,16,0],[28,2,18,0],[29,0,19,0],[30,0,20,0],[32,2,29,20],[34,2,31,0],[35,0,32,0],[36,0,33,0],[38,2,41,0],[39,0,42,0],[40,0,43,0],[42,2,60,0],[43,0,61,0],[44,0,62,0],[45,0,63,0],[46,0,64,0],[47,0,65,0],[49,2,75,0],[50,0,76,0],[51,0,77,0],[52,2,78,7],[52,11,78,16,"isValidReceipt"],[52,25,78,30,"isValidReceipt"],[52,26,78,31,"obj"],[52,29,78,43],[52,31,78,67],[53,4,79,2],[53,8,79,6],[53,9,79,7,"obj"],[53,12,79,10],[53,16,79,14],[53,23,79,21,"obj"],[53,26,79,24],[53,31,79,29],[53,39,79,37],[53,41,79,39],[53,48,79,46],[53,53,79,51],[54,4,80,2],[54,10,80,8,"receipt"],[54,17,80,15],[54,20,80,18,"obj"],[54,23,80,48],[55,4,82,2],[55,11,83,4],[55,18,83,11,"receipt"],[55,25,83,18],[55,26,83,19,"source"],[55,32,83,25],[55,37,83,30],[55,45,83,38],[55,49,84,4],[55,56,84,11,"receipt"],[55,63,84,18],[55,64,84,19,"sourceId"],[55,72,84,27],[55,77,84,32],[55,85,84,40],[55,89,85,4,"Array"],[55,94,85,9],[55,95,85,10,"isArray"],[55,102,85,17],[55,103,85,18,"receipt"],[55,110,85,25],[55,111,85,26,"items"],[55,116,85,31],[55,117,85,32],[55,121,86,4],[55,128,86,11,"receipt"],[55,135,86,18],[55,136,86,19,"balances"],[55,144,86,27],[55,149,86,32],[55,157,86,40],[55,161,87,4,"receipt"],[55,168,87,11],[55,169,87,12,"balances"],[55,177,87,20],[55,182,87,25],[55,186,87,29],[56,2,89,0],[58,2,91,0],[59,0,92,0],[60,0,93,0],[61,2,94,7],[61,11,94,16,"assertValidReceipt"],[61,29,94,34,"assertValidReceipt"],[61,30,94,35,"obj"],[61,33,94,47],[61,35,94,49,"context"],[61,42,94,65],[61,44,94,97],[62,4,95,2],[62,8,95,6],[62,9,95,7,"isValidReceipt"],[62,23,95,21],[62,24,95,22,"obj"],[62,27,95,25],[62,28,95,26],[62,30,95,28],[63,6,96,4],[63,12,96,10,"msg"],[63,15,96,13],[63,18,96,16],[63,42,96,40,"context"],[63,49,96,47],[63,52,96,50],[63,59,96,57,"context"],[63,66,96,64],[63,68,96,66],[63,71,96,69],[63,73,96,71],[63,77,96,75],[63,80,97,6],[63,126,97,52],[64,6,98,4,"console"],[64,13,98,11],[64,14,98,12,"error"],[64,19,98,17],[64,20,98,18],[64,44,98,42],[64,46,98,44,"msg"],[64,49,98,47],[64,51,98,49,"obj"],[64,54,98,52],[64,55,98,53],[65,6,99,4],[65,12,99,10],[65,16,99,14,"Error"],[65,21,99,19],[65,22,99,20,"msg"],[65,25,99,23],[65,26,99,24],[66,4,100,2],[67,2,101,0],[69,2,103,0],[70,0,104,0],[71,0,105,0],[72,2,106,7],[72,11,106,16,"getReceiptItemCount"],[72,30,106,35,"getReceiptItemCount"],[72,31,106,36,"receipt"],[72,38,106,58],[72,40,106,68],[73,4,107,2],[73,11,107,9,"receipt"],[73,18,107,16],[73,19,107,17,"items"],[73,24,107,22],[73,25,107,23,"reduce"],[73,31,107,29],[73,32,107,30],[73,33,107,31,"sum"],[73,36,107,34],[73,38,107,36,"item"],[73,42,107,40],[73,47,107,45,"sum"],[73,50,107,48],[73,53,107,51,"item"],[73,57,107,55],[73,58,107,56,"amount"],[73,64,107,62],[73,66,107,64],[73,67,107,65],[73,68,107,66],[74,2,108,0],[76,2,110,0],[77,0,111,0],[78,0,112,0],[79,2,113,7],[79,11,113,16,"formatReceiptItems"],[79,29,113,34,"formatReceiptItems"],[79,30,113,35,"receipt"],[79,37,113,57],[79,39,113,67],[80,4,114,2],[80,8,114,6,"receipt"],[80,15,114,13],[80,16,114,14,"items"],[80,21,114,19],[80,22,114,20,"length"],[80,28,114,26],[80,33,114,31],[80,34,114,32],[80,36,114,34],[81,6,115,4],[81,13,115,11,"receipt"],[81,20,115,18],[81,21,115,19,"alreadyClaimed"],[81,35,115,33],[81,38,115,36],[81,55,115,53],[81,58,115,56],[81,70,115,68],[82,4,116,2],[83,4,118,2],[83,11,118,9,"receipt"],[83,18,118,16],[83,19,118,17,"items"],[83,24,118,22],[83,25,119,5,"filter"],[83,31,119,11],[83,32,119,12,"item"],[83,36,119,16],[83,40,119,20,"item"],[83,44,119,24],[83,45,119,25,"amount"],[83,51,119,31],[83,54,119,34],[83,55,119,35],[83,56,119,36],[83,57,120,5,"map"],[83,60,120,8],[83,61,120,9,"item"],[83,65,120,13],[83,69,120,17],[83,72,120,20,"item"],[83,76,120,24],[83,77,120,25,"amount"],[83,83,120,31],[83,84,120,32,"toLocaleString"],[83,98,120,46],[83,99,120,47],[83,100,120,48],[83,104,120,52,"formatRewardType"],[83,120,120,68],[83,121,120,69,"item"],[83,125,120,73],[83,126,120,74,"type"],[83,130,120,78],[83,131,120,79],[83,133,120,81],[83,134,120,82],[83,135,121,5,"join"],[83,139,121,9],[83,140,121,10],[83,144,121,14],[83,145,121,15],[84,2,122,0],[86,2,124,0],[87,0,125,0],[88,0,126,0],[89,2,127,0],[89,11,127,9,"formatRewardType"],[89,27,127,25,"formatRewardType"],[89,28,127,26,"type"],[89,32,127,38],[89,34,127,48],[90,4,128,2],[90,10,128,8,"typeMap"],[90,17,128,39],[90,20,128,42],[91,6,129,4,"gold"],[91,10,129,8],[91,12,129,10],[91,18,129,16],[92,6,130,4,"coins"],[92,11,130,9],[92,13,130,11],[92,20,130,18],[93,6,131,4,"gems"],[93,10,131,8],[93,12,131,10],[93,18,131,16],[94,6,132,4,"divine_gems"],[94,17,132,15],[94,19,132,17],[94,32,132,30],[95,6,133,4,"crystals"],[95,14,133,12],[95,16,133,14],[95,26,133,24],[96,6,134,4,"stamina"],[96,13,134,11],[96,15,134,13],[96,24,134,22],[97,6,135,4,"divine_essence"],[97,20,135,18],[97,22,135,20],[97,38,135,36],[98,6,136,4,"soul_dust"],[98,15,136,13],[98,17,136,15],[98,28,136,26],[99,6,137,4,"skill_essence"],[99,19,137,17],[99,21,137,19],[99,36,137,34],[100,6,138,4,"enhancement_stones"],[100,24,138,22],[100,26,138,24],[100,46,138,44],[101,6,139,4,"hero_shards"],[101,17,139,15],[101,19,139,17],[101,32,139,30],[102,6,140,4,"rune_essence"],[102,18,140,16],[102,20,140,18],[103,4,141,2],[103,5,141,3],[104,4,143,2],[104,11,143,9,"typeMap"],[104,18,143,16],[104,19,143,17,"type"],[104,23,143,21],[104,24,143,22],[104,28,143,26,"type"],[104,32,143,30],[104,33,143,31,"replace"],[104,40,143,38],[104,41,143,39],[104,45,143,43],[104,47,143,45],[104,50,143,48],[104,51,143,49],[104,52,143,50,"replace"],[104,59,143,57],[104,60,143,58],[104,67,143,65],[104,69,143,67,"c"],[104,70,143,68],[104,74,143,72,"c"],[104,75,143,73],[104,76,143,74,"toUpperCase"],[104,87,143,85],[104,88,143,86],[104,89,143,87],[104,90,143,88],[105,2,144,0],[106,0,144,1],[106,3]],"functionMap":{"names":["<global>","isValidReceipt","assertValidReceipt","getReceiptItemCount","items.reduce$argument_0","formatReceiptItems","items.filter$argument_0","items.filter.map$argument_0","formatRewardType","type.replace.replace$argument_1"],"mappings":"AAA;OC6E;CDW;OEK;CFO;OGK;8BCC,gCD;CHC;OKK;YCM,uBD;SEC,wEF;CLE;AQK;mECgB,oBD;CRC"},"hasCjsExports":false},"type":"js/module"}]}