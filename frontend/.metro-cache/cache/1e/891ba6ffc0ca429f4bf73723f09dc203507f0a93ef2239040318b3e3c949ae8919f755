{"dependencies":[{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":213,"index":213}}],"key":"m+kcirlwHAgMIuUoyR2vCxbhWD4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"DEFAULT_TRANSPORT_BUFFER_SIZE\", {\n    enumerable: true,\n    get: function () {\n      return DEFAULT_TRANSPORT_BUFFER_SIZE;\n    }\n  });\n  Object.defineProperty(exports, \"createTransport\", {\n    enumerable: true,\n    get: function () {\n      return createTransport;\n    }\n  });\n  var _sentryUtils = require(_dependencyMap[0], \"@sentry/utils\");\n  const DEFAULT_TRANSPORT_BUFFER_SIZE = 30;\n\n  /**\n   * Creates an instance of a Sentry `Transport`\n   *\n   * @param options\n   * @param makeRequest\n   */\n  function createTransport(options, makeRequest, buffer = (0, _sentryUtils.makePromiseBuffer)(options.bufferSize || DEFAULT_TRANSPORT_BUFFER_SIZE)) {\n    let rateLimits = {};\n    const flush = timeout => buffer.drain(timeout);\n    function send(envelope) {\n      const filteredEnvelopeItems = [];\n\n      // Drop rate limited items from envelope\n      (0, _sentryUtils.forEachEnvelopeItem)(envelope, (item, type) => {\n        const envelopeItemDataCategory = (0, _sentryUtils.envelopeItemTypeToDataCategory)(type);\n        if ((0, _sentryUtils.isRateLimited)(rateLimits, envelopeItemDataCategory)) {\n          const event = getEventForEnvelopeItem(item, type);\n          options.recordDroppedEvent('ratelimit_backoff', envelopeItemDataCategory, event);\n        } else {\n          filteredEnvelopeItems.push(item);\n        }\n      });\n\n      // Skip sending if envelope is empty after filtering out rate limited events\n      if (filteredEnvelopeItems.length === 0) {\n        return (0, _sentryUtils.resolvedSyncPromise)();\n      }\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const filteredEnvelope = (0, _sentryUtils.createEnvelope)(envelope[0], filteredEnvelopeItems);\n\n      // Creates client report for each item in an envelope\n      const recordEnvelopeLoss = reason => {\n        (0, _sentryUtils.forEachEnvelopeItem)(filteredEnvelope, (item, type) => {\n          const event = getEventForEnvelopeItem(item, type);\n          options.recordDroppedEvent(reason, (0, _sentryUtils.envelopeItemTypeToDataCategory)(type), event);\n        });\n      };\n      const requestTask = () => makeRequest({\n        body: (0, _sentryUtils.serializeEnvelope)(filteredEnvelope, options.textEncoder)\n      }).then(response => {\n        // We don't want to throw on NOK responses, but we want to at least log them\n        if (response.statusCode !== undefined && (response.statusCode < 200 || response.statusCode >= 300)) {\n          (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && _sentryUtils.logger.warn(`Sentry responded with status code ${response.statusCode} to sent event.`);\n        }\n        rateLimits = (0, _sentryUtils.updateRateLimits)(rateLimits, response);\n        return response;\n      }, error => {\n        recordEnvelopeLoss('network_error');\n        throw error;\n      });\n      return buffer.add(requestTask).then(result => result, error => {\n        if (error instanceof _sentryUtils.SentryError) {\n          (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && _sentryUtils.logger.error('Skipped sending event because buffer is full.');\n          recordEnvelopeLoss('queue_overflow');\n          return (0, _sentryUtils.resolvedSyncPromise)();\n        } else {\n          throw error;\n        }\n      });\n    }\n\n    // We use this to identifify if the transport is the base transport\n    // TODO (v8): Remove this again as we'll no longer need it\n    send.__sentry__baseTransport__ = true;\n    return {\n      send,\n      flush\n    };\n  }\n  function getEventForEnvelopeItem(item, type) {\n    if (type !== 'event' && type !== 'transaction') {\n      return undefined;\n    }\n    return Array.isArray(item) ? item[1] : undefined;\n  }\n});","lineCount":98,"map":[[7,2,100,0,"Object"],[7,8,100,0],[7,9,100,0,"defineProperty"],[7,23,100,0],[7,24,100,0,"exports"],[7,31,100,0],[8,4,100,0,"enumerable"],[8,14,100,0],[9,4,100,0,"get"],[9,7,100,0],[9,18,100,0,"get"],[9,19,100,0],[10,6,100,0],[10,13,100,9,"DEFAULT_TRANSPORT_BUFFER_SIZE"],[10,42,100,38],[11,4,100,38],[12,2,100,38],[13,2,100,0,"Object"],[13,8,100,0],[13,9,100,0,"defineProperty"],[13,23,100,0],[13,24,100,0,"exports"],[13,31,100,0],[14,4,100,0,"enumerable"],[14,14,100,0],[15,4,100,0,"get"],[15,7,100,0],[15,18,100,0,"get"],[15,19,100,0],[16,6,100,0],[16,13,100,40,"createTransport"],[16,28,100,55],[17,4,100,55],[18,2,100,55],[19,2,1,0],[19,6,1,0,"_sentryUtils"],[19,18,1,0],[19,21,1,0,"require"],[19,28,1,0],[19,29,1,0,"_dependencyMap"],[19,43,1,0],[20,2,3,0],[20,8,3,6,"DEFAULT_TRANSPORT_BUFFER_SIZE"],[20,37,3,35],[20,40,3,38],[20,42,3,40],[22,2,5,0],[23,0,6,0],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,2,11,0],[28,11,11,9,"createTransport"],[28,26,11,24,"createTransport"],[28,27,12,2,"options"],[28,34,12,9],[28,36,13,2,"makeRequest"],[28,47,13,13],[28,49,14,2,"buffer"],[28,55,14,8],[28,58,14,11],[28,62,14,11,"makePromiseBuffer"],[28,74,14,28],[28,75,14,28,"makePromiseBuffer"],[28,92,14,28],[28,94,15,4,"options"],[28,101,15,11],[28,102,15,12,"bufferSize"],[28,112,15,22],[28,116,15,26,"DEFAULT_TRANSPORT_BUFFER_SIZE"],[28,145,16,2],[28,146,16,3],[28,148,17,2],[29,4,18,2],[29,8,18,6,"rateLimits"],[29,18,18,16],[29,21,18,19],[29,22,18,20],[29,23,18,21],[30,4,19,2],[30,10,19,8,"flush"],[30,15,19,13],[30,18,19,17,"timeout"],[30,25,19,24],[30,29,19,29,"buffer"],[30,35,19,35],[30,36,19,36,"drain"],[30,41,19,41],[30,42,19,42,"timeout"],[30,49,19,49],[30,50,19,50],[31,4,21,2],[31,13,21,11,"send"],[31,17,21,15,"send"],[31,18,21,16,"envelope"],[31,26,21,24],[31,28,21,26],[32,6,22,4],[32,12,22,10,"filteredEnvelopeItems"],[32,33,22,31],[32,36,22,34],[32,38,22,36],[34,6,24,4],[35,6,25,4],[35,10,25,4,"forEachEnvelopeItem"],[35,22,25,23],[35,23,25,23,"forEachEnvelopeItem"],[35,42,25,23],[35,44,25,24,"envelope"],[35,52,25,32],[35,54,25,34],[35,55,25,35,"item"],[35,59,25,39],[35,61,25,41,"type"],[35,65,25,45],[35,70,25,50],[36,8,26,6],[36,14,26,12,"envelopeItemDataCategory"],[36,38,26,36],[36,41,26,39],[36,45,26,39,"envelopeItemTypeToDataCategory"],[36,57,26,69],[36,58,26,69,"envelopeItemTypeToDataCategory"],[36,88,26,69],[36,90,26,70,"type"],[36,94,26,74],[36,95,26,75],[37,8,27,6],[37,12,27,10],[37,16,27,10,"isRateLimited"],[37,28,27,23],[37,29,27,23,"isRateLimited"],[37,42,27,23],[37,44,27,24,"rateLimits"],[37,54,27,34],[37,56,27,36,"envelopeItemDataCategory"],[37,80,27,60],[37,81,27,61],[37,83,27,63],[38,10,28,8],[38,16,28,14,"event"],[38,21,28,19],[38,24,28,22,"getEventForEnvelopeItem"],[38,47,28,45],[38,48,28,46,"item"],[38,52,28,50],[38,54,28,52,"type"],[38,58,28,56],[38,59,28,57],[39,10,29,8,"options"],[39,17,29,15],[39,18,29,16,"recordDroppedEvent"],[39,36,29,34],[39,37,29,35],[39,56,29,54],[39,58,29,56,"envelopeItemDataCategory"],[39,82,29,80],[39,84,29,82,"event"],[39,89,29,87],[39,90,29,88],[40,8,30,6],[40,9,30,7],[40,15,30,13],[41,10,31,8,"filteredEnvelopeItems"],[41,31,31,29],[41,32,31,30,"push"],[41,36,31,34],[41,37,31,35,"item"],[41,41,31,39],[41,42,31,40],[42,8,32,6],[43,6,33,4],[43,7,33,5],[43,8,33,6],[45,6,35,4],[46,6,36,4],[46,10,36,8,"filteredEnvelopeItems"],[46,31,36,29],[46,32,36,30,"length"],[46,38,36,36],[46,43,36,41],[46,44,36,42],[46,46,36,44],[47,8,37,6],[47,15,37,13],[47,19,37,13,"resolvedSyncPromise"],[47,31,37,32],[47,32,37,32,"resolvedSyncPromise"],[47,51,37,32],[47,53,37,33],[47,54,37,34],[48,6,38,4],[50,6,40,4],[51,6,41,4],[51,12,41,10,"filteredEnvelope"],[51,28,41,26],[51,31,41,29],[51,35,41,29,"createEnvelope"],[51,47,41,43],[51,48,41,43,"createEnvelope"],[51,62,41,43],[51,64,41,44,"envelope"],[51,72,41,52],[51,73,41,53],[51,74,41,54],[51,75,41,55],[51,77,41,57,"filteredEnvelopeItems"],[51,98,41,79],[51,99,41,80],[53,6,43,4],[54,6,44,4],[54,12,44,10,"recordEnvelopeLoss"],[54,30,44,28],[54,33,44,32,"reason"],[54,39,44,38],[54,43,44,43],[55,8,45,6],[55,12,45,6,"forEachEnvelopeItem"],[55,24,45,25],[55,25,45,25,"forEachEnvelopeItem"],[55,44,45,25],[55,46,45,26,"filteredEnvelope"],[55,62,45,42],[55,64,45,44],[55,65,45,45,"item"],[55,69,45,49],[55,71,45,51,"type"],[55,75,45,55],[55,80,45,60],[56,10,46,8],[56,16,46,14,"event"],[56,21,46,19],[56,24,46,22,"getEventForEnvelopeItem"],[56,47,46,45],[56,48,46,46,"item"],[56,52,46,50],[56,54,46,52,"type"],[56,58,46,56],[56,59,46,57],[57,10,47,8,"options"],[57,17,47,15],[57,18,47,16,"recordDroppedEvent"],[57,36,47,34],[57,37,47,35,"reason"],[57,43,47,41],[57,45,47,43],[57,49,47,43,"envelopeItemTypeToDataCategory"],[57,61,47,73],[57,62,47,73,"envelopeItemTypeToDataCategory"],[57,92,47,73],[57,94,47,74,"type"],[57,98,47,78],[57,99,47,79],[57,101,47,81,"event"],[57,106,47,86],[57,107,47,87],[58,8,48,6],[58,9,48,7],[58,10,48,8],[59,6,49,4],[59,7,49,5],[60,6,51,4],[60,12,51,10,"requestTask"],[60,23,51,21],[60,26,51,24,"requestTask"],[60,27,51,24],[60,32,52,6,"makeRequest"],[60,43,52,17],[60,44,52,18],[61,8,52,20,"body"],[61,12,52,24],[61,14,52,26],[61,18,52,26,"serializeEnvelope"],[61,30,52,43],[61,31,52,43,"serializeEnvelope"],[61,48,52,43],[61,50,52,44,"filteredEnvelope"],[61,66,52,60],[61,68,52,62,"options"],[61,75,52,69],[61,76,52,70,"textEncoder"],[61,87,52,81],[62,6,52,83],[62,7,52,84],[62,8,52,85],[62,9,52,86,"then"],[62,13,52,90],[62,14,53,8,"response"],[62,22,53,16],[62,26,53,20],[63,8,54,10],[64,8,55,10],[64,12,55,14,"response"],[64,20,55,22],[64,21,55,23,"statusCode"],[64,31,55,33],[64,36,55,38,"undefined"],[64,45,55,47],[64,50,55,52,"response"],[64,58,55,60],[64,59,55,61,"statusCode"],[64,69,55,71],[64,72,55,74],[64,75,55,77],[64,79,55,81,"response"],[64,87,55,89],[64,88,55,90,"statusCode"],[64,98,55,100],[64,102,55,104],[64,105,55,107],[64,106,55,108],[64,108,55,110],[65,10,56,12],[65,11,56,13],[65,18,56,20,"__SENTRY_DEBUG__"],[65,34,56,36],[65,39,56,41],[65,50,56,52],[65,54,56,56,"__SENTRY_DEBUG__"],[65,70,56,72],[65,75,56,77,"logger"],[65,87,56,83],[65,88,56,83,"logger"],[65,94,56,83],[65,95,56,84,"warn"],[65,99,56,88],[65,100,56,89],[65,137,56,126,"response"],[65,145,56,134],[65,146,56,135,"statusCode"],[65,156,56,145],[65,173,56,162],[65,174,56,163],[66,8,57,10],[67,8,59,10,"rateLimits"],[67,18,59,20],[67,21,59,23],[67,25,59,23,"updateRateLimits"],[67,37,59,39],[67,38,59,39,"updateRateLimits"],[67,54,59,39],[67,56,59,40,"rateLimits"],[67,66,59,50],[67,68,59,52,"response"],[67,76,59,60],[67,77,59,61],[68,8,60,10],[68,15,60,17,"response"],[68,23,60,25],[69,6,61,8],[69,7,61,9],[69,9,62,8,"error"],[69,14,62,13],[69,18,62,17],[70,8,63,10,"recordEnvelopeLoss"],[70,26,63,28],[70,27,63,29],[70,42,63,44],[70,43,63,45],[71,8,64,10],[71,14,64,16,"error"],[71,19,64,21],[72,6,65,8],[72,7,66,6],[72,8,66,7],[73,6,68,4],[73,13,68,11,"buffer"],[73,19,68,17],[73,20,68,18,"add"],[73,23,68,21],[73,24,68,22,"requestTask"],[73,35,68,33],[73,36,68,34],[73,37,68,35,"then"],[73,41,68,39],[73,42,69,6,"result"],[73,48,69,12],[73,52,69,16,"result"],[73,58,69,22],[73,60,70,6,"error"],[73,65,70,11],[73,69,70,15],[74,8,71,8],[74,12,71,12,"error"],[74,17,71,17],[74,29,71,29,"SentryError"],[74,41,71,40],[74,42,71,40,"SentryError"],[74,53,71,40],[74,55,71,42],[75,10,72,10],[75,11,72,11],[75,18,72,18,"__SENTRY_DEBUG__"],[75,34,72,34],[75,39,72,39],[75,50,72,50],[75,54,72,54,"__SENTRY_DEBUG__"],[75,70,72,70],[75,75,72,75,"logger"],[75,87,72,81],[75,88,72,81,"logger"],[75,94,72,81],[75,95,72,82,"error"],[75,100,72,87],[75,101,72,88],[75,148,72,135],[75,149,72,136],[76,10,73,10,"recordEnvelopeLoss"],[76,28,73,28],[76,29,73,29],[76,45,73,45],[76,46,73,46],[77,10,74,10],[77,17,74,17],[77,21,74,17,"resolvedSyncPromise"],[77,33,74,36],[77,34,74,36,"resolvedSyncPromise"],[77,53,74,36],[77,55,74,37],[77,56,74,38],[78,8,75,8],[78,9,75,9],[78,15,75,15],[79,10,76,10],[79,16,76,16,"error"],[79,21,76,21],[80,8,77,8],[81,6,78,6],[81,7,79,4],[81,8,79,5],[82,4,80,2],[84,4,82,2],[85,4,83,2],[86,4,84,2,"send"],[86,8,84,6],[86,9,84,7,"__sentry__baseTransport__"],[86,34,84,32],[86,37,84,35],[86,41,84,39],[87,4,86,2],[87,11,86,9],[88,6,87,4,"send"],[88,10,87,8],[89,6,88,4,"flush"],[90,4,89,2],[90,5,89,3],[91,2,90,0],[92,2,92,0],[92,11,92,9,"getEventForEnvelopeItem"],[92,34,92,32,"getEventForEnvelopeItem"],[92,35,92,33,"item"],[92,39,92,37],[92,41,92,39,"type"],[92,45,92,43],[92,47,92,45],[93,4,93,2],[93,8,93,6,"type"],[93,12,93,10],[93,17,93,15],[93,24,93,22],[93,28,93,26,"type"],[93,32,93,30],[93,37,93,35],[93,50,93,48],[93,52,93,50],[94,6,94,4],[94,13,94,11,"undefined"],[94,22,94,20],[95,4,95,2],[96,4,97,2],[96,11,97,9,"Array"],[96,16,97,14],[96,17,97,15,"isArray"],[96,24,97,22],[96,25,97,23,"item"],[96,29,97,27],[96,30,97,28],[96,33,97,32,"item"],[96,37,97,36],[96,38,97,39],[96,39,97,40],[96,40,97,41],[96,43,97,44,"undefined"],[96,52,97,53],[97,2,98,0],[98,0,98,1],[98,3]],"functionMap":{"names":["<global>","createTransport","flush","send","forEachEnvelopeItem$argument_1","recordEnvelopeLoss","requestTask","makeRequest.then$argument_0","makeRequest.then$argument_1","buffer.add.then$argument_0","buffer.add.then$argument_1","getEventForEnvelopeItem"],"mappings":"AAA;ACU;gBCQ,kCD;EEE;kCCI;KDQ;+BEW;4CDC;OCG;KFC;wBGE;QCE;SDQ;QEC;SFG;OHC;MMG,gBN;MOC;OPQ;GFE;CDU;AWE;CXM"},"hasCjsExports":false},"type":"js/module"}]}