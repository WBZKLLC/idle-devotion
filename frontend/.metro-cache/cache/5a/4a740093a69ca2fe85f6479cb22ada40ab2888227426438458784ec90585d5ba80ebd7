{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.isValidReceipt = isValidReceipt;\n  exports.assertValidReceipt = assertValidReceipt;\n  exports.getReceiptItemCount = getReceiptItemCount;\n  exports.formatReceiptItems = formatReceiptItems;\n  // /app/frontend/lib/types/receipt.ts\n  // Phase 3.24: Canonical Reward Receipt Type\n  //\n  // Single source of truth for receipt shape.\n  // All reward-granting endpoints return this shape.\n  // Frontend MUST use this type for all receipt handling.\n  //\n  // LOCKED source values:\n  // - bond_tribute\n  // - mail_reward_claim\n  // - mail_gift_claim\n  // - daily_login_claim\n  // - idle_claim\n  // - admin_grant\n\n  /**\n   * Valid reward source types (matches backend RewardSource)\n   */\n\n  /**\n   * Single reward item in a receipt\n   */\n\n  /**\n   * User balance snapshot\n   */\n\n  /**\n   * Canonical receipt shape for all reward grants (Phase 3.24)\n   * \n   * REQUIRED fields: source, sourceId, items, balances\n   * All reward endpoints MUST return this shape.\n   */\n\n  /**\n   * Type guard: Check if an object is a valid RewardReceipt\n   */\n  function isValidReceipt(obj) {\n    if (!obj || typeof obj !== 'object') return false;\n    const receipt = obj;\n    return typeof receipt.source === 'string' && typeof receipt.sourceId === 'string' && Array.isArray(receipt.items) && typeof receipt.balances === 'object' && receipt.balances !== null;\n  }\n\n  /**\n   * Validate and assert receipt shape (throws if invalid)\n   */\n  function assertValidReceipt(obj, context) {\n    if (!isValidReceipt(obj)) {\n      const msg = `Invalid receipt shape${context ? ` in ${context}` : ''}: ` + `missing source, sourceId, items, or balances`;\n      console.error('[RECEIPT_GUARD_FAILED]', msg, obj);\n      throw new Error(msg);\n    }\n  }\n\n  /**\n   * Extract total reward count from receipt\n   */\n  function getReceiptItemCount(receipt) {\n    return receipt.items.reduce((sum, item) => sum + item.amount, 0);\n  }\n\n  /**\n   * Format reward items for display\n   */\n  function formatReceiptItems(receipt) {\n    if (receipt.items.length === 0) {\n      return receipt.alreadyClaimed ? 'Already claimed' : 'No rewards';\n    }\n    return receipt.items.filter(item => item.amount > 0).map(item => `${item.amount.toLocaleString()} ${formatRewardType(item.type)}`).join(', ');\n  }\n\n  /**\n   * Format reward type for display\n   */\n  function formatRewardType(type) {\n    const typeMap = {\n      gold: 'Gold',\n      coins: 'Coins',\n      gems: 'Gems',\n      divine_gems: 'Divine Gems',\n      crystals: 'Crystals',\n      stamina: 'Stamina',\n      divine_essence: 'Divine Essence',\n      soul_dust: 'Soul Dust',\n      skill_essence: 'Skill Essence',\n      enhancement_stones: 'Enhancement Stones',\n      hero_shards: 'Hero Shards',\n      rune_essence: 'Rune Essence'\n    };\n    return typeMap[type] || type.replace(/_/g, ' ').replace(/\\b\\w/g, c => c.toUpperCase());\n  }\n});","lineCount":102,"map":[[7,2,74,0,"exports"],[7,9,74,0],[7,10,74,0,"isValidReceipt"],[7,24,74,0],[7,27,74,0,"isValidReceipt"],[7,41,74,0],[8,2,90,0,"exports"],[8,9,90,0],[8,10,90,0,"assertValidReceipt"],[8,28,90,0],[8,31,90,0,"assertValidReceipt"],[8,49,90,0],[9,2,102,0,"exports"],[9,9,102,0],[9,10,102,0,"getReceiptItemCount"],[9,29,102,0],[9,32,102,0,"getReceiptItemCount"],[9,51,102,0],[10,2,109,0,"exports"],[10,9,109,0],[10,10,109,0,"formatReceiptItems"],[10,28,109,0],[10,31,109,0,"formatReceiptItems"],[10,49,109,0],[11,2,1,0],[12,2,2,0],[13,2,3,0],[14,2,4,0],[15,2,5,0],[16,2,6,0],[17,2,7,0],[18,2,8,0],[19,2,9,0],[20,2,10,0],[21,2,11,0],[22,2,12,0],[23,2,13,0],[24,2,14,0],[26,2,16,0],[27,0,17,0],[28,0,18,0],[30,2,27,0],[31,0,28,0],[32,0,29,0],[34,2,37,0],[35,0,38,0],[36,0,39,0],[38,2,56,0],[39,0,57,0],[40,0,58,0],[41,0,59,0],[42,0,60,0],[43,0,61,0],[45,2,71,0],[46,0,72,0],[47,0,73,0],[48,2,74,7],[48,11,74,16,"isValidReceipt"],[48,25,74,30,"isValidReceipt"],[48,26,74,31,"obj"],[48,29,74,43],[48,31,74,67],[49,4,75,2],[49,8,75,6],[49,9,75,7,"obj"],[49,12,75,10],[49,16,75,14],[49,23,75,21,"obj"],[49,26,75,24],[49,31,75,29],[49,39,75,37],[49,41,75,39],[49,48,75,46],[49,53,75,51],[50,4,76,2],[50,10,76,8,"receipt"],[50,17,76,15],[50,20,76,18,"obj"],[50,23,76,48],[51,4,78,2],[51,11,79,4],[51,18,79,11,"receipt"],[51,25,79,18],[51,26,79,19,"source"],[51,32,79,25],[51,37,79,30],[51,45,79,38],[51,49,80,4],[51,56,80,11,"receipt"],[51,63,80,18],[51,64,80,19,"sourceId"],[51,72,80,27],[51,77,80,32],[51,85,80,40],[51,89,81,4,"Array"],[51,94,81,9],[51,95,81,10,"isArray"],[51,102,81,17],[51,103,81,18,"receipt"],[51,110,81,25],[51,111,81,26,"items"],[51,116,81,31],[51,117,81,32],[51,121,82,4],[51,128,82,11,"receipt"],[51,135,82,18],[51,136,82,19,"balances"],[51,144,82,27],[51,149,82,32],[51,157,82,40],[51,161,83,4,"receipt"],[51,168,83,11],[51,169,83,12,"balances"],[51,177,83,20],[51,182,83,25],[51,186,83,29],[52,2,85,0],[54,2,87,0],[55,0,88,0],[56,0,89,0],[57,2,90,7],[57,11,90,16,"assertValidReceipt"],[57,29,90,34,"assertValidReceipt"],[57,30,90,35,"obj"],[57,33,90,47],[57,35,90,49,"context"],[57,42,90,65],[57,44,90,97],[58,4,91,2],[58,8,91,6],[58,9,91,7,"isValidReceipt"],[58,23,91,21],[58,24,91,22,"obj"],[58,27,91,25],[58,28,91,26],[58,30,91,28],[59,6,92,4],[59,12,92,10,"msg"],[59,15,92,13],[59,18,92,16],[59,42,92,40,"context"],[59,49,92,47],[59,52,92,50],[59,59,92,57,"context"],[59,66,92,64],[59,68,92,66],[59,71,92,69],[59,73,92,71],[59,77,92,75],[59,80,93,6],[59,126,93,52],[60,6,94,4,"console"],[60,13,94,11],[60,14,94,12,"error"],[60,19,94,17],[60,20,94,18],[60,44,94,42],[60,46,94,44,"msg"],[60,49,94,47],[60,51,94,49,"obj"],[60,54,94,52],[60,55,94,53],[61,6,95,4],[61,12,95,10],[61,16,95,14,"Error"],[61,21,95,19],[61,22,95,20,"msg"],[61,25,95,23],[61,26,95,24],[62,4,96,2],[63,2,97,0],[65,2,99,0],[66,0,100,0],[67,0,101,0],[68,2,102,7],[68,11,102,16,"getReceiptItemCount"],[68,30,102,35,"getReceiptItemCount"],[68,31,102,36,"receipt"],[68,38,102,58],[68,40,102,68],[69,4,103,2],[69,11,103,9,"receipt"],[69,18,103,16],[69,19,103,17,"items"],[69,24,103,22],[69,25,103,23,"reduce"],[69,31,103,29],[69,32,103,30],[69,33,103,31,"sum"],[69,36,103,34],[69,38,103,36,"item"],[69,42,103,40],[69,47,103,45,"sum"],[69,50,103,48],[69,53,103,51,"item"],[69,57,103,55],[69,58,103,56,"amount"],[69,64,103,62],[69,66,103,64],[69,67,103,65],[69,68,103,66],[70,2,104,0],[72,2,106,0],[73,0,107,0],[74,0,108,0],[75,2,109,7],[75,11,109,16,"formatReceiptItems"],[75,29,109,34,"formatReceiptItems"],[75,30,109,35,"receipt"],[75,37,109,57],[75,39,109,67],[76,4,110,2],[76,8,110,6,"receipt"],[76,15,110,13],[76,16,110,14,"items"],[76,21,110,19],[76,22,110,20,"length"],[76,28,110,26],[76,33,110,31],[76,34,110,32],[76,36,110,34],[77,6,111,4],[77,13,111,11,"receipt"],[77,20,111,18],[77,21,111,19,"alreadyClaimed"],[77,35,111,33],[77,38,111,36],[77,55,111,53],[77,58,111,56],[77,70,111,68],[78,4,112,2],[79,4,114,2],[79,11,114,9,"receipt"],[79,18,114,16],[79,19,114,17,"items"],[79,24,114,22],[79,25,115,5,"filter"],[79,31,115,11],[79,32,115,12,"item"],[79,36,115,16],[79,40,115,20,"item"],[79,44,115,24],[79,45,115,25,"amount"],[79,51,115,31],[79,54,115,34],[79,55,115,35],[79,56,115,36],[79,57,116,5,"map"],[79,60,116,8],[79,61,116,9,"item"],[79,65,116,13],[79,69,116,17],[79,72,116,20,"item"],[79,76,116,24],[79,77,116,25,"amount"],[79,83,116,31],[79,84,116,32,"toLocaleString"],[79,98,116,46],[79,99,116,47],[79,100,116,48],[79,104,116,52,"formatRewardType"],[79,120,116,68],[79,121,116,69,"item"],[79,125,116,73],[79,126,116,74,"type"],[79,130,116,78],[79,131,116,79],[79,133,116,81],[79,134,116,82],[79,135,117,5,"join"],[79,139,117,9],[79,140,117,10],[79,144,117,14],[79,145,117,15],[80,2,118,0],[82,2,120,0],[83,0,121,0],[84,0,122,0],[85,2,123,0],[85,11,123,9,"formatRewardType"],[85,27,123,25,"formatRewardType"],[85,28,123,26,"type"],[85,32,123,38],[85,34,123,48],[86,4,124,2],[86,10,124,8,"typeMap"],[86,17,124,39],[86,20,124,42],[87,6,125,4,"gold"],[87,10,125,8],[87,12,125,10],[87,18,125,16],[88,6,126,4,"coins"],[88,11,126,9],[88,13,126,11],[88,20,126,18],[89,6,127,4,"gems"],[89,10,127,8],[89,12,127,10],[89,18,127,16],[90,6,128,4,"divine_gems"],[90,17,128,15],[90,19,128,17],[90,32,128,30],[91,6,129,4,"crystals"],[91,14,129,12],[91,16,129,14],[91,26,129,24],[92,6,130,4,"stamina"],[92,13,130,11],[92,15,130,13],[92,24,130,22],[93,6,131,4,"divine_essence"],[93,20,131,18],[93,22,131,20],[93,38,131,36],[94,6,132,4,"soul_dust"],[94,15,132,13],[94,17,132,15],[94,28,132,26],[95,6,133,4,"skill_essence"],[95,19,133,17],[95,21,133,19],[95,36,133,34],[96,6,134,4,"enhancement_stones"],[96,24,134,22],[96,26,134,24],[96,46,134,44],[97,6,135,4,"hero_shards"],[97,17,135,15],[97,19,135,17],[97,32,135,30],[98,6,136,4,"rune_essence"],[98,18,136,16],[98,20,136,18],[99,4,137,2],[99,5,137,3],[100,4,139,2],[100,11,139,9,"typeMap"],[100,18,139,16],[100,19,139,17,"type"],[100,23,139,21],[100,24,139,22],[100,28,139,26,"type"],[100,32,139,30],[100,33,139,31,"replace"],[100,40,139,38],[100,41,139,39],[100,45,139,43],[100,47,139,45],[100,50,139,48],[100,51,139,49],[100,52,139,50,"replace"],[100,59,139,57],[100,60,139,58],[100,67,139,65],[100,69,139,67,"c"],[100,70,139,68],[100,74,139,72,"c"],[100,75,139,73],[100,76,139,74,"toUpperCase"],[100,87,139,85],[100,88,139,86],[100,89,139,87],[100,90,139,88],[101,2,140,0],[102,0,140,1],[102,3]],"functionMap":{"names":["<global>","isValidReceipt","assertValidReceipt","getReceiptItemCount","items.reduce$argument_0","formatReceiptItems","items.filter$argument_0","items.filter.map$argument_0","formatRewardType","type.replace.replace$argument_1"],"mappings":"AAA;OCyE;CDW;OEK;CFO;OGK;8BCC,gCD;CHC;OKK;YCM,uBD;SEC,wEF;CLE;AQK;mECgB,oBD;CRC"},"hasCjsExports":false},"type":"js/module"}]}