{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.isValidReceipt = isValidReceipt;\n  exports.assertValidReceipt = assertValidReceipt;\n  exports.getReceiptItemCount = getReceiptItemCount;\n  exports.formatReceiptItems = formatReceiptItems;\n  // /app/frontend/lib/types/receipt.ts\n  // Phase 3.24: Canonical Reward Receipt Type\n  // Phase 3.26: Added mail_receipt_claim source\n  //\n  // Single source of truth for receipt shape.\n  // All reward-granting endpoints return this shape.\n  // Frontend MUST use this type for all receipt handling.\n  //\n  // LOCKED source values:\n  // - bond_tribute\n  // - mail_reward_claim\n  // - mail_gift_claim\n  // - mail_receipt_claim (Phase 3.26)\n  // - daily_login_claim\n  // - idle_claim\n  // - admin_grant\n\n  /**\n   * Valid reward source types (matches backend RewardSource)\n   */\n\n  // Phase 3.30: Store dev redeem\n\n  /**\n   * Single reward item in a receipt\n   */\n\n  /**\n   * User balance snapshot\n   */\n\n  /**\n   * Canonical receipt shape for all reward grants (Phase 3.24)\n   * \n   * REQUIRED fields: source, sourceId, items, balances\n   * All reward endpoints MUST return this shape.\n   */\n\n  /**\n   * Type guard: Check if an object is a valid RewardReceipt\n   */\n  function isValidReceipt(obj) {\n    if (!obj || typeof obj !== 'object') return false;\n    const receipt = obj;\n    return typeof receipt.source === 'string' && typeof receipt.sourceId === 'string' && Array.isArray(receipt.items) && typeof receipt.balances === 'object' && receipt.balances !== null;\n  }\n\n  /**\n   * Validate and assert receipt shape (throws if invalid)\n   */\n  function assertValidReceipt(obj, context) {\n    if (!isValidReceipt(obj)) {\n      const msg = `Invalid receipt shape${context ? ` in ${context}` : ''}: ` + `missing source, sourceId, items, or balances`;\n      console.error('[RECEIPT_GUARD_FAILED]', msg, obj);\n      throw new Error(msg);\n    }\n  }\n\n  /**\n   * Extract total reward count from receipt\n   */\n  function getReceiptItemCount(receipt) {\n    return receipt.items.reduce((sum, item) => sum + item.amount, 0);\n  }\n\n  /**\n   * Format reward items for display\n   */\n  function formatReceiptItems(receipt) {\n    if (receipt.items.length === 0) {\n      return receipt.alreadyClaimed ? 'Already claimed' : 'No rewards';\n    }\n    return receipt.items.filter(item => item.amount > 0).map(item => `${item.amount.toLocaleString()} ${formatRewardType(item.type)}`).join(', ');\n  }\n\n  /**\n   * Format reward type for display\n   */\n  function formatRewardType(type) {\n    const typeMap = {\n      gold: 'Gold',\n      coins: 'Coins',\n      gems: 'Gems',\n      divine_gems: 'Divine Gems',\n      crystals: 'Crystals',\n      stamina: 'Stamina',\n      divine_essence: 'Divine Essence',\n      soul_dust: 'Soul Dust',\n      skill_essence: 'Skill Essence',\n      enhancement_stones: 'Enhancement Stones',\n      hero_shards: 'Hero Shards',\n      rune_essence: 'Rune Essence'\n    };\n    return typeMap[type] || type.replace(/_/g, ' ').replace(/\\b\\w/g, c => c.toUpperCase());\n  }\n});","lineCount":106,"map":[[7,2,79,0,"exports"],[7,9,79,0],[7,10,79,0,"isValidReceipt"],[7,24,79,0],[7,27,79,0,"isValidReceipt"],[7,41,79,0],[8,2,95,0,"exports"],[8,9,95,0],[8,10,95,0,"assertValidReceipt"],[8,28,95,0],[8,31,95,0,"assertValidReceipt"],[8,49,95,0],[9,2,107,0,"exports"],[9,9,107,0],[9,10,107,0,"getReceiptItemCount"],[9,29,107,0],[9,32,107,0,"getReceiptItemCount"],[9,51,107,0],[10,2,114,0,"exports"],[10,9,114,0],[10,10,114,0,"formatReceiptItems"],[10,28,114,0],[10,31,114,0,"formatReceiptItems"],[10,49,114,0],[11,2,1,0],[12,2,2,0],[13,2,3,0],[14,2,4,0],[15,2,5,0],[16,2,6,0],[17,2,7,0],[18,2,8,0],[19,2,9,0],[20,2,10,0],[21,2,11,0],[22,2,12,0],[23,2,13,0],[24,2,14,0],[25,2,15,0],[26,2,16,0],[28,2,18,0],[29,0,19,0],[30,0,20,0],[32,2,30,21],[34,2,32,0],[35,0,33,0],[36,0,34,0],[38,2,42,0],[39,0,43,0],[40,0,44,0],[42,2,61,0],[43,0,62,0],[44,0,63,0],[45,0,64,0],[46,0,65,0],[47,0,66,0],[49,2,76,0],[50,0,77,0],[51,0,78,0],[52,2,79,7],[52,11,79,16,"isValidReceipt"],[52,25,79,30,"isValidReceipt"],[52,26,79,31,"obj"],[52,29,79,43],[52,31,79,67],[53,4,80,2],[53,8,80,6],[53,9,80,7,"obj"],[53,12,80,10],[53,16,80,14],[53,23,80,21,"obj"],[53,26,80,24],[53,31,80,29],[53,39,80,37],[53,41,80,39],[53,48,80,46],[53,53,80,51],[54,4,81,2],[54,10,81,8,"receipt"],[54,17,81,15],[54,20,81,18,"obj"],[54,23,81,48],[55,4,83,2],[55,11,84,4],[55,18,84,11,"receipt"],[55,25,84,18],[55,26,84,19,"source"],[55,32,84,25],[55,37,84,30],[55,45,84,38],[55,49,85,4],[55,56,85,11,"receipt"],[55,63,85,18],[55,64,85,19,"sourceId"],[55,72,85,27],[55,77,85,32],[55,85,85,40],[55,89,86,4,"Array"],[55,94,86,9],[55,95,86,10,"isArray"],[55,102,86,17],[55,103,86,18,"receipt"],[55,110,86,25],[55,111,86,26,"items"],[55,116,86,31],[55,117,86,32],[55,121,87,4],[55,128,87,11,"receipt"],[55,135,87,18],[55,136,87,19,"balances"],[55,144,87,27],[55,149,87,32],[55,157,87,40],[55,161,88,4,"receipt"],[55,168,88,11],[55,169,88,12,"balances"],[55,177,88,20],[55,182,88,25],[55,186,88,29],[56,2,90,0],[58,2,92,0],[59,0,93,0],[60,0,94,0],[61,2,95,7],[61,11,95,16,"assertValidReceipt"],[61,29,95,34,"assertValidReceipt"],[61,30,95,35,"obj"],[61,33,95,47],[61,35,95,49,"context"],[61,42,95,65],[61,44,95,97],[62,4,96,2],[62,8,96,6],[62,9,96,7,"isValidReceipt"],[62,23,96,21],[62,24,96,22,"obj"],[62,27,96,25],[62,28,96,26],[62,30,96,28],[63,6,97,4],[63,12,97,10,"msg"],[63,15,97,13],[63,18,97,16],[63,42,97,40,"context"],[63,49,97,47],[63,52,97,50],[63,59,97,57,"context"],[63,66,97,64],[63,68,97,66],[63,71,97,69],[63,73,97,71],[63,77,97,75],[63,80,98,6],[63,126,98,52],[64,6,99,4,"console"],[64,13,99,11],[64,14,99,12,"error"],[64,19,99,17],[64,20,99,18],[64,44,99,42],[64,46,99,44,"msg"],[64,49,99,47],[64,51,99,49,"obj"],[64,54,99,52],[64,55,99,53],[65,6,100,4],[65,12,100,10],[65,16,100,14,"Error"],[65,21,100,19],[65,22,100,20,"msg"],[65,25,100,23],[65,26,100,24],[66,4,101,2],[67,2,102,0],[69,2,104,0],[70,0,105,0],[71,0,106,0],[72,2,107,7],[72,11,107,16,"getReceiptItemCount"],[72,30,107,35,"getReceiptItemCount"],[72,31,107,36,"receipt"],[72,38,107,58],[72,40,107,68],[73,4,108,2],[73,11,108,9,"receipt"],[73,18,108,16],[73,19,108,17,"items"],[73,24,108,22],[73,25,108,23,"reduce"],[73,31,108,29],[73,32,108,30],[73,33,108,31,"sum"],[73,36,108,34],[73,38,108,36,"item"],[73,42,108,40],[73,47,108,45,"sum"],[73,50,108,48],[73,53,108,51,"item"],[73,57,108,55],[73,58,108,56,"amount"],[73,64,108,62],[73,66,108,64],[73,67,108,65],[73,68,108,66],[74,2,109,0],[76,2,111,0],[77,0,112,0],[78,0,113,0],[79,2,114,7],[79,11,114,16,"formatReceiptItems"],[79,29,114,34,"formatReceiptItems"],[79,30,114,35,"receipt"],[79,37,114,57],[79,39,114,67],[80,4,115,2],[80,8,115,6,"receipt"],[80,15,115,13],[80,16,115,14,"items"],[80,21,115,19],[80,22,115,20,"length"],[80,28,115,26],[80,33,115,31],[80,34,115,32],[80,36,115,34],[81,6,116,4],[81,13,116,11,"receipt"],[81,20,116,18],[81,21,116,19,"alreadyClaimed"],[81,35,116,33],[81,38,116,36],[81,55,116,53],[81,58,116,56],[81,70,116,68],[82,4,117,2],[83,4,119,2],[83,11,119,9,"receipt"],[83,18,119,16],[83,19,119,17,"items"],[83,24,119,22],[83,25,120,5,"filter"],[83,31,120,11],[83,32,120,12,"item"],[83,36,120,16],[83,40,120,20,"item"],[83,44,120,24],[83,45,120,25,"amount"],[83,51,120,31],[83,54,120,34],[83,55,120,35],[83,56,120,36],[83,57,121,5,"map"],[83,60,121,8],[83,61,121,9,"item"],[83,65,121,13],[83,69,121,17],[83,72,121,20,"item"],[83,76,121,24],[83,77,121,25,"amount"],[83,83,121,31],[83,84,121,32,"toLocaleString"],[83,98,121,46],[83,99,121,47],[83,100,121,48],[83,104,121,52,"formatRewardType"],[83,120,121,68],[83,121,121,69,"item"],[83,125,121,73],[83,126,121,74,"type"],[83,130,121,78],[83,131,121,79],[83,133,121,81],[83,134,121,82],[83,135,122,5,"join"],[83,139,122,9],[83,140,122,10],[83,144,122,14],[83,145,122,15],[84,2,123,0],[86,2,125,0],[87,0,126,0],[88,0,127,0],[89,2,128,0],[89,11,128,9,"formatRewardType"],[89,27,128,25,"formatRewardType"],[89,28,128,26,"type"],[89,32,128,38],[89,34,128,48],[90,4,129,2],[90,10,129,8,"typeMap"],[90,17,129,39],[90,20,129,42],[91,6,130,4,"gold"],[91,10,130,8],[91,12,130,10],[91,18,130,16],[92,6,131,4,"coins"],[92,11,131,9],[92,13,131,11],[92,20,131,18],[93,6,132,4,"gems"],[93,10,132,8],[93,12,132,10],[93,18,132,16],[94,6,133,4,"divine_gems"],[94,17,133,15],[94,19,133,17],[94,32,133,30],[95,6,134,4,"crystals"],[95,14,134,12],[95,16,134,14],[95,26,134,24],[96,6,135,4,"stamina"],[96,13,135,11],[96,15,135,13],[96,24,135,22],[97,6,136,4,"divine_essence"],[97,20,136,18],[97,22,136,20],[97,38,136,36],[98,6,137,4,"soul_dust"],[98,15,137,13],[98,17,137,15],[98,28,137,26],[99,6,138,4,"skill_essence"],[99,19,138,17],[99,21,138,19],[99,36,138,34],[100,6,139,4,"enhancement_stones"],[100,24,139,22],[100,26,139,24],[100,46,139,44],[101,6,140,4,"hero_shards"],[101,17,140,15],[101,19,140,17],[101,32,140,30],[102,6,141,4,"rune_essence"],[102,18,141,16],[102,20,141,18],[103,4,142,2],[103,5,142,3],[104,4,144,2],[104,11,144,9,"typeMap"],[104,18,144,16],[104,19,144,17,"type"],[104,23,144,21],[104,24,144,22],[104,28,144,26,"type"],[104,32,144,30],[104,33,144,31,"replace"],[104,40,144,38],[104,41,144,39],[104,45,144,43],[104,47,144,45],[104,50,144,48],[104,51,144,49],[104,52,144,50,"replace"],[104,59,144,57],[104,60,144,58],[104,67,144,65],[104,69,144,67,"c"],[104,70,144,68],[104,74,144,72,"c"],[104,75,144,73],[104,76,144,74,"toUpperCase"],[104,87,144,85],[104,88,144,86],[104,89,144,87],[104,90,144,88],[105,2,145,0],[106,0,145,1],[106,3]],"functionMap":{"names":["<global>","isValidReceipt","assertValidReceipt","getReceiptItemCount","items.reduce$argument_0","formatReceiptItems","items.filter$argument_0","items.filter.map$argument_0","formatRewardType","type.replace.replace$argument_1"],"mappings":"AAA;OC8E;CDW;OEK;CFO;OGK;8BCC,gCD;CHC;OKK;YCM,uBD;SEC,wEF;CLE;AQK;mECgB,oBD;CRC"},"hasCjsExports":false},"type":"js/module"}]}