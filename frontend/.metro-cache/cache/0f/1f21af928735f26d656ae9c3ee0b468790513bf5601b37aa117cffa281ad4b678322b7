{"dependencies":[{"name":"expo-av","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":159},"end":{"line":8,"column":32,"index":191}}],"key":"VxVG0TWBdB+Oc1qOQ32HKtN+H5M=","exportNames":["*"],"imports":1}},{"name":"../telemetry/events","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":192},"end":{"line":9,"column":52,"index":244}}],"key":"k7LZwhoWMWET/ud396YGvDlODrM=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.playSfx = playSfx;\n  exports.preloadSfx = preloadSfx;\n  exports.unloadSfx = unloadSfx;\n  exports.setSfxMuted = setSfxMuted;\n  exports.isSfxMuted = isSfxMuted;\n  var _expoAv = require(_dependencyMap[0], \"expo-av\");\n  var _telemetryEvents = require(_dependencyMap[1], \"../telemetry/events\");\n  /**\n   * Phase 4.0: SFX Audio System\n   * \n   * Safe audio wrapper that never crashes if assets are missing.\n   * Provides battle feel without blocking gameplay.\n   */\n\n  // SFX names - only these are allowed\n\n  // Asset mapping (placeholder - will be replaced with real assets)\n  const SFX_ASSETS = {\n    battle_start: null,\n    // require('../../assets/audio/battle_start.mp3'),\n    victory: null,\n    // require('../../assets/audio/victory.mp3'),\n    defeat: null // require('../../assets/audio/defeat.mp3'),\n  };\n\n  // Track loaded sounds for cleanup\n  let loadedSounds = new Map();\n\n  // Global mute flag\n  let isMuted = false;\n\n  /**\n   * Play a sound effect by name.\n   * Safe no-op if asset is missing or audio fails.\n   * Never throws or blocks.\n   */\n  async function playSfx(name) {\n    // Track the attempt regardless of outcome\n    const eventMap = {\n      battle_start: _telemetryEvents.Events.SFX_BATTLE_START_PLAYED,\n      victory: _telemetryEvents.Events.SFX_VICTORY_PLAYED,\n      defeat: _telemetryEvents.Events.SFX_DEFEAT_PLAYED\n    };\n    (0, _telemetryEvents.track)(eventMap[name], {\n      sfxName: name\n    });\n\n    // Silent no-op if muted or no asset\n    if (isMuted) return;\n    const asset = SFX_ASSETS[name];\n    if (!asset) {\n      // Asset not ready - silent no-op\n      if (__DEV__) {\n        console.log(`[SFX] Asset not loaded: ${name} (placeholder mode)`);\n      }\n      return;\n    }\n    try {\n      // Check if already loaded\n      let sound = loadedSounds.get(name);\n      if (!sound) {\n        // Load the sound\n        const {\n          sound: newSound\n        } = await _expoAv.Audio.Sound.createAsync(asset, {\n          shouldPlay: false,\n          volume: 0.7\n        });\n        sound = newSound;\n        loadedSounds.set(name, sound);\n      }\n\n      // Reset and play\n      await sound.setPositionAsync(0);\n      await sound.playAsync();\n    } catch (error) {\n      // Silent failure - never crash for audio\n      if (__DEV__) {\n        console.warn(`[SFX] Failed to play ${name}:`, error);\n      }\n    }\n  }\n\n  /**\n   * Preload all SFX assets.\n   * Call on app start for instant playback.\n   */\n  async function preloadSfx() {\n    try {\n      await _expoAv.Audio.setAudioModeAsync({\n        playsInSilentModeIOS: true,\n        staysActiveInBackground: false,\n        shouldDuckAndroid: true\n      });\n\n      // Preload all available assets\n      for (const [name, asset] of Object.entries(SFX_ASSETS)) {\n        if (asset) {\n          try {\n            const {\n              sound\n            } = await _expoAv.Audio.Sound.createAsync(asset, {\n              shouldPlay: false,\n              volume: 0.7\n            });\n            loadedSounds.set(name, sound);\n          } catch {\n            // Individual asset failure is OK\n          }\n        }\n      }\n    } catch {\n      // Audio setup failure is OK - will use no-op mode\n    }\n  }\n\n  /**\n   * Unload all SFX to free memory.\n   */\n  async function unloadSfx() {\n    for (const sound of loadedSounds.values()) {\n      try {\n        await sound.unloadAsync();\n      } catch {\n        // Ignore unload errors\n      }\n    }\n    loadedSounds.clear();\n  }\n\n  /**\n   * Set global mute state.\n   */\n  function setSfxMuted(muted) {\n    isMuted = muted;\n  }\n\n  /**\n   * Get current mute state.\n   */\n  function isSfxMuted() {\n    return isMuted;\n  }\n});","lineCount":150,"map":[[7,2,32,0,"exports"],[7,9,32,0],[7,10,32,0,"playSfx"],[7,17,32,0],[7,20,32,0,"playSfx"],[7,27,32,0],[8,2,83,0,"exports"],[8,9,83,0],[8,10,83,0,"preloadSfx"],[8,20,83,0],[8,23,83,0,"preloadSfx"],[8,33,83,0],[9,2,113,0,"exports"],[9,9,113,0],[9,10,113,0,"unloadSfx"],[9,19,113,0],[9,22,113,0,"unloadSfx"],[9,31,113,0],[10,2,127,0,"exports"],[10,9,127,0],[10,10,127,0,"setSfxMuted"],[10,21,127,0],[10,24,127,0,"setSfxMuted"],[10,35,127,0],[11,2,134,0,"exports"],[11,9,134,0],[11,10,134,0,"isSfxMuted"],[11,20,134,0],[11,23,134,0,"isSfxMuted"],[11,33,134,0],[12,2,8,0],[12,6,8,0,"_expoAv"],[12,13,8,0],[12,16,8,0,"require"],[12,23,8,0],[12,24,8,0,"_dependencyMap"],[12,38,8,0],[13,2,9,0],[13,6,9,0,"_telemetryEvents"],[13,22,9,0],[13,25,9,0,"require"],[13,32,9,0],[13,33,9,0,"_dependencyMap"],[13,47,9,0],[14,2,1,0],[15,0,2,0],[16,0,3,0],[17,0,4,0],[18,0,5,0],[19,0,6,0],[21,2,11,0],[23,2,14,0],[24,2,15,0],[24,8,15,6,"SFX_ASSETS"],[24,18,15,38],[24,21,15,41],[25,4,16,2,"battle_start"],[25,16,16,14],[25,18,16,16],[25,22,16,20],[26,4,16,22],[27,4,17,2,"victory"],[27,11,17,9],[27,13,17,11],[27,17,17,15],[28,4,17,22],[29,4,18,2,"defeat"],[29,10,18,8],[29,12,18,10],[29,16,18,14],[29,17,18,22],[30,2,19,0],[30,3,19,1],[32,2,21,0],[33,2,22,0],[33,6,22,4,"loadedSounds"],[33,18,22,43],[33,21,22,46],[33,25,22,50,"Map"],[33,28,22,53],[33,29,22,54],[33,30,22,55],[35,2,24,0],[36,2,25,0],[36,6,25,4,"isMuted"],[36,13,25,11],[36,16,25,14],[36,21,25,19],[38,2,27,0],[39,0,28,0],[40,0,29,0],[41,0,30,0],[42,0,31,0],[43,2,32,7],[43,17,32,22,"playSfx"],[43,24,32,29,"playSfx"],[43,25,32,30,"name"],[43,29,32,43],[43,31,32,60],[44,4,33,2],[45,4,34,2],[45,10,34,8,"eventMap"],[45,18,34,41],[45,21,34,44],[46,6,35,4,"battle_start"],[46,18,35,16],[46,20,35,18,"Events"],[46,36,35,24],[46,37,35,24,"Events"],[46,43,35,24],[46,44,35,25,"SFX_BATTLE_START_PLAYED"],[46,67,35,48],[47,6,36,4,"victory"],[47,13,36,11],[47,15,36,13,"Events"],[47,31,36,19],[47,32,36,19,"Events"],[47,38,36,19],[47,39,36,20,"SFX_VICTORY_PLAYED"],[47,57,36,38],[48,6,37,4,"defeat"],[48,12,37,10],[48,14,37,12,"Events"],[48,30,37,18],[48,31,37,18,"Events"],[48,37,37,18],[48,38,37,19,"SFX_DEFEAT_PLAYED"],[49,4,38,2],[49,5,38,3],[50,4,39,2],[50,8,39,2,"track"],[50,24,39,7],[50,25,39,7,"track"],[50,30,39,7],[50,32,39,8,"eventMap"],[50,40,39,16],[50,41,39,17,"name"],[50,45,39,21],[50,46,39,22],[50,48,39,24],[51,6,39,26,"sfxName"],[51,13,39,33],[51,15,39,35,"name"],[52,4,39,40],[52,5,39,41],[52,6,39,42],[54,4,41,2],[55,4,42,2],[55,8,42,6,"isMuted"],[55,15,42,13],[55,17,42,15],[56,4,44,2],[56,10,44,8,"asset"],[56,15,44,13],[56,18,44,16,"SFX_ASSETS"],[56,28,44,26],[56,29,44,27,"name"],[56,33,44,31],[56,34,44,32],[57,4,45,2],[57,8,45,6],[57,9,45,7,"asset"],[57,14,45,12],[57,16,45,14],[58,6,46,4],[59,6,47,4],[59,10,47,8,"__DEV__"],[59,17,47,15],[59,19,47,17],[60,8,48,6,"console"],[60,15,48,13],[60,16,48,14,"log"],[60,19,48,17],[60,20,48,18],[60,47,48,45,"name"],[60,51,48,49],[60,72,48,70],[60,73,48,71],[61,6,49,4],[62,6,50,4],[63,4,51,2],[64,4,53,2],[64,8,53,6],[65,6,54,4],[66,6,55,4],[66,10,55,8,"sound"],[66,15,55,13],[66,18,55,16,"loadedSounds"],[66,30,55,28],[66,31,55,29,"get"],[66,34,55,32],[66,35,55,33,"name"],[66,39,55,37],[66,40,55,38],[67,6,57,4],[67,10,57,8],[67,11,57,9,"sound"],[67,16,57,14],[67,18,57,16],[68,8,58,6],[69,8,59,6],[69,14,59,12],[70,10,59,14,"sound"],[70,15,59,19],[70,17,59,21,"newSound"],[71,8,59,30],[71,9,59,31],[71,12,59,34],[71,18,59,40,"Audio"],[71,25,59,45],[71,26,59,45,"Audio"],[71,31,59,45],[71,32,59,46,"Sound"],[71,37,59,51],[71,38,59,52,"createAsync"],[71,49,59,63],[71,50,59,64,"asset"],[71,55,59,69],[71,57,59,71],[72,10,60,8,"shouldPlay"],[72,20,60,18],[72,22,60,20],[72,27,60,25],[73,10,61,8,"volume"],[73,16,61,14],[73,18,61,16],[74,8,62,6],[74,9,62,7],[74,10,62,8],[75,8,63,6,"sound"],[75,13,63,11],[75,16,63,14,"newSound"],[75,24,63,22],[76,8,64,6,"loadedSounds"],[76,20,64,18],[76,21,64,19,"set"],[76,24,64,22],[76,25,64,23,"name"],[76,29,64,27],[76,31,64,29,"sound"],[76,36,64,34],[76,37,64,35],[77,6,65,4],[79,6,67,4],[80,6,68,4],[80,12,68,10,"sound"],[80,17,68,15],[80,18,68,16,"setPositionAsync"],[80,34,68,32],[80,35,68,33],[80,36,68,34],[80,37,68,35],[81,6,69,4],[81,12,69,10,"sound"],[81,17,69,15],[81,18,69,16,"playAsync"],[81,27,69,25],[81,28,69,26],[81,29,69,27],[82,4,71,2],[82,5,71,3],[82,6,71,4],[82,13,71,11,"error"],[82,18,71,16],[82,20,71,18],[83,6,72,4],[84,6,73,4],[84,10,73,8,"__DEV__"],[84,17,73,15],[84,19,73,17],[85,8,74,6,"console"],[85,15,74,13],[85,16,74,14,"warn"],[85,20,74,18],[85,21,74,19],[85,45,74,43,"name"],[85,49,74,47],[85,52,74,50],[85,54,74,52,"error"],[85,59,74,57],[85,60,74,58],[86,6,75,4],[87,4,76,2],[88,2,77,0],[90,2,79,0],[91,0,80,0],[92,0,81,0],[93,0,82,0],[94,2,83,7],[94,17,83,22,"preloadSfx"],[94,27,83,32,"preloadSfx"],[94,28,83,32],[94,30,83,50],[95,4,84,2],[95,8,84,6],[96,6,85,4],[96,12,85,10,"Audio"],[96,19,85,15],[96,20,85,15,"Audio"],[96,25,85,15],[96,26,85,16,"setAudioModeAsync"],[96,43,85,33],[96,44,85,34],[97,8,86,6,"playsInSilentModeIOS"],[97,28,86,26],[97,30,86,28],[97,34,86,32],[98,8,87,6,"staysActiveInBackground"],[98,31,87,29],[98,33,87,31],[98,38,87,36],[99,8,88,6,"shouldDuckAndroid"],[99,25,88,23],[99,27,88,25],[100,6,89,4],[100,7,89,5],[100,8,89,6],[102,6,91,4],[103,6,92,4],[103,11,92,9],[103,17,92,15],[103,18,92,16,"name"],[103,22,92,20],[103,24,92,22,"asset"],[103,29,92,27],[103,30,92,28],[103,34,92,32,"Object"],[103,40,92,38],[103,41,92,39,"entries"],[103,48,92,46],[103,49,92,47,"SFX_ASSETS"],[103,59,92,57],[103,60,92,58],[103,62,92,60],[104,8,93,6],[104,12,93,10,"asset"],[104,17,93,15],[104,19,93,17],[105,10,94,8],[105,14,94,12],[106,12,95,10],[106,18,95,16],[107,14,95,18,"sound"],[108,12,95,24],[108,13,95,25],[108,16,95,28],[108,22,95,34,"Audio"],[108,29,95,39],[108,30,95,39,"Audio"],[108,35,95,39],[108,36,95,40,"Sound"],[108,41,95,45],[108,42,95,46,"createAsync"],[108,53,95,57],[108,54,95,58,"asset"],[108,59,95,63],[108,61,95,65],[109,14,96,12,"shouldPlay"],[109,24,96,22],[109,26,96,24],[109,31,96,29],[110,14,97,12,"volume"],[110,20,97,18],[110,22,97,20],[111,12,98,10],[111,13,98,11],[111,14,98,12],[112,12,99,10,"loadedSounds"],[112,24,99,22],[112,25,99,23,"set"],[112,28,99,26],[112,29,99,27,"name"],[112,33,99,31],[112,35,99,44,"sound"],[112,40,99,49],[112,41,99,50],[113,10,100,8],[113,11,100,9],[113,12,100,10],[113,18,100,16],[114,12,101,10],[115,10,101,10],[116,8,103,6],[117,6,104,4],[118,4,105,2],[118,5,105,3],[118,6,105,4],[118,12,105,10],[119,6,106,4],[120,4,106,4],[121,2,108,0],[123,2,110,0],[124,0,111,0],[125,0,112,0],[126,2,113,7],[126,17,113,22,"unloadSfx"],[126,26,113,31,"unloadSfx"],[126,27,113,31],[126,29,113,49],[127,4,114,2],[127,9,114,7],[127,15,114,13,"sound"],[127,20,114,18],[127,24,114,22,"loadedSounds"],[127,36,114,34],[127,37,114,35,"values"],[127,43,114,41],[127,44,114,42],[127,45,114,43],[127,47,114,45],[128,6,115,4],[128,10,115,8],[129,8,116,6],[129,14,116,12,"sound"],[129,19,116,17],[129,20,116,18,"unloadAsync"],[129,31,116,29],[129,32,116,30],[129,33,116,31],[130,6,117,4],[130,7,117,5],[130,8,117,6],[130,14,117,12],[131,8,118,6],[132,6,118,6],[133,4,120,2],[134,4,121,2,"loadedSounds"],[134,16,121,14],[134,17,121,15,"clear"],[134,22,121,20],[134,23,121,21],[134,24,121,22],[135,2,122,0],[137,2,124,0],[138,0,125,0],[139,0,126,0],[140,2,127,7],[140,11,127,16,"setSfxMuted"],[140,22,127,27,"setSfxMuted"],[140,23,127,28,"muted"],[140,28,127,42],[140,30,127,50],[141,4,128,2,"isMuted"],[141,11,128,9],[141,14,128,12,"muted"],[141,19,128,17],[142,2,129,0],[144,2,131,0],[145,0,132,0],[146,0,133,0],[147,2,134,7],[147,11,134,16,"isSfxMuted"],[147,21,134,26,"isSfxMuted"],[147,22,134,26],[147,24,134,38],[148,4,135,2],[148,11,135,9,"isMuted"],[148,18,135,16],[149,2,136,0],[150,0,136,1],[150,3]],"functionMap":{"names":["<global>","playSfx","preloadSfx","unloadSfx","setSfxMuted","isSfxMuted"],"mappings":"AAA;OC+B;CD6C;OEM;CFyB;OGK;CHS;OIK;CJE;OKK;CLE"},"hasCjsExports":false},"type":"js/module"}]}