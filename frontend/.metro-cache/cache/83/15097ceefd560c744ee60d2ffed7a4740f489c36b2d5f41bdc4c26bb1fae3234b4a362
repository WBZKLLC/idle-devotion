{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":11,"column":0,"index":327},"end":{"line":11,"column":33,"index":360}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"../lib/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":12,"column":0,"index":361},"end":{"line":12,"column":71,"index":432}}],"key":"cGGbCGri3M695PzY+v7ylQ+Rxt0=","exportNames":["*"],"imports":1}},{"name":"../lib/entitlements/types","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0,"index":433},"end":{"line":21,"column":35,"index":669}}],"key":"W08TkULB6K5ayFSZK0DQ51a7f14=","exportNames":["*"],"imports":1}},{"name":"../lib/entitlements/legacy","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":670},"end":{"line":26,"column":36,"index":779}}],"key":"+rKOnoh7xdxUkJQypQ3SMN7jDOc=","exportNames":["*"],"imports":1}},{"name":"../lib/api","data":{"asyncType":"async","isESMImport":true,"locs":[{"start":{"line":38,"column":22,"index":1270},"end":{"line":38,"column":42,"index":1290}}],"key":"qv6pIAfHV5HK/E8UlfJgciwW1c8=","exportNames":["*"],"imports":1}},{"name":"expo/internal/async-require-module","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":38,"column":16,"index":1264},"end":{"line":38,"column":42,"index":1290}}],"key":"y8mhXL4zKvSVvgnacXXOn0UU+QQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"useEntitlementStore\", {\n    enumerable: true,\n    get: function () {\n      return useEntitlementStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var _libStorage = require(_dependencyMap[1], \"../lib/storage\");\n  var _libEntitlementsTypes = require(_dependencyMap[2], \"../lib/entitlements/types\");\n  var _libEntitlementsLegacy = require(_dependencyMap[3], \"../lib/entitlements/legacy\");\n  /**\n   * Entitlement Store - Server Truth Model\n   * \n   * STRICT INVARIANTS:\n   * - Store NEVER grants entitlements - only server can grant\n   * - Store caches server snapshots for UX (offline/fast reads)\n   * - All reads go through gating helpers, not direct store access\n   * - Refresh from server on: startup, post-purchase, manual\n   */\n\n  // Debug logging helpers\n  const dlog = (...args) => {\n    if (__DEV__) console.log(...args);\n  };\n  const STORAGE_KEY = '@idledevotion/entitlements/v4';\n  const LEGACY_STORAGE_KEY = '@idledevotion/entitlements/v3';\n\n  // API import (lazy to avoid circular deps at module load)\n  let _getEntitlementsSnapshot = null;\n  async function getEntitlementsSnapshotApi() {\n    if (!_getEntitlementsSnapshot) {\n      const api = await require(_dependencyMap[5], \"expo/internal/async-require-module\")(_dependencyMap[4], _dependencyMap.paths, \"../lib/api\");\n      _getEntitlementsSnapshot = api.getEntitlementsSnapshot;\n    }\n    return _getEntitlementsSnapshot();\n  }\n  const useEntitlementStore = (0, _zustand.create)((set, get) => ({\n    snapshot: null,\n    entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n    lastRefreshAt: null,\n    isRefreshing: false,\n    refreshError: null,\n    entitlementEpoch: 0,\n    // Bumped on clear() to invalidate in-flight requests\n\n    /**\n     * Hydrate from cached snapshot on app startup\n     * Does NOT grant - only restores last known server state\n     */\n    hydrateEntitlements: async () => {\n      dlog('[entitlementStore] Hydrating from cache...');\n      try {\n        // Try to load cached snapshot\n        const cached = await (0, _libStorage.storageGet)(STORAGE_KEY);\n        if (cached) {\n          const parsed = JSON.parse(cached);\n          const normalized = Object.assign({}, (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(), parsed.entitlements);\n          set({\n            snapshot: parsed,\n            entitlementsByKey: normalized\n          });\n          dlog('[entitlementStore] Hydrated from cache:', Object.keys(normalized).length, 'keys');\n        }\n\n        // Migrate legacy data if present\n        await migrateLegacyData(set, get);\n      } catch (e) {\n        console.error('[entitlementStore] Hydration error:', e);\n      }\n    },\n    /**\n     * Refresh entitlements from server\n     * This is the ONLY way to get authoritative entitlement state\n     */\n    refreshFromServer: async reason => {\n      if (get().isRefreshing) {\n        dlog('[entitlementStore] Already refreshing, skipping');\n        return;\n      }\n      const epochAtStart = get().entitlementEpoch;\n      dlog('[entitlementStore] Refreshing from server, reason:', reason);\n      set({\n        isRefreshing: true,\n        refreshError: null\n      });\n      try {\n        const snap = await getEntitlementsSnapshotApi();\n\n        // Epoch check: ignore late response if clear() was called (logout)\n        if (get().entitlementEpoch !== epochAtStart) {\n          dlog('[entitlementStore] Epoch mismatch - discarding stale response');\n          set({\n            isRefreshing: false\n          });\n          return;\n        }\n\n        // Strict normalization: fill missing keys as not_owned\n        const normalized = Object.assign({}, (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(), snap.entitlements);\n        set({\n          snapshot: snap,\n          entitlementsByKey: normalized,\n          lastRefreshAt: Date.now(),\n          isRefreshing: false\n        });\n\n        // Persist for offline cache\n        await (0, _libStorage.storageSet)(STORAGE_KEY, JSON.stringify(snap));\n        dlog('[entitlementStore] Refreshed from server:', snap.version);\n      } catch (e) {\n        // Epoch check before setting error state\n        if (get().entitlementEpoch !== epochAtStart) {\n          dlog('[entitlementStore] Epoch mismatch in error handler - discarding');\n          set({\n            isRefreshing: false\n          });\n          return;\n        }\n        const errorMsg = e?.response?.data?.detail || e?.message || 'Failed to refresh entitlements';\n        console.error('[entitlementStore] Refresh error:', errorMsg);\n        set({\n          isRefreshing: false,\n          refreshError: errorMsg\n        });\n      }\n    },\n    /**\n     * Apply a snapshot directly (used by purchase verify flow)\n     * Skips network call - uses snapshot returned from verify endpoint\n     */\n    applySnapshot: snap => {\n      dlog('[entitlementStore] Applying snapshot directly, version:', snap.version);\n\n      // Strict normalization\n      const normalized = Object.assign({}, (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(), snap.entitlements);\n      set({\n        snapshot: snap,\n        entitlementsByKey: normalized,\n        lastRefreshAt: Date.now(),\n        refreshError: null\n      });\n\n      // Persist for offline cache\n      (0, _libStorage.storageSet)(STORAGE_KEY, JSON.stringify(snap)).catch(() => {});\n    },\n    /**\n     * Clear all entitlement state (on logout)\n     * Bumps epoch to invalidate any in-flight requests\n     */\n    clear: () => {\n      dlog('[entitlementStore] Clearing state');\n      set(s => ({\n        snapshot: null,\n        entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n        lastRefreshAt: null,\n        refreshError: null,\n        entitlementEpoch: s.entitlementEpoch + 1 // Bump to invalidate in-flight requests\n      }));\n      (0, _libStorage.storageRemove)(STORAGE_KEY).catch(() => {});\n    },\n    /**\n     * Check if user has entitlement (internal use)\n     * Screens should use gating helpers instead\n     */\n    hasEntitlement: key => {\n      const {\n        entitlementsByKey,\n        snapshot\n      } = get();\n      const entitlement = entitlementsByKey[key];\n      if (!entitlement || entitlement.status !== 'owned') return false;\n\n      // Check expiry using server time\n      if (entitlement.expires_at && snapshot?.server_time) {\n        const expiresAt = new Date(entitlement.expires_at).getTime();\n        const serverNow = new Date(snapshot.server_time).getTime();\n        if (serverNow > expiresAt) return false;\n      }\n      return true;\n    },\n    // ═══════════════════════════════════════════════════════════\n    // DEV ONLY METHODS - For testing paywalls/features\n    // These should NEVER be called in production code paths\n    // ═══════════════════════════════════════════════════════════\n\n    devGrantEntitlement: key => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devGrantEntitlement called in production - BLOCKED');\n        return;\n      }\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = Object.assign({}, entitlementsByKey, {\n        [key]: {\n          key,\n          status: 'owned',\n          granted_at: new Date().toISOString(),\n          reason: 'admin'\n        }\n      });\n\n      // Create fake snapshot for dev\n      const fakeSnapshot = {\n        server_time: new Date().toISOString(),\n        version: Date.now(),\n        username: 'DEV_USER',\n        entitlements: updated,\n        source: 'database'\n      };\n      set({\n        entitlementsByKey: updated,\n        snapshot: fakeSnapshot\n      });\n      dlog('[entitlementStore] DEV: Granted', key);\n    },\n    devRevokeEntitlement: key => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devRevokeEntitlement called in production - BLOCKED');\n        return;\n      }\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = Object.assign({}, entitlementsByKey, {\n        [key]: {\n          key,\n          status: 'not_owned'\n        }\n      });\n      set({\n        entitlementsByKey: updated\n      });\n      dlog('[entitlementStore] DEV: Revoked', key);\n    },\n    devClearAll: () => {\n      if (!__DEV__) {\n        console.warn('[entitlementStore] devClearAll called in production - BLOCKED');\n        return;\n      }\n      set({\n        entitlementsByKey: (0, _libEntitlementsTypes.createEmptyEntitlementsMap)(),\n        snapshot: null\n      });\n      (0, _libStorage.storageRemove)(STORAGE_KEY).catch(() => {});\n      dlog('[entitlementStore] DEV: Cleared all entitlements');\n    }\n  }));\n\n  /**\n   * Migrate legacy entitlement data to new format\n   */\n  async function migrateLegacyData(set, get) {\n    try {\n      const legacyData = await (0, _libStorage.storageGet)(LEGACY_STORAGE_KEY);\n      if (!legacyData) return;\n      dlog('[entitlementStore] Migrating legacy data...');\n      const legacy = JSON.parse(legacyData);\n      const {\n        entitlementsByKey\n      } = get();\n      const updated = Object.assign({}, entitlementsByKey);\n\n      // Migrate each legacy key\n      for (const [oldKey, value] of Object.entries(legacy)) {\n        if (value) {\n          const newKey = (0, _libEntitlementsLegacy.migrateLegacyKey)(oldKey);\n          updated[newKey] = {\n            key: newKey,\n            status: 'owned',\n            granted_at: new Date().toISOString(),\n            reason: 'unknown'\n          };\n          dlog('[entitlementStore] Migrated:', oldKey, '->', newKey);\n        }\n      }\n      set({\n        entitlementsByKey: updated\n      });\n\n      // Remove legacy data after migration\n      await (0, _libStorage.storageRemove)(LEGACY_STORAGE_KEY);\n      dlog('[entitlementStore] Legacy migration complete');\n    } catch (e) {\n      console.error('[entitlementStore] Legacy migration error:', e);\n    }\n  }\n});","lineCount":294,"map":[[7,2,74,0,"Object"],[7,8,74,0],[7,9,74,0,"defineProperty"],[7,23,74,0],[7,24,74,0,"exports"],[7,31,74,0],[8,4,74,0,"enumerable"],[8,14,74,0],[9,4,74,0,"get"],[9,7,74,0],[9,18,74,0,"get"],[9,19,74,0],[10,6,74,0],[10,13,74,0,"useEntitlementStore"],[10,32,74,0],[11,4,74,0],[12,2,74,0],[13,2,11,0],[13,6,11,0,"_zustand"],[13,14,11,0],[13,17,11,0,"require"],[13,24,11,0],[13,25,11,0,"_dependencyMap"],[13,39,11,0],[14,2,12,0],[14,6,12,0,"_libStorage"],[14,17,12,0],[14,20,12,0,"require"],[14,27,12,0],[14,28,12,0,"_dependencyMap"],[14,42,12,0],[15,2,13,0],[15,6,13,0,"_libEntitlementsTypes"],[15,27,13,0],[15,30,13,0,"require"],[15,37,13,0],[15,38,13,0,"_dependencyMap"],[15,52,13,0],[16,2,22,0],[16,6,22,0,"_libEntitlementsLegacy"],[16,28,22,0],[16,31,22,0,"require"],[16,38,22,0],[16,39,22,0,"_dependencyMap"],[16,53,22,0],[17,2,1,0],[18,0,2,0],[19,0,3,0],[20,0,4,0],[21,0,5,0],[22,0,6,0],[23,0,7,0],[24,0,8,0],[25,0,9,0],[27,2,28,0],[28,2,29,0],[28,8,29,6,"dlog"],[28,12,29,10],[28,15,29,13,"dlog"],[28,16,29,14],[28,19,29,17,"args"],[28,23,29,28],[28,28,29,33],[29,4,29,35],[29,8,29,39,"__DEV__"],[29,15,29,46],[29,17,29,48,"console"],[29,24,29,55],[29,25,29,56,"log"],[29,28,29,59],[29,29,29,60],[29,32,29,63,"args"],[29,36,29,67],[29,37,29,68],[30,2,29,70],[30,3,29,71],[31,2,31,0],[31,8,31,6,"STORAGE_KEY"],[31,19,31,17],[31,22,31,20],[31,53,31,51],[32,2,32,0],[32,8,32,6,"LEGACY_STORAGE_KEY"],[32,26,32,24],[32,29,32,27],[32,60,32,58],[34,2,34,0],[35,2,35,0],[35,6,35,4,"_getEntitlementsSnapshot"],[35,30,35,74],[35,33,35,77],[35,37,35,81],[36,2,36,0],[36,17,36,15,"getEntitlementsSnapshotApi"],[36,43,36,41,"getEntitlementsSnapshotApi"],[36,44,36,41],[36,46,36,75],[37,4,37,2],[37,8,37,6],[37,9,37,7,"_getEntitlementsSnapshot"],[37,33,37,31],[37,35,37,33],[38,6,38,4],[38,12,38,10,"api"],[38,15,38,13],[38,18,38,16],[38,24,38,16,"require"],[38,31,38,16],[38,32,38,16,"_dependencyMap"],[38,46,38,16],[38,89,38,16,"_dependencyMap"],[38,103,38,16],[38,108,38,16,"_dependencyMap"],[38,122,38,16],[38,123,38,16,"paths"],[38,128,38,16],[38,143,38,42],[39,6,39,4,"_getEntitlementsSnapshot"],[39,30,39,28],[39,33,39,31,"api"],[39,36,39,34],[39,37,39,35,"getEntitlementsSnapshot"],[39,60,39,58],[40,4,40,2],[41,4,41,2],[41,11,41,9,"_getEntitlementsSnapshot"],[41,35,41,33],[41,36,41,34],[41,37,41,35],[42,2,42,0],[43,2,74,7],[43,8,74,13,"useEntitlementStore"],[43,27,74,32],[43,30,74,35],[43,34,74,35,"create"],[43,42,74,41],[43,43,74,41,"create"],[43,49,74,41],[43,51,74,65],[43,52,74,66,"set"],[43,55,74,69],[43,57,74,71,"get"],[43,60,74,74],[43,66,74,80],[44,4,75,2,"snapshot"],[44,12,75,10],[44,14,75,12],[44,18,75,16],[45,4,76,2,"entitlementsByKey"],[45,21,76,19],[45,23,76,21],[45,27,76,21,"createEmptyEntitlementsMap"],[45,48,76,47],[45,49,76,47,"createEmptyEntitlementsMap"],[45,75,76,47],[45,77,76,48],[45,78,76,49],[46,4,77,2,"lastRefreshAt"],[46,17,77,15],[46,19,77,17],[46,23,77,21],[47,4,78,2,"isRefreshing"],[47,16,78,14],[47,18,78,16],[47,23,78,21],[48,4,79,2,"refreshError"],[48,16,79,14],[48,18,79,16],[48,22,79,20],[49,4,80,2,"entitlementEpoch"],[49,20,80,18],[49,22,80,20],[49,23,80,21],[50,4,80,24],[52,4,82,2],[53,0,83,0],[54,0,84,0],[55,0,85,0],[56,4,86,2,"hydrateEntitlements"],[56,23,86,21],[56,25,86,23],[56,31,86,23,"hydrateEntitlements"],[56,32,86,23],[56,37,86,35],[57,6,87,4,"dlog"],[57,10,87,8],[57,11,87,9],[57,55,87,53],[57,56,87,54],[58,6,89,4],[58,10,89,8],[59,8,90,6],[60,8,91,6],[60,14,91,12,"cached"],[60,20,91,18],[60,23,91,21],[60,29,91,27],[60,33,91,27,"storageGet"],[60,44,91,37],[60,45,91,37,"storageGet"],[60,55,91,37],[60,57,91,38,"STORAGE_KEY"],[60,68,91,49],[60,69,91,50],[61,8,92,6],[61,12,92,10,"cached"],[61,18,92,16],[61,20,92,18],[62,10,93,8],[62,16,93,14,"parsed"],[62,22,93,20],[62,25,93,23,"JSON"],[62,29,93,27],[62,30,93,28,"parse"],[62,35,93,33],[62,36,93,34,"cached"],[62,42,93,40],[62,43,93,65],[63,10,94,8],[63,16,94,14,"normalized"],[63,26,94,24],[63,29,94,24,"Object"],[63,35,94,24],[63,36,94,24,"assign"],[63,42,94,24],[63,47,94,32],[63,51,94,32,"createEmptyEntitlementsMap"],[63,72,94,58],[63,73,94,58,"createEmptyEntitlementsMap"],[63,99,94,58],[63,101,94,59],[63,102,94,60],[63,104,94,65,"parsed"],[63,110,94,71],[63,111,94,72,"entitlements"],[63,123,94,84],[63,124,94,86],[64,10,95,8,"set"],[64,13,95,11],[64,14,95,12],[65,12,96,10,"snapshot"],[65,20,96,18],[65,22,96,20,"parsed"],[65,28,96,26],[66,12,97,10,"entitlementsByKey"],[66,29,97,27],[66,31,97,29,"normalized"],[67,10,98,8],[67,11,98,9],[67,12,98,10],[68,10,99,8,"dlog"],[68,14,99,12],[68,15,99,13],[68,56,99,54],[68,58,99,56,"Object"],[68,64,99,62],[68,65,99,63,"keys"],[68,69,99,67],[68,70,99,68,"normalized"],[68,80,99,78],[68,81,99,79],[68,82,99,80,"length"],[68,88,99,86],[68,90,99,88],[68,96,99,94],[68,97,99,95],[69,8,100,6],[71,8,102,6],[72,8,103,6],[72,14,103,12,"migrateLegacyData"],[72,31,103,29],[72,32,103,30,"set"],[72,35,103,33],[72,37,103,35,"get"],[72,40,103,38],[72,41,103,39],[73,6,105,4],[73,7,105,5],[73,8,105,6],[73,15,105,13,"e"],[73,16,105,14],[73,18,105,16],[74,8,106,6,"console"],[74,15,106,13],[74,16,106,14,"error"],[74,21,106,19],[74,22,106,20],[74,59,106,57],[74,61,106,59,"e"],[74,62,106,60],[74,63,106,61],[75,6,107,4],[76,4,108,2],[76,5,108,3],[77,4,110,2],[78,0,111,0],[79,0,112,0],[80,0,113,0],[81,4,114,2,"refreshFromServer"],[81,21,114,19],[81,23,114,21],[81,29,114,28,"reason"],[81,35,114,34],[81,39,114,39],[82,6,115,4],[82,10,115,8,"get"],[82,13,115,11],[82,14,115,12],[82,15,115,13],[82,16,115,14,"isRefreshing"],[82,28,115,26],[82,30,115,28],[83,8,116,6,"dlog"],[83,12,116,10],[83,13,116,11],[83,62,116,60],[83,63,116,61],[84,8,117,6],[85,6,118,4],[86,6,120,4],[86,12,120,10,"epochAtStart"],[86,24,120,22],[86,27,120,25,"get"],[86,30,120,28],[86,31,120,29],[86,32,120,30],[86,33,120,31,"entitlementEpoch"],[86,49,120,47],[87,6,121,4,"dlog"],[87,10,121,8],[87,11,121,9],[87,63,121,61],[87,65,121,63,"reason"],[87,71,121,69],[87,72,121,70],[88,6,122,4,"set"],[88,9,122,7],[88,10,122,8],[89,8,122,10,"isRefreshing"],[89,20,122,22],[89,22,122,24],[89,26,122,28],[90,8,122,30,"refreshError"],[90,20,122,42],[90,22,122,44],[91,6,122,49],[91,7,122,50],[91,8,122,51],[92,6,124,4],[92,10,124,8],[93,8,125,6],[93,14,125,12,"snap"],[93,18,125,16],[93,21,125,19],[93,27,125,25,"getEntitlementsSnapshotApi"],[93,53,125,51],[93,54,125,52],[93,55,125,53],[95,8,127,6],[96,8,128,6],[96,12,128,10,"get"],[96,15,128,13],[96,16,128,14],[96,17,128,15],[96,18,128,16,"entitlementEpoch"],[96,34,128,32],[96,39,128,37,"epochAtStart"],[96,51,128,49],[96,53,128,51],[97,10,129,8,"dlog"],[97,14,129,12],[97,15,129,13],[97,78,129,76],[97,79,129,77],[98,10,130,8,"set"],[98,13,130,11],[98,14,130,12],[99,12,130,14,"isRefreshing"],[99,24,130,26],[99,26,130,28],[100,10,130,34],[100,11,130,35],[100,12,130,36],[101,10,131,8],[102,8,132,6],[104,8,134,6],[105,8,135,6],[105,14,135,12,"normalized"],[105,24,135,22],[105,27,135,22,"Object"],[105,33,135,22],[105,34,135,22,"assign"],[105,40,135,22],[105,45,135,30],[105,49,135,30,"createEmptyEntitlementsMap"],[105,70,135,56],[105,71,135,56,"createEmptyEntitlementsMap"],[105,97,135,56],[105,99,135,57],[105,100,135,58],[105,102,135,63,"snap"],[105,106,135,67],[105,107,135,68,"entitlements"],[105,119,135,80],[105,120,135,82],[106,8,137,6,"set"],[106,11,137,9],[106,12,137,10],[107,10,138,8,"snapshot"],[107,18,138,16],[107,20,138,18,"snap"],[107,24,138,22],[108,10,139,8,"entitlementsByKey"],[108,27,139,25],[108,29,139,27,"normalized"],[108,39,139,37],[109,10,140,8,"lastRefreshAt"],[109,23,140,21],[109,25,140,23,"Date"],[109,29,140,27],[109,30,140,28,"now"],[109,33,140,31],[109,34,140,32],[109,35,140,33],[110,10,141,8,"isRefreshing"],[110,22,141,20],[110,24,141,22],[111,8,142,6],[111,9,142,7],[111,10,142,8],[113,8,144,6],[114,8,145,6],[114,14,145,12],[114,18,145,12,"storageSet"],[114,29,145,22],[114,30,145,22,"storageSet"],[114,40,145,22],[114,42,145,23,"STORAGE_KEY"],[114,53,145,34],[114,55,145,36,"JSON"],[114,59,145,40],[114,60,145,41,"stringify"],[114,69,145,50],[114,70,145,51,"snap"],[114,74,145,55],[114,75,145,56],[114,76,145,57],[115,8,147,6,"dlog"],[115,12,147,10],[115,13,147,11],[115,56,147,54],[115,58,147,56,"snap"],[115,62,147,60],[115,63,147,61,"version"],[115,70,147,68],[115,71,147,69],[116,6,149,4],[116,7,149,5],[116,8,149,6],[116,15,149,13,"e"],[116,16,149,19],[116,18,149,21],[117,8,150,6],[118,8,151,6],[118,12,151,10,"get"],[118,15,151,13],[118,16,151,14],[118,17,151,15],[118,18,151,16,"entitlementEpoch"],[118,34,151,32],[118,39,151,37,"epochAtStart"],[118,51,151,49],[118,53,151,51],[119,10,152,8,"dlog"],[119,14,152,12],[119,15,152,13],[119,80,152,78],[119,81,152,79],[120,10,153,8,"set"],[120,13,153,11],[120,14,153,12],[121,12,153,14,"isRefreshing"],[121,24,153,26],[121,26,153,28],[122,10,153,34],[122,11,153,35],[122,12,153,36],[123,10,154,8],[124,8,155,6],[125,8,157,6],[125,14,157,12,"errorMsg"],[125,22,157,20],[125,25,157,23,"e"],[125,26,157,24],[125,28,157,26,"response"],[125,36,157,34],[125,38,157,36,"data"],[125,42,157,40],[125,44,157,42,"detail"],[125,50,157,48],[125,54,157,52,"e"],[125,55,157,53],[125,57,157,55,"message"],[125,64,157,62],[125,68,157,66],[125,100,157,98],[126,8,158,6,"console"],[126,15,158,13],[126,16,158,14,"error"],[126,21,158,19],[126,22,158,20],[126,57,158,55],[126,59,158,57,"errorMsg"],[126,67,158,65],[126,68,158,66],[127,8,159,6,"set"],[127,11,159,9],[127,12,159,10],[128,10,160,8,"isRefreshing"],[128,22,160,20],[128,24,160,22],[128,29,160,27],[129,10,161,8,"refreshError"],[129,22,161,20],[129,24,161,22,"errorMsg"],[130,8,162,6],[130,9,162,7],[130,10,162,8],[131,6,163,4],[132,4,164,2],[132,5,164,3],[133,4,166,2],[134,0,167,0],[135,0,168,0],[136,0,169,0],[137,4,170,2,"applySnapshot"],[137,17,170,15],[137,19,170,18,"snap"],[137,23,170,44],[137,27,170,49],[138,6,171,4,"dlog"],[138,10,171,8],[138,11,171,9],[138,68,171,66],[138,70,171,68,"snap"],[138,74,171,72],[138,75,171,73,"version"],[138,82,171,80],[138,83,171,81],[140,6,173,4],[141,6,174,4],[141,12,174,10,"normalized"],[141,22,174,20],[141,25,174,20,"Object"],[141,31,174,20],[141,32,174,20,"assign"],[141,38,174,20],[141,43,174,28],[141,47,174,28,"createEmptyEntitlementsMap"],[141,68,174,54],[141,69,174,54,"createEmptyEntitlementsMap"],[141,95,174,54],[141,97,174,55],[141,98,174,56],[141,100,174,61,"snap"],[141,104,174,65],[141,105,174,66,"entitlements"],[141,117,174,78],[141,118,174,80],[142,6,176,4,"set"],[142,9,176,7],[142,10,176,8],[143,8,177,6,"snapshot"],[143,16,177,14],[143,18,177,16,"snap"],[143,22,177,20],[144,8,178,6,"entitlementsByKey"],[144,25,178,23],[144,27,178,25,"normalized"],[144,37,178,35],[145,8,179,6,"lastRefreshAt"],[145,21,179,19],[145,23,179,21,"Date"],[145,27,179,25],[145,28,179,26,"now"],[145,31,179,29],[145,32,179,30],[145,33,179,31],[146,8,180,6,"refreshError"],[146,20,180,18],[146,22,180,20],[147,6,181,4],[147,7,181,5],[147,8,181,6],[149,6,183,4],[150,6,184,4],[150,10,184,4,"storageSet"],[150,21,184,14],[150,22,184,14,"storageSet"],[150,32,184,14],[150,34,184,15,"STORAGE_KEY"],[150,45,184,26],[150,47,184,28,"JSON"],[150,51,184,32],[150,52,184,33,"stringify"],[150,61,184,42],[150,62,184,43,"snap"],[150,66,184,47],[150,67,184,48],[150,68,184,49],[150,69,184,50,"catch"],[150,74,184,55],[150,75,184,56],[150,81,184,62],[150,82,184,63],[150,83,184,64],[150,84,184,65],[151,4,185,2],[151,5,185,3],[152,4,187,2],[153,0,188,0],[154,0,189,0],[155,0,190,0],[156,4,191,2,"clear"],[156,9,191,7],[156,11,191,9,"clear"],[156,12,191,9],[156,17,191,15],[157,6,192,4,"dlog"],[157,10,192,8],[157,11,192,9],[157,46,192,44],[157,47,192,45],[158,6,193,4,"set"],[158,9,193,7],[158,10,193,9,"s"],[158,11,193,10],[158,16,193,16],[159,8,194,6,"snapshot"],[159,16,194,14],[159,18,194,16],[159,22,194,20],[160,8,195,6,"entitlementsByKey"],[160,25,195,23],[160,27,195,25],[160,31,195,25,"createEmptyEntitlementsMap"],[160,52,195,51],[160,53,195,51,"createEmptyEntitlementsMap"],[160,79,195,51],[160,81,195,52],[160,82,195,53],[161,8,196,6,"lastRefreshAt"],[161,21,196,19],[161,23,196,21],[161,27,196,25],[162,8,197,6,"refreshError"],[162,20,197,18],[162,22,197,20],[162,26,197,24],[163,8,198,6,"entitlementEpoch"],[163,24,198,22],[163,26,198,24,"s"],[163,27,198,25],[163,28,198,26,"entitlementEpoch"],[163,44,198,42],[163,47,198,45],[163,48,198,46],[163,49,198,49],[164,6,199,4],[164,7,199,5],[164,8,199,6],[164,9,199,7],[165,6,200,4],[165,10,200,4,"storageRemove"],[165,21,200,17],[165,22,200,17,"storageRemove"],[165,35,200,17],[165,37,200,18,"STORAGE_KEY"],[165,48,200,29],[165,49,200,30],[165,50,200,31,"catch"],[165,55,200,36],[165,56,200,37],[165,62,200,43],[165,63,200,44],[165,64,200,45],[165,65,200,46],[166,4,201,2],[166,5,201,3],[167,4,203,2],[168,0,204,0],[169,0,205,0],[170,0,206,0],[171,4,207,2,"hasEntitlement"],[171,18,207,16],[171,20,207,19,"key"],[171,23,207,30],[171,27,207,35],[172,6,208,4],[172,12,208,10],[173,8,208,12,"entitlementsByKey"],[173,25,208,29],[174,8,208,31,"snapshot"],[175,6,208,40],[175,7,208,41],[175,10,208,44,"get"],[175,13,208,47],[175,14,208,48],[175,15,208,49],[176,6,209,4],[176,12,209,10,"entitlement"],[176,23,209,21],[176,26,209,24,"entitlementsByKey"],[176,43,209,41],[176,44,209,42,"key"],[176,47,209,45],[176,48,209,46],[177,6,210,4],[177,10,210,8],[177,11,210,9,"entitlement"],[177,22,210,20],[177,26,210,24,"entitlement"],[177,37,210,35],[177,38,210,36,"status"],[177,44,210,42],[177,49,210,47],[177,56,210,54],[177,58,210,56],[177,65,210,63],[177,70,210,68],[179,6,212,4],[180,6,213,4],[180,10,213,8,"entitlement"],[180,21,213,19],[180,22,213,20,"expires_at"],[180,32,213,30],[180,36,213,34,"snapshot"],[180,44,213,42],[180,46,213,44,"server_time"],[180,57,213,55],[180,59,213,57],[181,8,214,6],[181,14,214,12,"expiresAt"],[181,23,214,21],[181,26,214,24],[181,30,214,28,"Date"],[181,34,214,32],[181,35,214,33,"entitlement"],[181,46,214,44],[181,47,214,45,"expires_at"],[181,57,214,55],[181,58,214,56],[181,59,214,57,"getTime"],[181,66,214,64],[181,67,214,65],[181,68,214,66],[182,8,215,6],[182,14,215,12,"serverNow"],[182,23,215,21],[182,26,215,24],[182,30,215,28,"Date"],[182,34,215,32],[182,35,215,33,"snapshot"],[182,43,215,41],[182,44,215,42,"server_time"],[182,55,215,53],[182,56,215,54],[182,57,215,55,"getTime"],[182,64,215,62],[182,65,215,63],[182,66,215,64],[183,8,216,6],[183,12,216,10,"serverNow"],[183,21,216,19],[183,24,216,22,"expiresAt"],[183,33,216,31],[183,35,216,33],[183,42,216,40],[183,47,216,45],[184,6,217,4],[185,6,219,4],[185,13,219,11],[185,17,219,15],[186,4,220,2],[186,5,220,3],[187,4,222,2],[188,4,223,2],[189,4,224,2],[190,4,225,2],[192,4,227,2,"devGrantEntitlement"],[192,23,227,21],[192,25,227,24,"key"],[192,28,227,35],[192,32,227,40],[193,6,228,4],[193,10,228,8],[193,11,228,9,"__DEV__"],[193,18,228,16],[193,20,228,18],[194,8,229,6,"console"],[194,15,229,13],[194,16,229,14,"warn"],[194,20,229,18],[194,21,229,19],[194,92,229,90],[194,93,229,91],[195,8,230,6],[196,6,231,4],[197,6,233,4],[197,12,233,10],[198,8,233,12,"entitlementsByKey"],[199,6,233,30],[199,7,233,31],[199,10,233,34,"get"],[199,13,233,37],[199,14,233,38],[199,15,233,39],[200,6,234,4],[200,12,234,10,"updated"],[200,19,234,17],[200,22,234,17,"Object"],[200,28,234,17],[200,29,234,17,"assign"],[200,35,234,17],[200,40,235,9,"entitlementsByKey"],[200,57,235,26],[201,8,236,6],[201,9,236,7,"key"],[201,12,236,10],[201,15,236,13],[202,10,237,8,"key"],[202,13,237,11],[203,10,238,8,"status"],[203,16,238,14],[203,18,238,16],[203,25,238,32],[204,10,239,8,"granted_at"],[204,20,239,18],[204,22,239,20],[204,26,239,24,"Date"],[204,30,239,28],[204,31,239,29],[204,32,239,30],[204,33,239,31,"toISOString"],[204,44,239,42],[204,45,239,43],[204,46,239,44],[205,10,240,8,"reason"],[205,16,240,14],[205,18,240,16],[206,8,241,6],[207,6,241,7],[207,8,242,5],[209,6,244,4],[210,6,245,4],[210,12,245,10,"fakeSnapshot"],[210,24,245,44],[210,27,245,47],[211,8,246,6,"server_time"],[211,19,246,17],[211,21,246,19],[211,25,246,23,"Date"],[211,29,246,27],[211,30,246,28],[211,31,246,29],[211,32,246,30,"toISOString"],[211,43,246,41],[211,44,246,42],[211,45,246,43],[212,8,247,6,"version"],[212,15,247,13],[212,17,247,15,"Date"],[212,21,247,19],[212,22,247,20,"now"],[212,25,247,23],[212,26,247,24],[212,27,247,25],[213,8,248,6,"username"],[213,16,248,14],[213,18,248,16],[213,28,248,26],[214,8,249,6,"entitlements"],[214,20,249,18],[214,22,249,20,"updated"],[214,29,249,27],[215,8,250,6,"source"],[215,14,250,12],[215,16,250,14],[216,6,251,4],[216,7,251,5],[217,6,253,4,"set"],[217,9,253,7],[217,10,253,8],[218,8,254,6,"entitlementsByKey"],[218,25,254,23],[218,27,254,25,"updated"],[218,34,254,32],[219,8,255,6,"snapshot"],[219,16,255,14],[219,18,255,16,"fakeSnapshot"],[220,6,256,4],[220,7,256,5],[220,8,256,6],[221,6,257,4,"dlog"],[221,10,257,8],[221,11,257,9],[221,44,257,42],[221,46,257,44,"key"],[221,49,257,47],[221,50,257,48],[222,4,258,2],[222,5,258,3],[223,4,260,2,"devRevokeEntitlement"],[223,24,260,22],[223,26,260,25,"key"],[223,29,260,36],[223,33,260,41],[224,6,261,4],[224,10,261,8],[224,11,261,9,"__DEV__"],[224,18,261,16],[224,20,261,18],[225,8,262,6,"console"],[225,15,262,13],[225,16,262,14,"warn"],[225,20,262,18],[225,21,262,19],[225,93,262,91],[225,94,262,92],[226,8,263,6],[227,6,264,4],[228,6,266,4],[228,12,266,10],[229,8,266,12,"entitlementsByKey"],[230,6,266,30],[230,7,266,31],[230,10,266,34,"get"],[230,13,266,37],[230,14,266,38],[230,15,266,39],[231,6,267,4],[231,12,267,10,"updated"],[231,19,267,17],[231,22,267,17,"Object"],[231,28,267,17],[231,29,267,17,"assign"],[231,35,267,17],[231,40,268,9,"entitlementsByKey"],[231,57,268,26],[232,8,269,6],[232,9,269,7,"key"],[232,12,269,10],[232,15,269,13],[233,10,270,8,"key"],[233,13,270,11],[234,10,271,8,"status"],[234,16,271,14],[234,18,271,16],[235,8,272,6],[236,6,272,7],[236,8,273,5],[237,6,275,4,"set"],[237,9,275,7],[237,10,275,8],[238,8,275,10,"entitlementsByKey"],[238,25,275,27],[238,27,275,29,"updated"],[239,6,275,37],[239,7,275,38],[239,8,275,39],[240,6,276,4,"dlog"],[240,10,276,8],[240,11,276,9],[240,44,276,42],[240,46,276,44,"key"],[240,49,276,47],[240,50,276,48],[241,4,277,2],[241,5,277,3],[242,4,279,2,"devClearAll"],[242,15,279,13],[242,17,279,15,"devClearAll"],[242,18,279,15],[242,23,279,21],[243,6,280,4],[243,10,280,8],[243,11,280,9,"__DEV__"],[243,18,280,16],[243,20,280,18],[244,8,281,6,"console"],[244,15,281,13],[244,16,281,14,"warn"],[244,20,281,18],[244,21,281,19],[244,84,281,82],[244,85,281,83],[245,8,282,6],[246,6,283,4],[247,6,285,4,"set"],[247,9,285,7],[247,10,285,8],[248,8,286,6,"entitlementsByKey"],[248,25,286,23],[248,27,286,25],[248,31,286,25,"createEmptyEntitlementsMap"],[248,52,286,51],[248,53,286,51,"createEmptyEntitlementsMap"],[248,79,286,51],[248,81,286,52],[248,82,286,53],[249,8,287,6,"snapshot"],[249,16,287,14],[249,18,287,16],[250,6,288,4],[250,7,288,5],[250,8,288,6],[251,6,289,4],[251,10,289,4,"storageRemove"],[251,21,289,17],[251,22,289,17,"storageRemove"],[251,35,289,17],[251,37,289,18,"STORAGE_KEY"],[251,48,289,29],[251,49,289,30],[251,50,289,31,"catch"],[251,55,289,36],[251,56,289,37],[251,62,289,43],[251,63,289,44],[251,64,289,45],[251,65,289,46],[252,6,290,4,"dlog"],[252,10,290,8],[252,11,290,9],[252,61,290,59],[252,62,290,60],[253,4,291,2],[254,2,292,0],[254,3,292,1],[254,4,292,2],[254,5,292,3],[256,2,294,0],[257,0,295,0],[258,0,296,0],[259,2,297,0],[259,17,297,15,"migrateLegacyData"],[259,34,297,32,"migrateLegacyData"],[259,35,298,2,"set"],[259,38,298,54],[259,40,299,2,"get"],[259,43,299,34],[259,45,300,2],[260,4,301,2],[260,8,301,6],[261,6,302,4],[261,12,302,10,"legacyData"],[261,22,302,20],[261,25,302,23],[261,31,302,29],[261,35,302,29,"storageGet"],[261,46,302,39],[261,47,302,39,"storageGet"],[261,57,302,39],[261,59,302,40,"LEGACY_STORAGE_KEY"],[261,77,302,58],[261,78,302,59],[262,6,303,4],[262,10,303,8],[262,11,303,9,"legacyData"],[262,21,303,19],[262,23,303,21],[263,6,305,4,"dlog"],[263,10,305,8],[263,11,305,9],[263,56,305,54],[263,57,305,55],[264,6,307,4],[264,12,307,10,"legacy"],[264,18,307,16],[264,21,307,19,"JSON"],[264,25,307,23],[264,26,307,24,"parse"],[264,31,307,29],[264,32,307,30,"legacyData"],[264,42,307,40],[264,43,307,41],[265,6,308,4],[265,12,308,10],[266,8,308,12,"entitlementsByKey"],[267,6,308,30],[267,7,308,31],[267,10,308,34,"get"],[267,13,308,37],[267,14,308,38],[267,15,308,39],[268,6,309,4],[268,12,309,10,"updated"],[268,19,309,17],[268,22,309,17,"Object"],[268,28,309,17],[268,29,309,17,"assign"],[268,35,309,17],[268,40,309,25,"entitlementsByKey"],[268,57,309,42],[268,58,309,44],[270,6,311,4],[271,6,312,4],[271,11,312,9],[271,17,312,15],[271,18,312,16,"oldKey"],[271,24,312,22],[271,26,312,24,"value"],[271,31,312,29],[271,32,312,30],[271,36,312,34,"Object"],[271,42,312,40],[271,43,312,41,"entries"],[271,50,312,48],[271,51,312,49,"legacy"],[271,57,312,55],[271,58,312,56],[271,60,312,58],[272,8,313,6],[272,12,313,10,"value"],[272,17,313,15],[272,19,313,17],[273,10,314,8],[273,16,314,14,"newKey"],[273,22,314,20],[273,25,314,23],[273,29,314,23,"migrateLegacyKey"],[273,51,314,39],[273,52,314,39,"migrateLegacyKey"],[273,68,314,39],[273,70,314,40,"oldKey"],[273,76,314,46],[273,77,314,47],[274,10,315,8,"updated"],[274,17,315,15],[274,18,315,16,"newKey"],[274,24,315,22],[274,25,315,23],[274,28,315,26],[275,12,316,10,"key"],[275,15,316,13],[275,17,316,15,"newKey"],[275,23,316,21],[276,12,317,10,"status"],[276,18,317,16],[276,20,317,18],[276,27,317,25],[277,12,318,10,"granted_at"],[277,22,318,20],[277,24,318,22],[277,28,318,26,"Date"],[277,32,318,30],[277,33,318,31],[277,34,318,32],[277,35,318,33,"toISOString"],[277,46,318,44],[277,47,318,45],[277,48,318,46],[278,12,319,10,"reason"],[278,18,319,16],[278,20,319,18],[279,10,320,8],[279,11,320,9],[280,10,321,8,"dlog"],[280,14,321,12],[280,15,321,13],[280,45,321,43],[280,47,321,45,"oldKey"],[280,53,321,51],[280,55,321,53],[280,59,321,57],[280,61,321,59,"newKey"],[280,67,321,65],[280,68,321,66],[281,8,322,6],[282,6,323,4],[283,6,325,4,"set"],[283,9,325,7],[283,10,325,8],[284,8,325,10,"entitlementsByKey"],[284,25,325,27],[284,27,325,29,"updated"],[285,6,325,37],[285,7,325,38],[285,8,325,39],[287,6,327,4],[288,6,328,4],[288,12,328,10],[288,16,328,10,"storageRemove"],[288,27,328,23],[288,28,328,23,"storageRemove"],[288,41,328,23],[288,43,328,24,"LEGACY_STORAGE_KEY"],[288,61,328,42],[288,62,328,43],[289,6,329,4,"dlog"],[289,10,329,8],[289,11,329,9],[289,57,329,55],[289,58,329,56],[290,4,331,2],[290,5,331,3],[290,6,331,4],[290,13,331,11,"e"],[290,14,331,12],[290,16,331,14],[291,6,332,4,"console"],[291,13,332,11],[291,14,332,12,"error"],[291,19,332,17],[291,20,332,18],[291,64,332,62],[291,66,332,64,"e"],[291,67,332,65],[291,68,332,66],[292,4,333,2],[293,2,334,0],[294,0,334,1],[294,3]],"functionMap":{"names":["<global>","dlog","getEntitlementsSnapshotApi","create$argument_0","hydrateEntitlements","refreshFromServer","applySnapshot","storageSet._catch$argument_0","clear","set$argument_0","storageRemove._catch$argument_0","hasEntitlement","devGrantEntitlement","devRevokeEntitlement","devClearAll","migrateLegacyData"],"mappings":"AAA;aC4B,0DD;AEO;CFM;iEGgC;uBCY;GDsB;qBEM;GFkD;iBGM;wDCc,QD;GHC;SKM;QCE;MDM;qCEC,QF;GLC;kBQM;GRa;uBSO;GT+B;wBUE;GViB;eWE;qCJU,QI;GXE;EHC;AeK;CfqC"},"hasCjsExports":false},"type":"js/module"}]}