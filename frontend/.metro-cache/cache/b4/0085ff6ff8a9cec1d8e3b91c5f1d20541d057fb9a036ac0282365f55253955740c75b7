{"dependencies":[{"name":"react-native-web/dist/exports/Alert","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"PEUC6jrQVoAGZ2qYkvimljMOyJI=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":310},"end":{"line":8,"column":37,"index":347}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"./types","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":348},"end":{"line":14,"column":17,"index":478}}],"key":"iV91Bk2eI9buML90FP6cK2SM5h0=","exportNames":["*"],"imports":1}},{"name":"../../stores/entitlementStore","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":20,"column":24,"index":647},"end":{"line":20,"column":64,"index":687}}],"key":"OtCrN9KW8vjKwegHvfNmyn8y/VA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.hasEntitlement = hasEntitlement;\n  exports.requireEntitlement = requireEntitlement;\n  exports.useHasEntitlement = useHasEntitlement;\n  exports.hasPremiumCinematicsPack = hasPremiumCinematicsPack;\n  exports.hasHeroCinematic = hasHeroCinematic;\n  exports.canAccessHeroCinematic = canAccessHeroCinematic;\n  exports.requireCinematicAccess = requireCinematicAccess;\n  exports.hasProSubscription = hasProSubscription;\n  exports.hasNoAds = hasNoAds;\n  var _reactNativeWebDistExportsAlert = require(_dependencyMap[0], \"react-native-web/dist/exports/Alert\");\n  var Alert = _interopDefault(_reactNativeWebDistExportsAlert);\n  var _expoRouter = require(_dependencyMap[1], \"expo-router\");\n  var _types = require(_dependencyMap[2], \"./types\");\n  // /app/frontend/lib/entitlements/gating.ts\n  // Entitlement gating helpers - enforce premium access at UI/navigation level\n  // Server-side enforcement is separate (backend must also reject)\n  // \n  // NOTE: This file imports entitlementStore dynamically to avoid circular deps\n\n  // Dynamic import to avoid circular dependency\n  let _entitlementStore = null;\n  function getEntitlementStore() {\n    if (!_entitlementStore) {\n      _entitlementStore = require(_dependencyMap[3], \"../../stores/entitlementStore\").useEntitlementStore;\n    }\n    return _entitlementStore;\n  }\n\n  /**\n   * Check if user has a specific entitlement (owned + not expired)\n   * Uses server_time for expiry checks\n   */\n  function hasEntitlement(key) {\n    const store = getEntitlementStore();\n    const state = store.getState();\n    const entitlement = state.entitlementsByKey[key];\n    const serverTime = state.snapshot?.server_time || new Date().toISOString();\n    return (0, _types.isEntitlementOwned)(entitlement, serverTime);\n  }\n\n  /**\n   * Require entitlement or show paywall\n   * Use this for guarding premium actions/navigation\n   * \n   * @returns true if entitled, false if blocked (and redirected to paywall)\n   */\n  function requireEntitlement(key, options) {\n    const isEntitled = hasEntitlement(key);\n    if (isEntitled) {\n      return true;\n    }\n    const {\n      alertTitle = 'Premium Feature',\n      alertMessage = 'This feature requires a premium purchase.',\n      showPaywall = true,\n      paywallRoute = '/store'\n    } = options ?? {};\n    Alert.default.alert(alertTitle, alertMessage, showPaywall ? [{\n      text: 'Cancel',\n      style: 'cancel'\n    }, {\n      text: 'View Store',\n      onPress: () => _expoRouter.router.push(paywallRoute)\n    }] : [{\n      text: 'OK'\n    }]);\n    return false;\n  }\n\n  /**\n   * Hook version of hasEntitlement for reactive components\n   * Must be called at top level of component\n   */\n  function useHasEntitlement(key) {\n    const store = getEntitlementStore();\n    const entitlement = store(s => s.entitlementsByKey[key]);\n    const serverTime = store(s => s.snapshot?.server_time) || new Date().toISOString();\n    return (0, _types.isEntitlementOwned)(entitlement, serverTime);\n  }\n\n  /**\n   * Check premium cinematics pack ownership\n   */\n  function hasPremiumCinematicsPack() {\n    return hasEntitlement(_types.ENTITLEMENT_KEYS.PREMIUM_CINEMATICS_PACK);\n  }\n\n  /**\n   * Check specific hero cinematic ownership\n   */\n  function hasHeroCinematic(heroId) {\n    return hasEntitlement(`${_types.PREMIUM_CINEMATIC_OWNED_PREFIX}${heroId}`);\n  }\n\n  /**\n   * Check if user can access any premium cinematic\n   * (either owns pack or individual hero cinematic)\n   */\n  function canAccessHeroCinematic(heroId) {\n    return hasPremiumCinematicsPack() || hasHeroCinematic(heroId);\n  }\n\n  /**\n   * Require premium cinematic access or show paywall\n   */\n  function requireCinematicAccess(heroId) {\n    if (canAccessHeroCinematic(heroId)) {\n      return true;\n    }\n    return requireEntitlement(_types.ENTITLEMENT_KEYS.PREMIUM_CINEMATICS_PACK, {\n      alertTitle: 'Premium Cinematic',\n      alertMessage: 'Unlock this cinematic with the Premium Cinematics Pack or purchase it individually.'\n    });\n  }\n\n  /**\n   * Check Pro subscription status\n   */\n  function hasProSubscription() {\n    return hasEntitlement(_types.ENTITLEMENT_KEYS.PREMIUM);\n  }\n\n  /**\n   * Check No Ads status\n   */\n  function hasNoAds() {\n    return hasEntitlement(_types.ENTITLEMENT_KEYS.NO_ADS);\n  }\n});","lineCount":140,"map":[[12,2,29,0,"exports"],[12,9,29,0],[12,10,29,0,"hasEntitlement"],[12,24,29,0],[12,27,29,0,"hasEntitlement"],[12,41,29,0],[13,2,43,0,"exports"],[13,9,43,0],[13,10,43,0,"requireEntitlement"],[13,28,43,0],[13,31,43,0,"requireEntitlement"],[13,49,43,0],[14,2,86,0,"exports"],[14,9,86,0],[14,10,86,0,"useHasEntitlement"],[14,27,86,0],[14,30,86,0,"useHasEntitlement"],[14,47,86,0],[15,2,96,0,"exports"],[15,9,96,0],[15,10,96,0,"hasPremiumCinematicsPack"],[15,34,96,0],[15,37,96,0,"hasPremiumCinematicsPack"],[15,61,96,0],[16,2,103,0,"exports"],[16,9,103,0],[16,10,103,0,"hasHeroCinematic"],[16,26,103,0],[16,29,103,0,"hasHeroCinematic"],[16,45,103,0],[17,2,111,0,"exports"],[17,9,111,0],[17,10,111,0,"canAccessHeroCinematic"],[17,32,111,0],[17,35,111,0,"canAccessHeroCinematic"],[17,57,111,0],[18,2,118,0,"exports"],[18,9,118,0],[18,10,118,0,"requireCinematicAccess"],[18,32,118,0],[18,35,118,0,"requireCinematicAccess"],[18,57,118,0],[19,2,135,0,"exports"],[19,9,135,0],[19,10,135,0,"hasProSubscription"],[19,28,135,0],[19,31,135,0,"hasProSubscription"],[19,49,135,0],[20,2,142,0,"exports"],[20,9,142,0],[20,10,142,0,"hasNoAds"],[20,18,142,0],[20,21,142,0,"hasNoAds"],[20,29,142,0],[21,2,144,1],[21,6,144,1,"_reactNativeWebDistExportsAlert"],[21,37,144,1],[21,40,144,1,"require"],[21,47,144,1],[21,48,144,1,"_dependencyMap"],[21,62,144,1],[22,2,144,1],[22,6,144,1,"Alert"],[22,11,144,1],[22,14,144,1,"_interopDefault"],[22,29,144,1],[22,30,144,1,"_reactNativeWebDistExportsAlert"],[22,61,144,1],[23,2,8,0],[23,6,8,0,"_expoRouter"],[23,17,8,0],[23,20,8,0,"require"],[23,27,8,0],[23,28,8,0,"_dependencyMap"],[23,42,8,0],[24,2,9,0],[24,6,9,0,"_types"],[24,12,9,0],[24,15,9,0,"require"],[24,22,9,0],[24,23,9,0,"_dependencyMap"],[24,37,9,0],[25,2,1,0],[26,2,2,0],[27,2,3,0],[28,2,4,0],[29,2,5,0],[31,2,16,0],[32,2,17,0],[32,6,17,4,"_entitlementStore"],[32,23,17,26],[32,26,17,29],[32,30,17,33],[33,2,18,0],[33,11,18,9,"getEntitlementStore"],[33,30,18,28,"getEntitlementStore"],[33,31,18,28],[33,33,18,31],[34,4,19,2],[34,8,19,6],[34,9,19,7,"_entitlementStore"],[34,26,19,24],[34,28,19,26],[35,6,20,4,"_entitlementStore"],[35,23,20,21],[35,26,20,24,"require"],[35,33,20,31],[35,34,20,31,"_dependencyMap"],[35,48,20,31],[35,84,20,63],[35,85,20,64],[35,86,20,65,"useEntitlementStore"],[35,105,20,84],[36,4,21,2],[37,4,22,2],[37,11,22,9,"_entitlementStore"],[37,28,22,26],[38,2,23,0],[40,2,25,0],[41,0,26,0],[42,0,27,0],[43,0,28,0],[44,2,29,7],[44,11,29,16,"hasEntitlement"],[44,25,29,30,"hasEntitlement"],[44,26,29,31,"key"],[44,29,29,42],[44,31,29,53],[45,4,30,2],[45,10,30,8,"store"],[45,15,30,13],[45,18,30,16,"getEntitlementStore"],[45,37,30,35],[45,38,30,36],[45,39,30,37],[46,4,31,2],[46,10,31,8,"state"],[46,15,31,13],[46,18,31,16,"store"],[46,23,31,21],[46,24,31,22,"getState"],[46,32,31,30],[46,33,31,31],[46,34,31,32],[47,4,32,2],[47,10,32,8,"entitlement"],[47,21,32,19],[47,24,32,22,"state"],[47,29,32,27],[47,30,32,28,"entitlementsByKey"],[47,47,32,45],[47,48,32,46,"key"],[47,51,32,49],[47,52,32,50],[48,4,33,2],[48,10,33,8,"serverTime"],[48,20,33,18],[48,23,33,21,"state"],[48,28,33,26],[48,29,33,27,"snapshot"],[48,37,33,35],[48,39,33,37,"server_time"],[48,50,33,48],[48,54,33,52],[48,58,33,56,"Date"],[48,62,33,60],[48,63,33,61],[48,64,33,62],[48,65,33,63,"toISOString"],[48,76,33,74],[48,77,33,75],[48,78,33,76],[49,4,34,2],[49,11,34,9],[49,15,34,9,"isEntitlementOwned"],[49,21,34,27],[49,22,34,27,"isEntitlementOwned"],[49,40,34,27],[49,42,34,28,"entitlement"],[49,53,34,39],[49,55,34,41,"serverTime"],[49,65,34,51],[49,66,34,52],[50,2,35,0],[52,2,37,0],[53,0,38,0],[54,0,39,0],[55,0,40,0],[56,0,41,0],[57,0,42,0],[58,2,43,7],[58,11,43,16,"requireEntitlement"],[58,29,43,34,"requireEntitlement"],[58,30,44,2,"key"],[58,33,44,13],[58,35,45,2,"options"],[58,42,50,3],[58,44,51,11],[59,4,52,2],[59,10,52,8,"isEntitled"],[59,20,52,18],[59,23,52,21,"hasEntitlement"],[59,37,52,35],[59,38,52,36,"key"],[59,41,52,39],[59,42,52,40],[60,4,54,2],[60,8,54,6,"isEntitled"],[60,18,54,16],[60,20,54,18],[61,6,55,4],[61,13,55,11],[61,17,55,15],[62,4,56,2],[63,4,58,2],[63,10,58,8],[64,6,59,4,"alertTitle"],[64,16,59,14],[64,19,59,17],[64,36,59,34],[65,6,60,4,"alertMessage"],[65,18,60,16],[65,21,60,19],[65,64,60,62],[66,6,61,4,"showPaywall"],[66,17,61,15],[66,20,61,18],[66,24,61,22],[67,6,62,4,"paywallRoute"],[67,18,62,16],[67,21,62,19],[68,4,63,2],[68,5,63,3],[68,8,63,6,"options"],[68,15,63,13],[68,19,63,17],[68,20,63,18],[68,21,63,19],[69,4,65,2,"Alert"],[69,9,65,7],[69,10,65,7,"default"],[69,17,65,7],[69,18,65,8,"alert"],[69,23,65,13],[69,24,66,4,"alertTitle"],[69,34,66,14],[69,36,67,4,"alertMessage"],[69,48,67,16],[69,50,68,4,"showPaywall"],[69,61,68,15],[69,64,69,8],[69,65,70,10],[70,6,70,12,"text"],[70,10,70,16],[70,12,70,18],[70,20,70,26],[71,6,70,28,"style"],[71,11,70,33],[71,13,70,35],[72,4,70,44],[72,5,70,45],[72,7,71,10],[73,6,72,12,"text"],[73,10,72,16],[73,12,72,18],[73,24,72,30],[74,6,73,12,"onPress"],[74,13,73,19],[74,15,73,21,"onPress"],[74,16,73,21],[74,21,73,27,"router"],[74,32,73,33],[74,33,73,33,"router"],[74,39,73,33],[74,40,73,34,"push"],[74,44,73,38],[74,45,73,39,"paywallRoute"],[74,57,73,58],[75,4,74,10],[75,5,74,11],[75,6,75,9],[75,9,76,8],[75,10,76,9],[76,6,76,11,"text"],[76,10,76,15],[76,12,76,17],[77,4,76,22],[77,5,76,23],[77,6,77,2],[77,7,77,3],[78,4,79,2],[78,11,79,9],[78,16,79,14],[79,2,80,0],[81,2,82,0],[82,0,83,0],[83,0,84,0],[84,0,85,0],[85,2,86,7],[85,11,86,16,"useHasEntitlement"],[85,28,86,33,"useHasEntitlement"],[85,29,86,34,"key"],[85,32,86,45],[85,34,86,56],[86,4,87,2],[86,10,87,8,"store"],[86,15,87,13],[86,18,87,16,"getEntitlementStore"],[86,37,87,35],[86,38,87,36],[86,39,87,37],[87,4,88,2],[87,10,88,8,"entitlement"],[87,21,88,19],[87,24,88,22,"store"],[87,29,88,27],[87,30,88,29,"s"],[87,31,88,35],[87,35,88,40,"s"],[87,36,88,41],[87,37,88,42,"entitlementsByKey"],[87,54,88,59],[87,55,88,60,"key"],[87,58,88,63],[87,59,88,64],[87,60,88,65],[88,4,89,2],[88,10,89,8,"serverTime"],[88,20,89,18],[88,23,89,21,"store"],[88,28,89,26],[88,29,89,28,"s"],[88,30,89,34],[88,34,89,39,"s"],[88,35,89,40],[88,36,89,41,"snapshot"],[88,44,89,49],[88,46,89,51,"server_time"],[88,57,89,62],[88,58,89,63],[88,62,89,67],[88,66,89,71,"Date"],[88,70,89,75],[88,71,89,76],[88,72,89,77],[88,73,89,78,"toISOString"],[88,84,89,89],[88,85,89,90],[88,86,89,91],[89,4,90,2],[89,11,90,9],[89,15,90,9,"isEntitlementOwned"],[89,21,90,27],[89,22,90,27,"isEntitlementOwned"],[89,40,90,27],[89,42,90,28,"entitlement"],[89,53,90,39],[89,55,90,41,"serverTime"],[89,65,90,51],[89,66,90,52],[90,2,91,0],[92,2,93,0],[93,0,94,0],[94,0,95,0],[95,2,96,7],[95,11,96,16,"hasPremiumCinematicsPack"],[95,35,96,40,"hasPremiumCinematicsPack"],[95,36,96,40],[95,38,96,52],[96,4,97,2],[96,11,97,9,"hasEntitlement"],[96,25,97,23],[96,26,97,24,"ENTITLEMENT_KEYS"],[96,32,97,40],[96,33,97,40,"ENTITLEMENT_KEYS"],[96,49,97,40],[96,50,97,41,"PREMIUM_CINEMATICS_PACK"],[96,73,97,64],[96,74,97,65],[97,2,98,0],[99,2,100,0],[100,0,101,0],[101,0,102,0],[102,2,103,7],[102,11,103,16,"hasHeroCinematic"],[102,27,103,32,"hasHeroCinematic"],[102,28,103,33,"heroId"],[102,34,103,47],[102,36,103,58],[103,4,104,2],[103,11,104,9,"hasEntitlement"],[103,25,104,23],[103,26,104,24],[103,29,104,27,"PREMIUM_CINEMATIC_OWNED_PREFIX"],[103,35,104,57],[103,36,104,57,"PREMIUM_CINEMATIC_OWNED_PREFIX"],[103,66,104,57],[103,69,104,60,"heroId"],[103,75,104,66],[103,77,104,68],[103,78,104,69],[104,2,105,0],[106,2,107,0],[107,0,108,0],[108,0,109,0],[109,0,110,0],[110,2,111,7],[110,11,111,16,"canAccessHeroCinematic"],[110,33,111,38,"canAccessHeroCinematic"],[110,34,111,39,"heroId"],[110,40,111,53],[110,42,111,64],[111,4,112,2],[111,11,112,9,"hasPremiumCinematicsPack"],[111,35,112,33],[111,36,112,34],[111,37,112,35],[111,41,112,39,"hasHeroCinematic"],[111,57,112,55],[111,58,112,56,"heroId"],[111,64,112,62],[111,65,112,63],[112,2,113,0],[114,2,115,0],[115,0,116,0],[116,0,117,0],[117,2,118,7],[117,11,118,16,"requireCinematicAccess"],[117,33,118,38,"requireCinematicAccess"],[117,34,118,39,"heroId"],[117,40,118,53],[117,42,118,64],[118,4,119,2],[118,8,119,6,"canAccessHeroCinematic"],[118,30,119,28],[118,31,119,29,"heroId"],[118,37,119,35],[118,38,119,36],[118,40,119,38],[119,6,120,4],[119,13,120,11],[119,17,120,15],[120,4,121,2],[121,4,123,2],[121,11,123,9,"requireEntitlement"],[121,29,123,27],[121,30,124,4,"ENTITLEMENT_KEYS"],[121,36,124,20],[121,37,124,20,"ENTITLEMENT_KEYS"],[121,53,124,20],[121,54,124,21,"PREMIUM_CINEMATICS_PACK"],[121,77,124,44],[121,79,125,4],[122,6,126,6,"alertTitle"],[122,16,126,16],[122,18,126,18],[122,37,126,37],[123,6,127,6,"alertMessage"],[123,18,127,18],[123,20,127,20],[124,4,128,4],[124,5,129,2],[124,6,129,3],[125,2,130,0],[127,2,132,0],[128,0,133,0],[129,0,134,0],[130,2,135,7],[130,11,135,16,"hasProSubscription"],[130,29,135,34,"hasProSubscription"],[130,30,135,34],[130,32,135,46],[131,4,136,2],[131,11,136,9,"hasEntitlement"],[131,25,136,23],[131,26,136,24,"ENTITLEMENT_KEYS"],[131,32,136,40],[131,33,136,40,"ENTITLEMENT_KEYS"],[131,49,136,40],[131,50,136,41,"PREMIUM"],[131,57,136,48],[131,58,136,49],[132,2,137,0],[134,2,139,0],[135,0,140,0],[136,0,141,0],[137,2,142,7],[137,11,142,16,"hasNoAds"],[137,19,142,24,"hasNoAds"],[137,20,142,24],[137,22,142,36],[138,4,143,2],[138,11,143,9,"hasEntitlement"],[138,25,143,23],[138,26,143,24,"ENTITLEMENT_KEYS"],[138,32,143,40],[138,33,143,40,"ENTITLEMENT_KEYS"],[138,49,143,40],[138,50,143,41,"NO_ADS"],[138,56,143,47],[138,57,143,48],[139,2,144,0],[140,0,144,1],[140,3]],"functionMap":{"names":["<global>","getEntitlementStore","hasEntitlement","requireEntitlement","onPress","useHasEntitlement","store$argument_0","hasPremiumCinematicsPack","hasHeroCinematic","canAccessHeroCinematic","requireCinematicAccess","hasProSubscription","hasNoAds"],"mappings":"AAA;ACiB;CDK;OEM;CFM;OGQ;qBC8B,sCD;CHO;OKM;4BCE,oCD;2BCC,mCD;CLE;OOK;CPE;OQK;CRE;OSM;CTE;OUK;CVY;OWK;CXE;OYK;CZE"},"hasCjsExports":false},"type":"js/module"}]}