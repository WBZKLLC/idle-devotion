{"dependencies":[{"name":"@sentry/core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"/o+dASQcHF2bB25icdsM0E4TExc=","exportNames":["*"],"imports":1}},{"name":"@sentry/utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":65,"index":118}}],"key":"m+kcirlwHAgMIuUoyR2vCxbhWD4=","exportNames":["*"],"imports":1}},{"name":"./utils/node-utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":119},"end":{"line":3,"column":73,"index":192}}],"key":"P5a/WZsfI6fXR126iSDKjdcy1Kk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"Prisma\", {\n    enumerable: true,\n    get: function () {\n      return Prisma;\n    }\n  });\n  var _sentryCore = require(_dependencyMap[0], \"@sentry/core\");\n  var _sentryUtils = require(_dependencyMap[1], \"@sentry/utils\");\n  var _utilsNodeUtilsJs = require(_dependencyMap[2], \"./utils/node-utils.js\");\n  function isValidPrismaClient(possibleClient) {\n    return !!possibleClient && !!possibleClient['$use'];\n  }\n\n  /** Tracing integration for @prisma/client package */\n  class Prisma {\n    /**\n     * @inheritDoc\n     */\n    static __initStatic() {\n      this.id = 'Prisma';\n    }\n\n    /**\n     * @inheritDoc\n     */\n\n    /**\n     * @inheritDoc\n     */\n    constructor(options = {}) {\n      this.name = Prisma.id;\n\n      // We instrument the PrismaClient inside the constructor and not inside `setupOnce` because in some cases of server-side\n      // bundling (Next.js) multiple Prisma clients can be instantiated, even though users don't intend to. When instrumenting\n      // in setupOnce we can only ever instrument one client.\n      // https://github.com/getsentry/sentry-javascript/issues/7216#issuecomment-1602375012\n      // In the future we might explore providing a dedicated PrismaClient middleware instead of this hack.\n      if (isValidPrismaClient(options.client) && !options.client._sentryInstrumented) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (0, _sentryUtils.addNonEnumerableProperty)(options.client, '_sentryInstrumented', true);\n        const clientData = {};\n        try {\n          const engineConfig = options.client._engineConfig;\n          if (engineConfig) {\n            const {\n              activeProvider,\n              clientVersion\n            } = engineConfig;\n            if (activeProvider) {\n              clientData['db.system'] = activeProvider;\n            }\n            if (clientVersion) {\n              clientData['db.prisma.version'] = clientVersion;\n            }\n          }\n        } catch (e) {\n          // ignore\n        }\n        options.client.$use((params, next) => {\n          if ((0, _utilsNodeUtilsJs.shouldDisableAutoInstrumentation)(_sentryCore.getCurrentHub)) {\n            return next(params);\n          }\n          const action = params.action;\n          const model = params.model;\n          return (0, _sentryCore.trace)({\n            name: model ? `${model} ${action}` : action,\n            op: 'db.prisma',\n            origin: 'auto.db.prisma',\n            data: {\n              ...clientData,\n              'db.operation': action\n            }\n          }, () => next(params));\n        });\n      } else {\n        (typeof __SENTRY_DEBUG__ === 'undefined' || __SENTRY_DEBUG__) && _sentryUtils.logger.warn('Unsupported Prisma client provided to PrismaIntegration. Provided client:', options.client);\n      }\n    }\n\n    /**\n     * @inheritDoc\n     */\n    setupOnce() {\n      // Noop - here for backwards compatibility\n    }\n  }\n  Prisma.__initStatic();\n});","lineCount":94,"map":[[7,2,83,0,"Object"],[7,8,83,0],[7,9,83,0,"defineProperty"],[7,23,83,0],[7,24,83,0,"exports"],[7,31,83,0],[8,4,83,0,"enumerable"],[8,14,83,0],[9,4,83,0,"get"],[9,7,83,0],[9,18,83,0,"get"],[9,19,83,0],[10,6,83,0],[10,13,83,9,"Prisma"],[10,19,83,15],[11,4,83,15],[12,2,83,15],[13,2,1,0],[13,6,1,0,"_sentryCore"],[13,17,1,0],[13,20,1,0,"require"],[13,27,1,0],[13,28,1,0,"_dependencyMap"],[13,42,1,0],[14,2,2,0],[14,6,2,0,"_sentryUtils"],[14,18,2,0],[14,21,2,0,"require"],[14,28,2,0],[14,29,2,0,"_dependencyMap"],[14,43,2,0],[15,2,3,0],[15,6,3,0,"_utilsNodeUtilsJs"],[15,23,3,0],[15,26,3,0,"require"],[15,33,3,0],[15,34,3,0,"_dependencyMap"],[15,48,3,0],[16,2,5,0],[16,11,5,9,"isValidPrismaClient"],[16,30,5,28,"isValidPrismaClient"],[16,31,5,29,"possibleClient"],[16,45,5,43],[16,47,5,45],[17,4,6,2],[17,11,6,9],[17,12,6,10],[17,13,6,11,"possibleClient"],[17,27,6,25],[17,31,6,29],[17,32,6,30],[17,33,6,32,"possibleClient"],[17,47,6,46],[17,48,6,49],[17,54,6,55],[17,55,6,56],[18,2,7,0],[20,2,9,0],[21,2,10,0],[21,8,10,6,"Prisma"],[21,14,10,12],[21,15,10,14],[22,4,11,2],[23,0,12,0],[24,0,13,0],[25,4,14,3],[25,11,14,10,"__initStatic"],[25,23,14,22,"__initStatic"],[25,24,14,22],[25,26,14,25],[26,6,14,26],[26,10,14,30],[26,11,14,31,"id"],[26,13,14,33],[26,16,14,36],[26,24,14,44],[27,4,14,45],[29,4,16,2],[30,0,17,0],[31,0,18,0],[33,4,20,2],[34,0,21,0],[35,0,22,0],[36,4,23,3,"constructor"],[36,15,23,14,"constructor"],[36,16,23,15,"options"],[36,23,23,22],[36,26,23,25],[36,27,23,26],[36,28,23,27],[36,30,23,29],[37,6,24,4],[37,10,24,8],[37,11,24,9,"name"],[37,15,24,13],[37,18,24,16,"Prisma"],[37,24,24,22],[37,25,24,23,"id"],[37,27,24,25],[39,6,26,4],[40,6,27,4],[41,6,28,4],[42,6,29,4],[43,6,30,4],[44,6,31,4],[44,10,31,8,"isValidPrismaClient"],[44,29,31,27],[44,30,31,28,"options"],[44,37,31,35],[44,38,31,36,"client"],[44,44,31,42],[44,45,31,43],[44,49,31,47],[44,50,31,48,"options"],[44,57,31,55],[44,58,31,56,"client"],[44,64,31,62],[44,65,31,63,"_sentryInstrumented"],[44,84,31,82],[44,86,31,84],[45,8,32,6],[46,8,33,6],[46,12,33,6,"addNonEnumerableProperty"],[46,24,33,30],[46,25,33,30,"addNonEnumerableProperty"],[46,49,33,30],[46,51,33,31,"options"],[46,58,33,38],[46,59,33,39,"client"],[46,65,33,45],[46,67,33,48],[46,88,33,69],[46,90,33,71],[46,94,33,75],[46,95,33,76],[47,8,35,6],[47,14,35,12,"clientData"],[47,24,35,22],[47,27,35,25],[47,28,35,26],[47,29,35,27],[48,8,36,6],[48,12,36,10],[49,10,37,8],[49,16,37,14,"engineConfig"],[49,28,37,26],[49,31,37,30,"options"],[49,38,37,37],[49,39,37,38,"client"],[49,45,37,44],[49,46,37,47,"_engineConfig"],[49,59,37,60],[50,10,38,8],[50,14,38,12,"engineConfig"],[50,26,38,24],[50,28,38,26],[51,12,39,10],[51,18,39,16],[52,14,39,18,"activeProvider"],[52,28,39,32],[53,14,39,34,"clientVersion"],[54,12,39,48],[54,13,39,49],[54,16,39,52,"engineConfig"],[54,28,39,64],[55,12,40,10],[55,16,40,14,"activeProvider"],[55,30,40,28],[55,32,40,30],[56,14,41,12,"clientData"],[56,24,41,22],[56,25,41,23],[56,36,41,34],[56,37,41,35],[56,40,41,38,"activeProvider"],[56,54,41,52],[57,12,42,10],[58,12,43,10],[58,16,43,14,"clientVersion"],[58,29,43,27],[58,31,43,29],[59,14,44,12,"clientData"],[59,24,44,22],[59,25,44,23],[59,44,44,42],[59,45,44,43],[59,48,44,46,"clientVersion"],[59,61,44,59],[60,12,45,10],[61,10,46,8],[62,8,47,6],[62,9,47,7],[62,10,47,8],[62,17,47,15,"e"],[62,18,47,16],[62,20,47,18],[63,10,48,8],[64,8,48,8],[65,8,51,6,"options"],[65,15,51,13],[65,16,51,14,"client"],[65,22,51,20],[65,23,51,21,"$use"],[65,27,51,25],[65,28,51,26],[65,29,51,27,"params"],[65,35,51,33],[65,37,51,35,"next"],[65,41,51,39],[65,46,51,44],[66,10,52,8],[66,14,52,12],[66,18,52,12,"shouldDisableAutoInstrumentation"],[66,35,52,44],[66,36,52,44,"shouldDisableAutoInstrumentation"],[66,68,52,44],[66,70,52,45,"getCurrentHub"],[66,81,52,58],[66,82,52,58,"getCurrentHub"],[66,95,52,58],[66,96,52,59],[66,98,52,61],[67,12,53,10],[67,19,53,17,"next"],[67,23,53,21],[67,24,53,22,"params"],[67,30,53,28],[67,31,53,29],[68,10,54,8],[69,10,56,8],[69,16,56,14,"action"],[69,22,56,20],[69,25,56,23,"params"],[69,31,56,29],[69,32,56,30,"action"],[69,38,56,36],[70,10,57,8],[70,16,57,14,"model"],[70,21,57,19],[70,24,57,22,"params"],[70,30,57,28],[70,31,57,29,"model"],[70,36,57,34],[71,10,59,8],[71,17,59,15],[71,21,59,15,"trace"],[71,32,59,20],[71,33,59,20,"trace"],[71,38,59,20],[71,40,60,10],[72,12,61,12,"name"],[72,16,61,16],[72,18,61,18,"model"],[72,23,61,23],[72,26,61,26],[72,29,61,29,"model"],[72,34,61,34],[72,38,61,38,"action"],[72,44,61,44],[72,46,61,46],[72,49,61,49,"action"],[72,55,61,55],[73,12,62,12,"op"],[73,14,62,14],[73,16,62,16],[73,27,62,27],[74,12,63,12,"origin"],[74,18,63,18],[74,20,63,20],[74,36,63,36],[75,12,64,12,"data"],[75,16,64,16],[75,18,64,18],[76,14,64,20],[76,17,64,23,"clientData"],[76,27,64,33],[77,14,64,35],[77,28,64,49],[77,30,64,51,"action"],[78,12,64,58],[79,10,65,10],[79,11,65,11],[79,13,66,10],[79,19,66,16,"next"],[79,23,66,20],[79,24,66,21,"params"],[79,30,66,27],[79,31,67,8],[79,32,67,9],[80,8,68,6],[80,9,68,7],[80,10,68,8],[81,6,69,4],[81,7,69,5],[81,13,69,11],[82,8,70,6],[82,9,70,7],[82,16,70,14,"__SENTRY_DEBUG__"],[82,32,70,30],[82,37,70,35],[82,48,70,46],[82,52,70,50,"__SENTRY_DEBUG__"],[82,68,70,66],[82,73,71,8,"logger"],[82,85,71,14],[82,86,71,14,"logger"],[82,92,71,14],[82,93,71,15,"warn"],[82,97,71,19],[82,98,71,20],[82,173,71,95],[82,175,71,97,"options"],[82,182,71,104],[82,183,71,105,"client"],[82,189,71,111],[82,190,71,112],[83,6,72,4],[84,4,73,2],[86,4,75,2],[87,0,76,0],[88,0,77,0],[89,4,78,3,"setupOnce"],[89,13,78,12,"setupOnce"],[89,14,78,12],[89,16,78,15],[90,6,79,4],[91,4,79,4],[92,2,81,0],[93,2,81,2,"Prisma"],[93,8,81,8],[93,9,81,9,"__initStatic"],[93,21,81,21],[93,22,81,22],[93,23,81,23],[94,0,81,24],[94,3]],"functionMap":{"names":["<global>","isValidPrismaClient","Prisma","Prisma.__initStatic","Prisma#constructor","options.client.$use$argument_0","trace$argument_1","Prisma#setupOnce"],"mappings":"AAA;ACI;CDE;AEG;GCI,2CD;GES;0BC4B;UCe,kBD;ODE;GFK;GKK;GLE;CFC"},"hasCjsExports":false},"type":"js/module"}]}