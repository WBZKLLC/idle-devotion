{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.getMailSummary = getMailSummary;\n  exports.getMailRewards = getMailRewards;\n  exports.getMailMessages = getMailMessages;\n  exports.getMailGifts = getMailGifts;\n  exports.claimMailReward = claimMailReward;\n  exports.claimMailGift = claimMailGift;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  // /app/frontend/lib/api/mail.ts\n  // Phase 3.23.2: Mail API Layer\n  //\n  // Canonical API calls for mail system.\n  // Graceful error handling â€” returns defaults on failure.\n\n  const API_BASE = _expoVirtualEnv.env.EXPO_PUBLIC_API_URL || '';\n\n  /**\n   * Get mail summary (badge counts)\n   */\n  async function getMailSummary(username) {\n    try {\n      const res = await fetch(`${API_BASE}/api/mail/summary/${username}`);\n      if (!res.ok) throw new Error('Failed to fetch mail summary');\n      return await res.json();\n    } catch {\n      // Default fallback - show daily rewards available\n      return {\n        rewardsAvailable: 1,\n        unreadMessages: 0,\n        giftsAvailable: 0\n      };\n    }\n  }\n\n  /**\n   * Get mail rewards list\n   */\n  async function getMailRewards(username) {\n    try {\n      const res = await fetch(`${API_BASE}/api/mail/rewards/${username}`);\n      if (!res.ok) throw new Error('Failed to fetch rewards');\n      return await res.json();\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Get mail messages list\n   */\n  async function getMailMessages(username) {\n    try {\n      const res = await fetch(`${API_BASE}/api/mail/messages/${username}`);\n      if (!res.ok) throw new Error('Failed to fetch messages');\n      return await res.json();\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Get mail gifts list\n   */\n  async function getMailGifts(username) {\n    try {\n      const res = await fetch(`${API_BASE}/api/mail/gifts/${username}`);\n      if (!res.ok) throw new Error('Failed to fetch gifts');\n      return await res.json();\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Claim a mail reward\n   */\n  async function claimMailReward(username, rewardId) {\n    const res = await fetch(`${API_BASE}/api/mail/rewards/${username}/${rewardId}/claim`, {\n      method: 'POST'\n    });\n    if (!res.ok) throw new Error('Failed to claim reward');\n  }\n\n  /**\n   * Claim a mail gift\n   */\n  async function claimMailGift(username, giftId) {\n    const res = await fetch(`${API_BASE}/api/mail/gifts/${username}/${giftId}/claim`, {\n      method: 'POST'\n    });\n    if (!res.ok) throw new Error('Failed to claim gift');\n  }\n});","lineCount":98,"map":[[7,2,12,0,"exports"],[7,9,12,0],[7,10,12,0,"getMailSummary"],[7,24,12,0],[7,27,12,0,"getMailSummary"],[7,41,12,0],[8,2,30,0,"exports"],[8,9,30,0],[8,10,30,0,"getMailRewards"],[8,24,30,0],[8,27,30,0,"getMailRewards"],[8,41,30,0],[9,2,50,0,"exports"],[9,9,50,0],[9,10,50,0,"getMailMessages"],[9,25,50,0],[9,28,50,0,"getMailMessages"],[9,43,50,0],[10,2,69,0,"exports"],[10,9,69,0],[10,10,69,0,"getMailGifts"],[10,22,69,0],[10,25,69,0,"getMailGifts"],[10,37,69,0],[11,2,88,0,"exports"],[11,9,88,0],[11,10,88,0,"claimMailReward"],[11,25,88,0],[11,28,88,0,"claimMailReward"],[11,43,88,0],[12,2,98,0,"exports"],[12,9,98,0],[12,10,98,0,"claimMailGift"],[12,23,98,0],[12,26,98,0,"claimMailGift"],[12,39,98,0],[13,2,103,1],[13,6,103,1,"_expoVirtualEnv"],[13,21,103,1],[13,24,103,1,"require"],[13,31,103,1],[13,32,103,1,"_dependencyMap"],[13,46,103,1],[14,2,1,0],[15,2,2,0],[16,2,3,0],[17,2,4,0],[18,2,5,0],[20,2,7,0],[20,8,7,6,"API_BASE"],[20,16,7,14],[20,19,7,17,"_expoVirtualEnv"],[20,34,7,17],[20,35,7,17,"env"],[20,38,7,17],[20,39,7,17,"EXPO_PUBLIC_API_URL"],[20,58,7,17],[20,62,7,52],[20,64,7,54],[22,2,9,0],[23,0,10,0],[24,0,11,0],[25,2,12,7],[25,17,12,22,"getMailSummary"],[25,31,12,36,"getMailSummary"],[25,32,12,37,"username"],[25,40,12,53],[25,42,16,3],[26,4,17,2],[26,8,17,6],[27,6,18,4],[27,12,18,10,"res"],[27,15,18,13],[27,18,18,16],[27,24,18,22,"fetch"],[27,29,18,27],[27,30,18,28],[27,33,18,31,"API_BASE"],[27,41,18,39],[27,62,18,60,"username"],[27,70,18,68],[27,72,18,70],[27,73,18,71],[28,6,19,4],[28,10,19,8],[28,11,19,9,"res"],[28,14,19,12],[28,15,19,13,"ok"],[28,17,19,15],[28,19,19,17],[28,25,19,23],[28,29,19,27,"Error"],[28,34,19,32],[28,35,19,33],[28,65,19,63],[28,66,19,64],[29,6,20,4],[29,13,20,11],[29,19,20,17,"res"],[29,22,20,20],[29,23,20,21,"json"],[29,27,20,25],[29,28,20,26],[29,29,20,27],[30,4,21,2],[30,5,21,3],[30,6,21,4],[30,12,21,10],[31,6,22,4],[32,6,23,4],[32,13,23,11],[33,8,23,13,"rewardsAvailable"],[33,24,23,29],[33,26,23,31],[33,27,23,32],[34,8,23,34,"unreadMessages"],[34,22,23,48],[34,24,23,50],[34,25,23,51],[35,8,23,53,"giftsAvailable"],[35,22,23,67],[35,24,23,69],[36,6,23,71],[36,7,23,72],[37,4,24,2],[38,2,25,0],[40,2,27,0],[41,0,28,0],[42,0,29,0],[43,2,30,7],[43,17,30,22,"getMailRewards"],[43,31,30,36,"getMailRewards"],[43,32,30,37,"username"],[43,40,30,53],[43,42,37,4],[44,4,38,2],[44,8,38,6],[45,6,39,4],[45,12,39,10,"res"],[45,15,39,13],[45,18,39,16],[45,24,39,22,"fetch"],[45,29,39,27],[45,30,39,28],[45,33,39,31,"API_BASE"],[45,41,39,39],[45,62,39,60,"username"],[45,70,39,68],[45,72,39,70],[45,73,39,71],[46,6,40,4],[46,10,40,8],[46,11,40,9,"res"],[46,14,40,12],[46,15,40,13,"ok"],[46,17,40,15],[46,19,40,17],[46,25,40,23],[46,29,40,27,"Error"],[46,34,40,32],[46,35,40,33],[46,60,40,58],[46,61,40,59],[47,6,41,4],[47,13,41,11],[47,19,41,17,"res"],[47,22,41,20],[47,23,41,21,"json"],[47,27,41,25],[47,28,41,26],[47,29,41,27],[48,4,42,2],[48,5,42,3],[48,6,42,4],[48,12,42,10],[49,6,43,4],[49,13,43,11],[49,15,43,13],[50,4,44,2],[51,2,45,0],[53,2,47,0],[54,0,48,0],[55,0,49,0],[56,2,50,7],[56,17,50,22,"getMailMessages"],[56,32,50,37,"getMailMessages"],[56,33,50,38,"username"],[56,41,50,54],[56,43,56,4],[57,4,57,2],[57,8,57,6],[58,6,58,4],[58,12,58,10,"res"],[58,15,58,13],[58,18,58,16],[58,24,58,22,"fetch"],[58,29,58,27],[58,30,58,28],[58,33,58,31,"API_BASE"],[58,41,58,39],[58,63,58,61,"username"],[58,71,58,69],[58,73,58,71],[58,74,58,72],[59,6,59,4],[59,10,59,8],[59,11,59,9,"res"],[59,14,59,12],[59,15,59,13,"ok"],[59,17,59,15],[59,19,59,17],[59,25,59,23],[59,29,59,27,"Error"],[59,34,59,32],[59,35,59,33],[59,61,59,59],[59,62,59,60],[60,6,60,4],[60,13,60,11],[60,19,60,17,"res"],[60,22,60,20],[60,23,60,21,"json"],[60,27,60,25],[60,28,60,26],[60,29,60,27],[61,4,61,2],[61,5,61,3],[61,6,61,4],[61,12,61,10],[62,6,62,4],[62,13,62,11],[62,15,62,13],[63,4,63,2],[64,2,64,0],[66,2,66,0],[67,0,67,0],[68,0,68,0],[69,2,69,7],[69,17,69,22,"getMailGifts"],[69,29,69,34,"getMailGifts"],[69,30,69,35,"username"],[69,38,69,51],[69,40,75,4],[70,4,76,2],[70,8,76,6],[71,6,77,4],[71,12,77,10,"res"],[71,15,77,13],[71,18,77,16],[71,24,77,22,"fetch"],[71,29,77,27],[71,30,77,28],[71,33,77,31,"API_BASE"],[71,41,77,39],[71,60,77,58,"username"],[71,68,77,66],[71,70,77,68],[71,71,77,69],[72,6,78,4],[72,10,78,8],[72,11,78,9,"res"],[72,14,78,12],[72,15,78,13,"ok"],[72,17,78,15],[72,19,78,17],[72,25,78,23],[72,29,78,27,"Error"],[72,34,78,32],[72,35,78,33],[72,58,78,56],[72,59,78,57],[73,6,79,4],[73,13,79,11],[73,19,79,17,"res"],[73,22,79,20],[73,23,79,21,"json"],[73,27,79,25],[73,28,79,26],[73,29,79,27],[74,4,80,2],[74,5,80,3],[74,6,80,4],[74,12,80,10],[75,6,81,4],[75,13,81,11],[75,15,81,13],[76,4,82,2],[77,2,83,0],[79,2,85,0],[80,0,86,0],[81,0,87,0],[82,2,88,7],[82,17,88,22,"claimMailReward"],[82,32,88,37,"claimMailReward"],[82,33,88,38,"username"],[82,41,88,54],[82,43,88,56,"rewardId"],[82,51,88,72],[82,53,88,89],[83,4,89,2],[83,10,89,8,"res"],[83,13,89,11],[83,16,89,14],[83,22,89,20,"fetch"],[83,27,89,25],[83,28,89,26],[83,31,89,29,"API_BASE"],[83,39,89,37],[83,60,89,58,"username"],[83,68,89,66],[83,72,89,70,"rewardId"],[83,80,89,78],[83,88,89,86],[83,90,89,88],[84,6,90,4,"method"],[84,12,90,10],[84,14,90,12],[85,4,91,2],[85,5,91,3],[85,6,91,4],[86,4,92,2],[86,8,92,6],[86,9,92,7,"res"],[86,12,92,10],[86,13,92,11,"ok"],[86,15,92,13],[86,17,92,15],[86,23,92,21],[86,27,92,25,"Error"],[86,32,92,30],[86,33,92,31],[86,57,92,55],[86,58,92,56],[87,2,93,0],[89,2,95,0],[90,0,96,0],[91,0,97,0],[92,2,98,7],[92,17,98,22,"claimMailGift"],[92,30,98,35,"claimMailGift"],[92,31,98,36,"username"],[92,39,98,52],[92,41,98,54,"giftId"],[92,47,98,68],[92,49,98,85],[93,4,99,2],[93,10,99,8,"res"],[93,13,99,11],[93,16,99,14],[93,22,99,20,"fetch"],[93,27,99,25],[93,28,99,26],[93,31,99,29,"API_BASE"],[93,39,99,37],[93,58,99,56,"username"],[93,66,99,64],[93,70,99,68,"giftId"],[93,76,99,74],[93,84,99,82],[93,86,99,84],[94,6,100,4,"method"],[94,12,100,10],[94,14,100,12],[95,4,101,2],[95,5,101,3],[95,6,101,4],[96,4,102,2],[96,8,102,6],[96,9,102,7,"res"],[96,12,102,10],[96,13,102,11,"ok"],[96,15,102,13],[96,17,102,15],[96,23,102,21],[96,27,102,25,"Error"],[96,32,102,30],[96,33,102,31],[96,55,102,53],[96,56,102,54],[97,2,103,0],[98,0,103,1],[98,3]],"functionMap":{"names":["<global>","getMailSummary","getMailRewards","getMailMessages","getMailGifts","claimMailReward","claimMailGift"],"mappings":"AAA;OCW;CDa;OEK;CFe;OGK;CHc;OIK;CJc;OKK;CLK;OMK;CNK"},"hasCjsExports":false},"type":"js/module"}]}